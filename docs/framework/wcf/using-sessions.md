---
title: Použití relací
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: ''
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- sessions [WCF]
ms.assetid: 864ba12f-3331-4359-a359-6d6d387f1035
caps.latest.revision: 32
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 172ef71bd3ae09e3c9f15cb0bdb48728a587605e
ms.sourcegitcommit: 94d33cadc5ff81d2ac389bf5f26422c227832052
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/30/2018
---
# <a name="using-sessions"></a><span data-ttu-id="8e1ab-102">Použití relací</span><span class="sxs-lookup"><span data-stu-id="8e1ab-102">Using Sessions</span></span>
<span data-ttu-id="8e1ab-103">V [!INCLUDE[indigo1](../../../includes/indigo1-md.md)] aplikace, *relace* korelaci skupinu zpráv k konverzaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-103">In [!INCLUDE[indigo1](../../../includes/indigo1-md.md)] applications, a *session* correlates a group of messages into a conversation.</span></span> [!INCLUDE[indigo2](../../../includes/indigo2-md.md)]<span data-ttu-id="8e1ab-104"> relace se liší od k dispozici v objektu session [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] aplikace, podporují různé chování a jsou ovládaná různými způsoby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-104"> sessions are different than the session object available in [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] applications, support different behaviors, and are controlled in different ways.</span></span> <span data-ttu-id="8e1ab-105">Toto téma popisuje funkce, které umožňují relací v [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] aplikací a jejich použití.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-105">This topic describes the features that sessions enable in [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] applications and how to use them.</span></span>  
  
## <a name="sessions-in-windows-communication-foundation-applications"></a><span data-ttu-id="8e1ab-106">Relace v aplikacích Windows Communication Foundation</span><span class="sxs-lookup"><span data-stu-id="8e1ab-106">Sessions in Windows Communication Foundation Applications</span></span>  
 <span data-ttu-id="8e1ab-107">Při kontrakt služby specifikuje, že vyžaduje relaci, je této smlouvy určující, zda všechna volání (který je základní výměny zpráv podporující volání) musí být součástí stejné konverzaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-107">When a service contract specifies that it requires a session, that contract is specifying that all calls (that is, the underlying message exchanges that support the calls) must be part of the same conversation.</span></span> <span data-ttu-id="8e1ab-108">Pokud kontrakt Určuje, že umožňuje relace, ale nevyžaduje jeden, klienti mohou připojit a buď vytvořit relaci nebo není vytvořit relaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-108">If a contract specifies that it allows sessions but does not require one, clients can connect and either establish a session or not establish a session.</span></span> <span data-ttu-id="8e1ab-109">Pokud relace skončí a je odeslána zpráva prostřednictvím stejného kanálu, který je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-109">If the session ends and a message is sent through the same channel an exception is thrown.</span></span>  
  
 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)]<span data-ttu-id="8e1ab-110"> relace mají následující hlavní koncepční funkce:</span><span class="sxs-lookup"><span data-stu-id="8e1ab-110"> sessions have the following main conceptual features:</span></span>  
  
-   <span data-ttu-id="8e1ab-111">Jsou explicitně iniciované a ukončila příkazem volající aplikace (klienta WCF).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-111">They are explicitly initiated and terminated by the calling application (the WCF client).</span></span>  
  
-   <span data-ttu-id="8e1ab-112">Zpráv doručených během relace se zpracovávají v pořadí, ve kterém jsou přijaty.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-112">Messages delivered during a session are processed in the order in which they are received.</span></span>  
  
-   <span data-ttu-id="8e1ab-113">Relace korelovat skupinu zpráv k konverzaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-113">Sessions correlate a group of messages into a conversation.</span></span> <span data-ttu-id="8e1ab-114">Různé typy korelace je možné.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-114">Different types of correlation are possible.</span></span> <span data-ttu-id="8e1ab-115">Jeden kanál na bázi relace, například mohou souviset zprávy založené na sdílené síťové připojení, zatímco jiné kanál na bázi relací, mohou souviset zprávy založené na značku sdílené v textu zprávy.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-115">For instance, one session-based channel may correlate messages based on a shared network connection while another session-based channel may correlate messages based on a shared tag in the message body.</span></span> <span data-ttu-id="8e1ab-116">Funkce, které může být odvozen z relace závisí na povaze korelaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-116">The features that can be derived from the session depend on the nature of the correlation.</span></span>  
  
-   <span data-ttu-id="8e1ab-117">Neexistuje žádné obecné datové úložiště přidružené [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] relace.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-117">There is no general data store associated with a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] session.</span></span>  
  
 <span data-ttu-id="8e1ab-118">Pokud jste se seznámili s <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> třídy v [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] aplikace a funkce, poskytuje, můžete si všimnout, následující rozdíly mezi tento druh relace a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] relace:</span><span class="sxs-lookup"><span data-stu-id="8e1ab-118">If you are familiar with the <xref:System.Web.SessionState.HttpSessionState?displayProperty=nameWithType> class in [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] applications and the functionality it provides, you might notice the following differences between that kind of session and [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] sessions:</span></span>  
  
-   [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]<span data-ttu-id="8e1ab-119"> relace jsou vždy iniciovaných serverem.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-119"> sessions are always server-initiated.</span></span>  
  
-   [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]<span data-ttu-id="8e1ab-120"> jsou implicitně neuspořádaný relace.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-120"> sessions are implicitly unordered.</span></span>  
  
-   [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]<span data-ttu-id="8e1ab-121"> relace poskytují mechanismus obecné datové úložiště napříč požadavky.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-121"> sessions provide a general data storage mechanism across requests.</span></span>  
  
 <span data-ttu-id="8e1ab-122">Toto téma popisuje:</span><span class="sxs-lookup"><span data-stu-id="8e1ab-122">This topic describes:</span></span>  
  
-   <span data-ttu-id="8e1ab-123">Výchozí chování při spuštění při použití vazby na bázi relace v vrstva modelu služby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-123">The default execution behavior when using session-based bindings in the service model layer.</span></span>  
  
-   <span data-ttu-id="8e1ab-124">Typy funkce, které [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] poskytují na bázi relace, pokud systém vazby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-124">The types of features that the [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] session-based, system-provided bindings provide.</span></span>  
  
-   <span data-ttu-id="8e1ab-125">Postup vytvoření kontraktu, který deklaruje požadavek relace.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-125">How to create a contract that declares a session requirement.</span></span>  
  
-   <span data-ttu-id="8e1ab-126">Jak pochopit a řídí vytváření a ukončení relace a vztah relace v instanci služby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-126">How to understand and control the creation and termination of the session and the relationship of the session to the service instance.</span></span>  
  
## <a name="default-execution-behavior-using-sessions"></a><span data-ttu-id="8e1ab-127">Výchozí provádění chování pomocí relace</span><span class="sxs-lookup"><span data-stu-id="8e1ab-127">Default Execution Behavior Using Sessions</span></span>  
 <span data-ttu-id="8e1ab-128">Je volána vazbu, která se pokusí o zahájení relace *na bázi relací* vazby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-128">A binding that attempts to initiate a session is called a *session-based* binding.</span></span> <span data-ttu-id="8e1ab-129">Kontrakty služeb uvést, že budou vyžadovat, povolit nebo odmítnout na bázi relací vazby nastavením <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> vlastnost u rozhraní kontraktu služby (nebo třída) do jednoho z <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> hodnot výčtu.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-129">Service contracts specify that they require, permit, or refuse session-based bindings by setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property on the service contract interface (or class) to one of the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> enumeration values.</span></span> <span data-ttu-id="8e1ab-130">Výchozí hodnota této vlastnosti je <xref:System.ServiceModel.SessionMode.Allowed>, což znamená, že pokud klient používá vazba na bázi relace s [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] implementace služby službu vytváří a používá zadané relace.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-130">By default, the value of this property is <xref:System.ServiceModel.SessionMode.Allowed>, which means that if a client uses a session-based binding with a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service implementation, the service establishes and uses the session provided.</span></span>  
  
 <span data-ttu-id="8e1ab-131">Když [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] služba přijímá klientské relace, ve výchozím nastavení jsou povoleny následující funkce:</span><span class="sxs-lookup"><span data-stu-id="8e1ab-131">When a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service accepts a client session, the following features are enabled by default:</span></span>  
  
1.  <span data-ttu-id="8e1ab-132">Všechna volání mezi [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] objekt klienta jsou zpracovávány stejnou instanci služby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-132">All calls between a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client object are handled by the same service instance.</span></span>  
  
2.  <span data-ttu-id="8e1ab-133">Různé vazby na bázi relací poskytují další funkce.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-133">Different session-based bindings provide additional features.</span></span>  
  
## <a name="system-provided-session-types"></a><span data-ttu-id="8e1ab-134">Typy relace poskytované systémem</span><span class="sxs-lookup"><span data-stu-id="8e1ab-134">System-Provided Session Types</span></span>  
 <span data-ttu-id="8e1ab-135">Vazba na bázi relací podporuje přidružení výchozí instanci služby s konkrétní relací.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-135">A session-based binding supports the default association of a service instance with a particular session.</span></span> <span data-ttu-id="8e1ab-136">Různé vazby na bázi relací však podporují různé funkce kromě povolení na bázi relací zřizování instancí řízení popsaných výše.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-136">However, different session-based bindings support different features in addition to enabling the session-based instancing control previously described.</span></span>  
  
 [!INCLUDE[indigo2](../../../includes/indigo2-md.md)]<span data-ttu-id="8e1ab-137"> poskytuje následující typy chování na základě relace aplikace:</span><span class="sxs-lookup"><span data-stu-id="8e1ab-137"> provides the following types of session-based application behavior:</span></span>  
  
-   <span data-ttu-id="8e1ab-138"><xref:System.ServiceModel.Channels.SecurityBindingElement?displayProperty=nameWithType> Podporuje zabezpečení na základě relací, ve kterých obou konců komunikace uzavřeli na konkrétní zabezpečenou konverzaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-138">The <xref:System.ServiceModel.Channels.SecurityBindingElement?displayProperty=nameWithType> supports security-based sessions, in which both ends of communication have agreed upon a specific secure conversation.</span></span> <span data-ttu-id="8e1ab-139">Další informace najdete v tématu [zabezpečení služby](../../../docs/framework/wcf/securing-services.md).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-139">For more information, see [Securing Services](../../../docs/framework/wcf/securing-services.md).</span></span> <span data-ttu-id="8e1ab-140">Například <xref:System.ServiceModel.WSHttpBinding?displayProperty=nameWithType> vazby, který obsahuje podporu pro zabezpečení relací a spolehlivé relace, ve výchozím nastavení používá jenom zabezpečené relace, který šifruje a digitálně podepíše zprávy.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-140">For example, the <xref:System.ServiceModel.WSHttpBinding?displayProperty=nameWithType> binding, which contains support for both security sessions and reliable sessions, by default uses only a secure session that encrypts and digitally signs messages.</span></span>  
  
-   <span data-ttu-id="8e1ab-141"><xref:System.ServiceModel.NetTcpBinding?displayProperty=nameWithType> Vazba podporuje založené na protokolu TCP relací zajistit, že jsou všechny zprávy korelační připojení na úrovni soketu.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-141">The <xref:System.ServiceModel.NetTcpBinding?displayProperty=nameWithType> binding supports TCP/IP-based sessions to ensure that all messages are correlated by the connection at the socket level.</span></span>  
  
-   <span data-ttu-id="8e1ab-142"><xref:System.ServiceModel.Channels.ReliableSessionBindingElement?displayProperty=nameWithType> Element, který implementuje specifikace protokolu WS-ReliableMessaging, poskytuje podporu pro spolehlivé relace, ve kterých je možné nakonfigurovat zprávy na doručit v pořadí a přesně po zajištění i v případě, že zprávy při přenosu jsou přijaty zprávy. mezi několika uzly během konverzace.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-142">The <xref:System.ServiceModel.Channels.ReliableSessionBindingElement?displayProperty=nameWithType> element, which implements the WS-ReliableMessaging specification, provides support for reliable sessions in which messages can be configured to be delivered in order and exactly once, ensuring messages are received even when messages travel across multiple nodes during the conversation.</span></span> <span data-ttu-id="8e1ab-143">Další informace najdete v tématu [spolehlivé relace](../../../docs/framework/wcf/feature-details/reliable-sessions.md).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-143">For more information, see [Reliable Sessions](../../../docs/framework/wcf/feature-details/reliable-sessions.md).</span></span>  
  
-   <span data-ttu-id="8e1ab-144"><xref:System.ServiceModel.NetMsmqBinding?displayProperty=nameWithType> Vazby poskytuje relací datagram MSMQ.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-144">The <xref:System.ServiceModel.NetMsmqBinding?displayProperty=nameWithType> binding provides MSMQ datagram sessions.</span></span> <span data-ttu-id="8e1ab-145">Další informace najdete v tématu [fronty ve WCF](../../../docs/framework/wcf/feature-details/queues-in-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-145">For more information, see [Queues in WCF](../../../docs/framework/wcf/feature-details/queues-in-wcf.md).</span></span>  
  
 <span data-ttu-id="8e1ab-146">Nastavení <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> vlastnost neurčuje typ relace kontrakt vyžaduje, jen to vyžaduje jeden.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-146">Setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> property does not specify the type of session the contract requires, only that it requires one.</span></span>  
  
## <a name="creating-a-contract-that-requires-a-session"></a><span data-ttu-id="8e1ab-147">Vytvoření kontraktu, která vyžaduje relaci</span><span class="sxs-lookup"><span data-stu-id="8e1ab-147">Creating a Contract That Requires a Session</span></span>  
 <span data-ttu-id="8e1ab-148">Vytvoření kontraktu, která vyžaduje že relaci tvrdí, že skupině operací, které kontrakt služby deklaruje všechny se provedou v rámci stejné relace a že zprávy musí být dodávány v určitém pořadí.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-148">Creating a contract that requires a session states that the group of operations that the service contract declares must all be executed within the same session and that messages must be delivered in order.</span></span> <span data-ttu-id="8e1ab-149">K vyhodnocení úroveň podpory relace, která vyžaduje kontraktu služby, nastavte <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> vlastnost na rozhraní kontraktu služby nebo třída na hodnotu <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> výčtu k určení zda kontrakt:</span><span class="sxs-lookup"><span data-stu-id="8e1ab-149">To assert the level of session support that a service contract requires, set the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A?displayProperty=nameWithType> property on your service contract interface or class to the value of the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> enumeration to specify whether the contract:</span></span>  
  
-   <span data-ttu-id="8e1ab-150">Vyžaduje relaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-150">Requires a session.</span></span>  
  
-   <span data-ttu-id="8e1ab-151">Umožňuje vytvořit relaci klienta.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-151">Allows a client to establish a session.</span></span>  
  
-   <span data-ttu-id="8e1ab-152">Zakáže relaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-152">Prohibits a session.</span></span>  
  
 <span data-ttu-id="8e1ab-153">Nastavení <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> vlastnost však neurčuje typ chování na základě relace vyžaduje kontrakt.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-153">Setting the <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A> property does not, however, specify the type of session-based behavior the contract requires.</span></span> <span data-ttu-id="8e1ab-154">Zadá [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] potvrďte za běhu, nakonfigurované (která vytvoří komunikační kanál) pro službu nemá, neexistuje nebo můžete vytvořit relaci při implementaci služby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-154">It instructs [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] to confirm at runtime that the configured binding (which creates the communication channel) for the service does, does not, or can establish a session when implementing a service.</span></span> <span data-ttu-id="8e1ab-155">Znovu, vazba může stát odpovědí na tento požadavek s žádným typem relace na základě chování zvolí – zabezpečení, přenos, spolehlivé nebo jejich kombinaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-155">Again, the binding can satisfy that requirement with any type of session-based behavior it chooses—security, transport, reliable, or some combination.</span></span> <span data-ttu-id="8e1ab-156">Přesný postup závisí na <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> hodnota vybraná.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-156">The exact behavior depends on the <xref:System.ServiceModel.SessionMode?displayProperty=nameWithType> value selected.</span></span> <span data-ttu-id="8e1ab-157">Pokud je nakonfigurovaná vazba služby neodpovídá hodnotě <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A>, je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-157">If the configured binding of the service does not conform to the value of <xref:System.ServiceModel.ServiceContractAttribute.SessionMode%2A>, an exception is thrown.</span></span> <span data-ttu-id="8e1ab-158">Vazby a kanály vytvoří že relací podpory se říká, že na bázi relací.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-158">Bindings and the channels they create that support sessions are said to be session-based.</span></span>  
  
 <span data-ttu-id="8e1ab-159">Následující kontrakt služby určuje, že všechny operace v `ICalculatorSession` musí být vyměňují v rámci relace.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-159">The following service contract specifies that all operations in the `ICalculatorSession` must be exchanged within a session.</span></span> <span data-ttu-id="8e1ab-160">Žádná z operací vrací hodnotu volajícího s výjimkou `Equals` metoda.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-160">None of the operations returns a value to the caller except the `Equals` method.</span></span> <span data-ttu-id="8e1ab-161">Ale `Equals` metoda nepřijímá žádné parametry a proto může vrátit pouze nenulovou hodnotu v relaci, ve kterém data již byla předána dalších operací.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-161">However, the `Equals` method takes no parameters and, therefore, can only return a non-zero value inside a session in which data has already been passed to the other operations.</span></span> <span data-ttu-id="8e1ab-162">Tato smlouva vyžaduje relaci fungovat správně.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-162">This contract requires a session to function properly.</span></span> <span data-ttu-id="8e1ab-163">Bez relaci spojené s konkrétním klientovi instance služby nemá možnost nijak zjistit, jaká předchozí data odeslal tohoto klienta.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-163">Without a session associated with a specific client, the service instance has no way of knowing what previous data this client has sent.</span></span>  
  
 [!code-csharp[S_Service_Session#1](../../../samples/snippets/csharp/VS_Snippets_CFX/s_service_session/cs/service.cs#1)]
 [!code-vb[S_Service_Session#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/s_service_session/vb/service.vb#1)]  
  
 <span data-ttu-id="8e1ab-164">Pokud služba umožňuje relaci, pak relace je vytvořit a použít, pokud klient zahájí jeden; jinak není třeba vytvořit relaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-164">If a service allows a session, then a session is established and used if the client initiates one; otherwise, no session is established.</span></span>  
  
## <a name="sessions-and-service-instances"></a><span data-ttu-id="8e1ab-165">Relace a instance služby</span><span class="sxs-lookup"><span data-stu-id="8e1ab-165">Sessions and Service Instances</span></span>  
 <span data-ttu-id="8e1ab-166">Pokud použijete výchozí chování v vytváření instancí [!INCLUDE[indigo2](../../../includes/indigo2-md.md)], všechna volání mezi [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] objekt klienta jsou zpracovávány stejnou instanci služby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-166">If you use the default instancing behavior in [!INCLUDE[indigo2](../../../includes/indigo2-md.md)], all calls between a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client object are handled by the same service instance.</span></span> <span data-ttu-id="8e1ab-167">Proto na úrovni aplikace, si můžete představit jako povolení chování aplikace, podobně jako místní volání chování relace.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-167">Therefore, at the application level, you can think of a session as enabling application behavior similar to local call behavior.</span></span> <span data-ttu-id="8e1ab-168">Když například vytvoříte místní objekt:</span><span class="sxs-lookup"><span data-stu-id="8e1ab-168">For example, when you create a local object:</span></span>  
  
-   <span data-ttu-id="8e1ab-169">Konstruktor je volána.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-169">A constructor is called.</span></span>  
  
-   <span data-ttu-id="8e1ab-170">Všechny následné volání do [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] odkaz na objekt klienta se zpracovávají na stejnou instanci objektu.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-170">All subsequent calls made to the [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client object reference are processed by the same object instance.</span></span>  
  
-   <span data-ttu-id="8e1ab-171">Destruktor je volána, když je zničen odkaz na objekt.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-171">A destructor is called when the object reference is destroyed.</span></span>  
  
 <span data-ttu-id="8e1ab-172">Relace povolit podobné chování mezi klienty a služby, pokud se používá výchozí chování instance služby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-172">Sessions enable a similar behavior between clients and services as long as the default service instance behavior is used.</span></span> <span data-ttu-id="8e1ab-173">Pokud kontraktu služby vyžaduje nebo podporuje relací, jednu nebo více operací kontrakt může být označen jako inicializaci nebo ukončení relace nastavením <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A> a <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A> vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-173">If a service contract requires or supports sessions, one or more contract operations can be marked as initiating or terminating a session by setting the <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A> and <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A> properties.</span></span>  
  
 <span data-ttu-id="8e1ab-174">*Spouštění operací* jsou ty, které musí být voláno jako první operace novou relaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-174">*Initiating operations* are those that must be called as the first operation of a new session.</span></span> <span data-ttu-id="8e1ab-175">Inicializaci jiné operace lze volat pouze po nejméně jednu operaci Inicializace byla volána.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-175">Non-initiating operations can be called only after at least one initiating operation has been called.</span></span> <span data-ttu-id="8e1ab-176">Proto můžete vytvořit druh relace konstruktor pro vaši službu deklarováním inicializace operace, které jsou navržené tak, aby vstupní od klientů, které jsou vhodné pro začátek instance služby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-176">You can therefore create a kind of session constructor for your service by declaring initiating operations designed to take input from clients appropriate to the beginning of the service instance.</span></span> <span data-ttu-id="8e1ab-177">(Stav je přidružené k této relaci, ale a není objekt služby).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-177">(The state is associated with the session, however, and not the service object.)</span></span>  
  
 <span data-ttu-id="8e1ab-178">*Ukončení operací*, naopak jsou ty, které musí být volána jako poslední zprávy v existující relaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-178">*Terminating operations*, conversely, are those that must be called as the last message in an existing session.</span></span> <span data-ttu-id="8e1ab-179">V případě výchozí [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] recykluje objektu služby a jeho kontextu po uzavření relace, ke kterému se vztahovaly službu.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-179">In the default case, [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] recycles the service object and its context after the session with which the service was associated is closed.</span></span> <span data-ttu-id="8e1ab-180">Proto můžete vytvořit druh – destruktor deklarováním ukončující operations navržený tak, aby vykonávat funkci odpovídající konci instance služby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-180">You can, therefore, create a kind of destructor by declaring terminating operations designed to perform a function appropriate to the end of the service instance.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="8e1ab-181">I když výchozí chování nenese podobný místní konstruktory a destruktory, je pouze podobají.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-181">Although the default behavior bears a resemblance to local constructors and destructors, it is only a resemblance.</span></span> <span data-ttu-id="8e1ab-182">Všechny [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] operace služby může být inicializaci nebo ukončování operace nebo oba ve stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-182">Any [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service operation can be an initiating or terminating operation, or both at the same time.</span></span> <span data-ttu-id="8e1ab-183">Kromě toho v případě výchozí spouštění operací lze volat libovolný počet časy v libovolném pořadí; žádné další relace jsou vytvořeny po vytvoření a přidružené instance, pokud explicitně řídí životnost instance služby relace (manipulací <xref:System.ServiceModel.InstanceContext?displayProperty=nameWithType> objekt).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-183">In addition, in the default case, initiating operations can be called any number of times in any order; no additional sessions are created once the session is established and associated with an instance unless you explicitly control the lifetime of the service instance (by manipulating the <xref:System.ServiceModel.InstanceContext?displayProperty=nameWithType> object).</span></span> <span data-ttu-id="8e1ab-184">Nakonec stav je přidružena k relaci a není objektu služby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-184">Finally, the state is associated with the session and not the service object.</span></span>  
  
 <span data-ttu-id="8e1ab-185">Například `ICalculatorSession` smlouvy používat v předchozím příkladu vyžaduje, aby [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] první volání objektu klienta `Clear` operaci před všechny ostatní operace a zda relace s to [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] objekt klienta by měl ukončit při volání `Equals` operaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-185">For example, the `ICalculatorSession` contract used in the preceding example requires that the [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client object first call the `Clear` operation prior to any other operation and that the session with this [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client object should terminate when it calls the `Equals` operation.</span></span> <span data-ttu-id="8e1ab-186">Následující příklad kódu ukazuje kontrakt, který vynucuje tyto požadavky.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-186">The following code example shows a contract that enforces these requirements.</span></span> <span data-ttu-id="8e1ab-187">`Clear` musí být nejdříve volána k zahájení relace, a že ukončení relace při `Equals` je volána.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-187">`Clear` must be called first to initiate a session, and that session ends when `Equals` is called.</span></span>  
  
 [!code-csharp[SCA.IsInitiatingIsTerminating#1](../../../samples/snippets/csharp/VS_Snippets_CFX/sca.isinitiatingisterminating/cs/service.cs#1)]
 [!code-vb[SCA.IsInitiatingIsTerminating#1](../../../samples/snippets/visualbasic/VS_Snippets_CFX/sca.isinitiatingisterminating/vb/service.vb#1)]  
  
 <span data-ttu-id="8e1ab-188">Služby nelze spustit relace s klienty.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-188">Services do not start sessions with clients.</span></span> <span data-ttu-id="8e1ab-189">V [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] klientské aplikace, existuje přímé vztah mezi životnost kanál na bázi relací a doba platnosti relace, sám sebe.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-189">In [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client applications, a direct relationship exists between the lifetime of the session-based channel and the lifetime of the session itself.</span></span> <span data-ttu-id="8e1ab-190">Klienti jako takový vytvořit nové relace vytvářejí nové kanály na bázi relací a přerušit existující relace řádně ukončením relace na základě kanály.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-190">As such, clients create new sessions by creating new session-based channels and tear down existing sessions by closing session-based channels gracefully.</span></span> <span data-ttu-id="8e1ab-191">Klient spustí relaci s koncového bodu služby voláním jednu z těchto možností:</span><span class="sxs-lookup"><span data-stu-id="8e1ab-191">A client starts a session with a service endpoint by calling one of the following:</span></span>  
  
-   <span data-ttu-id="8e1ab-192"><xref:System.ServiceModel.ICommunicationObject.Open%2A?displayProperty=nameWithType> na kanálu vrácený volání <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-192"><xref:System.ServiceModel.ICommunicationObject.Open%2A?displayProperty=nameWithType> on the channel returned by a call to <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="8e1ab-193"><xref:System.ServiceModel.ClientBase%601.Open%2A?displayProperty=nameWithType> na [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] objekt klienta, které jsou generované [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-193"><xref:System.ServiceModel.ClientBase%601.Open%2A?displayProperty=nameWithType> on the [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client object generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span>  
  
-   <span data-ttu-id="8e1ab-194">Operace inicializace na některý typ [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] objekt klienta (ve výchozím nastavení, jsou všechny operace inicializace).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-194">An initiating operation on either type of [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client object (by default, all operations are initiating).</span></span> <span data-ttu-id="8e1ab-195">Při první operace je volána, [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] objekt klient automaticky otevře kanál a inicializuje relaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-195">When the first operation is called, the [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client object automatically opens the channel and initiates a session.</span></span>  
  
 <span data-ttu-id="8e1ab-196">Klient obvykle ukončí relaci s koncového bodu služby voláním jednu z těchto možností:</span><span class="sxs-lookup"><span data-stu-id="8e1ab-196">Typically a client ends a session with a service endpoint by calling one of the following:</span></span>  
  
-   <span data-ttu-id="8e1ab-197"><xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> na kanálu vrácený volání <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-197"><xref:System.ServiceModel.ICommunicationObject.Close%2A?displayProperty=nameWithType> on the channel returned by a call to <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="8e1ab-198"><xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType> na [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] generované Svcutil.exe objekt klienta.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-198"><xref:System.ServiceModel.ClientBase%601.Close%2A?displayProperty=nameWithType> on the [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client object generated by Svcutil.exe.</span></span>  
  
-   <span data-ttu-id="8e1ab-199">Ukončování operace na některý typ [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] objekt klienta (ve výchozím nastavení, jsou žádné operace ukončení; kontrakt nutné explicitně zadat ukončování operace).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-199">A terminating operation on either type of [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client object (by default, no operations are terminating; the contract must explicitly specify a terminating operation).</span></span> <span data-ttu-id="8e1ab-200">Při první operace je volána, [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] objekt klient automaticky otevře kanál a inicializuje relaci.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-200">When the first operation is called, the [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] client object automatically opens the channel and initiates a session.</span></span>  
  
 <span data-ttu-id="8e1ab-201">Příklady najdete v tématu [postupy: vytváření služby, vyžaduje relací](../../../docs/framework/wcf/feature-details/how-to-create-a-service-that-requires-sessions.md) společně s [výchozí chování služby](../../../docs/framework/wcf/samples/default-service-behavior.md) a [Instancing](../../../docs/framework/wcf/samples/instancing.md) ukázky.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-201">For examples, see [How to: Create a Service That Requires Sessions](../../../docs/framework/wcf/feature-details/how-to-create-a-service-that-requires-sessions.md) as well as the [Default Service Behavior](../../../docs/framework/wcf/samples/default-service-behavior.md) and [Instancing](../../../docs/framework/wcf/samples/instancing.md) samples.</span></span>  
  
 <span data-ttu-id="8e1ab-202">Další informace o klientech a relací najdete v tématu [přístup k službám pomocí klienta WCF](../../../docs/framework/wcf/feature-details/accessing-services-using-a-client.md).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-202">For more information about clients and sessions, see [Accessing Services Using a WCF Client](../../../docs/framework/wcf/feature-details/accessing-services-using-a-client.md).</span></span>  
  
## <a name="sessions-interact-with-instancecontext-settings"></a><span data-ttu-id="8e1ab-203">Relace interakci s InstanceContext nastavení</span><span class="sxs-lookup"><span data-stu-id="8e1ab-203">Sessions Interact with InstanceContext Settings</span></span>  
 <span data-ttu-id="8e1ab-204">Je interakci mezi <xref:System.ServiceModel.SessionMode> výčet ve kontraktu a <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> vlastnosti, která řídí přidružení mezi kanály a objekty konkrétní služby.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-204">There is an interaction between the <xref:System.ServiceModel.SessionMode> enumeration in a contract and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A?displayProperty=nameWithType> property, which controls the association between channels and specific service objects.</span></span> <span data-ttu-id="8e1ab-205">Další informace najdete v tématu [relací, Instancing a souběžnost](../../../docs/framework/wcf/feature-details/sessions-instancing-and-concurrency.md).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-205">For more information, see [Sessions, Instancing, and Concurrency](../../../docs/framework/wcf/feature-details/sessions-instancing-and-concurrency.md).</span></span>  
  
### <a name="sharing-instancecontext-objects"></a><span data-ttu-id="8e1ab-206">Sdílení InstanceContext objekty</span><span class="sxs-lookup"><span data-stu-id="8e1ab-206">Sharing InstanceContext Objects</span></span>  
 <span data-ttu-id="8e1ab-207">Můžete taky řídit, které na bázi relací kanál nebo volání je přidružen který <xref:System.ServiceModel.InstanceContext> objektu tak, že provedete toto přidružení sami.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-207">You can also control which session-based channel or call is associated with which <xref:System.ServiceModel.InstanceContext> object by performing that association yourself.</span></span> <span data-ttu-id="8e1ab-208">Úplný příklad najdete v tématu [InstanceContextSharing](http://msdn.microsoft.com/library/4a6a46d7-b7d7-4bb5-a0dd-03ffa3cbc230).</span><span class="sxs-lookup"><span data-stu-id="8e1ab-208">For a complete example, see [InstanceContextSharing](http://msdn.microsoft.com/library/4a6a46d7-b7d7-4bb5-a0dd-03ffa3cbc230).</span></span>  
  
## <a name="sessions-and-streaming"></a><span data-ttu-id="8e1ab-209">Relace a vysílání datového proudu</span><span class="sxs-lookup"><span data-stu-id="8e1ab-209">Sessions and Streaming</span></span>  
 <span data-ttu-id="8e1ab-210">Pokud máte velké množství dat pro přenos datových proudů režim přenosu v [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] vhodný alternativu, která umožňuje výchozí chování ukládání do vyrovnávací paměti a zpracování zpráv v paměti jako celek.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-210">When you have a large amount of data to transfer, the streaming transfer mode in [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] is a feasible alternative to the default behavior of buffering and processing messages in memory in their entirety.</span></span> <span data-ttu-id="8e1ab-211">Při volání streamování s vazbou na bázi relací, může dojít k neočekávanému chování.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-211">You may get unexpected behavior when streaming calls with a session-based binding.</span></span> <span data-ttu-id="8e1ab-212">Všechna volání streamování jsou provedeny prostřednictvím jednoho kanálu (kanál datagram), který nepodporuje relace, i v případě, že je vazba používá nakonfigurovaný na použití relací.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-212">All streaming calls are made through a single channel (the datagram channel) that does not support sessions even if the binding being used is configured to use sessions.</span></span> <span data-ttu-id="8e1ab-213">Pokud více klientů volání streamování ke stejnému objektu služby přes vazbu na bázi relací a objektu služby souběžný režim je nastavena na jednou a jeho instance kontextu režim je nastaven `PerSession`, všechna volání musí procházet přes kanál datagram a tak najednou je zpracovat pouze jedno volání.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-213">If multiple clients make streaming calls to the same service object over a session-based binding, and the service object's concurrency mode is set to single and its instance context mode is set to `PerSession`, all calls must go through the datagram channel and so only one call is processed at a time.</span></span> <span data-ttu-id="8e1ab-214">Jeden nebo více klientů může pak vypršení časového limitu. Tento problém můžete vyřešit nastavením objektu služby `InstanceContextMode` k `PerCall` nebo souběžnosti násobek.</span><span class="sxs-lookup"><span data-stu-id="8e1ab-214">One or more clients may then time out. You can work around this issue by either setting the service object's `InstanceContextMode` to `PerCall` or Concurrency to multiple.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="8e1ab-215">MaxConcurrentSessions mít žádný vliv v tomto případě, protože není k dispozici pouze jeden "relace".</span><span class="sxs-lookup"><span data-stu-id="8e1ab-215">MaxConcurrentSessions have no effect in this case because there is only one "session" available.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8e1ab-216">Viz také</span><span class="sxs-lookup"><span data-stu-id="8e1ab-216">See Also</span></span>  
 <xref:System.ServiceModel.OperationContractAttribute.IsInitiating%2A>  
 <xref:System.ServiceModel.OperationContractAttribute.IsTerminating%2A>
