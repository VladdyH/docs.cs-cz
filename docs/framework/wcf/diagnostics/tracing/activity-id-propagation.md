---
title: "Šíření ID aktivity"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: cd1c1ae5-cc8a-4f51-90c9-f7b476bcfe70
caps.latest.revision: "6"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 7bb8ae9388a9f56ad35697a391137c06ed3ae80b
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/02/2017
---
# <a name="activity-id-propagation"></a><span data-ttu-id="8ca74-102">Šíření ID aktivity</span><span class="sxs-lookup"><span data-stu-id="8ca74-102">Activity ID Propagation</span></span>
<span data-ttu-id="8ca74-103">Šíření se stane, když ServiceModel aktivity trasování povoleno (ServiceModel šíření) nebo zakázán (rozšíření aktivity uživatel-uživatel).</span><span class="sxs-lookup"><span data-stu-id="8ca74-103">Propagation happens when ServiceModel activity tracing is enabled (ServiceModel propagation) or disabled (User-to-User activity propagation).</span></span>  
  
## <a name="servicemodel-activity-tracing-is-enabled"></a><span data-ttu-id="8ca74-104">Je povoleno trasování aktivity ServiceModel</span><span class="sxs-lookup"><span data-stu-id="8ca74-104">ServiceModel Activity Tracing is Enabled</span></span>  
 <span data-ttu-id="8ca74-105">Pokud je povoleno ServiceModel ActivityTracing, dochází k šíření mezi ProcessAction aktivity.</span><span class="sxs-lookup"><span data-stu-id="8ca74-105">If ServiceModel ActivityTracing is enabled, propagation happens between ProcessAction activities.</span></span>  
  
### <a name="server"></a><span data-ttu-id="8ca74-106">Server</span><span class="sxs-lookup"><span data-stu-id="8ca74-106">Server</span></span>  
 <span data-ttu-id="8ca74-107">Když `propagateActivity` je atribut nastaven na `true` na klientovi a serveru, ID `ProcessAction` aktivity na serveru je stejný jako Identifikátor v šířený `ActivityId` záhlaví zprávy.</span><span class="sxs-lookup"><span data-stu-id="8ca74-107">When the `propagateActivity` attribute is set to `true` on both the client and server, the ID of the `ProcessAction` activity in the server is identical to the ID in the propagated `ActivityId` message header.</span></span>  
  
 <span data-ttu-id="8ca74-108">Pokud ne `ActivityId` záhlaví se nachází ve zprávě (tedy `propagateActivity` = `false` na straně klienta), nebo když `propagateActivity` = `false` na serveru, server vygeneruje nové ID aktivity.</span><span class="sxs-lookup"><span data-stu-id="8ca74-108">When no `ActivityId` header is present in the message (that is, `propagateActivity`=`false` on the client), or when `propagateActivity`=`false` on the server, the server generates a new activity ID.</span></span>  
  
### <a name="client"></a><span data-ttu-id="8ca74-109">Klient</span><span class="sxs-lookup"><span data-stu-id="8ca74-109">Client</span></span>  
 <span data-ttu-id="8ca74-110">Pokud klient je synchronně jednoho vlákna, klient ignoruje žádné nastavení `propagateActivity` na klienta nebo serveru.</span><span class="sxs-lookup"><span data-stu-id="8ca74-110">If the client is synchronously single threaded, the client disregards any settings of `propagateActivity` at the client or server.</span></span> <span data-ttu-id="8ca74-111">Místo toho je odpověď zpracována v aktivitu žádosti.</span><span class="sxs-lookup"><span data-stu-id="8ca74-111">Instead, the response is handled in the request activity.</span></span> <span data-ttu-id="8ca74-112">Pokud je klient synchronní nebo asynchronní s více vlákny, `propagateActivity` = `true` v klientovi a je ve zprávě server odesílá hlavičku ID aktivity, klient načte ID aktivity ze zprávy a přenese Zpracovat aktivity akce, který obsahuje ID šířený aktivity.</span><span class="sxs-lookup"><span data-stu-id="8ca74-112">If the client is asynchronous or synchronous multithreaded, `propagateActivity`=`true` in the client, and there is an activity ID header in the message sent by the server, the client retrieves the activity ID from the message, and transfers to the Process Action activity that contains the propagated activity ID.</span></span> <span data-ttu-id="8ca74-113">Klient se, jinak hodnota přenáší z aktivitu procesu zprávu novou aktivitu procesu akce.</span><span class="sxs-lookup"><span data-stu-id="8ca74-113">Otherwise, the client transfers from Process Message activity to a new Process Action activity.</span></span> <span data-ttu-id="8ca74-114">K tomuto navíc přenosu nová aktivita procesu akce se provádí pro konzistence.</span><span class="sxs-lookup"><span data-stu-id="8ca74-114">This extra transfer to a new Process Action activity is done for consistency.</span></span> <span data-ttu-id="8ca74-115">Uvnitř této aktivity klient načte ID aktivity BeginCall aktivity z kontextu místní vlákno při vlákno přidělení pro zpracování zprávy odpovědi.</span><span class="sxs-lookup"><span data-stu-id="8ca74-115">Inside this activity, the client retrieves the activity ID of the BeginCall activity from the local thread context, when the thread is allocated for response message processing.</span></span> <span data-ttu-id="8ca74-116">Pak přenese do počáteční aktivity procesu akce.</span><span class="sxs-lookup"><span data-stu-id="8ca74-116">It then transfers to the initial Process Action activity.</span></span>  
  
 <span data-ttu-id="8ca74-117">Pokud je klient duplexní, klient funguje jako server na danou zprávu přijala.</span><span class="sxs-lookup"><span data-stu-id="8ca74-117">If the client is duplex, the client acts as server on receiving the message.</span></span>  
  
### <a name="propagation-in-fault-messages"></a><span data-ttu-id="8ca74-118">Šíření v chybové zprávy</span><span class="sxs-lookup"><span data-stu-id="8ca74-118">Propagation in Fault Messages</span></span>  
 <span data-ttu-id="8ca74-119">Není žádný rozdíl ve zpracování platný a chybové zprávy.</span><span class="sxs-lookup"><span data-stu-id="8ca74-119">There is no difference in handling valid and fault messages.</span></span> <span data-ttu-id="8ca74-120">Pokud `propagateActivity` = `true`, ID aktivity a přidá do hlavičky SOAP selhání zpráv je stejný jako vedlejším aktivity.</span><span class="sxs-lookup"><span data-stu-id="8ca74-120">If `propagateActivity`=`true`, the activity ID added to the SOAP fault message headers is identical to the ambient activity.</span></span>  
  
## <a name="servicemodel-activity-tracing-is-disabled"></a><span data-ttu-id="8ca74-121">Trasování aktivit ServiceModel je zakázána.</span><span class="sxs-lookup"><span data-stu-id="8ca74-121">ServiceModel Activity Tracing is Disabled</span></span>  
 <span data-ttu-id="8ca74-122">Pokud ServiceModel ActivityTracing je zakázaná, dojde k šíření mezi aktivitami kód uživatele přímo bez ServiceModel aktivity.</span><span class="sxs-lookup"><span data-stu-id="8ca74-122">If ServiceModel ActivityTracing is disabled, propagation occurs between user code activities directly without going through ServiceModel activities.</span></span> <span data-ttu-id="8ca74-123">Uživatelem definované aktivity ID také šíří prostřednictvím záhlaví zprávy ID aktivity.</span><span class="sxs-lookup"><span data-stu-id="8ca74-123">A user-defined activity ID is also propagated through the message activity ID header.</span></span>  
  
 <span data-ttu-id="8ca74-124">Pokud `propagateActivity` = `true` a `ActivityTracing` = `off` pro naslouchací ServiceModel (bez ohledu na to, jestli je povolené trasování na ServiceModel) následující dojít na straně klienta nebo serveru:</span><span class="sxs-lookup"><span data-stu-id="8ca74-124">If `propagateActivity`=`true` and `ActivityTracing`=`off` for a ServiceModel trace listener (regardless of whether tracing is enabled on ServiceModel), the following happen on either the client or server:</span></span>  
  
-   <span data-ttu-id="8ca74-125">Žádost o operaci nebo odeslání odpovědi ID aktivity v TLS rozšířena z uživatelského kódu, dokud je vytvořen zprávu.</span><span class="sxs-lookup"><span data-stu-id="8ca74-125">On operation request or sending response, the activity ID in TLS is propagated out of user code until a message is formed.</span></span> <span data-ttu-id="8ca74-126">Hlavičku ID aktivity je rovněž vložen do zprávy před odesláním.</span><span class="sxs-lookup"><span data-stu-id="8ca74-126">An activity ID header is also inserted into the message before it is sent.</span></span>  
  
-   <span data-ttu-id="8ca74-127">Při přijímání požadavku nebo odpovědi přijímání, je ID aktivity načíst z záhlaví zprávy při vytvoření objektu přijaté zprávy.</span><span class="sxs-lookup"><span data-stu-id="8ca74-127">On receiving request or receiving response, the activity ID is retrieved from the message header as soon as the received message object is created.</span></span> <span data-ttu-id="8ca74-128">ID aktivity v TLS rozšířena také zpráva zmizí z oboru, dokud nebude dosaženo uživatelského kódu.</span><span class="sxs-lookup"><span data-stu-id="8ca74-128">The activity ID in TLS is propagated as soon as the message disappears from scope until user code is reached.</span></span>  
  
 <span data-ttu-id="8ca74-129">Tyto akce zaručit, že uživatel trasování se zobrazí v je jedna aktivita, pokud propagace je zapnutá.</span><span class="sxs-lookup"><span data-stu-id="8ca74-129">These actions guarantee that user traces will appear in the same activity if propagation is on.</span></span> <span data-ttu-id="8ca74-130">Lze však žádná záruka na ServiceModel trasování.</span><span class="sxs-lookup"><span data-stu-id="8ca74-130">However, it makes no guarantee on ServiceModel traces.</span></span> <span data-ttu-id="8ca74-131">Trasování ServiceModel dojít kód aktivitou uživatele jenom v případě, že zpracování těchto trasování se spustí ve stejném vlákně, kde byl nastaven kód aktivity uživatelů.</span><span class="sxs-lookup"><span data-stu-id="8ca74-131">ServiceModel traces occur in a user code activity only if the processing of those traces is executed on the same thread where the user code activity was set.</span></span>  
  
 <span data-ttu-id="8ca74-132">Obecně platí může být dodržen ServiceModel trasování na těchto místech:</span><span class="sxs-lookup"><span data-stu-id="8ca74-132">In general, ServiceModel traces can be observed in the following places:</span></span>  
  
-   <span data-ttu-id="8ca74-133">Pokud ServiceModel trasování je zakázáno, se zobrazí v uživatelské aktivity všech emitovaného trasování.</span><span class="sxs-lookup"><span data-stu-id="8ca74-133">If ServiceModel tracing is disabled, all emitted traces appear in user activities.</span></span> <span data-ttu-id="8ca74-134">Pokud je povoleno šíření na serveru a klienta, toto trasování bude ve stejné aktivitě.</span><span class="sxs-lookup"><span data-stu-id="8ca74-134">If propagation is enabled at both the server and client, these traces will be in the same activity.</span></span>  
  
-   <span data-ttu-id="8ca74-135">Pokud je povolené trasování ServiceModel, ale je zakázán ActivityTracing, zobrazí trasování uživatele ve stejné aktivitě, pokud je povoleno šíření na obou koncích.</span><span class="sxs-lookup"><span data-stu-id="8ca74-135">If ServiceModel tracing is enabled, but ActivityTracing is disabled, user traces appear in the same activity if propagation is enabled on both ends.</span></span> <span data-ttu-id="8ca74-136">Nastávají ve stejném vlákně, v jako zpracování kód uživatele, kde aktivity je zpočátku nastavený v výchozí 0000 aktivita, zobrazen ServiceModel trasování.</span><span class="sxs-lookup"><span data-stu-id="8ca74-136">ServiceModel traces appear in the default 0000 activity, unless they occur in the same thread as the user code processing where the activity is initially set.</span></span>  
  
-   <span data-ttu-id="8ca74-137">Pokud jsou povolené trasování ServiceModel a ActivityTracing, trasování uživatele zobrazeny v uživatelské aktivity a ServiceModel trasování zobrazeny v definované ServiceModel aktivity.</span><span class="sxs-lookup"><span data-stu-id="8ca74-137">If both ServiceModel tracing and ActivityTracing are enabled, user traces appear in user-defined activities, and ServiceModel traces appear in ServiceModel-defined activities.</span></span> <span data-ttu-id="8ca74-138">Šíření se odehrává na úrovni ServiceModel.</span><span class="sxs-lookup"><span data-stu-id="8ca74-138">Propagation happens at ServiceModel level.</span></span>
