---
title: Zásady rozšířené ochrany
ms.date: 03/30/2017
ms.assetid: e2616a10-317e-4c34-8023-0c015a80a82f
ms.openlocfilehash: 00d1500b271625addde4499bc62b5ed4d689caf9
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/04/2018
ms.locfileid: "33504355"
---
# <a name="extended-protection-policy"></a><span data-ttu-id="c8222-102">Zásady rozšířené ochrany</span><span class="sxs-lookup"><span data-stu-id="c8222-102">Extended Protection Policy</span></span>
<span data-ttu-id="c8222-103">Rozšířená ochrana je initiative zabezpečení pro ochranu proti útokům man-in-the-middle (typu MITM).</span><span class="sxs-lookup"><span data-stu-id="c8222-103">Extended Protection is a security initiative for protecting against man-in-the-middle (MITM) attacks.</span></span> <span data-ttu-id="c8222-104">Útoky typu MITM je ohrožení zabezpečení, ve kterém MITM přijímá pověření klienta a předává je na server.</span><span class="sxs-lookup"><span data-stu-id="c8222-104">A MITM attack is a security threat in which a MITM takes a client’s credentials and forwards it to a server.</span></span>  
  
## <a name="demonstrates"></a><span data-ttu-id="c8222-105">Demonstruje</span><span class="sxs-lookup"><span data-stu-id="c8222-105">Demonstrates</span></span>  
 <span data-ttu-id="c8222-106">Rozšířená ochrana</span><span class="sxs-lookup"><span data-stu-id="c8222-106">Extended protection</span></span>  
  
## <a name="discussion"></a><span data-ttu-id="c8222-107">Diskusní</span><span class="sxs-lookup"><span data-stu-id="c8222-107">Discussion</span></span>  
 <span data-ttu-id="c8222-108">Pokud aplikace ověřit pomocí protokolu Kerberos, algoritmus Digest ani protokol NTLM pomocí protokolu HTTPS, je nejprve vytvořit kanál úroveň zabezpečení TLS (Transport) a pak ověřování probíhá pomocí zabezpečený kanál.</span><span class="sxs-lookup"><span data-stu-id="c8222-108">When applications authenticate using Kerberos, Digest or NTLM using HTTPS, a Transport Level Security (TLS) channel is first established and then authentication takes place using the secure channel.</span></span> <span data-ttu-id="c8222-109">Však neexistuje žádná vazba mezi klíč relace generované SSL a klíč relace vygenerovaných během ověřování.</span><span class="sxs-lookup"><span data-stu-id="c8222-109">However, there is no binding between the session key generated by SSL and the session key generated during authentication.</span></span> <span data-ttu-id="c8222-110">Všechny MITM můžete určit sám sebe mezi klientem a serverem a spustit předávání žádosti z klienta, i v případě, že kanál přenosu samotného je bezpečné, protože server nemá žádný způsob, jak zjistit, zda zabezpečený kanál je vytvořený z klienta nebo MITM.</span><span class="sxs-lookup"><span data-stu-id="c8222-110">Any MITM can establish itself between the client and the server and start forwarding the requests from the client, even when the transport channel itself is secure, because the server has no way of knowing whether the secure channel has been established from the client or a MITM.</span></span> <span data-ttu-id="c8222-111">Řešení v tomto scénáři je vytvoření vazby s kanálem vnitřní ověřování vnější kanál TLS tak, že server může zjistit, jestli je MITM.</span><span class="sxs-lookup"><span data-stu-id="c8222-111">The solution in this scenario is to bind the outer TLS channel with the inner authentication channel such that the server can detect if there is a MITM.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c8222-112">Tato ukázka pouze funguje, když hostované ve službě IIS a nemůže pracovat na Cassini – vývojový Server sady Visual Studio, protože Cassini nepodporuje protokol HTTPS.</span><span class="sxs-lookup"><span data-stu-id="c8222-112">This sample only works when hosted on IIS and cannot work on Cassini – Visual Studio Development Server because Cassini does not support HTTPS.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c8222-113">Tato funkce je aktuálně k dispozici pouze v systému Windows 7.</span><span class="sxs-lookup"><span data-stu-id="c8222-113">This feature is currently only available on Windows 7.</span></span> <span data-ttu-id="c8222-114">Následující kroky jsou specifické pro systém Windows 7.</span><span class="sxs-lookup"><span data-stu-id="c8222-114">The following steps are specific to Windows 7.</span></span>  
  
#### <a name="to-set-up-build-and-run-the-sample"></a><span data-ttu-id="c8222-115">Pokud chcete nastavit, sestavit a spustit ukázku</span><span class="sxs-lookup"><span data-stu-id="c8222-115">To set up, build, and run the sample</span></span>  
  
1.  <span data-ttu-id="c8222-116">Nainstalujte Internetovou informační službu z **ovládací panely**, **přidat nebo odebrat programy**, **funkce systému Windows**.</span><span class="sxs-lookup"><span data-stu-id="c8222-116">Install Internet Information Services from **Control Panel**, **Add/Remove Programs**, **Windows Features**.</span></span>  
  
2.  <span data-ttu-id="c8222-117">Nainstalujte **ověřování systému Windows** v **funkce systému Windows**, **Internetová informační služba**, **webové služby**,  **Zabezpečení**, a **ověřování systému Windows**.</span><span class="sxs-lookup"><span data-stu-id="c8222-117">Install **Windows Authentication** in **Windows Features**, **Internet Information Services**, **World Wide Web Services**, **Security**, and **Windows Authentication**.</span></span>  
  
3.  <span data-ttu-id="c8222-118">Nainstalujte **aktivace Windows Communication Foundation HTTP** v **funkce systému Windows**, **rozhraní Microsoft .NET Framework 3.5.1**, a **komunikaci Windows Aktivace Foundation HTTP**.</span><span class="sxs-lookup"><span data-stu-id="c8222-118">Install **Windows Communication Foundation HTTP Activation** in **Windows Features**, **Microsoft .NET Framework 3.5.1**, and **Windows Communication Foundation HTTP Activation**.</span></span>  
  
4.  <span data-ttu-id="c8222-119">Tato ukázka vyžaduje, aby klient k navázání zabezpečeného kanálu se serverem, takže vyžaduje přítomnost certifikát serveru, které můžete nainstalovat ze Správce Internetové informační služby (IIS).</span><span class="sxs-lookup"><span data-stu-id="c8222-119">This sample requires the client to establish a secure channel with the server, so it requires the presence of a server certificate which can be installed from Internet Information Services (IIS) Manager.</span></span>  
  
    1.  <span data-ttu-id="c8222-120">Otevřete Správce služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c8222-120">Open IIS Manager.</span></span> <span data-ttu-id="c8222-121">Otevřete **certifikáty serveru**, který se objevuje v **zobrazení funkce** kartě, pokud je vybrána kořenového uzlu (název počítače).</span><span class="sxs-lookup"><span data-stu-id="c8222-121">Open **Server certificates**, which appears in the **Feature View** tab when the root node (machine name) is selected.</span></span>  
  
    2.  <span data-ttu-id="c8222-122">Pro účely testování této ukázce, vytvořte certifikát podepsaný svým držitelem.</span><span class="sxs-lookup"><span data-stu-id="c8222-122">For the purpose of testing this sample, create a self-signed certificate.</span></span> <span data-ttu-id="c8222-123">Pokud nechcete, aby se vás zeptá, certifikát nebude zabezpečené v aplikaci Internet Explorer, nainstalujte certifikát do úložiště Důvěryhodné kořenové certifikační autority.</span><span class="sxs-lookup"><span data-stu-id="c8222-123">If you do not want Internet Explorer to prompt you about the certificate not being secure, install the certificate in the Trusted Certificate Root authority store.</span></span>  
  
5.  <span data-ttu-id="c8222-124">Otevřete **akce** podokno pro výchozí web.</span><span class="sxs-lookup"><span data-stu-id="c8222-124">Open the **Actions** pane for the default Web site.</span></span> <span data-ttu-id="c8222-125">Klikněte na tlačítko **web upravit**, **vazby**.</span><span class="sxs-lookup"><span data-stu-id="c8222-125">Click **Edit Site**, **Bindings**.</span></span> <span data-ttu-id="c8222-126">Přidat HTTPS jako typ Pokud již nejsou přítomny, s číslem portu 443.</span><span class="sxs-lookup"><span data-stu-id="c8222-126">Add HTTPS as a type if not already present, with port number 443.</span></span> <span data-ttu-id="c8222-127">Přiřadíte certifikát SSL vytvořili v předchozím kroku.</span><span class="sxs-lookup"><span data-stu-id="c8222-127">Assign the SSL certificate created in the preceding step.</span></span>  
  
6.  <span data-ttu-id="c8222-128">Vytvořte službu.</span><span class="sxs-lookup"><span data-stu-id="c8222-128">Build the service.</span></span> <span data-ttu-id="c8222-129">To vytvoří virtuální adresář ve službě IIS a zkopíruje soubory .dll, .svc a .config podle potřeby má být hostovaná na webu pro službu.</span><span class="sxs-lookup"><span data-stu-id="c8222-129">This creates a virtual directory in IIS, and copies the .dll, .svc and .config files as required for the service to be Web hosted.</span></span>  
  
7.  <span data-ttu-id="c8222-130">Otevřete Správce služby IIS.</span><span class="sxs-lookup"><span data-stu-id="c8222-130">Open IIS Manager.</span></span> <span data-ttu-id="c8222-131">Klikněte pravým tlačítkem na virtuální adresář (**ExtendedProtection**), který byl vytvořen v předchozím kroku.</span><span class="sxs-lookup"><span data-stu-id="c8222-131">Right-click the virtual directory (**ExtendedProtection**), which was created in the preceding step.</span></span> <span data-ttu-id="c8222-132">Vyberte **převést na aplikaci**.</span><span class="sxs-lookup"><span data-stu-id="c8222-132">Select **Convert to Application**.</span></span>  
  
8.  <span data-ttu-id="c8222-133">Otevřete **ověřování** modulu ve Správci služby IIS pro tento virtuální adresář a povolit **ověřování systému Windows**.</span><span class="sxs-lookup"><span data-stu-id="c8222-133">Open the **Authentication** module in IIS Manager for this virtual directory and enable **Windows Authentication**.</span></span>  
  
9. <span data-ttu-id="c8222-134">Otevřete **Upřesnit nastavení** pod **ověřování systému Windows** pro tento virtuální adresář a nastavte ji na **požadované**.</span><span class="sxs-lookup"><span data-stu-id="c8222-134">Open **Advanced Settings** under **Windows Authentication** for this virtual directory and set it to **Required**.</span></span>  
  
10. <span data-ttu-id="c8222-135">Službu můžete otestovat přístup k adresu URL HTTPS z okna prohlížeče (zadejte název a plně kvalifikované domény).</span><span class="sxs-lookup"><span data-stu-id="c8222-135">You can test the service by accessing the HTTPS URL from a browser window (Provide a fully-qualified domain name).</span></span> <span data-ttu-id="c8222-136">Pokud chcete přístup k této adrese URL ze vzdáleného počítače, ujistěte se, že brána firewall, je otevřené pro všechna příchozí připojení HTTP a HTTPS.</span><span class="sxs-lookup"><span data-stu-id="c8222-136">If you want to access this URL from a remote machine, make sure that the firewall is opened for all incoming HTTP and HTTPS connections.</span></span>  
  
11. <span data-ttu-id="c8222-137">Otevřete konfigurační soubor klienta a zadejte název plně kvalifikované domény pro atribut adresa klienta nebo koncový bod, který nahrazuje `<<full_machine_name>>`.</span><span class="sxs-lookup"><span data-stu-id="c8222-137">Open the client configuration file and provide a fully-qualified domain name for the client or endpoint address attribute that replaces `<<full_machine_name>>`.</span></span>  
  
12. <span data-ttu-id="c8222-138">Spuštění klienta.</span><span class="sxs-lookup"><span data-stu-id="c8222-138">Run the client.</span></span> <span data-ttu-id="c8222-139">Klient komunikuje se službou, která vytváří zabezpečený kanál a používá rozšířené ochrany.</span><span class="sxs-lookup"><span data-stu-id="c8222-139">The client communicates with the service, which establishes a secure channel and uses extended protection.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="c8222-140">Ukázky může být již nainstalována na váš počítač.</span><span class="sxs-lookup"><span data-stu-id="c8222-140">The samples may already be installed on your machine.</span></span> <span data-ttu-id="c8222-141">Před pokračováním zkontrolovat na následující adresář (výchozí).</span><span class="sxs-lookup"><span data-stu-id="c8222-141">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="c8222-142">Pokud tento adresář neexistuje, přejděte na [Windows Communication Foundation (WCF) a ukázky Windows Workflow Foundation (WF) pro rozhraní .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) ke stažení všechny Windows Communication Foundation (WCF) a [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ukázky.</span><span class="sxs-lookup"><span data-stu-id="c8222-142">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="c8222-143">Tato ukázka se nachází v následujícím adresáři.</span><span class="sxs-lookup"><span data-stu-id="c8222-143">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Services\Security\ExtendedProtection`
