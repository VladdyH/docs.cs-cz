---
title: Přemostění a zpracování chyb
ms.date: 03/30/2017
ms.assetid: 4ae87d1a-b615-4014-a494-a53f63ff0137
ms.openlocfilehash: 6afaddc75855b7e95ad708b2179cabb9aee35001
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/04/2018
ms.locfileid: "43514539"
---
# <a name="bridging-and-error-handling"></a><span data-ttu-id="323b0-102">Přemostění a zpracování chyb</span><span class="sxs-lookup"><span data-stu-id="323b0-102">Bridging and Error Handling</span></span>
<span data-ttu-id="323b0-103">Tato ukázka demonstruje použití směrovací službou Windows Communication Foundation (WCF) přemostění komunikace mezi klientem a službu, která pomocí různých vazby.</span><span class="sxs-lookup"><span data-stu-id="323b0-103">This sample demonstrates how the Windows Communication Foundation (WCF) routing service is used for bridging communication between a client and a service that use different bindings.</span></span> <span data-ttu-id="323b0-104">Tento příklad také ukazuje, jak pomocí služby zálohování pro scénáře převzetí služeb při selhání.</span><span class="sxs-lookup"><span data-stu-id="323b0-104">This sample also shows how to use a back-up service for failover scenarios.</span></span> <span data-ttu-id="323b0-105">Směrovací služba je komponenta WCF, který umožňuje snadno do aplikace zahrnout směrovač založené na obsahu.</span><span class="sxs-lookup"><span data-stu-id="323b0-105">The routing service is a WCF component that makes it easy to include a content-based router in your application.</span></span> <span data-ttu-id="323b0-106">Tato ukázka se přizpůsobí standardní kalkulačky Ukázky WCF na komunikaci pomocí směrovací službou.</span><span class="sxs-lookup"><span data-stu-id="323b0-106">This sample adapts the standard WCF Calculator Sample to communicate using the routing service.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="323b0-107">Vzorky mohou již být nainstalováno ve vašem počítači.</span><span class="sxs-lookup"><span data-stu-id="323b0-107">The samples may already be installed on your computer.</span></span> <span data-ttu-id="323b0-108">Před pokračováním zkontrolujte následující adresář (výchozí).</span><span class="sxs-lookup"><span data-stu-id="323b0-108">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="323b0-109">Pokud tento adresář neexistuje, přejděte na [Windows Communication Foundation (WCF) a ukázky Windows Workflow Foundation (WF) pro rozhraní .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) stáhnout všechny Windows Communication Foundation (WCF) a [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ukázky.</span><span class="sxs-lookup"><span data-stu-id="323b0-109">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="323b0-110">Tato ukázka se nachází v následujícím adresáři.</span><span class="sxs-lookup"><span data-stu-id="323b0-110">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\RoutingServices\ErrorHandlingAndBridging`  
  
## <a name="sample-details"></a><span data-ttu-id="323b0-111">Ukázka podrobnosti</span><span class="sxs-lookup"><span data-stu-id="323b0-111">Sample Details</span></span>  
 <span data-ttu-id="323b0-112">V této ukázce je Kalkulačka klient nakonfigurovaný pro odesílání zpráv do koncového bodu určeného směrovače.</span><span class="sxs-lookup"><span data-stu-id="323b0-112">In this sample, the Calculator client is configured to send messages to an endpoint exposed by the router.</span></span> <span data-ttu-id="323b0-113">Směrovací služba je nakonfigurovaná tak, aby přijímal všechny zprávy odeslané do ní a předávají do koncového bodu, který odpovídá službu kalkulačky.</span><span class="sxs-lookup"><span data-stu-id="323b0-113">The routing service is configured to accept all messages sent to it and to forward them to an endpoint that corresponds to the Calculator service.</span></span> <span data-ttu-id="323b0-114">Následující body popisují konfiguraci primární službu kalkulačky, službu kalkulačky zálohování a Kalkulačka klienta a jak probíhá komunikace mezi klientem a službou pomocí směrování služby:</span><span class="sxs-lookup"><span data-stu-id="323b0-114">The following points describe the configuration of the primary Calculator service, the back-up Calculator service, and the Calculator client and how the communication between the client and the service happens using the routing service:</span></span>  
  
-   <span data-ttu-id="323b0-115">Kalkulačka klienta konfigurován pro použití tříd BasicHttpBinding při Kalkulačka služba je nakonfigurována pro použití NetTcpBinding.</span><span class="sxs-lookup"><span data-stu-id="323b0-115">The Calculator client is configured to use BasicHttpBinding while the Calculator service is configured to use NetTcpBinding.</span></span> <span data-ttu-id="323b0-116">Směrovací služba automaticky převede zprávy podle potřeby před jejich odesláním do služby kalkulačky a také převádí odpovědi, aby klient Kalkulačka přístup.</span><span class="sxs-lookup"><span data-stu-id="323b0-116">The routing service automatically converts the messages as necessary before sending them to the Calculator service and it also converts the responses so that the Calculator client can access them.</span></span>  
  
-   <span data-ttu-id="323b0-117">Směrovací služba ví o dvě služby Kalkulačka: primární Kalkulačka službu a službu kalkulačky zálohování.</span><span class="sxs-lookup"><span data-stu-id="323b0-117">The routing service knows about two Calculator services: the primary Calculator service and the back-up Calculator service.</span></span> <span data-ttu-id="323b0-118">Směrovací služby se nejprve pokusí komunikovat s primární koncový bod služby kalkulačku.</span><span class="sxs-lookup"><span data-stu-id="323b0-118">The routing service first attempts to communicate with the primary Calculator service endpoint.</span></span> <span data-ttu-id="323b0-119">Pokud tento pokus selže z důvodu koncový bod je mimo provoz, směrovací služba potom se pokusí o komunikaci s koncovým bodem zálohování Kalkulačka služby.</span><span class="sxs-lookup"><span data-stu-id="323b0-119">If this attempt fails due to the endpoint being down, the routing service then tries to communicate with the back-up Calculator service endpoint.</span></span>  
  
 <span data-ttu-id="323b0-120">Proto zpráv odeslaných z klienta jsou přijímány směrovače a jsou přesměrovány do aktuální Kalkulačka služby.</span><span class="sxs-lookup"><span data-stu-id="323b0-120">Thus messages sent from the client are received by the router and are rerouted to the actual Calculator service.</span></span> <span data-ttu-id="323b0-121">Pokud koncový bod služby kalkulačky je vypnutý, směrovací službou směruje zprávy do koncového bodu Kalkulačka služby zálohování.</span><span class="sxs-lookup"><span data-stu-id="323b0-121">If the Calculator service endpoint is down, the routing service routes the message to the back-up Calculator service endpoint.</span></span> <span data-ttu-id="323b0-122">Zprávy ze služby zálohování Kalkulačka odesílají zpět do služby směrovač, který je zase předá zpět do klienta kalkulačky.</span><span class="sxs-lookup"><span data-stu-id="323b0-122">Messages from the back-up Calculator service are sent back to the service router, which in turn passes them back to the Calculator client.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="323b0-123">Seznam zálohování může mít více než jeden koncový bod definovaný.</span><span class="sxs-lookup"><span data-stu-id="323b0-123">A back-up list can have more than one endpoint defined.</span></span> <span data-ttu-id="323b0-124">V tomto případě pokud koncový bod služby zálohování je mimo provoz, směrovací služba pokusí připojit k další zálohování koncový bod v seznamu dokud neproběhne úspěšné připojení.</span><span class="sxs-lookup"><span data-stu-id="323b0-124">In this case if the back-up service endpoint is down, the routing service attempts to connect to the next back-up endpoint in the list until a successful connection occurs.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="323b0-125">Pro fungování této ukázky</span><span class="sxs-lookup"><span data-stu-id="323b0-125">To use this sample</span></span>  
  
1.  <span data-ttu-id="323b0-126">Pomocí [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], otevřete RouterBridgingAndErrorHandling.sln.</span><span class="sxs-lookup"><span data-stu-id="323b0-126">Using [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], open RouterBridgingAndErrorHandling.sln.</span></span>  
  
2.  <span data-ttu-id="323b0-127">V sadě Visual Studio stiskněte klávesu F5 nebo CTRL + SHIFT + B</span><span class="sxs-lookup"><span data-stu-id="323b0-127">Press F5 or CTRL+SHIFT+B in Visual Studio</span></span>  
  
    1.  <span data-ttu-id="323b0-128">Pokud chcete automaticky spouštět nezbytné projektů při stisknutí klávesy F5, klikněte pravým tlačítkem na řešení, vyberte možnost **vlastnosti**a **spouštěný projekt** pod uzlem **společné vlastnosti**vyberte **více projektů po spuštění**a nastavte všechny projekty **Start**.</span><span class="sxs-lookup"><span data-stu-id="323b0-128">If you would like to auto-launch the necessary projects when you press F5, right-click the solution, select **Properties**, and in the **Startup Project** node under **Common Properties**, select **Multiple Startup Projects**, and set all projects to **Start**.</span></span>  
  
    2.  <span data-ttu-id="323b0-129">Při vytváření projektu pomocí kombinace kláves CTRL + SHIFT + B, spusťte následující aplikace:</span><span class="sxs-lookup"><span data-stu-id="323b0-129">If you build the project with CTRL+SHIFT+B, start the following applications:</span></span>  
  
        1.  <span data-ttu-id="323b0-130">Kalkulačka klienta (. / CalculatorClient/bin/client.exe)</span><span class="sxs-lookup"><span data-stu-id="323b0-130">Calculator client (./CalculatorClient/bin/client.exe)</span></span>  
  
        2.  <span data-ttu-id="323b0-131">Kalkulačka služby (. / CalculatorService/bin/service.exe)</span><span class="sxs-lookup"><span data-stu-id="323b0-131">Calculator service (./CalculatorService/bin/service.exe)</span></span>  
  
        3.  <span data-ttu-id="323b0-132">Služba směrování (. / RoutingService/bin/RoutingService.exe)</span><span class="sxs-lookup"><span data-stu-id="323b0-132">Routing Service (./RoutingService/bin/RoutingService.exe)</span></span>  
  
3.  <span data-ttu-id="323b0-133">V klientovi kalkulačky stisknutím klávesy ENTER klienta.</span><span class="sxs-lookup"><span data-stu-id="323b0-133">In the Calculator Client, press ENTER to start the client.</span></span>  
  
     <span data-ttu-id="323b0-134">Byste měli vidět následující výstup:</span><span class="sxs-lookup"><span data-stu-id="323b0-134">You should see the following output:</span></span>  
  
    ```Output  
    Add(100,15.99) = 115.99  
    Subtract(145,76.54) = 68.46  
    Multiply(9,81.25) = 731.25  
    Divide(22,7) = 3.14285714285714  
    ```  
  
## <a name="configurable-via-code-or-appconfig"></a><span data-ttu-id="323b0-135">Konfigurovat pomocí kódu nebo souboru App.config</span><span class="sxs-lookup"><span data-stu-id="323b0-135">Configurable Via Code or App.config</span></span>  
 <span data-ttu-id="323b0-136">Ukázka lodí umožňují definovat chování ve směrovači použít soubor App.config.</span><span class="sxs-lookup"><span data-stu-id="323b0-136">The sample ships configured to use an App.config file to define the router’s behavior.</span></span> <span data-ttu-id="323b0-137">Můžete také změnit název souboru App.config na něco jiného, tak, aby nebyl rozpoznán a zrušte komentář u volání metod, které `ConfigureRouterViaCode()`.</span><span class="sxs-lookup"><span data-stu-id="323b0-137">You can also change the name of the App.config file to something else so that it is not recognized and uncomment the method call to `ConfigureRouterViaCode()`.</span></span> <span data-ttu-id="323b0-138">Některé z metod má za následek stejné chování směrovače.</span><span class="sxs-lookup"><span data-stu-id="323b0-138">Either method results in the same behavior from the router.</span></span>  
  
### <a name="scenario"></a><span data-ttu-id="323b0-139">Scénář</span><span class="sxs-lookup"><span data-stu-id="323b0-139">Scenario</span></span>  
 <span data-ttu-id="323b0-140">Tato ukázka předvádí, směrovač služeb funguje jako popisovač most a Chyba protokolu.</span><span class="sxs-lookup"><span data-stu-id="323b0-140">This sample demonstrates the service router acting as a protocol bridge and error handler.</span></span> <span data-ttu-id="323b0-141">V tomto scénáři žádné směrování na základě obsahu dojde k; směrovací služba funguje jako uzel transparentní proxy server nakonfigurovaný tak, aby předávání zpráv přímo do předkonfigurovaného sadu cílové koncové body.</span><span class="sxs-lookup"><span data-stu-id="323b0-141">In this scenario, no content-based routing occurs; the routing service acts as a transparent proxy node configured to pass messages directly to a preconfigured set of destination endpoints.</span></span> <span data-ttu-id="323b0-142">Směrovací služba provádí také transparentně zpracování chyb vzniklých se ho pokusí odeslat ke koncovým bodům, že je nakonfigurován pro komunikaci s další kroky.</span><span class="sxs-lookup"><span data-stu-id="323b0-142">The routing service also performs the additional steps of transparently handling errors that occur when it tries to send to the endpoints that it is configured to communicate with.</span></span> <span data-ttu-id="323b0-143">Služba směrování podle funguje jako most protokol, umožňuje uživateli definovat jeden protokol pro externí komunikaci a druhý k interní komunikace.</span><span class="sxs-lookup"><span data-stu-id="323b0-143">By acting as a protocol bridge, the routing service enables the user to define one protocol for external communication and another for internal communication.</span></span>  
  
### <a name="real-world-scenario"></a><span data-ttu-id="323b0-144">Reálné scénáře</span><span class="sxs-lookup"><span data-stu-id="323b0-144">Real World Scenario</span></span>  
 <span data-ttu-id="323b0-145">Contoso chce poskytovat interoperabilní služby koncového bodu na světě, a optimalizace výkonu interně.</span><span class="sxs-lookup"><span data-stu-id="323b0-145">Contoso wants to provide an interoperable service endpoint to the world, while optimizing performance internally.</span></span> <span data-ttu-id="323b0-146">Proto zpřístupňuje jeho služeb na celém světě prostřednictvím koncového bodu pomocí BasicHttpBinding, zatímco interně pomocí směrovací službou přemostění toto připojení ke koncovému bodu pomocí NetTcpBinding, které využívají jeho služby.</span><span class="sxs-lookup"><span data-stu-id="323b0-146">Thus it exposes its services to the world through an endpoint using the BasicHttpBinding, while internally using the routing service to bridge that connection to the endpoint using NetTcpBinding, which its services use.</span></span> <span data-ttu-id="323b0-147">Kromě toho Contoso chce, aby se jeho služba bude odolný vůči chybám dočasných výpadků ve všech svých produkčních služeb a proto Virtualizuje několik koncových bodů za služby na směrovač pomocí uživatele chyba možnosti automatické převzetí služeb při selhání zpracování zálohování koncových bodů v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="323b0-147">Furthermore, Contoso wants its service offering to be tolerant of temporary outages in any one of their production services and thus virtualizes multiple endpoints behind the router service using the ’s error handling capabilities to automatically failover to back-up endpoints when necessary.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="323b0-148">Viz také</span><span class="sxs-lookup"><span data-stu-id="323b0-148">See Also</span></span>  
 [<span data-ttu-id="323b0-149">Hostování AppFabric a ukázky trvalosti</span><span class="sxs-lookup"><span data-stu-id="323b0-149">AppFabric Hosting and Persistence Samples</span></span>](https://go.microsoft.com/fwlink/?LinkId=193961)
