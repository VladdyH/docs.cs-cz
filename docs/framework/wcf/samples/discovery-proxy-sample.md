---
title: Ukázka proxy serveru zjišťování
ms.date: 03/30/2017
ms.assetid: 1dfa02df-15b1-4e97-9c8e-f5f2772711b0
ms.openlocfilehash: e9cbfcb717f502a849d4d508d13df6c00b95db58
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/04/2018
ms.locfileid: "33503181"
---
# <a name="discovery-proxy-sample"></a><span data-ttu-id="867c7-102">Ukázka proxy serveru zjišťování</span><span class="sxs-lookup"><span data-stu-id="867c7-102">Discovery Proxy Sample</span></span>
<span data-ttu-id="867c7-103">Tento příklad ukazuje, jak vytvořit implementace zjišťování proxy k uložení informací o existujících služeb a jak se klienti mohou odesílat dotazy tento proxy server pro informace.</span><span class="sxs-lookup"><span data-stu-id="867c7-103">This sample shows how to create an implementation of a Discovery proxy to store information about existing services and how clients can query that proxy for information.</span></span> <span data-ttu-id="867c7-104">Tato ukázka se skládá ze tří projektů:</span><span class="sxs-lookup"><span data-stu-id="867c7-104">This sample consists of three projects:</span></span>  
  
-   <span data-ttu-id="867c7-105">**Služba**: jednoduchý kalkulačky služba Windows Communication Foundation (WCF), která registruje zjišťování proxy.</span><span class="sxs-lookup"><span data-stu-id="867c7-105">**Service**: A simple Windows Communication Foundation (WCF) calculator service that registers itself with the discovery proxy.</span></span>  
  
-   <span data-ttu-id="867c7-106">**Zjišťování Proxy**: Implementace zjišťování proxy služby.</span><span class="sxs-lookup"><span data-stu-id="867c7-106">**Discovery Proxy**: The implementation of a discovery proxy service.</span></span>  
  
-   <span data-ttu-id="867c7-107">**Klient**: A WCF klientskou aplikaci, která volá zjišťování proxy k vyhledání služeb.</span><span class="sxs-lookup"><span data-stu-id="867c7-107">**Client**: A WCF client application that calls the discovery proxy to search for services.</span></span>  
  
## <a name="demonstrates"></a><span data-ttu-id="867c7-108">Demonstruje</span><span class="sxs-lookup"><span data-stu-id="867c7-108">Demonstrates</span></span>  
 <span data-ttu-id="867c7-109">Implementace proxy zjišťování</span><span class="sxs-lookup"><span data-stu-id="867c7-109">Discovery proxy implementation</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="867c7-110">Ukázky může být již nainstalována na váš počítač.</span><span class="sxs-lookup"><span data-stu-id="867c7-110">The samples may already be installed on your machine.</span></span> <span data-ttu-id="867c7-111">Před pokračováním zkontrolovat na následující adresář (výchozí).</span><span class="sxs-lookup"><span data-stu-id="867c7-111">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="867c7-112">Pokud tento adresář neexistuje, přejděte na [Windows Communication Foundation (WCF) a ukázky Windows Workflow Foundation (WF) pro rozhraní .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) ke stažení všechny Windows Communication Foundation (WCF) a [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ukázky.</span><span class="sxs-lookup"><span data-stu-id="867c7-112">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="867c7-113">Tato ukázka se nachází v následujícím adresáři.</span><span class="sxs-lookup"><span data-stu-id="867c7-113">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Discovery\DiscoveryProxy`  
  
## <a name="discoveryproxy"></a><span data-ttu-id="867c7-114">DiscoveryProxy</span><span class="sxs-lookup"><span data-stu-id="867c7-114">DiscoveryProxy</span></span>  
 <span data-ttu-id="867c7-115">V `Main` metoda souboru Program.cs příklad ukazuje, jak službu typu <xref:System.ServiceModel.Discovery.DiscoveryProxy> je hostovaná.</span><span class="sxs-lookup"><span data-stu-id="867c7-115">In the `Main` method of the Program.cs file, the sample shows how a service of type <xref:System.ServiceModel.Discovery.DiscoveryProxy> is hosted.</span></span> <span data-ttu-id="867c7-116">Poskytuje dva koncové body, jeden typ <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> a další typu <xref:System.ServiceModel.Discovery.AnnouncementEndpoint>.</span><span class="sxs-lookup"><span data-stu-id="867c7-116">It exposes two endpoints, one of type <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> and another of type <xref:System.ServiceModel.Discovery.AnnouncementEndpoint>.</span></span> <span data-ttu-id="867c7-117">Oba koncových bodů TCP používají jako přenosového mechanismu.</span><span class="sxs-lookup"><span data-stu-id="867c7-117">Both of the endpoints use TCP as a transport.</span></span> <span data-ttu-id="867c7-118"><xref:System.ServiceModel.Discovery.DiscoveryEndpoint> Naslouchá na identifikátoru URI určeného `probeEndpointAddress` parametr, to je, kde klienti mohou zasílat zprávy testu dotazovat proxy server pro svoje data.</span><span class="sxs-lookup"><span data-stu-id="867c7-118">The <xref:System.ServiceModel.Discovery.DiscoveryEndpoint> is listening at the URI specified by the `probeEndpointAddress` parameter, this is where clients can send probe messages to query the proxy for its data.</span></span> <span data-ttu-id="867c7-119"><xref:System.ServiceModel.Discovery.AnnouncementEndpoint> Naslouchá na identifikátoru URI určeného `announcementEndpointAddress` parametr.</span><span class="sxs-lookup"><span data-stu-id="867c7-119">The <xref:System.ServiceModel.Discovery.AnnouncementEndpoint> is listening at the URI specified by the `announcementEndpointAddress` parameter.</span></span> <span data-ttu-id="867c7-120">Toto je, kde proxy server naslouchá na oznámení.</span><span class="sxs-lookup"><span data-stu-id="867c7-120">This is where the proxy listens to for announcements.</span></span> <span data-ttu-id="867c7-121">Po přijetí oznámení online proxy server přidá do své mezipaměti služby a po přijetí oznámení offline odebere službu ze své mezipaměti.</span><span class="sxs-lookup"><span data-stu-id="867c7-121">When an online announcement is received, the proxy adds the service to its cache and when an offline announcement is received it removes the service from its cache.</span></span>  
  
 <span data-ttu-id="867c7-122">DiscoveryProxy.cs obsahuje implementace <xref:System.ServiceModel.Discovery.DiscoveryProxy>.</span><span class="sxs-lookup"><span data-stu-id="867c7-122">The DiscoveryProxy.cs contains the implementation of the <xref:System.ServiceModel.Discovery.DiscoveryProxy>.</span></span> <span data-ttu-id="867c7-123">Proxy server musí dědit z <xref:System.Object> třídy a vyžaduje implementaci <xref:System.Runtime.Remoting.Messaging.AsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="867c7-123">The Proxy must inherit from the <xref:System.Object> class and requires an implementation of <xref:System.Runtime.Remoting.Messaging.AsyncResult>.</span></span> <span data-ttu-id="867c7-124">Při vytváření instancí, vytvoří novou Proxy <xref:System.Collections.Generic.Dictionary%602>, který se používá k uložení elementy ví o.</span><span class="sxs-lookup"><span data-stu-id="867c7-124">At instantiation, the Proxy creates a new <xref:System.Collections.Generic.Dictionary%602>, which it uses to store elements it knows about.</span></span>  
  
 <span data-ttu-id="867c7-125">Soubor je rozdělené do dvou oblastí, metody mezipaměti Proxy a implementace Proxy zjišťování.</span><span class="sxs-lookup"><span data-stu-id="867c7-125">The file is divided into two regions, Proxy Cache Methods and Discovery Proxy Implementation.</span></span> <span data-ttu-id="867c7-126">Oblasti Proxy mezipaměti metody obsahuje metody, které používá k aktualizaci <xref:System.Collections.Generic.Dictionary%602>, provádět dotazy proti <xref:System.Collections.Generic.Dictionary%602>a tisk dat pro uživatele.</span><span class="sxs-lookup"><span data-stu-id="867c7-126">The Proxy Cache Methods region contains methods used to update the <xref:System.Collections.Generic.Dictionary%602>, perform queries against the <xref:System.Collections.Generic.Dictionary%602>, and print the data for users.</span></span> <span data-ttu-id="867c7-127">Implementace Proxy zjišťování oblast obsahuje přepsané metody požadované pro funkci oznámení a kontroly.</span><span class="sxs-lookup"><span data-stu-id="867c7-127">The Discovery Proxy Implementation region contains the overridden methods required for the Announcement and Probe functionality.</span></span> <span data-ttu-id="867c7-128">Že definují akce prováděné na serveru proxy, po přijetí Online oznámení, oznámení do režimu Offline nebo test zprávy.</span><span class="sxs-lookup"><span data-stu-id="867c7-128">They define the actions taken by a proxy after receiving an Online Announcement, an Offline Announcement, or a Probe message.</span></span>  
  
## <a name="service"></a><span data-ttu-id="867c7-129">Služba</span><span class="sxs-lookup"><span data-stu-id="867c7-129">Service</span></span>  
 <span data-ttu-id="867c7-130">V souboru Program.cs v projektu služby se stejným identifikátorem URI používá pro svůj koncový bod oznámení jako proxy server zjišťování.</span><span class="sxs-lookup"><span data-stu-id="867c7-130">In the Program.cs file in the Service project, the same URI is used for its announcement endpoint as the discovery proxy.</span></span> <span data-ttu-id="867c7-131">Je to proto, že služba používá pro odesílání oznámení, zatímco proxy serveru se používá pro příjem je koncový bod.</span><span class="sxs-lookup"><span data-stu-id="867c7-131">This is because service uses the endpoint for sending the announcements, while the proxy uses it for receiving them.</span></span> <span data-ttu-id="867c7-132">Služba používá <xref:System.ServiceModel.Discovery.EndpointDiscoveryBehavior> a přidá do něj koncový bod oznámení.</span><span class="sxs-lookup"><span data-stu-id="867c7-132">The service uses the <xref:System.ServiceModel.Discovery.EndpointDiscoveryBehavior> and adds an announcement endpoint to it.</span></span>  
  
## <a name="client"></a><span data-ttu-id="867c7-133">Klient</span><span class="sxs-lookup"><span data-stu-id="867c7-133">Client</span></span>  
 <span data-ttu-id="867c7-134">Projektu klienta používá stejný identifikátor URI pro svůj koncový bod testu jako proxy server.</span><span class="sxs-lookup"><span data-stu-id="867c7-134">The Client project uses the same URI for its probe endpoint as the Proxy.</span></span> <span data-ttu-id="867c7-135">To je proto sondy v tomto scénáři jsou zároveň jednosměrového vysílání určený speciálně pro koncový bod k dispozici na proxy serveru.</span><span class="sxs-lookup"><span data-stu-id="867c7-135">This is because the probes in this scenario are also being unicast specifically to the endpoint available on the proxy.</span></span> <span data-ttu-id="867c7-136">Klient připojí k této známou adresu a potom se dotazuje služby.</span><span class="sxs-lookup"><span data-stu-id="867c7-136">The Client connects to this well-known address and then queries it for the service.</span></span> <span data-ttu-id="867c7-137">Po nalezení služby, ke kterému je připojen k němu.</span><span class="sxs-lookup"><span data-stu-id="867c7-137">Once it has found the service it connects to it.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="867c7-138">Pro fungování této ukázky</span><span class="sxs-lookup"><span data-stu-id="867c7-138">To use this sample</span></span>  
  
1.  <span data-ttu-id="867c7-139">Načtení projektu řešení v [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] a sestavte projekt.</span><span class="sxs-lookup"><span data-stu-id="867c7-139">Load the project solution in [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] and build the project.</span></span>  
  
2.  <span data-ttu-id="867c7-140">Nejprve spuštěním zjišťování Proxy aplikace, vygenerovaných \DiscoveryProxy\bin\debug [základní adresář řešení].</span><span class="sxs-lookup"><span data-stu-id="867c7-140">First run the Discovery Proxy application, generated in [solution base directory]\DiscoveryProxy\bin\debug.</span></span> <span data-ttu-id="867c7-141">Zjišťování Proxy musí nejprve spustit, protože koncové body TCP oznámení musí být pro službu pro odeslání jeho oznámení.</span><span class="sxs-lookup"><span data-stu-id="867c7-141">The Discovery Proxy must run first because TCP announcement endpoints must be up for the service to send its announcements.</span></span>  
  
3.  <span data-ttu-id="867c7-142">Druhý spusťte aplikaci služby vygenerovaných \Service\bin\debug [základní adresář řešení].</span><span class="sxs-lookup"><span data-stu-id="867c7-142">Second, run the service application generated in [solution base directory]\Service\bin\debug.</span></span> <span data-ttu-id="867c7-143">Při spouštění služba odesílá oznámení oznámení koncový bod zjišťování serveru proxy a je zaregistrován v mezipaměti k proxy serveru.</span><span class="sxs-lookup"><span data-stu-id="867c7-143">At start-up, the service sends an announcement to the announcement endpoint of the discovery proxy and is registered in the proxy’s cache.</span></span>  
  
4.  <span data-ttu-id="867c7-144">V dalším kroku spusťte klientskou aplikaci, vygenerovaných \Client\bin\debug [základní adresář řešení].</span><span class="sxs-lookup"><span data-stu-id="867c7-144">Next, run the client application, generated in [solution base directory]\Client\bin\debug.</span></span> <span data-ttu-id="867c7-145">Klient dotazuje proxy server, získá adresu služby a potom připojí ke službě.</span><span class="sxs-lookup"><span data-stu-id="867c7-145">The client queries the proxy, gets the service address and then connects to the service.</span></span>  
  
5.  <span data-ttu-id="867c7-146">Ukončete nakonec klient služby a proxy server.</span><span class="sxs-lookup"><span data-stu-id="867c7-146">Lastly, terminate the client, service and then the proxy.</span></span> <span data-ttu-id="867c7-147">Proxy server musí používat pro příjem oznámení služby offline.</span><span class="sxs-lookup"><span data-stu-id="867c7-147">The proxy must be running for it to receive the service's offline announcement.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="867c7-148">Viz také</span><span class="sxs-lookup"><span data-stu-id="867c7-148">See Also</span></span>
