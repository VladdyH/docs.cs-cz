---
title: Podmíněné operace Get a Put
ms.date: 03/30/2017
ms.assetid: 3d22067f-57b8-4e0f-a571-a694512187ae
ms.openlocfilehash: 29819f89327128cdd71cc89eb8d14126522dc2df
ms.sourcegitcommit: 5bbfe34a9a14e4ccb22367e57b57585c208cf757
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/17/2018
ms.locfileid: "45971904"
---
# <a name="conditional-get-and-put"></a><span data-ttu-id="da0f4-102">Podmíněné operace Get a Put</span><span class="sxs-lookup"><span data-stu-id="da0f4-102">Conditional Get and Put</span></span>
<span data-ttu-id="da0f4-103">Tento příklad znázorňuje způsob použití nového podmíněné načíst a aktualizovat rozhraní API pro programovací model WCF REST.</span><span class="sxs-lookup"><span data-stu-id="da0f4-103">This sample demonstrates how to use the new conditional retrieve and update APIs for the WCF REST programming model.</span></span> <span data-ttu-id="da0f4-104">Protože podmíněné načtení a aktualizace jsou nejvhodnější pro založenému na záznamech prostředků a služeb REST, tento příklad rozšiřuje [služba základních prostředků](../../../../docs/framework/wcf/samples/basic-resource-service.md) vzorku.</span><span class="sxs-lookup"><span data-stu-id="da0f4-104">Because conditional retrieve and update are most appropriate for resource-oriented and REST services, this sample extends the [Basic Resource Service](../../../../docs/framework/wcf/samples/basic-resource-service.md) sample.</span></span> <span data-ttu-id="da0f4-105">Tato ukázka se zaměřuje na přidání podpory pro podmíněné načtení a proveďte aktualizaci [služba základních prostředků](../../../../docs/framework/wcf/samples/basic-resource-service.md) ukázkový pomocí nových rozhraní API zavedený [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)].</span><span class="sxs-lookup"><span data-stu-id="da0f4-105">This sample focuses on adding support for conditional retrieve and update to the [Basic Resource Service](../../../../docs/framework/wcf/samples/basic-resource-service.md) sample using the new APIs introduced in [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)].</span></span>  
  
## <a name="demonstrates"></a><span data-ttu-id="da0f4-106">Demonstruje</span><span class="sxs-lookup"><span data-stu-id="da0f4-106">Demonstrates</span></span>  
 <span data-ttu-id="da0f4-107">Podmíněné načtení a aktualizace</span><span class="sxs-lookup"><span data-stu-id="da0f4-107">Conditional Retrieve and Update</span></span>  
  
## <a name="discussion"></a><span data-ttu-id="da0f4-108">Diskuse</span><span class="sxs-lookup"><span data-stu-id="da0f4-108">Discussion</span></span>  
 <span data-ttu-id="da0f4-109">Služby WCF v této ukázce poskytuje kolekci zákazníků v záznamech prostředků a způsobem REST.</span><span class="sxs-lookup"><span data-stu-id="da0f4-109">The WCF service in this sample exposes a collection of customers in a resource-oriented and REST manner.</span></span> <span data-ttu-id="da0f4-110">Podrobný popis implementace služby, najdete v tématu [služba základních prostředků](../../../../docs/framework/wcf/samples/basic-resource-service.md) vzorku.</span><span class="sxs-lookup"><span data-stu-id="da0f4-110">For a detailed description of the service implementation, please see the [Basic Resource Service](../../../../docs/framework/wcf/samples/basic-resource-service.md) sample.</span></span>  
  
 <span data-ttu-id="da0f4-111">Tato ukázka přidá podmíněný načtení a funkce aktualizace pro [služba základních prostředků](../../../../docs/framework/wcf/samples/basic-resource-service.md) vzorku.</span><span class="sxs-lookup"><span data-stu-id="da0f4-111">This sample adds conditional retrieve and update capabilities to the [Basic Resource Service](../../../../docs/framework/wcf/samples/basic-resource-service.md) sample.</span></span> <span data-ttu-id="da0f4-112">Podmíněné načítají a aktualizují použití značek entit HTTP a hlaviček protokolu HTTP If-None-Match a If-Match se ověřit, že klienti mají, nebo nemají aktuální entity pro daný prostředek.</span><span class="sxs-lookup"><span data-stu-id="da0f4-112">Conditional retrieve and update use HTTP entity tags and the HTTP If-None-Match and If-Match headers to validate that clients either have or do not have the most current entity for a given resource.</span></span> <span data-ttu-id="da0f4-113">Ale implementace kódu správně analyzovat záhlaví HTTP If-None-Match a If-Match může být zdlouhavé a náchylné k chybě.</span><span class="sxs-lookup"><span data-stu-id="da0f4-113">However, implementing the code to correctly parse the HTTP If-None-Match and If-Match headers can be tedious and error-prone.</span></span> <span data-ttu-id="da0f4-114">Proto <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> a <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> metody byly přidány do <xref:System.ServiceModel.Web.IncomingWebRequestContext>, které lze přistupovat pomocí aktuální instancí třídy <xref:System.ServiceModel.Web.WebOperationContext>.</span><span class="sxs-lookup"><span data-stu-id="da0f4-114">Therefore, the <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> and <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> methods have been added to the <xref:System.ServiceModel.Web.IncomingWebRequestContext>, which can be accessed using the current instance of the <xref:System.ServiceModel.Web.WebOperationContext>.</span></span> <span data-ttu-id="da0f4-115">Kromě toho `SetETag` metoda byl přidán do <xref:System.ServiceModel.Web.OutgoingWebRequestContext>, což usnadňuje nevrátilo značky platný entity.</span><span class="sxs-lookup"><span data-stu-id="da0f4-115">In addition, the `SetETag` method has been added to the <xref:System.ServiceModel.Web.OutgoingWebRequestContext>, making it easier to return valid entity tags.</span></span>  
  
 <span data-ttu-id="da0f4-116"><xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> Metoda je určena pro použití s operacemi [WebGet].</span><span class="sxs-lookup"><span data-stu-id="da0f4-116">The <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> method is intended to be used with [WebGet] operations.</span></span> <span data-ttu-id="da0f4-117">Trvá, než aktuální značku entity pro daný prostředek, jako `entityTag` parametr, který může být `string`, `int`, `long` nebo `Guid`.</span><span class="sxs-lookup"><span data-stu-id="da0f4-117">It takes the current entity tag for the given resource as the `entityTag` parameter, which can be a `string`, `int`, `long` or `Guid`.</span></span> <span data-ttu-id="da0f4-118"><xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> Metoda zkontroluje značka entity proti záhlaví HTTP If-None-Match požadavku.</span><span class="sxs-lookup"><span data-stu-id="da0f4-118">The <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> method checks the entity tag against the HTTP If-None-Match header of the request.</span></span> <span data-ttu-id="da0f4-119">Pokud je k dispozici v hlavičce protokolu HTTP If-None-Match značka entity o <xref:System.ServiceModel.Web.WebFaultException> se stavem je vyvolána kód nedojde ke změně (304); v opačném případě vrátí metoda.</span><span class="sxs-lookup"><span data-stu-id="da0f4-119">If the entity tag is present in the HTTP If-None-Match header, then a <xref:System.ServiceModel.Web.WebFaultException> with a status code of Not Modified (304) is thrown; otherwise the method returns.</span></span> <span data-ttu-id="da0f4-120">Podmíněné načtení mechanismus umožňuje klientovi sdělíte serveru, že na něm tuto entitu a pokud klient již nemá ji odeslat pouze aktuální entitu.</span><span class="sxs-lookup"><span data-stu-id="da0f4-120">The conditional retrieve mechanism allows the client to tell the server that it has this entity and to only send the current entity if the client does not already have it.</span></span> <span data-ttu-id="da0f4-121">Příklad použití <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> metoda si můžete prohlédnout ve `GetCustomer` a `GetCustomers` operace služby.</span><span class="sxs-lookup"><span data-stu-id="da0f4-121">Example usage of the <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> method can be seen in the `GetCustomer` and `GetCustomers` operations of the service.</span></span> <span data-ttu-id="da0f4-122">Je důležité si uvědomit, která volá do <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> nesmí vracet.</span><span class="sxs-lookup"><span data-stu-id="da0f4-122">It is important to note that calls to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> may not return.</span></span> <span data-ttu-id="da0f4-123">Vývojáři by měly implementovat operace tak, že žádost je již znám k dosažení úspěchu před voláním <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> je provedeno, například, že pokud volání <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> není k dispozici, služba bude posílat odpovědi úspěšné stavovým kódem.</span><span class="sxs-lookup"><span data-stu-id="da0f4-123">Developers should implement the operation so that the request is already known to be successful before the call to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> is executed, such that if the call to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> was not present, the service would send a response with a successful status code.</span></span>  
  
 <span data-ttu-id="da0f4-124"><xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> Metoda je podobná <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> metody.</span><span class="sxs-lookup"><span data-stu-id="da0f4-124">The <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> method is similar to the <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A> method.</span></span> <span data-ttu-id="da0f4-125">Také využívá aktuální značku entity pro daný prostředek.</span><span class="sxs-lookup"><span data-stu-id="da0f4-125">It also takes the current entity tag for the given resource.</span></span> <span data-ttu-id="da0f4-126">Ale je určena pro použití s [WebInvoke] operace, ve kterých je metoda nastavena na "Vložit" nebo "Odstranit".</span><span class="sxs-lookup"><span data-stu-id="da0f4-126">However, it is intended to be used with [WebInvoke] operations in which the method is set to "PUT" or "DELETE".</span></span> <span data-ttu-id="da0f4-127"><xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> Metoda zkontroluje značka entity proti záhlaví HTTP If-Match požadavku.</span><span class="sxs-lookup"><span data-stu-id="da0f4-127">The <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> method checks the entity tag against the HTTP If-Match header of the request.</span></span> <span data-ttu-id="da0f4-128">Pokud není k dispozici v hlavičce protokolu HTTP If-Match značka entity o <xref:System.ServiceModel.Web.WebFaultException> se stavem kód Předběžná podmínka je neplatná (412) je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="da0f4-128">If the entity tag is not present in the HTTP If-Match header, then a <xref:System.ServiceModel.Web.WebFaultException> with a status code of Precondition Failed (412) is thrown.</span></span> <span data-ttu-id="da0f4-129">Aktualizace podmíněného mechanismus umožňuje klientovi sdělíte serveru, má tato entita pro prostředek a povolit pouze klienta ke změně prostředku. Pokud má entita je aktuální.</span><span class="sxs-lookup"><span data-stu-id="da0f4-129">The conditional update mechanism allows the client to tell the server that it has this entity for the resource and to only allow the client to alter the resource; if the entity it has is current.</span></span> <span data-ttu-id="da0f4-130">Příklad použití <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> metoda si můžete prohlédnout ve `UpdateCustomer` a `DeleteCustomer` operace služby.</span><span class="sxs-lookup"><span data-stu-id="da0f4-130">Example usage of the <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> method can be seen in the `UpdateCustomer` and `DeleteCustomer` operations of the service.</span></span> <span data-ttu-id="da0f4-131">Stejně jako u <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A>, je důležité si uvědomit, která volá do <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> nesmí vracet.</span><span class="sxs-lookup"><span data-stu-id="da0f4-131">Just as with <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalRetrieve%2A>, it is important to note that calls to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> may not return.</span></span> <span data-ttu-id="da0f4-132">Vývojáři by měly implementovat operace tak, že žádost je již znám k dosažení úspěchu před voláním <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> je provedeno, například, že pokud volání <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> nebyl k dispozici, služba by odpovědět úspěšné stavovým kódem.</span><span class="sxs-lookup"><span data-stu-id="da0f4-132">Developers should implement the operation such that the request is already known to be successful before the call to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> is executed, such that if the call to <xref:System.ServiceModel.Web.IncomingWebRequestContext.CheckConditionalUpdate%2A> was not present, the service would respond with a successful status code.</span></span>  
  
 <span data-ttu-id="da0f4-133">Ukázka se skládá z služba v místním prostředí a klienta, který běží v rámci konzolové aplikace.</span><span class="sxs-lookup"><span data-stu-id="da0f4-133">The sample consists of a self-hosted service and a client that runs within a console application.</span></span> <span data-ttu-id="da0f4-134">Konzolová aplikace běží, klient vytvářejí požadavky na službu a zapíše relevantní informace z odpovědi v okně konzoly.</span><span class="sxs-lookup"><span data-stu-id="da0f4-134">As the console application runs, the client makes requests to the service and writes the pertinent information from the responses to the console window.</span></span>  
  
#### <a name="to-run-the-sample"></a><span data-ttu-id="da0f4-135">Chcete-li spustit ukázku</span><span class="sxs-lookup"><span data-stu-id="da0f4-135">To run the sample</span></span>  
  
1.  <span data-ttu-id="da0f4-136">Otevřete řešení pro ukázku podmíněné Get a Put.</span><span class="sxs-lookup"><span data-stu-id="da0f4-136">Open the solution for the Conditional Get and Put sample.</span></span> <span data-ttu-id="da0f4-137">Při spuštění [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], musíte spustit jako správce a spusťte ukázku úspěšně.</span><span class="sxs-lookup"><span data-stu-id="da0f4-137">When launching [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)], you must run as an administrator to execute the sample successfully.</span></span> <span data-ttu-id="da0f4-138">To můžete provést kliknutím pravým tlačítkem myši [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] ikonu a zvolíte **spustit jako správce** v místní nabídce.</span><span class="sxs-lookup"><span data-stu-id="da0f4-138">Do this by right-clicking the [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] icon and choosing **Run as Administrator** from the context menu.</span></span>  
  
2.  <span data-ttu-id="da0f4-139">Stiskněte kombinaci kláves CTRL + SHIFT + B, sestavte řešení a pak stisknutím kombinace kláves CTRL + F5 spusťte projekt konzolové aplikace.</span><span class="sxs-lookup"><span data-stu-id="da0f4-139">Press CTRL+SHIFT+B to build the solution and then press CTRL+F5 to run the console application project.</span></span> <span data-ttu-id="da0f4-140">Pokud spuštění tohoto projektu se ladění povoleno (stisknutím klávesy F5 místo CTRL + F5), ladicí program chvíle, kdy je vyvolána výjimka, pomocí zásad správy GET a PUT, kontrola.</span><span class="sxs-lookup"><span data-stu-id="da0f4-140">If running this project with debugging enabled (by pressing F5 instead of CTRL+F5), the debugger stops when an exception is thrown by the conditional GET and PUT checking.</span></span> <span data-ttu-id="da0f4-141">Pokud k tomu dojde, stisknutím klávesy F5 pokračovat v provádění vzorku.</span><span class="sxs-lookup"><span data-stu-id="da0f4-141">When this happens, press F5 to continue executing the sample.</span></span>  
  
3.  <span data-ttu-id="da0f4-142">V okně konzoly se zobrazí písek obsahuje identifikátor URI spuštěnou službu a identifikátor URI na stránce nápovědy HTML pro spuštěnou službu.</span><span class="sxs-lookup"><span data-stu-id="da0f4-142">The console window appear sand provides the URI of the running service and the URI of the HTML help page for the running service.</span></span>  
  
4.  <span data-ttu-id="da0f4-143">Při spuštění ukázky, klient zasílá požadavky službě a zapíše odpovědi v okně konzoly.</span><span class="sxs-lookup"><span data-stu-id="da0f4-143">As the sample runs, the client sends requests to the service and writes the responses to the console window.</span></span>  
  
5.  <span data-ttu-id="da0f4-144">Stisknutím libovolné klávesy ukončete vzorovou.</span><span class="sxs-lookup"><span data-stu-id="da0f4-144">Press any key to terminate the sample.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="da0f4-145">Vzorky mohou již být nainstalováno na svém počítači.</span><span class="sxs-lookup"><span data-stu-id="da0f4-145">The samples may already be installed on your machine.</span></span> <span data-ttu-id="da0f4-146">Před pokračováním zkontrolujte následující adresář (výchozí).</span><span class="sxs-lookup"><span data-stu-id="da0f4-146">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="da0f4-147">Pokud tento adresář neexistuje, přejděte na [Windows Communication Foundation (WCF) a ukázky Windows Workflow Foundation (WF) pro rozhraní .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) stáhnout všechny Windows Communication Foundation (WCF) a [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ukázky.</span><span class="sxs-lookup"><span data-stu-id="da0f4-147">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="da0f4-148">Tato ukázka se nachází v následujícím adresáři.</span><span class="sxs-lookup"><span data-stu-id="da0f4-148">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Basic\Web\ConditionalGetAndPut`
