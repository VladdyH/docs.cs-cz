---
title: "Omezení distribuce zpráv"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 8b5ec4b8-1ce9-45ef-bb90-2c840456bcc1
caps.latest.revision: "10"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 191baa2df4a6a5a4fe8139e8b7ad36bd1c60b40d
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/02/2017
---
# <a name="limiting-message-distribution"></a><span data-ttu-id="218ff-102">Omezení distribuce zpráv</span><span class="sxs-lookup"><span data-stu-id="218ff-102">Limiting Message Distribution</span></span>
<span data-ttu-id="218ff-103">Rovnocenného kanálu je záměrné všesměrového vysílání mřížku.</span><span class="sxs-lookup"><span data-stu-id="218ff-103">Peer Channel is by design a broadcast mesh.</span></span> <span data-ttu-id="218ff-104">Svůj základní flooding model spočívá v distribuci každá zpráva odeslaná do všech členů tohoto oka kteréhokoli člena mřížku.</span><span class="sxs-lookup"><span data-stu-id="218ff-104">Its basic flooding model involves distributing each message sent by any member of a mesh to all other members of that mesh.</span></span> <span data-ttu-id="218ff-105">To se hodí v situacích, kde každé zprávy vygenerované metodou členem je relevantní a užitečné pro všechny ostatní členy (například konverzační skupina).</span><span class="sxs-lookup"><span data-stu-id="218ff-105">This is ideal in situations where every message generated by a member is relevant and useful to all other members (for example, a chat room).</span></span> <span data-ttu-id="218ff-106">Ale mnoho aplikací mít občasné potřebu omezení distribuce zpráv.</span><span class="sxs-lookup"><span data-stu-id="218ff-106">However, many applications have an occasional need for limiting message distribution.</span></span> <span data-ttu-id="218ff-107">Například pokud nového člena spojí mřížku a chce načíst poslední zprávou odeslanou přes síť, tento požadavek není nutné k zaplnění na každého člena OK.</span><span class="sxs-lookup"><span data-stu-id="218ff-107">For example, if a new member joins a mesh and wants to retrieve the last message sent through the mesh, this request does not need to be flooded to every member of the mesh.</span></span> <span data-ttu-id="218ff-108">Žádost může být omezen na téměř okolí, nebo může být odfiltrována místně vygenerovanou zprávy. Zprávy mohou rovněž odeslány do jednotlivých uzlu na OK.</span><span class="sxs-lookup"><span data-stu-id="218ff-108">The request could be limited to near neighbors, or locally generated messages can be filtered out. Messages can also be sent to an individual node on the mesh.</span></span> <span data-ttu-id="218ff-109">Toto téma popisuje použití počet směrování, šíření filtru zpráv, filtrem místní nebo přímé připojení k řízení, jak se předávají zprávy v průběhu OK a obsahuje obecné pokyny pro výběr přístup.</span><span class="sxs-lookup"><span data-stu-id="218ff-109">This topic discusses using Hop Count, a Message Propagation Filter, a local filter, or a direct connection to control how messages are forwarded throughout the mesh, and provides general guidelines for choosing an approach.</span></span>  
  
## <a name="hop-counts"></a><span data-ttu-id="218ff-110">Počet směrování</span><span class="sxs-lookup"><span data-stu-id="218ff-110">Hop Counts</span></span>  
 <span data-ttu-id="218ff-111">Koncept `PeerHopCount` je podobná TTL (Time-To-Live) používá v protokolu IP.</span><span class="sxs-lookup"><span data-stu-id="218ff-111">The concept of `PeerHopCount` is similar to TTL (Time-To-Live) used in IP protocol.</span></span> <span data-ttu-id="218ff-112">Hodnota `PeerHopCount` je vázaný na instanci zprávy a určuje, kolikrát by měly být předávány zprávu před probíhá vyřazování.</span><span class="sxs-lookup"><span data-stu-id="218ff-112">The value of `PeerHopCount` is tied to a message instance, and it specifies how many times a message should be forwarded before being dropped.</span></span> <span data-ttu-id="218ff-113">Pokaždé, když je přijata zpráva rovnocenného kanálu klientem, klient hledá se zobrazí, pokud `PeerHopCount` je zadán.</span><span class="sxs-lookup"><span data-stu-id="218ff-113">Each time a message is received by a Peer Channel client, the client examines the message to see if `PeerHopCount` is specified.</span></span> <span data-ttu-id="218ff-114">Pokud je zadán, pak snižuje klienta ke směrování počet hodnotu jednou před předáním zprávy do sousedních uzlů.</span><span class="sxs-lookup"><span data-stu-id="218ff-114">If it is specified, then the client decrements the hop count value by one before forwarding the message to neighboring nodes.</span></span> <span data-ttu-id="218ff-115">Když klient obdrží zprávu s nulovou hodnotou počet směrování, klient zprávu zpracuje, ale není předávat zprávy okolí.</span><span class="sxs-lookup"><span data-stu-id="218ff-115">When a client receives a message with a hop count value of zero, the client processes the message, but does not forward the message to neighbors.</span></span>  
  
 <span data-ttu-id="218ff-116">Počet směrování mohou být přidány do zprávy můžete přidat `PeerHopCount` jako atribut použít vlastnost nebo pole v implementaci třídy zprávy.</span><span class="sxs-lookup"><span data-stu-id="218ff-116">Hop count may be added to a message by adding `PeerHopCount` as an attribute to the applicable property or field in the implementation of the message class.</span></span> <span data-ttu-id="218ff-117">To můžete nastavit na konkrétní hodnotu před odesláním zprávy na mřížku.</span><span class="sxs-lookup"><span data-stu-id="218ff-117">You can set this to a specific value before sending the message to the mesh.</span></span> <span data-ttu-id="218ff-118">Tímto způsobem můžete počet směrování k omezení distribuce zpráv v rámci mřížky, pokud je to nezbytné, potenciálně zabraňující duplikace nepotřebné zprávy.</span><span class="sxs-lookup"><span data-stu-id="218ff-118">In this manner, you can use hop count to limit distribution of messages throughout the mesh when necessary, potentially avoiding unnecessary message duplication.</span></span> <span data-ttu-id="218ff-119">To je užitečné v případech, kde OK obsahuje vysoké množství redundantních dat, nebo odesílání zprávy pro okamžité Sousedé BGP nebo Sousedé BGP v rámci několik segmentů směrování.</span><span class="sxs-lookup"><span data-stu-id="218ff-119">This is useful in cases where the mesh contains a high amount of redundant data, or for sending a message to immediate neighbors, or neighbors within a few hops.</span></span>  
  
-   <span data-ttu-id="218ff-120">Fragmenty kódu a související informace najdete v tématu [rovnocenného kanálu blog](http://go.microsoft.com/fwlink/?LinkID=114531) (http://go.microsoft.com/fwlink/?LinkID=114531).</span><span class="sxs-lookup"><span data-stu-id="218ff-120">For code snippets and related information, see the [Peer Channel blog](http://go.microsoft.com/fwlink/?LinkID=114531) (http://go.microsoft.com/fwlink/?LinkID=114531).</span></span>  
  
## <a name="message-propagation-filter"></a><span data-ttu-id="218ff-121">Šíření filtr zpráv</span><span class="sxs-lookup"><span data-stu-id="218ff-121">Message Propagation Filter</span></span>  
 <span data-ttu-id="218ff-122">`MessagePropagationFilter`můžete použít pro vlastní řízení zahlcení zprávy, zejména v případě, že obsah zprávy nebo jiných konkrétních scénářů určit šíření.</span><span class="sxs-lookup"><span data-stu-id="218ff-122">`MessagePropagationFilter` can be used for customized control of message flooding, especially when the content of the message or other specific scenarios determine propagation.</span></span> <span data-ttu-id="218ff-123">Filtr rozhoduje šíření pro každou zprávu, které procházejí uzlu.</span><span class="sxs-lookup"><span data-stu-id="218ff-123">The filter makes propagation decisions for every message that passes through the node.</span></span> <span data-ttu-id="218ff-124">To platí pro zprávy, které pochází jinde v mřížce, vaše uzlu přijal i zprávy vytvořené v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="218ff-124">This is true for messages that originated elsewhere in the mesh that your node has received as well as messages created by your application.</span></span> <span data-ttu-id="218ff-125">Filtr má přístup ke zprávě a jeho vzniku, takže rozhodnutí o předávání nebo vyřazuje zprávy může být založen na úplné informace, které jsou k dispozici.</span><span class="sxs-lookup"><span data-stu-id="218ff-125">The filter has access to both the message and its origination, so decisions about forwarding or dropping the message can be based on the full information available.</span></span>  
  
 <span data-ttu-id="218ff-126"><xref:System.ServiceModel.PeerMessagePropagationFilter>je abstraktní základní třídu s jedinou funkci <xref:System.ServiceModel.PeerMessagePropagationFilter.ShouldMessagePropagate%2A>.</span><span class="sxs-lookup"><span data-stu-id="218ff-126"><xref:System.ServiceModel.PeerMessagePropagationFilter> is a base abstract class with a single function, <xref:System.ServiceModel.PeerMessagePropagationFilter.ShouldMessagePropagate%2A>.</span></span> <span data-ttu-id="218ff-127">První argument volání metody předá úplnou kopii zprávy.</span><span class="sxs-lookup"><span data-stu-id="218ff-127">The first argument of the method call passes in a full copy of the message.</span></span> <span data-ttu-id="218ff-128">Všechny změny na zprávu neovlivní skutečné zprávy.</span><span class="sxs-lookup"><span data-stu-id="218ff-128">Any changes made to the message do not affect the actual message.</span></span> <span data-ttu-id="218ff-129">Poslední argument volání metody, které identifikuje počátek zprávy (`PeerMessageOrigination.Local` nebo `PeerMessageOrigination.Remote`).</span><span class="sxs-lookup"><span data-stu-id="218ff-129">The last argument of the method call identifies the origin of the message (`PeerMessageOrigination.Local` or `PeerMessageOrigination.Remote`).</span></span> <span data-ttu-id="218ff-130">Konkrétní implementace této metody musí vracet konstanta z <xref:System.ServiceModel.PeerMessagePropagation> výčtu označující, že zprávy je k přeposlání do místních aplikací (`Local`), přesměrovaná ke vzdáleným klientům (`Remote`), obě (`LocalAndRemote`), nebo žádný z nich (`None`).</span><span class="sxs-lookup"><span data-stu-id="218ff-130">Concrete implementations of this method must return a constant from the <xref:System.ServiceModel.PeerMessagePropagation> enumeration indicating that the message is to be forwarded to the local application (`Local`), forwarded to remote clients (`Remote`), both (`LocalAndRemote`), or neither (`None`).</span></span> <span data-ttu-id="218ff-131">Tento filtr lze použít přímým přístupem k odpovídající položce `PeerNode` objekt a zadání instanci odvozené šíření filtrovat třídy v `PeerNode.MessagePropagationFilter` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="218ff-131">This filter can be applied by accessing the corresponding `PeerNode` object and specifying an instance of the derived propagation filter class in the `PeerNode.MessagePropagationFilter` property.</span></span> <span data-ttu-id="218ff-132">Zkontrolujte, zda filtr šíření připojen před otevřením rovnocenného kanálu.</span><span class="sxs-lookup"><span data-stu-id="218ff-132">Ensure that the propagation filter is attached before opening the Peer Channel.</span></span>  
  
-   <span data-ttu-id="218ff-133">Fragmenty kódu a související informace najdete v tématu [rovnocenného kanálu blog](http://go.microsoft.com/fwlink/?LinkID=114532) (http://go.microsoft.com/fwlink/?LinkID=114532).</span><span class="sxs-lookup"><span data-stu-id="218ff-133">For code snippets and related information, see the [Peer Channel blog](http://go.microsoft.com/fwlink/?LinkID=114532) (http://go.microsoft.com/fwlink/?LinkID=114532).</span></span>  
  
## <a name="contacting-an-individual-node-in-the-mesh"></a><span data-ttu-id="218ff-134">Kontaktování jednotlivého uzlu v mřížce</span><span class="sxs-lookup"><span data-stu-id="218ff-134">Contacting an Individual Node in the Mesh</span></span>  
 <span data-ttu-id="218ff-135">Nelze kontaktovat jednotlivého uzlu v mřížku nastavení místní filtr, nebo nastavením přímé připojení.</span><span class="sxs-lookup"><span data-stu-id="218ff-135">An individual node in a mesh can be contacted by setting up a local filter, or by setting up a direct connection.</span></span>  
  
 <span data-ttu-id="218ff-136">Pokud uzly v mřížku každé jednotlivé ID, lze zadat ID cílové implementace zprávu.</span><span class="sxs-lookup"><span data-stu-id="218ff-136">If the nodes in a mesh each have an individual ID, a destination ID can be specified in the implementation of your message.</span></span> <span data-ttu-id="218ff-137">Místní filtru můžete nastavit tak, že napíšete funkci v vaší kontrakt zprávy, která bude obsahovat pouze zprávy do aktuálního uzlu Pokud je zadané ID cílové odpovídá jeho ID.</span><span class="sxs-lookup"><span data-stu-id="218ff-137">A local filter can be set up by writing a function in your message contract that will only display the message to the current node if its ID matches the destination ID you specified.</span></span> <span data-ttu-id="218ff-138">OK určena k přenosu zpráv, tak nebude muset vám být účtovány režii nastavením nového připojení.</span><span class="sxs-lookup"><span data-stu-id="218ff-138">The mesh transports the message, so the overhead of setting up a new connection does not have to be incurred.</span></span> <span data-ttu-id="218ff-139">Je však ke ztrátě efektivitu vzhledem k tomu, že je zpráva odeslána mnohokrát v rámci OK.</span><span class="sxs-lookup"><span data-stu-id="218ff-139">However, there is a loss of efficiency since the message is sent many times throughout the mesh.</span></span> <span data-ttu-id="218ff-140">To funguje dobře pro odesílání zpráv na jednotlivé členy mřížky, pokud jsou zprávy příliš často ani příliš velký.</span><span class="sxs-lookup"><span data-stu-id="218ff-140">This works well for sending messages to individual members of a mesh as long as the messages are neither too big nor too frequent.</span></span>  
  
 <span data-ttu-id="218ff-141">Pro trvalý, širokopásmové připojení jsou vhodnější než přímé připojení.</span><span class="sxs-lookup"><span data-stu-id="218ff-141">For long-lasting, high-bandwidth connections, direct connections are preferable.</span></span> <span data-ttu-id="218ff-142">Můžete odeslat informace o připojení přes síť a poté nastavit přímé připojení dle vlastního výběru k odesílání a příjem zpráv.</span><span class="sxs-lookup"><span data-stu-id="218ff-142">You can send connection information over the mesh, and then set up a direct connection of your choosing to send/receive messages.</span></span>  
  
## <a name="choosing-an-approach-for-limiting-message-distribution"></a><span data-ttu-id="218ff-143">Výběr přístup pro omezení distribuce zpráv</span><span class="sxs-lookup"><span data-stu-id="218ff-143">Choosing an Approach for Limiting Message Distribution</span></span>  
 <span data-ttu-id="218ff-144">Po zjištění scénář, ve kterém je potřeba k omezení distribuce zpráv, položte si následující otázky:</span><span class="sxs-lookup"><span data-stu-id="218ff-144">When you discover a scenario in which you need to limit message distribution, ask yourself the following questions:</span></span>  
  
-   <span data-ttu-id="218ff-145">**Kdo** musí zpráva?</span><span class="sxs-lookup"><span data-stu-id="218ff-145">**Who** needs to receive the message?</span></span> <span data-ttu-id="218ff-146">Jedním sousedním uzlu?</span><span class="sxs-lookup"><span data-stu-id="218ff-146">Just one neighbor node?</span></span> <span data-ttu-id="218ff-147">Uzel někde jinde v mřížce?</span><span class="sxs-lookup"><span data-stu-id="218ff-147">A node somewhere else in the mesh?</span></span> <span data-ttu-id="218ff-148">Poloviční OK?</span><span class="sxs-lookup"><span data-stu-id="218ff-148">Half the mesh?</span></span>  
  
-   <span data-ttu-id="218ff-149">**Jak často** tuto zprávu zašle?</span><span class="sxs-lookup"><span data-stu-id="218ff-149">**How often** will this message be sent?</span></span>  
  
-   <span data-ttu-id="218ff-150">Jaký typ z **šířky pásma** použije tuto zprávu?</span><span class="sxs-lookup"><span data-stu-id="218ff-150">What kind of **bandwidth** will this message use?</span></span>  
  
 <span data-ttu-id="218ff-151">Odpovědi na tyto otázky vám může pomoct určit, jestli se má používat počet směrování, šíření filtru zpráv, filtrem místní nebo přímé připojení k.</span><span class="sxs-lookup"><span data-stu-id="218ff-151">The answers to these questions can help you determine whether to use Hop Count, a Message Propagation Filter, a local filter, or a direct connection.</span></span> <span data-ttu-id="218ff-152">Vezměte v úvahu následující obecné pokyny:</span><span class="sxs-lookup"><span data-stu-id="218ff-152">Consider the following general guidelines:</span></span>  
  
-   <span data-ttu-id="218ff-153">**Kdo**</span><span class="sxs-lookup"><span data-stu-id="218ff-153">**Who**</span></span>  
  
    -   <span data-ttu-id="218ff-154">*Jednotlivé uzlu*: filtru místní nebo přímé připojení.</span><span class="sxs-lookup"><span data-stu-id="218ff-154">*Individual node*:  Local filter or direct connection.</span></span>  
  
    -   <span data-ttu-id="218ff-155">*Okolí v rámci určitých okolí*: PeerHopCount.</span><span class="sxs-lookup"><span data-stu-id="218ff-155">*Neighbors within a certain vicinity*:  PeerHopCount.</span></span>  
  
    -   <span data-ttu-id="218ff-156">*Komplexní podmnožinu OK*: Třída MessagePropagationFilter.</span><span class="sxs-lookup"><span data-stu-id="218ff-156">*Complex subset of the mesh*:  MessagePropagationFilter.</span></span>  
  
-   <span data-ttu-id="218ff-157">**Jak často**</span><span class="sxs-lookup"><span data-stu-id="218ff-157">**How often**</span></span>  
  
    -   <span data-ttu-id="218ff-158">*Velmi často*: přímé připojení, PeerHopCount, Třída MessagePropagationFilter.</span><span class="sxs-lookup"><span data-stu-id="218ff-158">*Very frequent*:  Direct connection, PeerHopCount, MessagePropagationFilter.</span></span>  
  
    -   <span data-ttu-id="218ff-159">*Příležitostně*: místní filtru.</span><span class="sxs-lookup"><span data-stu-id="218ff-159">*Occasional*:  Local filter.</span></span>  
  
-   <span data-ttu-id="218ff-160">**Využití šířky pásma**</span><span class="sxs-lookup"><span data-stu-id="218ff-160">**Bandwidth use**</span></span>  
  
    -   <span data-ttu-id="218ff-161">*Vysoká*: přímé připojení, méně vhodné používat Třída MessagePropagationFilter nebo místní filtru.</span><span class="sxs-lookup"><span data-stu-id="218ff-161">*High*:  Direct connection, less advisable to use MessagePropagationFilter or local filter.</span></span>  
  
    -   <span data-ttu-id="218ff-162">*Nízká*: žádné, přímé připojení nejspíš potřeba.</span><span class="sxs-lookup"><span data-stu-id="218ff-162">*Low*:  Any, direct connection probably not needed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="218ff-163">Viz také</span><span class="sxs-lookup"><span data-stu-id="218ff-163">See Also</span></span>  
 [<span data-ttu-id="218ff-164">Vytvoření aplikace rovnocenného kanálu</span><span class="sxs-lookup"><span data-stu-id="218ff-164">Building a Peer Channel Application</span></span>](../../../../docs/framework/wcf/feature-details/building-a-peer-channel-application.md)
