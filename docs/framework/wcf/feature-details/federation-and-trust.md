---
title: Federace a důvěryhodnost
ms.date: 03/30/2017
helpviewer_keywords:
- federation [WCF], and trust
ms.assetid: 4bdec4f2-f8a2-4512-bdcf-14ef54b5877a
ms.openlocfilehash: fc6a14ed825fa447e80a8389684d10ed07a00815
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/04/2018
ms.locfileid: "33492902"
---
# <a name="federation-and-trust"></a><span data-ttu-id="c5c05-102">Federace a důvěryhodnost</span><span class="sxs-lookup"><span data-stu-id="c5c05-102">Federation and Trust</span></span>
<span data-ttu-id="c5c05-103">Toto téma popisuje různé aspekty související s federovaným aplikacím, hranice vztahů důvěryhodnosti a konfiguraci a používat vydané tokeny Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="c5c05-103">This topic covers various aspects related to federated applications, trust boundaries and configuration, and use of issued tokens in Windows Communication Foundation (WCF).</span></span>  
  
## <a name="services-security-token-services-and-trust"></a><span data-ttu-id="c5c05-104">Služby, služby tokenů zabezpečení a vztah důvěryhodnosti</span><span class="sxs-lookup"><span data-stu-id="c5c05-104">Services, Security Token Services, and Trust</span></span>  
 <span data-ttu-id="c5c05-105">Služby, které obvykle zveřejňují federované koncové body očekávají, že klienti k ověření pomocí tokenu poskytované konkrétní vystavitele.</span><span class="sxs-lookup"><span data-stu-id="c5c05-105">Services that expose federated endpoints typically expect clients to authenticate using a token provided by a specific issuer.</span></span> <span data-ttu-id="c5c05-106">Je důležité, aby služba je nakonfigurována se správnými přihlašovacími údaji pro vystavitele; jinak nebude možné k ověřování podpisů přes vystavené tokeny a klient nebude moci komunikovat se službou.</span><span class="sxs-lookup"><span data-stu-id="c5c05-106">It is important that the service is configured with the correct credentials for the issuer; otherwise, it will not be able to verify signatures over the issued tokens, and the client will be unable to communicate with the service.</span></span> <span data-ttu-id="c5c05-107">Další informace o konfiguraci přihlašovacích údajů vystavitele ve službě najdete v tématu [postupy: Konfigurace pověření ve službě Federation](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md).</span><span class="sxs-lookup"><span data-stu-id="c5c05-107">For more information about configuring issuer credentials on the service, see [How to: Configure Credentials on a Federation Service](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md).</span></span>  
  
 <span data-ttu-id="c5c05-108">Podobně při použití symetrické klíče, klíče jsou šifrována pro cílovou službu, takže musíte nakonfigurovat služby tokenů zabezpečení se správnými přihlašovacími údaji pro cílovou službu; jinak nebude možné k zašifrování klíče pro cílovou službu a znovu, bude klient nemůže komunikovat se službou.</span><span class="sxs-lookup"><span data-stu-id="c5c05-108">Similarly, when using symmetric keys, the keys are encrypted for the target service, so you must configure the security token service with the correct credentials for the target service; otherwise, it will be unable to encrypt the key for the target service, and again, the client will be unable to communicate with the service.</span></span>  
  
 <span data-ttu-id="c5c05-109">Služby WCF, použijte hodnotu <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> vlastnost [elementu SecurityBindingElement](../../../../docs/framework/wcf/diagnostics/wmi/securitybindingelement.md) umožňující hodiny zkosení mezi klientem a službou.</span><span class="sxs-lookup"><span data-stu-id="c5c05-109">WCF services use the value of the <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> property on the [SecurityBindingElement](../../../../docs/framework/wcf/diagnostics/wmi/securitybindingelement.md) to allow for clock skew between the client and service.</span></span> <span data-ttu-id="c5c05-110">Federaci `MaxClockSkew` nastavení se vztahuje na hodiny zkosí mezi klientem a ze kterých klient získal vydaný token služby tokenů zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="c5c05-110">In federation, the `MaxClockSkew` setting applies to clock skews between both the client and the security token service from where the client obtained the issued token.</span></span> <span data-ttu-id="c5c05-111">Služby tokenů zabezpečení nemusí proto zkontrolujte hodiny zkosení přídavky při nastavování vystavený token platné a časy vypršení platnosti.</span><span class="sxs-lookup"><span data-stu-id="c5c05-111">Therefore, security token services need not make clock-skew allowances when setting the issued token's effective and expiration times.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c5c05-112">Význam hodiny zkosení zvyšuje jako zkracuje dobu životnosti vydaný token.</span><span class="sxs-lookup"><span data-stu-id="c5c05-112">The importance of clock skew increases as the lifetime of the issued token shortens.</span></span> <span data-ttu-id="c5c05-113">Ve většině případů není hodiny zkosení významný problém, pokud dobu životnosti tokenu je 30 minut nebo déle.</span><span class="sxs-lookup"><span data-stu-id="c5c05-113">In most cases, clock skew is not a significant issue if the token lifetime is 30 minutes or more.</span></span> <span data-ttu-id="c5c05-114">Scénáře s kratší životnosti nebo kde je důležité dobu přesný platnosti tokenu by se měly navrhovat vzít v úvahu zkosení hodiny.</span><span class="sxs-lookup"><span data-stu-id="c5c05-114">Scenarios with shorter lifetimes or where the exact validity time of the token is important should be designed to take clock skew into account.</span></span>  
  
## <a name="federated-endpoints-and-time-outs"></a><span data-ttu-id="c5c05-115">Federované koncových bodů a vypršení časových limitů</span><span class="sxs-lookup"><span data-stu-id="c5c05-115">Federated Endpoints and Time-Outs</span></span>  
 <span data-ttu-id="c5c05-116">Pokud klient komunikuje s federované koncový bod, musíte nejprve získat token odpovídající od služby tokenů zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="c5c05-116">When a client communicates with a federated endpoint, it must first acquire an appropriate token from a security token service.</span></span> <span data-ttu-id="c5c05-117">Pokud služby tokenů zabezpečení zpřístupní koncový bod federované, musí klient nejdřív získat od vystavitele pro tento koncový bod token.</span><span class="sxs-lookup"><span data-stu-id="c5c05-117">If the security token service exposes a federated endpoint, the client must first obtain a token from the issuer for that endpoint.</span></span> <span data-ttu-id="c5c05-118">Každý token pořízení trvá určitou dobu a tento čas podléhá celkový časový limit pro odesílání skutečné zprávy koncovým bodem.</span><span class="sxs-lookup"><span data-stu-id="c5c05-118">Each token acquisition takes time, and that time is subject to the overall time-out for sending the actual message to the final endpoint.</span></span>  
  
 <span data-ttu-id="c5c05-119">Časový limit na straně klienta kanálu je třeba nastavit na 30 sekund.</span><span class="sxs-lookup"><span data-stu-id="c5c05-119">For example, the time-out on the client-side channel is set to 30 seconds.</span></span> <span data-ttu-id="c5c05-120">Dva tokenu vystavitelů muset volat načíst tokeny před odesláním zprávy na poslední koncový bod a každou trvá 15 sekund vydání tokenu.</span><span class="sxs-lookup"><span data-stu-id="c5c05-120">Two token issuers need to be called to retrieve tokens before sending the message to the final endpoint, and each takes 15 seconds to issue a token.</span></span> <span data-ttu-id="c5c05-121">V takovém případě se nezdaří pokus a <xref:System.TimeoutException> je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="c5c05-121">In this case, the attempt will fail and a <xref:System.TimeoutException> is thrown.</span></span> <span data-ttu-id="c5c05-122">Proto je nutné nastavit <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> hodnotu na kanálu klienta na hodnotu dostatečně velký pro zahrnout čas potřebný k načtení všech vystavené tokeny.</span><span class="sxs-lookup"><span data-stu-id="c5c05-122">Thus, you need to set the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> value on the client channel to a value large enough to include the time taken to retrieve all issued tokens.</span></span> <span data-ttu-id="c5c05-123">V případě, kde není zadána hodnota pro <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> vlastnost, <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> vlastnost nebo <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> vlastnost (nebo obě) je nutné nastavit na hodnotu dostatečně velký pro zahrnout čas potřebný k načtení všech vystavené tokeny.</span><span class="sxs-lookup"><span data-stu-id="c5c05-123">In the case where a value is not specified for the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> property, the <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> property or the <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> property (or both) need to be set to a value large enough to include the time taken to retrieve all issued tokens.</span></span>  
  
## <a name="token-lifetime-and-renewal"></a><span data-ttu-id="c5c05-124">Životnost tokenu a obnovení</span><span class="sxs-lookup"><span data-stu-id="c5c05-124">Token Lifetime and Renewal</span></span>  
 <span data-ttu-id="c5c05-125">Klienti WCF Neprovádět kontrolu vydaný token při vytváření počátečního požadavku na službu.</span><span class="sxs-lookup"><span data-stu-id="c5c05-125">WCF clients do not check the issued token when making an initial request to a service.</span></span>  <span data-ttu-id="c5c05-126">Místo toho WCF vztahy důvěryhodnosti služby tokenů zabezpečení vydání tokenu s odpovídající platné a časy vypršení platnosti.</span><span class="sxs-lookup"><span data-stu-id="c5c05-126">Rather, WCF trusts the security token service to issue a token with appropriate effective and expiration times.</span></span> <span data-ttu-id="c5c05-127">Pokud token je uložené v mezipaměti klienta a znovu použít, je na následné žádosti zaškrtnuta možnost dobu životnosti tokenu a klient automaticky obnovuje token v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="c5c05-127">If the token is cached by the client and reused, the token lifetime is checked on subsequent requests and the client automatically renews the token if necessary.</span></span> <span data-ttu-id="c5c05-128">Další informace o ukládání tokenu do mezipaměti najdete v tématu [postupy: vytvoření federovaného klienta](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md).</span><span class="sxs-lookup"><span data-stu-id="c5c05-128">For more information about token caching, see [How to: Create a Federated Client](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md).</span></span>  
  
 <span data-ttu-id="c5c05-129">Zadání krátkou životnost, v řádu 30 sekund nebo méně pro vydané tokeny nebo tokenů kontextu zabezpečení, může mít za následek vypršení časových limitů vyjednávání nebo jiné výjimky hlášeny WCF klienty při požaduje vystavené tokeny, nebo při vyjednávání nebo obnovení zabezpečení kontext tokeny.</span><span class="sxs-lookup"><span data-stu-id="c5c05-129">Specifying short lifetimes, on the order of 30 seconds or less for issued tokens or security context tokens, may result in negotiation time-outs or other exceptions being thrown by WCF clients when requesting issued tokens or when negotiating or renewing security context tokens.</span></span>  
  
## <a name="issued-tokens-and-inclusionmode"></a><span data-ttu-id="c5c05-130">Vystavené tokeny a InclusionMode</span><span class="sxs-lookup"><span data-stu-id="c5c05-130">Issued Tokens and InclusionMode</span></span>  
 <span data-ttu-id="c5c05-131">Jestli vystavený token je serializována v zprávy odeslané z klienta do federované koncového bodu nebo není řízeny nastavením <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> vlastnost <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> třídy.</span><span class="sxs-lookup"><span data-stu-id="c5c05-131">Whether an issued token is serialized in a message sent from a client to a federated endpoint or not is controlled by setting the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> property of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> class.</span></span> <span data-ttu-id="c5c05-132">Tuto vlastnost lze nastavit na jednu z <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> hodnot výčtu, ale není užitečný ve scénářích, většina federované.</span><span class="sxs-lookup"><span data-stu-id="c5c05-132">This property can be set to one of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> enumeration values, but it is not useful in most federated scenarios.</span></span> <span data-ttu-id="c5c05-133">`SecurityTokenInclusionMode.Never` a `SecurityTokenInclusionMode.AlwaysToInitiator` hodnoty způsobit, že klient k odeslání odkaz na tokenem vydaným službou tokenů zabezpečení k předávající straně.</span><span class="sxs-lookup"><span data-stu-id="c5c05-133">The `SecurityTokenInclusionMode.Never` and `SecurityTokenInclusionMode.AlwaysToInitiator` values cause the client to send a reference to the token issued by the security token service to the relying party.</span></span> <span data-ttu-id="c5c05-134">Pokud předávající strana má kopii vydaných tokenů, ověřování selže, protože odkaz tokenu není možné přeložit.</span><span class="sxs-lookup"><span data-stu-id="c5c05-134">Unless the relying party possesses a copy of the issued token, authentication will fail because the token reference is not resolvable.</span></span> <span data-ttu-id="c5c05-135">Zpracovává WCF `SecurityTokenInclusionMode.Once` jako ekvivalentní `SecurityTokenInclusionMode.AlwaysToRecipient`.</span><span class="sxs-lookup"><span data-stu-id="c5c05-135">WCF treats `SecurityTokenInclusionMode.Once` as equivalent to `SecurityTokenInclusionMode.AlwaysToRecipient`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c5c05-136">Viz také</span><span class="sxs-lookup"><span data-stu-id="c5c05-136">See Also</span></span>  
 <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode>  
 [<span data-ttu-id="c5c05-137">Postupy: Vytvoření federovaného klienta</span><span class="sxs-lookup"><span data-stu-id="c5c05-137">How to: Create a Federated Client</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)  
 [<span data-ttu-id="c5c05-138">Postupy: Konfigurace přihlašovacích údajů ve službě Federation Service</span><span class="sxs-lookup"><span data-stu-id="c5c05-138">How to: Configure Credentials on a Federation Service</span></span>](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)  
 [<span data-ttu-id="c5c05-139">Postupy: Vytvoření WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="c5c05-139">How to: Create a WSFederationHttpBinding</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-wsfederationhttpbinding.md)
