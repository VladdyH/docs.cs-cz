---
title: Streamování přenosu zpráv
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 72a47a51-e5e7-4b76-b24a-299d51e0ae5a
caps.latest.revision: 13
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: ed2aa57e044910ab9fd9c60dfd47eb7aaa0ce75e
ms.sourcegitcommit: 94d33cadc5ff81d2ac389bf5f26422c227832052
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/30/2018
---
# <a name="streaming-message-transfer"></a><span data-ttu-id="6a476-102">Streamování přenosu zpráv</span><span class="sxs-lookup"><span data-stu-id="6a476-102">Streaming Message Transfer</span></span>
[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]<span data-ttu-id="6a476-103"> přenosy podporují dva režimy pro přenos zpráv:</span><span class="sxs-lookup"><span data-stu-id="6a476-103"> transports support two modes for transferring messages:</span></span>  
  
-   <span data-ttu-id="6a476-104">Ve vyrovnávací paměti přenosy uložení celé zprávy vyrovnávací paměť v až do dokončení přenosu.</span><span class="sxs-lookup"><span data-stu-id="6a476-104">Buffered transfers hold the entire message in a memory buffer until the transfer is complete.</span></span> <span data-ttu-id="6a476-105">Zprávu ve vyrovnávací paměti musí být zcela doručována předtím, než příjemce může číst.</span><span class="sxs-lookup"><span data-stu-id="6a476-105">A buffered message must be completely delivered before a receiver can read it.</span></span>  
  
-   <span data-ttu-id="6a476-106">Přenášené datovými proudy přenosy vystavit zprávu jako datový proud.</span><span class="sxs-lookup"><span data-stu-id="6a476-106">Streamed transfers expose the message as a stream.</span></span> <span data-ttu-id="6a476-107">Příjemce spustí, než je zcela doručit zpracování zprávy.</span><span class="sxs-lookup"><span data-stu-id="6a476-107">The receiver starts processing the message before it is completely delivered.</span></span>  
  
-   <span data-ttu-id="6a476-108">Přenášené datovými proudy přenosy může zlepšit škálovatelnost služby odstraněním požadavek pro velké paměti vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="6a476-108">Streamed transfers can improve the scalability of a service by eliminating the requirement for large memory buffers.</span></span> <span data-ttu-id="6a476-109">Zda změna režimu přenosu zlepšuje škálovatelnost, závisí na velikosti přenášených zpráv.</span><span class="sxs-lookup"><span data-stu-id="6a476-109">Whether changing the transfer mode improves scalability depends on the size of the messages being transferred.</span></span> <span data-ttu-id="6a476-110">Velké zpráva velikosti upřednostnit pomocí přenášené datovými proudy přenosů.</span><span class="sxs-lookup"><span data-stu-id="6a476-110">Large message sizes favor using streamed transfers.</span></span>  
  
 <span data-ttu-id="6a476-111">Ve výchozím nastavení používají ve vyrovnávací paměti přenosy HTTP, TCP/IP a přenosy pojmenovaný kanál.</span><span class="sxs-lookup"><span data-stu-id="6a476-111">By default, the HTTP, TCP/IP, and named pipe transports use buffered transfers.</span></span> <span data-ttu-id="6a476-112">Tento dokument popisuje, jak přepínat těchto přenosů z ve vyrovnávací paměti pro režim přenosu přenášené datovými proudy a důsledky tak.</span><span class="sxs-lookup"><span data-stu-id="6a476-112">This document describes how to switch these transports from a buffered to streamed transfer mode and the consequences of doing so.</span></span>  
  
## <a name="enabling-streamed-transfers"></a><span data-ttu-id="6a476-113">Povolení přenášené datovými proudy přenosů</span><span class="sxs-lookup"><span data-stu-id="6a476-113">Enabling Streamed Transfers</span></span>  
 <span data-ttu-id="6a476-114">Výběr mezi režimy ve vyrovnávací paměti a přenášené datovými proudy přenos se provádí u prvku vazby přenosu.</span><span class="sxs-lookup"><span data-stu-id="6a476-114">Selecting between buffered and streamed transfer modes is done on the binding element of the transport.</span></span> <span data-ttu-id="6a476-115">Obsahuje prvku vazby <xref:System.ServiceModel.TransferMode> vlastnost, která může být nastaven na `Buffered`, `Streamed`, `StreamedRequest`, nebo `StreamedResponse`.</span><span class="sxs-lookup"><span data-stu-id="6a476-115">The binding element has a <xref:System.ServiceModel.TransferMode> property that can be set to `Buffered`, `Streamed`, `StreamedRequest`, or `StreamedResponse`.</span></span> <span data-ttu-id="6a476-116">Nastavení režimu přenosu `Streamed` umožňuje streamování komunikace v obou směrech.</span><span class="sxs-lookup"><span data-stu-id="6a476-116">Setting the transfer mode to `Streamed` enables streaming communication in both directions.</span></span> <span data-ttu-id="6a476-117">Nastavení režimu přenosu `StreamedRequest` nebo `StreamedResponse` umožňuje streamování komunikace v uvedeném směru.</span><span class="sxs-lookup"><span data-stu-id="6a476-117">Setting the transfer mode to `StreamedRequest` or `StreamedResponse` enables streaming communication in the indicated direction only.</span></span>  
  
 <span data-ttu-id="6a476-118"><xref:System.ServiceModel.BasicHttpBinding>, <xref:System.ServiceModel.NetTcpBinding>, A <xref:System.ServiceModel.NetNamedPipeBinding> zveřejněte vazby <xref:System.ServiceModel.TransferMode> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="6a476-118">The <xref:System.ServiceModel.BasicHttpBinding>, <xref:System.ServiceModel.NetTcpBinding>, and <xref:System.ServiceModel.NetNamedPipeBinding> bindings expose the <xref:System.ServiceModel.TransferMode> property.</span></span> <span data-ttu-id="6a476-119">Pro ostatní přenosy musíte vytvořit vlastní vazby nastavit režim přenosu.</span><span class="sxs-lookup"><span data-stu-id="6a476-119">For other transports, you must create a custom binding to set the transfer mode.</span></span>  
  
 <span data-ttu-id="6a476-120">Rozhodnutí použít ve vyrovnávací paměti nebo přenášené datovými proudy přenosy je místní rozhodnutí koncového bodu.</span><span class="sxs-lookup"><span data-stu-id="6a476-120">The decision to use either buffered or streamed transfers is a local decision of the endpoint.</span></span> <span data-ttu-id="6a476-121">Pro přenosy protokolu HTTP režim přenosu nešířily přes připojení nebo na servery a jiných zprostředkovatelů.</span><span class="sxs-lookup"><span data-stu-id="6a476-121">For HTTP transports, the transfer mode does not propagate across a connection, or to servers and other intermediaries.</span></span> <span data-ttu-id="6a476-122">Nastavení režimu přenosu se nereflektují v popisu rozhraní služby.</span><span class="sxs-lookup"><span data-stu-id="6a476-122">Setting the transfer mode is not reflected in the description of the service interface.</span></span> <span data-ttu-id="6a476-123">Po generování třídy klienta pro službu, musíte upravit konfigurační soubor pro služby určena pro použití s přenášené datovými proudy přenosy nastavení režimu.</span><span class="sxs-lookup"><span data-stu-id="6a476-123">After generating a client class for a service, you must edit the configuration file for services intended to be used with streamed transfers to set the mode.</span></span> <span data-ttu-id="6a476-124">TCP a přenosy pojmenovaný kanál režim přenosu rozšířena jako výraz zásad.</span><span class="sxs-lookup"><span data-stu-id="6a476-124">For TCP and named pipe transports, the transfer mode is propagated as a policy assertion.</span></span>  
  
 <span data-ttu-id="6a476-125">Ukázky kódu, najdete v části [postupy: povolení streamování](../../../../docs/framework/wcf/feature-details/how-to-enable-streaming.md).</span><span class="sxs-lookup"><span data-stu-id="6a476-125">For code samples, see [How to: Enable Streaming](../../../../docs/framework/wcf/feature-details/how-to-enable-streaming.md).</span></span>  
  
## <a name="enabling-asynchronous-streaming"></a><span data-ttu-id="6a476-126">Povolení asynchronní datové proudy</span><span class="sxs-lookup"><span data-stu-id="6a476-126">Enabling Asynchronous Streaming</span></span>  
 <span data-ttu-id="6a476-127">Chcete-li povolit asynchronní streamování, přidejte <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> chování koncového bodu do hostitele služby a nastavte její <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> vlastnost `true`.</span><span class="sxs-lookup"><span data-stu-id="6a476-127">To enable asynchronous streaming, add the  <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior> endpoint behavior to the service host and set its <xref:System.ServiceModel.Description.DispatcherSynchronizationBehavior.AsynchronousSendEnabled%2A> property to `true`.</span></span>  
  
 <span data-ttu-id="6a476-128">Tato verze služby WCF také adde možnosti true asynchronní streamování na straně odeslání.</span><span class="sxs-lookup"><span data-stu-id="6a476-128">This version of WCF also adde the capability of true asynchronous streaming on the send side.</span></span> <span data-ttu-id="6a476-129">To zlepšuje škálovatelnost služby ve scénářích, kde ji je streamování zprávy na více klientů, z nichž některé jsou pomalé v režimu čtení; pravděpodobně z důvodu zahlcení sítě nebo jsou není čtení vůbec.</span><span class="sxs-lookup"><span data-stu-id="6a476-129">This improves scalability of the service in scenarios where it is streaming messages to multiple clients some of which are slow in reading; possibly due to network congestion or are not reading at all.</span></span> <span data-ttu-id="6a476-130">V těchto scénářích WCF už blokuje jednotlivých vláken ve službě za klienta.</span><span class="sxs-lookup"><span data-stu-id="6a476-130">In these scenarios WCF no longer blocks individual threads on the service per client.</span></span> <span data-ttu-id="6a476-131">Tím se zajistí, že služba je schopna zpracovat mnoho více klientů a zlepšení škálovatelnosti služby.</span><span class="sxs-lookup"><span data-stu-id="6a476-131">This ensures that the service is able to process many more clients thereby improving the scalability of the service.</span></span>  
  
## <a name="restrictions-on-streamed-transfers"></a><span data-ttu-id="6a476-132">Omezení přenášené datovými proudy převodů</span><span class="sxs-lookup"><span data-stu-id="6a476-132">Restrictions on Streamed Transfers</span></span>  
 <span data-ttu-id="6a476-133">Pomocí režimu přenášené datovými proudy přenos způsobí, že čas spuštění vynutit další omezení.</span><span class="sxs-lookup"><span data-stu-id="6a476-133">Using the streamed transfer mode causes the run time to enforce additional restrictions.</span></span>  
  
 <span data-ttu-id="6a476-134">Operace, které napříč přenášené datovými proudy přenosu může mít kontrakt s maximálně jeden vstupní nebo výstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="6a476-134">Operations that occur across a streamed transport can have a contract with at most one input or output parameter.</span></span> <span data-ttu-id="6a476-135">Tento parametr odpovídá celý text zprávy a musí být <xref:System.ServiceModel.Channels.Message>, odvozený typ <xref:System.IO.Stream>, nebo <xref:System.Xml.Serialization.IXmlSerializable> implementace.</span><span class="sxs-lookup"><span data-stu-id="6a476-135">That parameter corresponds to the entire body of the message and must be a <xref:System.ServiceModel.Channels.Message>, a derived type of <xref:System.IO.Stream>, or an <xref:System.Xml.Serialization.IXmlSerializable> implementation.</span></span> <span data-ttu-id="6a476-136">S návratovou hodnotou pro operace je ekvivalentní s výstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="6a476-136">Having a return value for an operation is equivalent to having an output parameter.</span></span>  
  
 <span data-ttu-id="6a476-137">Některé [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] funkce, jako je spolehlivé zasílání zpráv, transakce a zabezpečení na úrovni zprávu protokolu SOAP, závisí na ukládání do vyrovnávací paměti zpráv pro přenosy.</span><span class="sxs-lookup"><span data-stu-id="6a476-137">Some [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] features, such as reliable messaging, transactions, and SOAP message-level security, rely on buffering messages for transmissions.</span></span> <span data-ttu-id="6a476-138">Používání těchto funkcí může omezit nebo odstranit výkonu výhody pomocí vysílání datového proudu.</span><span class="sxs-lookup"><span data-stu-id="6a476-138">Using these features may reduce or eliminate the performance benefits gained by using streaming.</span></span> <span data-ttu-id="6a476-139">K zabezpečení přenášené datovými proudy přenosu, použijte pouze zabezpečení na úrovni přenosu nebo použijte zabezpečení transportní vrstvy a zabezpečení jen ověřování zpráv.</span><span class="sxs-lookup"><span data-stu-id="6a476-139">To secure a streamed transport, use transport-level security only or use transport-level security plus authentication-only message security.</span></span>  
  
 <span data-ttu-id="6a476-140">Hlavičky SOAP jsou vždy do vyrovnávací paměti, i když přenos režim je nastaven na přenášené datovými proudy.</span><span class="sxs-lookup"><span data-stu-id="6a476-140">SOAP headers are always buffered, even when the transfer mode is set to streamed.</span></span> <span data-ttu-id="6a476-141">Hlavičky pro zprávu nesmí překročit velikost `MaxBufferSize` kvóty přenosu.</span><span class="sxs-lookup"><span data-stu-id="6a476-141">The headers for a message must not exceed the size of the `MaxBufferSize` transport quota.</span></span> <span data-ttu-id="6a476-142">Další informace o tomto nastavení najdete v tématu [přenosové kvóty](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="6a476-142">For more information about this setting, see [Transport Quotas](../../../../docs/framework/wcf/feature-details/transport-quotas.md).</span></span>  
  
## <a name="differences-between-buffered-and-streamed-transfers"></a><span data-ttu-id="6a476-143">Rozdíly mezi přenosy ve vyrovnávací paměti a přenášené datovými proudy</span><span class="sxs-lookup"><span data-stu-id="6a476-143">Differences Between Buffered and Streamed Transfers</span></span>  
 <span data-ttu-id="6a476-144">Změna režimu přenosu z vyrovnávací paměti pro streamování také změní tvar nativní kanálu TCP a přenosy pojmenovaný kanál.</span><span class="sxs-lookup"><span data-stu-id="6a476-144">Changing the transfer mode from buffered to streamed also changes the native channel shape of the TCP and named pipe transports.</span></span> <span data-ttu-id="6a476-145">Pro přenosy ve vyrovnávací paměti, je tvar nativní kanálu <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span><span class="sxs-lookup"><span data-stu-id="6a476-145">For buffered transfers, the native channel shape is <xref:System.ServiceModel.Channels.IDuplexSessionChannel>.</span></span> <span data-ttu-id="6a476-146">Pro přenášené datovými proudy přenosy jsou nativní kanály <xref:System.ServiceModel.Channels.IRequestChannel> a <xref:System.ServiceModel.Channels.IReplyChannel>.</span><span class="sxs-lookup"><span data-stu-id="6a476-146">For streamed transfers, the native channels are <xref:System.ServiceModel.Channels.IRequestChannel> and <xref:System.ServiceModel.Channels.IReplyChannel>.</span></span> <span data-ttu-id="6a476-147">Změna režimu přenosu v existující aplikaci, která používá tyto přenosy, přímo (tedy ne prostřednictvím smlouvy o poskytování služeb) vyžaduje změna tvaru očekávané kanál pro kanál továrny a naslouchací procesy.</span><span class="sxs-lookup"><span data-stu-id="6a476-147">Changing the transfer mode in an existing application that uses these transports directly (that is, not through a service contract) requires changing the expected channel shape for channel factories and listeners.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6a476-148">Viz také</span><span class="sxs-lookup"><span data-stu-id="6a476-148">See Also</span></span>  
 [<span data-ttu-id="6a476-149">Postupy: Povolení streamování</span><span class="sxs-lookup"><span data-stu-id="6a476-149">How to: Enable Streaming</span></span>](../../../../docs/framework/wcf/feature-details/how-to-enable-streaming.md)
