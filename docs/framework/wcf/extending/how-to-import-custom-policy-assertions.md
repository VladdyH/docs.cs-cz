---
title: "Postupy: Import kontrolních výrazů vlastních zásad"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 1f41d787-accb-4a10-bfc6-a807671d1581
caps.latest.revision: "8"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 916f5b820ce9e1c30c13a9834548c83e32bc3579
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/22/2017
---
# <a name="how-to-import-custom-policy-assertions"></a><span data-ttu-id="b4c34-102">Postupy: Import kontrolních výrazů vlastních zásad</span><span class="sxs-lookup"><span data-stu-id="b4c34-102">How to: Import Custom Policy Assertions</span></span>
<span data-ttu-id="b4c34-103">Kontrolní výrazy zásad jsou popsány možnosti a požadavky koncového bodu služby.</span><span class="sxs-lookup"><span data-stu-id="b4c34-103">Policy assertions describe the capabilities and requirements of a service endpoint.</span></span>  <span data-ttu-id="b4c34-104">Klientské aplikace můžete použít výrazy zásad v metadata služby ke konfiguraci klienta vazby nebo k přizpůsobení kontrakt služby pro koncový bod služby.</span><span class="sxs-lookup"><span data-stu-id="b4c34-104">Client applications can use policy assertions in service metadata to configure the client binding or to customize the service contract for a service endpoint.</span></span>  
  
 <span data-ttu-id="b4c34-105">Kontrolních výrazů vlastních zásad importují implementací <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> rozhraní a předání objektu metadat systému nebo tím, že zaregistrujete implementace zadejte v konfiguračním souboru aplikace.</span><span class="sxs-lookup"><span data-stu-id="b4c34-105">Custom policy assertions are imported by implementing the <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> interface and passing that object to the metadata system or by registering the implementation type in your application configuration file.</span></span>  <span data-ttu-id="b4c34-106">Implementace <xref:System.ServiceModel.Description.IPolicyImportExtension> rozhraní musíte zadat výchozí konstruktor.</span><span class="sxs-lookup"><span data-stu-id="b4c34-106">Implementations of the <xref:System.ServiceModel.Description.IPolicyImportExtension> interface must provide a default constructor.</span></span>  
  
### <a name="to-import-custom-policy-assertions"></a><span data-ttu-id="b4c34-107">Import kontrolních výrazů vlastních zásad</span><span class="sxs-lookup"><span data-stu-id="b4c34-107">To import custom policy assertions</span></span>  
  
1.  <span data-ttu-id="b4c34-108">Implementace <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> rozhraní na třídu.</span><span class="sxs-lookup"><span data-stu-id="b4c34-108">Implement the <xref:System.ServiceModel.Description.IPolicyImportExtension?displayProperty=nameWithType> interface on a class.</span></span> <span data-ttu-id="b4c34-109">Postupujte podle následujících pokynů.</span><span class="sxs-lookup"><span data-stu-id="b4c34-109">See the following procedures.</span></span>  
  
2.  <span data-ttu-id="b4c34-110">Vložit – Importér vlastní zásady buď pomocí:</span><span class="sxs-lookup"><span data-stu-id="b4c34-110">Insert the custom policy importer either by:</span></span>  
  
3.  <span data-ttu-id="b4c34-111">Použití konfiguračního souboru.</span><span class="sxs-lookup"><span data-stu-id="b4c34-111">Using a configuration file.</span></span> <span data-ttu-id="b4c34-112">Postupujte podle následujících pokynů.</span><span class="sxs-lookup"><span data-stu-id="b4c34-112">See the following procedures.</span></span>  
  
4.  <span data-ttu-id="b4c34-113">Použití konfiguračního souboru s [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span><span class="sxs-lookup"><span data-stu-id="b4c34-113">Using a configuration file with [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span> <span data-ttu-id="b4c34-114">Postupujte podle následujících pokynů.</span><span class="sxs-lookup"><span data-stu-id="b4c34-114">See the following procedures.</span></span>  
  
5.  <span data-ttu-id="b4c34-115">Prostřednictvím kódu programu vkládání – Importér zásad.</span><span class="sxs-lookup"><span data-stu-id="b4c34-115">Programmatically inserting the policy importer.</span></span> <span data-ttu-id="b4c34-116">Postupujte podle následujících pokynů.</span><span class="sxs-lookup"><span data-stu-id="b4c34-116">See the following procedures.</span></span>  
  
### <a name="to-implement-the-systemservicemodeldescriptionipolicyimportextension-interface-on-any-class"></a><span data-ttu-id="b4c34-117">Implementace rozhraní System.ServiceModel.Description.IPolicyImportExtension u jakékoli třídy</span><span class="sxs-lookup"><span data-stu-id="b4c34-117">To implement the System.ServiceModel.Description.IPolicyImportExtension interface on any class</span></span>  
  
1.  <span data-ttu-id="b4c34-118">V <xref:System.ServiceModel.Description.IPolicyImportExtension.ImportPolicy%2A?displayProperty=nameWithType> metoda, pro každý předmět zásad, která vás zajímá, najít výrazy zásad, které chcete importovat voláním odpovídající metodu (v závislosti na rozsahu kontrolní výraz, který chcete) na <xref:System.ServiceModel.Description.PolicyConversionContext?displayProperty=nameWithType> byl předán objekt Metoda.</span><span class="sxs-lookup"><span data-stu-id="b4c34-118">In the <xref:System.ServiceModel.Description.IPolicyImportExtension.ImportPolicy%2A?displayProperty=nameWithType> method, for each policy subject that you are interested in, find the policy assertions that you want to import by calling the appropriate method (depending upon the scope of the assertion that you want) on the <xref:System.ServiceModel.Description.PolicyConversionContext?displayProperty=nameWithType> object passed to the method.</span></span> <span data-ttu-id="b4c34-119">Následující příklad kódu ukazuje, jak používat <xref:System.ServiceModel.Description.PolicyAssertionCollection.Remove%2A?displayProperty=nameWithType> metoda vyhledat výraz vlastních zásad a jeho odebrání z kolekce v jednom kroku.</span><span class="sxs-lookup"><span data-stu-id="b4c34-119">The following code example shows how to use the <xref:System.ServiceModel.Description.PolicyAssertionCollection.Remove%2A?displayProperty=nameWithType> method to locate the custom policy assertion and remove it from the collection in one step.</span></span> <span data-ttu-id="b4c34-120">Pokud používáte metodu odebrat můžete nalézt a odstranit kontrolní výraz, nemáte proveďte krok 4.</span><span class="sxs-lookup"><span data-stu-id="b4c34-120">If you use the remove method to locate and remove the assertion, you do not have to perform step 4.</span></span>  
  
     [!code-csharp[CustomPolicySample#9](../../../../samples/snippets/csharp/VS_Snippets_CFX/custompolicysample/cs/policyimporter.cs#9)]
     [!code-vb[CustomPolicySample#9](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/custompolicysample/vb/policyimporter.vb#9)]  
  
2.  <span data-ttu-id="b4c34-121">Zpracovat výrazy zásad.</span><span class="sxs-lookup"><span data-stu-id="b4c34-121">Process the policy assertions.</span></span> <span data-ttu-id="b4c34-122">Všimněte si, že zásady systému není normalizaci vnořené zásady a `wsp:optional`.</span><span class="sxs-lookup"><span data-stu-id="b4c34-122">Note that the policy system does not normalize nested policies and `wsp:optional`.</span></span> <span data-ttu-id="b4c34-123">Je nutné zpracovat tyto konstrukce v implementaci zásad import rozšíření.</span><span class="sxs-lookup"><span data-stu-id="b4c34-123">You must process these constructs in your policy import extension implementation.</span></span>  
  
3.  <span data-ttu-id="b4c34-124">Proveďte vlastní vazby nebo kontrakt, který podporuje schopnosti nebo požadavek určeného výraz zásad.</span><span class="sxs-lookup"><span data-stu-id="b4c34-124">Perform the customization to the binding or contract that supports the capability or requirement specified by the policy assertion.</span></span> <span data-ttu-id="b4c34-125">Kontrolní výrazy obvykle označují, že vazba vyžaduje konkrétní konfigurací nebo prvku konkrétní vazby.</span><span class="sxs-lookup"><span data-stu-id="b4c34-125">Typically assertions indicate that a binding requires a particular configuration or a specific binding element.</span></span> <span data-ttu-id="b4c34-126">Proveďte tyto úpravy přímým přístupem <xref:System.ServiceModel.Description.PolicyConversionContext.BindingElements%2A?displayProperty=nameWithType> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="b4c34-126">Make these modifications by accessing the <xref:System.ServiceModel.Description.PolicyConversionContext.BindingElements%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="b4c34-127">Další kontrolní výrazy vyžadují, že upravíte kontrakt.</span><span class="sxs-lookup"><span data-stu-id="b4c34-127">Other assertions require that you modify the contract.</span></span>  <span data-ttu-id="b4c34-128">Můžete používat a upravit pomocí kontrakt <xref:System.ServiceModel.Description.PolicyConversionContext.Contract%2A?displayProperty=nameWithType> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="b4c34-128">You can access and modify the contract using the <xref:System.ServiceModel.Description.PolicyConversionContext.Contract%2A?displayProperty=nameWithType> property.</span></span>  <span data-ttu-id="b4c34-129">Všimněte si, že vaše zásady – Importér může získat volat vícekrát pro stejnou vazbu a kontrakt, ale jinou zásadu alternativy, pokud Import zásady alternativní selže.</span><span class="sxs-lookup"><span data-stu-id="b4c34-129">Note that your policy importer may get called multiple times for the same binding and contract, but different policy alternatives if importing a policy alternative fails.</span></span> <span data-ttu-id="b4c34-130">Váš kód by měl být odolné vůči toto chování.</span><span class="sxs-lookup"><span data-stu-id="b4c34-130">Your code should be resilient to this behavior.</span></span>  
  
4.  <span data-ttu-id="b4c34-131">Kontrolní výraz vlastní zásady pro odebrání z kolekce kontrolní výraz.</span><span class="sxs-lookup"><span data-stu-id="b4c34-131">Remove the custom policy assertion from the assertion collection.</span></span> <span data-ttu-id="b4c34-132">Pokud neodeberete kontrolní výraz [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] předpokládá, že import zásady nebylo úspěšné a neimportuje přidružené vazby.</span><span class="sxs-lookup"><span data-stu-id="b4c34-132">If you do not remove the assertion [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] assumes that the policy import was unsuccessful and does not import the associated binding.</span></span> <span data-ttu-id="b4c34-133">Pokud jste použili <xref:System.ServiceModel.Description.PolicyAssertionCollection.Remove%2A?displayProperty=nameWithType> metoda vyhledat výraz vlastních zásad a jeho odebrání z kolekce v jednom kroku není nutné k provedení tohoto kroku.</span><span class="sxs-lookup"><span data-stu-id="b4c34-133">If you used the <xref:System.ServiceModel.Description.PolicyAssertionCollection.Remove%2A?displayProperty=nameWithType> method to locate the custom policy assertion and remove it from the collection in one step you do not have to perform this step.</span></span>  
  
### <a name="to-insert-the-custom-policy-importer-into-the-metadata-system-using-a-configuration-file"></a><span data-ttu-id="b4c34-134">Program pro import vlastních zásad pro vložení do metadat systému pomocí konfiguračního souboru</span><span class="sxs-lookup"><span data-stu-id="b4c34-134">To insert the custom policy importer into the metadata System using a configuration file</span></span>  
  
1.  <span data-ttu-id="b4c34-135">Přidat – Importér typ, který má `<extensions>` element uvnitř [ \<policyImporters >](../../../../docs/framework/configure-apps/file-schema/wcf/policyimporters.md) element v souboru konfigurace klienta.</span><span class="sxs-lookup"><span data-stu-id="b4c34-135">Add the importer type to the `<extensions>` element inside the [\<policyImporters>](../../../../docs/framework/configure-apps/file-schema/wcf/policyimporters.md) element in the client configuration file.</span></span>  
  
     [!code-xml[CustomPolicySample#7](../../../../samples/snippets/csharp/VS_Snippets_CFX/custompolicysample/cs/client.exe.config#7)]   
  
2.  <span data-ttu-id="b4c34-136">V aplikaci klienta použít <xref:System.ServiceModel.Description.MetadataResolver?displayProperty=nameWithType> nebo <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType> řešení, se automaticky vyvolá metadata a program pro import.</span><span class="sxs-lookup"><span data-stu-id="b4c34-136">In the client application, use the <xref:System.ServiceModel.Description.MetadataResolver?displayProperty=nameWithType> or <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType> to resolve the metadata and the importer is invoked automatically.</span></span>  
  
     [!code-csharp[CustomPolicySample#10](../../../../samples/snippets/csharp/VS_Snippets_CFX/custompolicysample/cs/client.cs#10)]
     [!code-vb[CustomPolicySample#10](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/custompolicysample/vb/client.vb#10)]  
  
### <a name="to-insert-the-custom-policy-importer-into-the-metadata-system-using-svcutilexe"></a><span data-ttu-id="b4c34-137">Program pro import vlastních zásad pro vložení do systému metadat pomocí Svcutil.exe</span><span class="sxs-lookup"><span data-stu-id="b4c34-137">To insert the custom policy importer into the metadata system using Svcutil.exe</span></span>  
  
1.  <span data-ttu-id="b4c34-138">Přidat – Importér typ, který má `<extensions>` element uvnitř [ \<policyImporters >](../../../../docs/framework/configure-apps/file-schema/wcf/policyimporters.md) element v konfiguračním souboru Svcutil.exe.config.</span><span class="sxs-lookup"><span data-stu-id="b4c34-138">Add the importer type to the `<extensions>` element inside the [\<policyImporters>](../../../../docs/framework/configure-apps/file-schema/wcf/policyimporters.md) element in the Svcutil.exe.config configuration file.</span></span> <span data-ttu-id="b4c34-139">Můžete také bodu Svcutil.exe načíst zásady typů – Importér zaregistrováno v různých konfiguračním souboru pomocí `/svcutilConfig` možnost.</span><span class="sxs-lookup"><span data-stu-id="b4c34-139">You can also point Svcutil.exe to load policy importer types registered in a different configuration file by using the `/svcutilConfig` option.</span></span>  
  
2.  <span data-ttu-id="b4c34-140">Použití [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) importovat metadata a – Importér vyvolán automaticky.</span><span class="sxs-lookup"><span data-stu-id="b4c34-140">Use [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md) to import the metadata and the importer is invoked automatically.</span></span>  
  
### <a name="to-insert-the-custom-policy-importer-into-the-metadata-system-programmatically"></a><span data-ttu-id="b4c34-141">Vložení vlastní zásady – Importér do systém metadat prostřednictvím kódu programu</span><span class="sxs-lookup"><span data-stu-id="b4c34-141">To insert the custom policy importer into the metadata system programmatically</span></span>  
  
1.  <span data-ttu-id="b4c34-142">Přidat – Importér k <xref:System.ServiceModel.Description.MetadataImporter.PolicyImportExtensions%2A?displayProperty=nameWithType> vlastnosti (například pokud používáte <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType>) před importem metadata.</span><span class="sxs-lookup"><span data-stu-id="b4c34-142">Add the importer to the <xref:System.ServiceModel.Description.MetadataImporter.PolicyImportExtensions%2A?displayProperty=nameWithType> property (for example, if you are using the <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType>) prior to importing the metadata.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b4c34-143">Viz také</span><span class="sxs-lookup"><span data-stu-id="b4c34-143">See Also</span></span>  
 <xref:System.ServiceModel.Description.MetadataResolver?displayProperty=nameWithType>  
 <xref:System.ServiceModel.Description.WsdlImporter?displayProperty=nameWithType>  
 <xref:System.ServiceModel.Description.MetadataResolver?displayProperty=nameWithType>  
 [<span data-ttu-id="b4c34-144">Rozšíření systému metadat</span><span class="sxs-lookup"><span data-stu-id="b4c34-144">Extending the Metadata System</span></span>](../../../../docs/framework/wcf/extending/extending-the-metadata-system.md)
