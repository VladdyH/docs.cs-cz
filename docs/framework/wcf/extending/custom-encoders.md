---
title: "Vlastní kodéry"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: fa0e1d7f-af36-4bf4-aac9-cd4eab95bc4f
caps.latest.revision: "15"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: f1c8223ea7900ba0a89ee2c5c48895a1782d18a0
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/22/2017
---
# <a name="custom-encoders"></a><span data-ttu-id="07421-102">Vlastní kodéry</span><span class="sxs-lookup"><span data-stu-id="07421-102">Custom Encoders</span></span>
<span data-ttu-id="07421-103">Toto téma popisuje, jak vytvořit vlastní kodéry.</span><span class="sxs-lookup"><span data-stu-id="07421-103">This topic discusses how to create custom encoders.</span></span>  
  
 <span data-ttu-id="07421-104">V [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)], můžete použít *vazby* určení způsobu přenosu dat v síti mezi koncovými body.</span><span class="sxs-lookup"><span data-stu-id="07421-104">In [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)], you use a *binding* to specify how to transfer data across a network between endpoints.</span></span> <span data-ttu-id="07421-105">Vazba je tvořen posloupnost *elementů vazby*.</span><span class="sxs-lookup"><span data-stu-id="07421-105">A binding is made up of a sequence of *binding elements*.</span></span> <span data-ttu-id="07421-106">Vazba obsahuje prvky vazby volitelné protokol například zabezpečení, požadovanou *kodér zpráv* prvku vazby a element vazby požadované přenosu.</span><span class="sxs-lookup"><span data-stu-id="07421-106">A binding includes optional protocol binding elements such as security, a required *Message Encoder* binding element, and a required transport binding element.</span></span> <span data-ttu-id="07421-107">Kodér zpráv je reprezentována zprávu kódování prvku vazby.</span><span class="sxs-lookup"><span data-stu-id="07421-107">A message encoder is represented by a message encoding binding element.</span></span> <span data-ttu-id="07421-108">Tři kodéry zprávy jsou součástí [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]: binární, zpráva přenosu optimalizace mechanismus (MTOM) a Text.</span><span class="sxs-lookup"><span data-stu-id="07421-108">Three message encoders are included in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]: Binary, Message Transmission Optimization Mechanism (MTOM), and Text.</span></span>  
  
 <span data-ttu-id="07421-109">Kódování prvku vazby serializuje odchozí zprávy <xref:System.ServiceModel.Channels.Message> a předává je pro přenos, nebo přijme serializovaný formu zprávu z přenosu a předá ji do vrstvy protokolu, pokud existuje, nebo k aplikaci, pokud nejsou přítomny.</span><span class="sxs-lookup"><span data-stu-id="07421-109">A message encoding binding element serializes an outgoing <xref:System.ServiceModel.Channels.Message> and passes it to the transport, or receives the serialized form of a message from the transport and passes it to the protocol layer if present, or to the application, if not present.</span></span>  
  
 <span data-ttu-id="07421-110">Zpráva kodéry transformace <xref:System.ServiceModel.Channels.Message> instance do a z síťové vyjádření.</span><span class="sxs-lookup"><span data-stu-id="07421-110">Message encoders transform <xref:System.ServiceModel.Channels.Message> instances to and from a wire representation.</span></span> <span data-ttu-id="07421-111">I když kodéry jsou popsány jako najednou vyšší přenosové vrstvy v zásobníku kanál, jsou umístěny v přenosové vrstvě.</span><span class="sxs-lookup"><span data-stu-id="07421-111">Although encoders are described as sitting above the transport layer in the channel stack, they reside inside the transport layer.</span></span> <span data-ttu-id="07421-112">Přenosy (například protokol HTTP) formátu zprávy v souladu s požadavky standardu přenosu.</span><span class="sxs-lookup"><span data-stu-id="07421-112">Transports (for example HTTP) format the message according to the requirements of the transport standard.</span></span> <span data-ttu-id="07421-113">Kódovací moduly (například textu Xml) právě kódování zprávy.</span><span class="sxs-lookup"><span data-stu-id="07421-113">Encoders (for example Text Xml) just encode the message.</span></span>  
  
 <span data-ttu-id="07421-114">Při připojování k dříve existující klient nebo server, nemusí mít volba o pomocí konkrétní zprávu kódování.</span><span class="sxs-lookup"><span data-stu-id="07421-114">When connecting to a preexisting client or server, you may not have a choice about using a particular message encoding.</span></span> <span data-ttu-id="07421-115">Ale [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] služeb mohou být přístupné přes několik koncových bodů, každý s kodéru různé zprávy.</span><span class="sxs-lookup"><span data-stu-id="07421-115">However, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services can be made accessible through multiple endpoints, each with a different message encoder.</span></span> <span data-ttu-id="07421-116">Při jednom kodér nepokrývá celou cílovou skupinu pro vaši službu, vezměte v úvahu vystavení služby přes několik koncových bodů.</span><span class="sxs-lookup"><span data-stu-id="07421-116">When a single encoder does not cover the entire audience for your service, consider exposing your service over multiple endpoints.</span></span> <span data-ttu-id="07421-117">Klientské aplikace můžete pak vybrat koncový bod, který je nejvhodnější pro ně.</span><span class="sxs-lookup"><span data-stu-id="07421-117">Client applications can then choose the endpoint that is best for them.</span></span> <span data-ttu-id="07421-118">Pomocí několik koncových bodů můžete kombinovat s jinými prvky vazby výhod kodéry jiná zpráva.</span><span class="sxs-lookup"><span data-stu-id="07421-118">Using multiple endpoints allows you to combine the advantages of different message encoders with other binding elements.</span></span>  
  
## <a name="system-provided-encoders"></a><span data-ttu-id="07421-119">Kodéry poskytované systémem</span><span class="sxs-lookup"><span data-stu-id="07421-119">System-Provided Encoders</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="07421-120">poskytuje několik vazeb poskytovaných systémem, které jsou navrženy tak, aby pokrývalo nejběžnějších scénářů aplikace.</span><span class="sxs-lookup"><span data-stu-id="07421-120"> provides several system-provided bindings that are designed to cover the most common application scenarios.</span></span> <span data-ttu-id="07421-121">Každý z těchto vazeb kombinovat přenos, kodér zpráv a další možnosti (například zabezpečení).</span><span class="sxs-lookup"><span data-stu-id="07421-121">Each of these bindings combine a transport, message encoder, and other options (security, for example).</span></span> <span data-ttu-id="07421-122">Toto téma popisuje, jak rozšířit `Text`, `Binary`, a `MTOM` zprávy kodéry, které jsou součástí [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], nebo vytvořit vlastní kodér.</span><span class="sxs-lookup"><span data-stu-id="07421-122">This topic describes how to extend the `Text`, `Binary`, and `MTOM` message encoders that are included in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], or create your own custom encoder.</span></span> <span data-ttu-id="07421-123">Kodér textu zprávy podporuje prostý kódování XML jak kódování SOAP.</span><span class="sxs-lookup"><span data-stu-id="07421-123">The text message encoder supports both a plain XML encoding as well as SOAP encodings.</span></span> <span data-ttu-id="07421-124">Kodér POX ("prostý formát XML") ho odlišuje od založený na textu protokolu SOAP kódování se nazývá prostý režim kódování XML kodér textu zprávy.</span><span class="sxs-lookup"><span data-stu-id="07421-124">The plain XML encoding mode of the text message encoder is called the POX ("Plain Old XML") encoder to distinguish it from the text-based SOAP encoding.</span></span>  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="07421-125">kombinace prvky vazeb poskytovaných vazby poskytované systémem najdete v části odpovídající v [volba přenosu](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span><span class="sxs-lookup"><span data-stu-id="07421-125"> the combinations of binding elements provided by the system-provided bindings, see the corresponding section in [Choosing a Transport](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md).</span></span>  
  
## <a name="how-to-work-with-system-provided-encoders"></a><span data-ttu-id="07421-126">Jak pracovat s kodéry poskytované systémem</span><span class="sxs-lookup"><span data-stu-id="07421-126">How to Work with System-Provided Encoders</span></span>  
 <span data-ttu-id="07421-127">Kódování se přidá do vazbu pomocí třídy odvozené od <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="07421-127">An encoding is added to a binding using a class derived from <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span></span>  
  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="07421-128">poskytuje následující typy odvozené z elementů vazby <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> třídu, která může poskytnout pro text, binary a kódování zpráv přenosu optimalizace mechanismus (MTOM):</span><span class="sxs-lookup"><span data-stu-id="07421-128"> provides the following types of binding elements derived from the <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> class that can provide for text, binary and Message Transmission Optimization Mechanism (MTOM) encoding:</span></span>  
  
-   <span data-ttu-id="07421-129"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>: Interoperabilních nejvíce, ale alespoň efektivní kodéru zpráv XML.</span><span class="sxs-lookup"><span data-stu-id="07421-129"><xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>: The most interoperable, but the least efficient encoder for XML messages.</span></span> <span data-ttu-id="07421-130">Webová služba nebo klient webové služby lze obecně pochopit textovou XML.</span><span class="sxs-lookup"><span data-stu-id="07421-130">A Web service or Web service client can generally understand textual XML.</span></span> <span data-ttu-id="07421-131">Ale přenos velkých bloků binárních dat jako text není efektivní.</span><span class="sxs-lookup"><span data-stu-id="07421-131">However, transmitting large blocks of binary data as text is not efficient.</span></span>  
  
-   <span data-ttu-id="07421-132"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>: Představuje vazby elementu, který určuje kódování znaků a správa verzí používá pro zprávy XML, binární zprávy.</span><span class="sxs-lookup"><span data-stu-id="07421-132"><xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>: Represents the binding element that specifies the character encoding and message versioning used for binary-based XML messages.</span></span> <span data-ttu-id="07421-133">Toto je nejúčinnější možnosti kódování, ale alespoň interoperabilní, protože je podporován pouze pomocí [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] koncové body.</span><span class="sxs-lookup"><span data-stu-id="07421-133">This is most efficient of the encoding options, but the least interoperable, because it is only supported by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoints.</span></span>  
  
-   <span data-ttu-id="07421-134"><<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement -->`System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`>: představuje element vazby, který určuje kódování znaků a správa verzí zpráv použít pro zprávu pomocí kódování zpráv přenosu optimalizace mechanismus (MTOM).</span><span class="sxs-lookup"><span data-stu-id="07421-134"><<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement --> `System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`>: Represents the binding element that specifies the character encoding and message versioning used for a message using a Message Transmission Optimization Mechanism (MTOM) encoding.</span></span> <span data-ttu-id="07421-135">MTOM je technologie efektivní přenosu zpráv binární data v [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] zprávy.</span><span class="sxs-lookup"><span data-stu-id="07421-135">MTOM is an efficient technology for transmitting binary data in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] messages.</span></span> <span data-ttu-id="07421-136">Kodér MTOM pokusí rovnováha mezi efektivitu a vzájemná funkční spolupráce.</span><span class="sxs-lookup"><span data-stu-id="07421-136">The MTOM encoder attempts to balance between efficiency and interoperability.</span></span> <span data-ttu-id="07421-137">Kódování MTOM přenáší většina XML v textové podobě, ale optimalizuje velkých bloků binárních dat tím, že je jako přenosu-je, bez převodu na text.</span><span class="sxs-lookup"><span data-stu-id="07421-137">The MTOM encoding transmits most XML in textual form, but optimizes large blocks of binary data by transmitting them as-is, without conversion to text.</span></span>  
  
 <span data-ttu-id="07421-138">Element vazby vytvoří binární, MTOM nebo text <xref:System.ServiceModel.Channels.MessageEncoderFactory>.</span><span class="sxs-lookup"><span data-stu-id="07421-138">The binding element creates a binary, MTOM, or text <xref:System.ServiceModel.Channels.MessageEncoderFactory>.</span></span> <span data-ttu-id="07421-139">Vytvoří objekt factory binární, MTOM nebo text <xref:System.ServiceModel.Channels.MessageEncoderFactory> instance.</span><span class="sxs-lookup"><span data-stu-id="07421-139">The factory creates a binary, MTOM, or text <xref:System.ServiceModel.Channels.MessageEncoderFactory> instance.</span></span> <span data-ttu-id="07421-140">Obvykle je pouze jedna instance.</span><span class="sxs-lookup"><span data-stu-id="07421-140">Typically, there is only a single instance.</span></span> <span data-ttu-id="07421-141">Ale pokud relací se používají, může poskytovat různé kodér každé relaci.</span><span class="sxs-lookup"><span data-stu-id="07421-141">However if sessions are used, a different encoder may be provided to each session.</span></span> <span data-ttu-id="07421-142">Binární kodér využívá tohoto ke koordinaci dynamické slovník (viz XML infrastruktury).</span><span class="sxs-lookup"><span data-stu-id="07421-142">The Binary encoder makes use of this to coordinate dynamic dictionaries (see XML Infrastructure).</span></span>  
  
 <span data-ttu-id="07421-143"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> a <xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> metody jsou jádrem kodérů.</span><span class="sxs-lookup"><span data-stu-id="07421-143">The <xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> and <xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> methods are the core of the encoders.</span></span> <span data-ttu-id="07421-144">Poskytují metody pro čtení zprávy z datového proudu nebo <xref:System.Byte> pole.</span><span class="sxs-lookup"><span data-stu-id="07421-144">The methods provide for reading a message from a stream or from a <xref:System.Byte> array.</span></span> <span data-ttu-id="07421-145">Bajtová pole se používají při přenosu pracuje v režimu vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="07421-145">Byte arrays are used when the transport is operating in buffered mode.</span></span> <span data-ttu-id="07421-146">Zprávy jsou vždy zapisovány do datových proudů.</span><span class="sxs-lookup"><span data-stu-id="07421-146">Messages are always written to streams.</span></span> <span data-ttu-id="07421-147">Pokud přenos musí vyrovnávací paměť zprávy, poskytuje datový proud, který nemá ukládání do vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="07421-147">If the transport must buffer the message, it provides a stream that does the buffering.</span></span>  
  
 <span data-ttu-id="07421-148">Zbývající členy, pracovat s typy médií obsahu, podpora, a <xref:System.ServiceModel.Channels.MessageEncoder.MessageVersion%2A>.</span><span class="sxs-lookup"><span data-stu-id="07421-148">The rest of the members work with support content, media types, and <xref:System.ServiceModel.Channels.MessageEncoder.MessageVersion%2A>.</span></span> <span data-ttu-id="07421-149">Přenos volá tyto metody kodér otestovat, zda lze příchozí zpráva dekódovat tímto nebo určit, zda je platná pro tento kodér odchozí zprávy.</span><span class="sxs-lookup"><span data-stu-id="07421-149">The transport calls these encoder methods to test whether the incoming message can be decoded by it, or to determine if the outgoing message is valid for this encoder.</span></span>  
  
 <span data-ttu-id="07421-150">Všechny tři implementace kodér přidá vlastnosti, které jsou relevantní pro konkrétní kódování a je plně konfigurovatelné.</span><span class="sxs-lookup"><span data-stu-id="07421-150">Each of the three encoder implementations adds properties that are relevant to the specific encodings and is fully configurable.</span></span> <span data-ttu-id="07421-151">Kodéry také vystavit čtečky kvóty, které mají výchozí nastavení zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="07421-151">The encoders also expose reader quotas that have secure defaults.</span></span> <span data-ttu-id="07421-152">V tématu XML infrastruktura diskuzi o kvóty.</span><span class="sxs-lookup"><span data-stu-id="07421-152">See XML Infrastructure for a discussion of the quotas.</span></span>  
  
## <a name="features-of-system-provided-encoders"></a><span data-ttu-id="07421-153">Funkce poskytované systémem kodéry</span><span class="sxs-lookup"><span data-stu-id="07421-153">Features of System-Provided Encoders</span></span>  
 <span data-ttu-id="07421-154">Existuje několik funkcí poskytovaných kodéry poskytované systémem.</span><span class="sxs-lookup"><span data-stu-id="07421-154">There are a number of features provided by the system-provided encoders.</span></span>  
  
### <a name="pooling"></a><span data-ttu-id="07421-155">Sdružování</span><span class="sxs-lookup"><span data-stu-id="07421-155">Pooling</span></span>  
 <span data-ttu-id="07421-156">Každý z implementace kodér pokusí fond co nejvíc.</span><span class="sxs-lookup"><span data-stu-id="07421-156">Each of the encoder implementations tries to pool as much as possible.</span></span> <span data-ttu-id="07421-157">Omezení přidělení je klíče způsob, jak zlepšit výkon spravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="07421-157">Reducing allocations is a key way to improve the performance of managed code.</span></span> <span data-ttu-id="07421-158">K provedení této sdružování, implementace použít `SynchronizedPool` třídy.</span><span class="sxs-lookup"><span data-stu-id="07421-158">To accomplish this pooling, the implementations use the `SynchronizedPool` class.</span></span> <span data-ttu-id="07421-159">Soubor C# obsahuje popis Další optimalizace použitou touto třídou.</span><span class="sxs-lookup"><span data-stu-id="07421-159">The C# file contains a description of the additional optimizations used by this class.</span></span>  
  
 <span data-ttu-id="07421-160">`XmlDictionaryReader`a `XmlDictionaryWriter` instance jsou ve fondu a znovu inicializován, aby se zabránilo přidělování nové pro každou zprávu.</span><span class="sxs-lookup"><span data-stu-id="07421-160">`XmlDictionaryReader` and `XmlDictionaryWriter` instances are pooled and reinitialized to prevent allocating new ones for each message.</span></span> <span data-ttu-id="07421-161">Pro čtečky `OnClose` zpětného volání získá čtečky při `Close()` je volána.</span><span class="sxs-lookup"><span data-stu-id="07421-161">For the readers, an `OnClose` callback reclaims the reader when `Close()` is called.</span></span> <span data-ttu-id="07421-162">Kodér recyklování také některé objekty stavu zpráv použitý při sestavování zprávy.</span><span class="sxs-lookup"><span data-stu-id="07421-162">The encoder also recycles some message state objects used when constructing messages.</span></span> <span data-ttu-id="07421-163">Velikosti tyto fondy se dají konfigurovat pomocí `MaxReadPoolSize` a `MaxWritePoolSize` vlastnosti na všech tří třídy odvozené od <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="07421-163">The sizes of these pools are configurable by the `MaxReadPoolSize` and `MaxWritePoolSize` properties on each of the three classes derived from <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>.</span></span>  
  
### <a name="binary-encoding"></a><span data-ttu-id="07421-164">Binární kódování</span><span class="sxs-lookup"><span data-stu-id="07421-164">Binary Encoding</span></span>  
 <span data-ttu-id="07421-165">Když binární kódování relace používá dynamický slovník řetězec musí sdělit k příjemce zprávy.</span><span class="sxs-lookup"><span data-stu-id="07421-165">When binary encoding uses sessions, the dynamic dictionary string must be communicated to the receiver of the message.</span></span> <span data-ttu-id="07421-166">To se provádí pomocí prefixu zprávu s řetězci dynamický slovník.</span><span class="sxs-lookup"><span data-stu-id="07421-166">This is done by prefixing the message with the dynamic dictionary strings.</span></span> <span data-ttu-id="07421-167">Příjemce odstraní vypnout řetězce, je přidá do relace a zprávu zpracuje.</span><span class="sxs-lookup"><span data-stu-id="07421-167">The receiver strips off the strings, adds them to the session, and processes the message.</span></span> <span data-ttu-id="07421-168">Správně předávání řetězce slovník vyžaduje, aby přenosu do vyrovnávací paměti.</span><span class="sxs-lookup"><span data-stu-id="07421-168">Correctly passing dictionary strings requires that the transport be buffered.</span></span>  
  
 <span data-ttu-id="07421-169">Řetězce se připojují ke zprávě pomocí interní `AddSessionInformationToMessage` metoda.</span><span class="sxs-lookup"><span data-stu-id="07421-169">The strings are appended to the message by an internal `AddSessionInformationToMessage` method.</span></span> <span data-ttu-id="07421-170">Přidá řetězce jako UTF-8 před předponu jejich délku zprávy.</span><span class="sxs-lookup"><span data-stu-id="07421-170">It adds the strings as UTF-8 to the front of the message prefixed with their length.</span></span> <span data-ttu-id="07421-171">Hlavička celý slovníku je pak předponu délka jeho data.</span><span class="sxs-lookup"><span data-stu-id="07421-171">The entire dictionary header is then prefixed with the length of its data.</span></span> <span data-ttu-id="07421-172">Operaci zpětné provádí interní `ExtractSessionInformationFromMessage` metoda.</span><span class="sxs-lookup"><span data-stu-id="07421-172">The reverse operation is performed by an internal `ExtractSessionInformationFromMessage` method.</span></span>  
  
 <span data-ttu-id="07421-173">Kromě zpracování dynamický slovník klíče, jsou přijaty ve vyrovnávací paměti relacemi zprávy jednoznačným způsobem.</span><span class="sxs-lookup"><span data-stu-id="07421-173">In addition to processing dynamic dictionary keys, buffered sessionful messages are received in a unique way.</span></span> <span data-ttu-id="07421-174">Místo vytváření čtečku přes dokument a její zpracování, binární kodér používá interní `MessagePatterns` třídy deconstruct binárního datového proudu.</span><span class="sxs-lookup"><span data-stu-id="07421-174">Instead of creating a reader over the document and processing it, the binary encoder uses the internal `MessagePatterns` class to deconstruct the binary stream.</span></span> <span data-ttu-id="07421-175">Na nápad je, že většina zprávy sadu hlaviček, které se zobrazí v určitém pořadí při generované [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="07421-175">The idea is that most messages have a certain set of headers that show up in a certain order when generated by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span></span> <span data-ttu-id="07421-176">Vzor systému dělí zprávu od sebe založenou na se očekává.</span><span class="sxs-lookup"><span data-stu-id="07421-176">The pattern system breaks the message apart based on what it expects.</span></span> <span data-ttu-id="07421-177">Pokud je úspěšné, inicializuje <xref:System.ServiceModel.Channels.MessageHeaders> objektu bez analýza kódu XML.</span><span class="sxs-lookup"><span data-stu-id="07421-177">If it is successful, it initializes a <xref:System.ServiceModel.Channels.MessageHeaders> object without parsing the XML.</span></span> <span data-ttu-id="07421-178">Pokud ne, spadne zpět na standardní metoda.</span><span class="sxs-lookup"><span data-stu-id="07421-178">If not, it falls back to the standard method.</span></span>  
  
### <a name="mtom-encoding"></a><span data-ttu-id="07421-179">Kódování MTOM</span><span class="sxs-lookup"><span data-stu-id="07421-179">MTOM Encoding</span></span>  
 <span data-ttu-id="07421-180"><<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement --> `System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`> Třída má další konfiguraci vlastnost s názvem <<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement --> `System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`. MaxBufferSize % 2A >.</span><span class="sxs-lookup"><span data-stu-id="07421-180">The <<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement --> `System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`> class has an additional configuration property called <<!--zz xref:System.ServiceModel.Channels.MTOMMessageEncodingBindingElement --> `System.ServiceModel.Channels.MTOMMessageEncodingBindingElement`.MaxBufferSize%2A>.</span></span> <span data-ttu-id="07421-181">Horní mez to umístí na kolik dat je povoleno vyrovnávací paměti při čtení zprávy.</span><span class="sxs-lookup"><span data-stu-id="07421-181">This places an upper bound on how much data it is allowed to buffer during the process of reading a message.</span></span> <span data-ttu-id="07421-182">XML informace sady (informační sadu), nebo dalšími částmi MIME chtít do vyrovnávací paměti sestavit všechny části standardu MIME do jedné zprávy.</span><span class="sxs-lookup"><span data-stu-id="07421-182">The XML Information Set (Infoset), or other MIME parts, may need to be buffered to reassemble all the MIME parts into a single message.</span></span>  
  
 <span data-ttu-id="07421-183">Fungovat správně s protokolem HTTP, interní třída kodér zpráv MTOM poskytuje některé interní rozhraní API pro `GetContentType` (což je také vnitřní) a `WriteMessage`, který je veřejný a je možné přepsat.</span><span class="sxs-lookup"><span data-stu-id="07421-183">To work correctly with HTTP, the internal MTOM message encoder class provides some internal APIs for `GetContentType` (which is also internal) and `WriteMessage`, which is public and can be overridden.</span></span> <span data-ttu-id="07421-184">Další komunikace, musí dojít k zajištění, že hodnoty v hlavičkách protokolu HTTP souhlas s hodnotami v hlavičkách MIME.</span><span class="sxs-lookup"><span data-stu-id="07421-184">More communication must occur to ensure values in the HTTP headers agree with values in the MIME headers.</span></span>  
  
 <span data-ttu-id="07421-185">Interně používá kodér zpráv MTOM [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]je čtečky textu a je podobná kodér textu.</span><span class="sxs-lookup"><span data-stu-id="07421-185">Internally, the MTOM message encoder uses [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]'s text readers, and is similar to the Text encoder.</span></span> <span data-ttu-id="07421-186">Hlavní rozdíl je, že optimalizuje velké skupiny binární, nebo "Binární rozsáhlé objekty" (BLOB), není převede na kódování Base-64 před jeho vkládání do bajtů zpráv.</span><span class="sxs-lookup"><span data-stu-id="07421-186">The main difference is that it optimizes large chunks of binary, or "Binary Large Objects" (BLOBs), by not converting them to Base-64 encoding prior to being embedded into the message bytes.</span></span> <span data-ttu-id="07421-187">Místo toho tyto objekty BLOB jsou uchovány extrahované a odkazované jako přílohy MIME.</span><span class="sxs-lookup"><span data-stu-id="07421-187">Instead, these BLOBs are kept extracted, and referenced as the MIME attachments.</span></span>  
  
## <a name="writing-your-own-encoder"></a><span data-ttu-id="07421-188">Zápis vlastní kodér</span><span class="sxs-lookup"><span data-stu-id="07421-188">Writing your own Encoder</span></span>  
 <span data-ttu-id="07421-189">Chcete-li implementovat vlastní vlastní kodér zpráv, je nutné zadat vlastní implementace následující abstraktní základní třídy:</span><span class="sxs-lookup"><span data-stu-id="07421-189">To implement your own custom message encoder, you must provide custom implementations of the following abstract base classes:</span></span>  
  
-   <xref:System.ServiceModel.Channels.MessageEncoder>  
  
-   <xref:System.ServiceModel.Channels.MessageEncoderFactory>  
  
-   <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>  
  
 <span data-ttu-id="07421-190">Převod z reprezentací v paměti zprávu k reprezentaci, s možností zápisu do datového proudu je zapouzdřený <xref:System.ServiceModel.Channels.MessageEncoder> třídy, která slouží jako objekt pro vytváření pro čtečky XML a zapisovače XML, které podporují konkrétní typy XML kódování.</span><span class="sxs-lookup"><span data-stu-id="07421-190">Converting from the in-memory representation of a message to a representation that can be written to a stream is encapsulated within the <xref:System.ServiceModel.Channels.MessageEncoder> class, which serves as a factory for XML readers and XML writers that support specific types of XML encodings.</span></span>  
  
-   <span data-ttu-id="07421-191">Klíče metody této třídy, které je nutné přepsat jsou následující:</span><span class="sxs-lookup"><span data-stu-id="07421-191">The key methods of this class that you must override are:</span></span>  
  
-   <span data-ttu-id="07421-192"><xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A>které trvá <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> objektu a zapíše ho do <xref:System.IO.Stream> objektu.</span><span class="sxs-lookup"><span data-stu-id="07421-192"><xref:System.ServiceModel.Channels.MessageEncoder.WriteMessage%2A> which takes a <xref:System.ServiceModel.Channels.MessageEncodingBindingElement> object and writes it into a <xref:System.IO.Stream> object.</span></span>  
  
-   <span data-ttu-id="07421-193"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A>které trvá <xref:System.IO.Stream> objekt a velikost maximální záhlaví a vrátí <xref:System.ServiceModel.Channels.Message> objektu.</span><span class="sxs-lookup"><span data-stu-id="07421-193"><xref:System.ServiceModel.Channels.MessageEncoder.ReadMessage%2A> which takes a <xref:System.IO.Stream> object and a maximum header size and returns a <xref:System.ServiceModel.Channels.Message> object.</span></span>  
  
 <span data-ttu-id="07421-194">Je kód napsaný v těchto metod, který zpracovává převod mezi standardní přenosový protokol a vlastní kódování.</span><span class="sxs-lookup"><span data-stu-id="07421-194">It is the code you write in these methods that handles conversion between the standard transport protocol, and your customized encoding.</span></span>  
  
 <span data-ttu-id="07421-195">Dále je třeba kód třídu objektů factory, který vytváří vlastní kodér.</span><span class="sxs-lookup"><span data-stu-id="07421-195">Next you need to code a factory class that creates your custom encoder.</span></span> <span data-ttu-id="07421-196">Přepsání <xref:System.ServiceModel.Channels.MessageEncoderFactory.Encoder%2A> vrátit instanci vaše vlastní <xref:System.ServiceModel.Channels.MessageEncoder>.</span><span class="sxs-lookup"><span data-stu-id="07421-196">Override the <xref:System.ServiceModel.Channels.MessageEncoderFactory.Encoder%2A> to return an instance of your custom <xref:System.ServiceModel.Channels.MessageEncoder>.</span></span>  
  
 <span data-ttu-id="07421-197">Připojte se vaše vlastní <xref:System.ServiceModel.Channels.MessageEncoderFactory> slouží ke konfiguraci služby nebo klienta přepsáním zásobníku element vazby <xref:System.ServiceModel.Channels.MessageEncodingBindingElement.CreateMessageEncoderFactory%2A> metoda vrátit instanci tohoto objektu pro vytváření.</span><span class="sxs-lookup"><span data-stu-id="07421-197">Then connect your custom <xref:System.ServiceModel.Channels.MessageEncoderFactory> to the binding element stack used to configure the service or client by overriding the <xref:System.ServiceModel.Channels.MessageEncodingBindingElement.CreateMessageEncoderFactory%2A> method to return an instance of this factory.</span></span>  
  
 <span data-ttu-id="07421-198">Jsou k dispozici dva vzorky součástí [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] které ilustrují tento proces se ukázkový kód: [vlastní kodér zpráv: vlastní kodér textu](../../../../docs/framework/wcf/samples/custom-message-encoder-custom-text-encoder.md) a [vlastní kodér zpráv: kompresní kodér](../../../../docs/framework/wcf/samples/custom-message-encoder-compression-encoder.md).</span><span class="sxs-lookup"><span data-stu-id="07421-198">There are two samples provided with [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] that illustrate this process with sample code: [Custom Message Encoder: Custom Text Encoder](../../../../docs/framework/wcf/samples/custom-message-encoder-custom-text-encoder.md) and [Custom Message Encoder: Compression Encoder](../../../../docs/framework/wcf/samples/custom-message-encoder-compression-encoder.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="07421-199">Viz také</span><span class="sxs-lookup"><span data-stu-id="07421-199">See Also</span></span>  
 <xref:System.ServiceModel.Channels.MessageEncodingBindingElement>  
 <xref:System.ServiceModel.Channels.MessageEncoderFactory>  
 <xref:System.ServiceModel.Channels.MessageEncoder>  
 [<span data-ttu-id="07421-200">Strukturální přehled přenosu dat</span><span class="sxs-lookup"><span data-stu-id="07421-200">Data Transfer Architectural Overview</span></span>](../../../../docs/framework/wcf/feature-details/data-transfer-architectural-overview.md)  
 [<span data-ttu-id="07421-201">Výběr kodéru zprávy</span><span class="sxs-lookup"><span data-stu-id="07421-201">Choosing a Message Encoder</span></span>](../../../../docs/framework/wcf/feature-details/choosing-a-message-encoder.md)  
 [<span data-ttu-id="07421-202">Volba přenosu</span><span class="sxs-lookup"><span data-stu-id="07421-202">Choosing a Transport</span></span>](../../../../docs/framework/wcf/feature-details/choosing-a-transport.md)
