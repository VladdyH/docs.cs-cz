---
title: Určování a zpracování chyb v kontraktech a službách
ms.date: 03/30/2017
helpviewer_keywords:
- handling faults [WCF]
ms.assetid: a9696563-d404-4905-942d-1e0834c26dea
ms.openlocfilehash: 93ebbf3410dc197982ca617b4e989d07f0e0b454
ms.sourcegitcommit: 15109844229ade1c6449f48f3834db1b26907824
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/07/2018
---
# <a name="specifying-and-handling-faults-in-contracts-and-services"></a><span data-ttu-id="f9296-102">Určování a zpracování chyb v kontraktech a službách</span><span class="sxs-lookup"><span data-stu-id="f9296-102">Specifying and Handling Faults in Contracts and Services</span></span>
<span data-ttu-id="f9296-103">Aplikace Windows Communication Foundation (WCF) zpracování chyby situacích mapování objektů spravovaných výjimek na protokolu SOAP selhání objekty a objekty chybu protokolu SOAP na objekty spravovaných výjimek.</span><span class="sxs-lookup"><span data-stu-id="f9296-103">Windows Communication Foundation (WCF) applications handle error situations by mapping managed exception objects to SOAP fault objects and SOAP fault objects to managed exception objects.</span></span> <span data-ttu-id="f9296-104">Témata v této části popisují postup návrhu kontrakty vystavit chyba podmínek jako vlastní chyb SOAP, jak vracet tyto chyby v rámci implementace služby a jak klienti catch takové chyby.</span><span class="sxs-lookup"><span data-stu-id="f9296-104">The topics in this section discuss how to design contracts to expose error conditions as custom SOAP faults, how to return such faults as part of service implementation, and how clients catch such faults.</span></span>  
  
## <a name="error-handling-overview"></a><span data-ttu-id="f9296-105">Přehled zpracování chyb</span><span class="sxs-lookup"><span data-stu-id="f9296-105">Error Handling Overview</span></span>  
 <span data-ttu-id="f9296-106">Ve všech spravovaných aplikací, jsou reprezentovány zpracování chyb <xref:System.Exception> objekty.</span><span class="sxs-lookup"><span data-stu-id="f9296-106">In all managed applications, processing errors are represented by <xref:System.Exception> objects.</span></span> <span data-ttu-id="f9296-107">V aplikacích založených na protokolu SOAP jako jsou například aplikace WCF metody služeb komunikovat pomocí protokolu SOAP zprávy selhání informace o chybě zpracování.</span><span class="sxs-lookup"><span data-stu-id="f9296-107">In SOAP-based applications such as WCF applications, service methods communicate processing error information using SOAP fault messages.</span></span> <span data-ttu-id="f9296-108">Chyb SOAP jsou typy zpráv, které jsou součástí metadat pro operace služby a proto vytvoření kontraktu selhání, který můžou klienti používat, aby jejich operaci více robustní nebo interaktivní.</span><span class="sxs-lookup"><span data-stu-id="f9296-108">SOAP faults are message types that are included in the metadata for a service operation and therefore create a fault contract that clients can use to make their operation more robust or interactive.</span></span> <span data-ttu-id="f9296-109">Kromě toho protože chyb SOAP jsou vyjádřeny klientům ve formátu XML, je vysoce interoperabilní typ systému, který můžou klienti na jakékoli platformě SOAP používat, zvýšení reach aplikace WCF.</span><span class="sxs-lookup"><span data-stu-id="f9296-109">In addition, because SOAP faults are expressed to clients in XML form, it is a highly interoperable type system that clients on any SOAP platform can use, increasing the reach of your WCF application.</span></span>  
  
 <span data-ttu-id="f9296-110">Vzhledem k tomu WCF aplikace běží pod oba typy systémů chyba, všechny spravované výjimka informace, které se může odeslat klientovi je nutné převést z výjimky do protokolu SOAP chyb ve službě, odeslané a převést z chyb SOAP na selhání výjimky v klienti WCF.</span><span class="sxs-lookup"><span data-stu-id="f9296-110">Because WCF applications run under both types of error systems, any managed exception information that is sent to the client must be converted from exceptions into SOAP faults on the service, sent, and converted from SOAP faults to fault exceptions in WCF clients.</span></span> <span data-ttu-id="f9296-111">V případě duplexní klientů můžete klienta kontrakty také odeslat chyb SOAP zpět do služby.</span><span class="sxs-lookup"><span data-stu-id="f9296-111">In the case of duplex clients, client contracts can also send SOAP faults back to a service.</span></span> <span data-ttu-id="f9296-112">V obou případech můžete použít výchozí chování výjimce služby, nebo můžete explicitně řídit zda – a jak – výjimky jsou namapované na chybové zprávy.</span><span class="sxs-lookup"><span data-stu-id="f9296-112">In either case, you can use the default service exception behaviors, or you can explicitly control whether—and how—exceptions are mapped to fault messages.</span></span>  
  
 <span data-ttu-id="f9296-113">Dva typy chyb SOAP mohou být odesílány: *deklarovaný* a *nedeklarované*.</span><span class="sxs-lookup"><span data-stu-id="f9296-113">Two types of SOAP faults can be sent: *declared* and *undeclared*.</span></span> <span data-ttu-id="f9296-114">Deklarovaný chyb SOAP jsou ty, ve kterých se operace <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> atribut, který určuje vlastní typ chybu protokolu SOAP.</span><span class="sxs-lookup"><span data-stu-id="f9296-114">Declared SOAP faults are those in which an operation has a <xref:System.ServiceModel.FaultContractAttribute?displayProperty=nameWithType> attribute that specifies a custom SOAP fault type.</span></span> <span data-ttu-id="f9296-115">*Nedeklarovaný* chyb SOAP nebyly zadány v kontraktu operace.</span><span class="sxs-lookup"><span data-stu-id="f9296-115">*Undeclared* SOAP faults are not specified in the contract for an operation.</span></span>  
  
 <span data-ttu-id="f9296-116">Důrazně doporučujeme, aby operací služby deklarace jejich chyb pomocí <xref:System.ServiceModel.FaultContractAttribute> atribut oficiálně zadat všechny SOAP chyb, které klient můžete očekávat při běžném průběhu operace.</span><span class="sxs-lookup"><span data-stu-id="f9296-116">It is strongly recommended that service operations declare their faults by using the <xref:System.ServiceModel.FaultContractAttribute> attribute to formally specify all SOAP faults that a client can expect to receive in the normal course of an operation.</span></span> <span data-ttu-id="f9296-117">Doporučujeme také, že vrátíte v rámci protokolu SOAP pouze informace, které klient musí vědět, chcete-li minimalizovat zpřístupnění informací.</span><span class="sxs-lookup"><span data-stu-id="f9296-117">It is also recommended that you return in a SOAP fault only the information that a client must know to minimize information disclosure.</span></span>  
  
 <span data-ttu-id="f9296-118">Obvykle služeb (a duplexní klientů) proveďte následující kroky úspěšně integrovat do svých aplikací pro zpracování chyb:</span><span class="sxs-lookup"><span data-stu-id="f9296-118">Typically, services (and duplex clients) take the following steps to successfully integrate error handling into their applications:</span></span>  
  
-   <span data-ttu-id="f9296-119">Mapování výjimky na vlastní chyb SOAP.</span><span class="sxs-lookup"><span data-stu-id="f9296-119">Map exception conditions to custom SOAP faults.</span></span>  
  
-   <span data-ttu-id="f9296-120">Služby a klienti odesílat a přijímat SOAP chyby jako výjimky.</span><span class="sxs-lookup"><span data-stu-id="f9296-120">Clients and services send and receive SOAP faults as exceptions.</span></span>  
  
 <span data-ttu-id="f9296-121">Kromě toho klienti WCF a služeb můžete použít chyb nedeklarované soap pro účely ladění a můžete rozšířit výchozí chování chyby.</span><span class="sxs-lookup"><span data-stu-id="f9296-121">In addition, WCF clients and services can use undeclared soap faults for debugging purposes and can extend the default error behavior.</span></span> <span data-ttu-id="f9296-122">Následující části popisují tyto úlohy a koncepty.</span><span class="sxs-lookup"><span data-stu-id="f9296-122">The following sections discuss these tasks and concepts.</span></span>  
  
## <a name="map-exceptions-to-soap-faults"></a><span data-ttu-id="f9296-123">Mapování výjimky na chyb SOAP</span><span class="sxs-lookup"><span data-stu-id="f9296-123">Map Exceptions to SOAP Faults</span></span>  
 <span data-ttu-id="f9296-124">Prvním krokem při vytváření operace, která zpracovává chybové stavy je rozhodnout, za jakých podmínek klientskou aplikaci informováni o chybách.</span><span class="sxs-lookup"><span data-stu-id="f9296-124">The first step in creating an operation that handles error conditions is to decide under what conditions a client application should be informed about errors.</span></span> <span data-ttu-id="f9296-125">Některé operace mít chybové stavy, které jsou specifické pro jejich funkce.</span><span class="sxs-lookup"><span data-stu-id="f9296-125">Some operations have error conditions specific to their functionality.</span></span> <span data-ttu-id="f9296-126">Například `PurchaseOrder` operace může vrátit konkrétní informace pro zákazníky, kteří jsou již povolen zahájíte nákupní objednávka.</span><span class="sxs-lookup"><span data-stu-id="f9296-126">For example, a `PurchaseOrder` operation might return specific information to customers who are no longer permitted to initiate a purchase order.</span></span> <span data-ttu-id="f9296-127">V ostatních případech, jako `Calculator` služby, další Obecné `MathFault` chybu protokolu SOAP, pravděpodobně bude moci popisují všechny chybové stavy v celé služby.</span><span class="sxs-lookup"><span data-stu-id="f9296-127">In other cases, such as a `Calculator` service, a more general `MathFault` SOAP fault may be able to describe all error conditions across an entire service.</span></span> <span data-ttu-id="f9296-128">Jakmile chybové stavy klientů služby jsou určeny, lze sestavit vlastní chybu protokolu SOAP a operace může být označen jako vrátí tuto chybu protokolu SOAP, když dojde k jeho odpovídající chybový stav.</span><span class="sxs-lookup"><span data-stu-id="f9296-128">Once the error conditions of clients of your service are identified, a custom SOAP fault can be constructed and the operation can be marked as returning that SOAP fault when its corresponding error condition arises.</span></span>  
  
 <span data-ttu-id="f9296-129">Další informace o tomto kroku vývoje služba nebo klienta najdete v tématu [definiční a určení chyb](../../../docs/framework/wcf/defining-and-specifying-faults.md).</span><span class="sxs-lookup"><span data-stu-id="f9296-129">For more information about this step of developing your service or client, see [Defining and Specifying Faults](../../../docs/framework/wcf/defining-and-specifying-faults.md).</span></span>  
  
## <a name="clients-and-services-handle-soap-faults-as-exceptions"></a><span data-ttu-id="f9296-130">Služby a klienti zpracování chyb SOAP jako výjimky</span><span class="sxs-lookup"><span data-stu-id="f9296-130">Clients and Services Handle SOAP Faults as Exceptions</span></span>  
 <span data-ttu-id="f9296-131">Identifikace operace chybové stavy, definování vlastních chyb protokolu SOAP a označení tyto operace jako vrácení těchto chyb v úspěšné zpracování chyb v aplikace WCF je první kroků.</span><span class="sxs-lookup"><span data-stu-id="f9296-131">Identifying operation error conditions, defining custom SOAP faults, and marking those operations as returning those faults are the first steps in successful error handling in WCF applications.</span></span> <span data-ttu-id="f9296-132">Dalším krokem je správně implementovat odesílání a příjem těchto chyb.</span><span class="sxs-lookup"><span data-stu-id="f9296-132">The next step is to properly implement the sending and receiving of these faults.</span></span> <span data-ttu-id="f9296-133">Obvykle služby posílat chyb, které informují klientské aplikace o chybové stavy ale duplexní klientů můžete také odeslat chyb SOAP služby.</span><span class="sxs-lookup"><span data-stu-id="f9296-133">Typically services send faults to inform client applications about error conditions, but duplex clients can also send SOAP faults to services.</span></span>  
  
 <span data-ttu-id="f9296-134">Další informace najdete v tématu [odesílání a přijímání chyb](../../../docs/framework/wcf/sending-and-receiving-faults.md).</span><span class="sxs-lookup"><span data-stu-id="f9296-134">For more information, see [Sending and Receiving Faults](../../../docs/framework/wcf/sending-and-receiving-faults.md).</span></span>  
  
## <a name="undeclared-soap-faults-and-debugging"></a><span data-ttu-id="f9296-135">Nedeklarovaný SOAP chyb a ladění</span><span class="sxs-lookup"><span data-stu-id="f9296-135">Undeclared SOAP Faults and Debugging</span></span>  
 <span data-ttu-id="f9296-136">Deklarované chyb SOAP jsou velmi užitečné pro vytváření robustní umožňuje vzájemnou spolupráci distribuovaných aplikací.</span><span class="sxs-lookup"><span data-stu-id="f9296-136">Declared SOAP faults are extremely useful for building robust, interoperable, distributed applications.</span></span> <span data-ttu-id="f9296-137">V některých případech je užitečné pro službu (nebo duplexní klienta) k odeslání nedeklarované chybu protokolu SOAP, ten, který není uveden v webové služby WSDL (Description Language) pro tuto operaci.</span><span class="sxs-lookup"><span data-stu-id="f9296-137">However, in some cases it is useful for a service (or duplex client) to send an undeclared SOAP fault, one that is not mentioned in the Web Services Description Language (WSDL) for that operation.</span></span> <span data-ttu-id="f9296-138">Například při vývoji služby, neočekávané situacích může dojít ve kterých je užitečný při ladění posílat informace zpět do klienta.</span><span class="sxs-lookup"><span data-stu-id="f9296-138">For example, when developing a service, unexpected situations can occur in which it is useful for debugging purposes to send information back to the client.</span></span> <span data-ttu-id="f9296-139">Kromě toho můžete nastavit <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> vlastnost nebo <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> vlastnost `true` tak, aby povolovala WCF klientům získat informace o interní služby operaci výjimky.</span><span class="sxs-lookup"><span data-stu-id="f9296-139">In addition, you can set the <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property or the <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property to `true` to permit WCF clients to obtain information about internal service operation exceptions.</span></span> <span data-ttu-id="f9296-140">Odesílání chyb jednotlivých i nastavení ladění chování vlastnosti jsou popsány v [odesílání a přijímání chyb](../../../docs/framework/wcf/sending-and-receiving-faults.md).</span><span class="sxs-lookup"><span data-stu-id="f9296-140">Both sending individual faults and setting the debugging behavior properties are described in [Sending and Receiving Faults](../../../docs/framework/wcf/sending-and-receiving-faults.md).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="f9296-141">Protože spravované výjimky mohou být informace o interní aplikace, nastavení <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> nebo <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> k `true` můžete povolit klientům WCF získat informace o operaci výjimky interní služby, včetně osobní osobní a dalších citlivých informací.</span><span class="sxs-lookup"><span data-stu-id="f9296-141">Because managed exceptions can expose internal application information, setting <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> or <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> to `true` can permit WCF clients to obtain information about internal service operation exceptions, including personally identifiable or other sensitive information.</span></span>  
>   
>  <span data-ttu-id="f9296-142">Proto nastavení <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> nebo <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> k `true` se doporučuje jenom jako způsob, jak dočasně ladění aplikace služby.</span><span class="sxs-lookup"><span data-stu-id="f9296-142">Therefore, setting <xref:System.ServiceModel.ServiceBehaviorAttribute.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> or <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> to `true` is recommended only as a way to temporarily debug a service application.</span></span> <span data-ttu-id="f9296-143">Kromě toho schématu WSDL pro metodu, která vrátí neošetřené se spravovanými výjimkami tímto způsobem neobsahuje kontrakt <xref:System.ServiceModel.FaultException%601> typu <xref:System.ServiceModel.ExceptionDetail>.</span><span class="sxs-lookup"><span data-stu-id="f9296-143">In addition, the WSDL for a method that returns unhandled managed exceptions in this way does not contain the contract for the <xref:System.ServiceModel.FaultException%601> of type <xref:System.ServiceModel.ExceptionDetail>.</span></span> <span data-ttu-id="f9296-144">Klienti měli očekávat možnost neznámé chybě protokolu SOAP (klientům WCF jako <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> objekty) získat informace o ladění správně.</span><span class="sxs-lookup"><span data-stu-id="f9296-144">Clients must expect the possibility of an unknown SOAP fault (returned to WCF clients as <xref:System.ServiceModel.FaultException?displayProperty=nameWithType> objects) to obtain the debugging information properly.</span></span>  
  
## <a name="customizing-error-handling-with-ierrorhandler"></a><span data-ttu-id="f9296-145">Přizpůsobení zpracování chyb pomocí IErrorHandler</span><span class="sxs-lookup"><span data-stu-id="f9296-145">Customizing Error Handling with IErrorHandler</span></span>  
 <span data-ttu-id="f9296-146">Pokud máte speciální požadavky, které chcete přizpůsobit zprávu odpovědi klientovi, když dojde k výjimce na úrovni aplikace nebo provést některé vlastní zpracování poté, co se vrátí zprávu odpovědi, implementovat <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="f9296-146">If you have special requirements to either customize the response message to the client when an application-level exception happens or perform some custom processing after the response message is returned, implement the <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> interface.</span></span>  
  
## <a name="fault-serialization-issues"></a><span data-ttu-id="f9296-147">Selhání serializace problémy</span><span class="sxs-lookup"><span data-stu-id="f9296-147">Fault Serialization Issues</span></span>  
 <span data-ttu-id="f9296-148">Při deserializaci chyba – kontrakt, nejprve pokusí najít název kontraktu chyby v protokolu SOAP zprávy s typem chyby kontraktu WCF.</span><span class="sxs-lookup"><span data-stu-id="f9296-148">When deserializing a fault contract, WCF first attempts to match the fault contract name in the SOAP message with the fault contract type.</span></span> <span data-ttu-id="f9296-149">Pokud nemůže najít přesnou shodu, které pak vyhledá seznam v abecedním pořadí pro kompatibilní typ smlouvy k dispozici selhání.</span><span class="sxs-lookup"><span data-stu-id="f9296-149">If it cannot find an exact match it will then search the list of available fault contracts in alphabetical order for a compatible type.</span></span> <span data-ttu-id="f9296-150">Pokud dva poruch kontrakty jsou kompatibilní typy (jeden je podtřídou třídy jiné, například) nesprávný typ lze deserializovat poruchy.</span><span class="sxs-lookup"><span data-stu-id="f9296-150">If two fault contracts are compatible types (one is a subclass of another, for example) the wrong type may be used to de-serialize the fault.</span></span> <span data-ttu-id="f9296-151">Pouze k tomu dojde, pokud chyba – kontrakt neurčuje název, obor názvů a akce.</span><span class="sxs-lookup"><span data-stu-id="f9296-151">This only occurs if the fault contract does not specify a name, namespace, and action.</span></span> <span data-ttu-id="f9296-152">Chcete-li zabránit výskytu tohoto problému, vždy plnému určení selhání kontrakty zadáním jména, obor názvů a atributů akce.</span><span class="sxs-lookup"><span data-stu-id="f9296-152">To prevent this issue from occurring, always fully qualify fault contracts by specifying the name, namespace, and action attributes.</span></span> <span data-ttu-id="f9296-153">Kromě toho pokud jste definovali počet odvozování od třídy sdílené základní kontrakty související chyby, je třeba označit žádné nové členy s `[DataMember(IsRequired=true)]`.</span><span class="sxs-lookup"><span data-stu-id="f9296-153">Additionally if you have defined a number of related fault contracts derived from a shared base class, make sure to mark any new members with `[DataMember(IsRequired=true)]`.</span></span> <span data-ttu-id="f9296-154">Další informace v tomto `IsRequired` najdete atribut <xref:System.Runtime.Serialization.DataMemberAttribute>.</span><span class="sxs-lookup"><span data-stu-id="f9296-154">For more information on this `IsRequired` attribute see, <xref:System.Runtime.Serialization.DataMemberAttribute>.</span></span> <span data-ttu-id="f9296-155">To zabrání základní třídu nebudou kompatibilní typ a vynutit selhání rekonstrukce do správné odvozený typ.</span><span class="sxs-lookup"><span data-stu-id="f9296-155">This will prevent a base class from being a compatible type and force the fault to be deserialized into the correct derived type.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f9296-156">Viz také</span><span class="sxs-lookup"><span data-stu-id="f9296-156">See Also</span></span>  
 <xref:System.ServiceModel.FaultException>  
 <xref:System.ServiceModel.FaultContractAttribute>  
 <xref:System.ServiceModel.FaultException>  
 <xref:System.Xml.Serialization.XmlSerializer>  
 <xref:System.ServiceModel.XmlSerializerFormatAttribute>  
 <xref:System.ServiceModel.FaultContractAttribute>  
 <xref:System.ServiceModel.CommunicationException>  
 <xref:System.ServiceModel.FaultContractAttribute.Action%2A>  
 <xref:System.ServiceModel.FaultException.Code%2A>  
 <xref:System.ServiceModel.FaultException.Reason%2A>  
 <xref:System.ServiceModel.FaultCode.SubCode%2A>  
 <xref:System.ServiceModel.OperationContractAttribute.IsOneWay%2A>  
 [<span data-ttu-id="f9296-157">Definice a určení chyb</span><span class="sxs-lookup"><span data-stu-id="f9296-157">Defining and Specifying Faults</span></span>](../../../docs/framework/wcf/defining-and-specifying-faults.md)
