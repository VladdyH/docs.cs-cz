---
title: Přehled profilace
ms.date: 03/30/2017
helpviewer_keywords:
- managed code, profiling API support
- unmanaged code, combining with managed code in profiling
- notification threads [.NET Framework profiling]
- unmanaged code, profiling
- profiling API [.NET Framework], and COM
- profiling API [.NET Framework], unmanaged code profiling
- profilers, writing
- profiling API [.NET Framework], call stacks
- code profilers, writing
- profiling API [.NET Framework], security considerations
- profiling API [.NET Framework], managed code support
- common language runtime, profiling
- profiling API [.NET Framework], notification threads
- call stacks [.NET Framework profiling]
- profiling API [.NET Framework], stack depth
- common language runtime, writing a profiler
- profiling API [.NET Framework], information retrieval interfaces
- shadow stacks [.NET Framework profiling]
- COM, using in the profiling API
- stack snapshots [.NET Framework profiling]
- profiling API [.NET Framework], supported features
- profiling API [.NET Framework], overview
- security, profiling API considerations
- stack depth [.NET Framework profiling]
ms.assetid: 864c2344-71dc-46f9-96b2-ed59fb6427a8
author: mairaw
ms.author: mairaw
ms.openlocfilehash: b38b64e1c86174bea11086e722ed86b0a0046e2c
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/04/2018
ms.locfileid: "33461910"
---
# <a name="profiling-overview"></a><span data-ttu-id="300ac-102">Přehled profilace</span><span class="sxs-lookup"><span data-stu-id="300ac-102">Profiling Overview</span></span>
<a name="top"></a> <span data-ttu-id="300ac-103">Profileru je nástroj, který monitoruje provádění jiná aplikace.</span><span class="sxs-lookup"><span data-stu-id="300ac-103">A profiler is a tool that monitors the execution of another application.</span></span> <span data-ttu-id="300ac-104">Běžné profileru language runtime (CLR) je dynamická knihovna (DLL), která se skládá z funkcí, které příjem zpráv z a odeslání zpráv do modulu CLR pomocí rozhraní API pro profilaci.</span><span class="sxs-lookup"><span data-stu-id="300ac-104">A common language runtime (CLR) profiler is a dynamic link library (DLL) that consists of functions that receive messages from, and send messages to, the CLR by using the profiling API.</span></span> <span data-ttu-id="300ac-105">Profileru knihovnu DLL modulu CLR zavedená v době běhu.</span><span class="sxs-lookup"><span data-stu-id="300ac-105">The profiler DLL is loaded by the CLR at run time.</span></span>  
  
 <span data-ttu-id="300ac-106">Tradiční nástroje pro profilaci zaměřit se na měření spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="300ac-106">Traditional profiling tools focus on measuring the execution of the application.</span></span> <span data-ttu-id="300ac-107">To znamená že měření času stráveného v každé funkce nebo využití paměti aplikace v průběhu času.</span><span class="sxs-lookup"><span data-stu-id="300ac-107">That is, they measure the time that is spent in each function or the memory usage of the application over time.</span></span> <span data-ttu-id="300ac-108">Profilace API cílí širší třídu diagnostických nástrojů, jako jsou nástroje pro pokrytí kódu a i rozšířené ladění pomůcky.</span><span class="sxs-lookup"><span data-stu-id="300ac-108">The profiling API targets a broader class of diagnostic tools such as code-coverage utilities and even advanced debugging aids.</span></span> <span data-ttu-id="300ac-109">Tato použití jsou všechny diagnostiky ve své podstatě.</span><span class="sxs-lookup"><span data-stu-id="300ac-109">These uses are all diagnostic in nature.</span></span> <span data-ttu-id="300ac-110">Profilace API nejen měří, ale také monitoruje spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="300ac-110">The profiling API not only measures but also monitors the execution of an application.</span></span> <span data-ttu-id="300ac-111">Z tohoto důvodu profilaci API by nikdy používat vlastní aplikace a spuštění aplikace by neměl závisí na (nebo mít vliv) profileru.</span><span class="sxs-lookup"><span data-stu-id="300ac-111">For this reason, the profiling API should never be used by the application itself, and the application’s execution should not depend on (or be affected by) the profiler.</span></span>  
  
 <span data-ttu-id="300ac-112">Profilace aplikace CLR vyžaduje další podporu než profilace obvykle zkompilovaný kód počítače.</span><span class="sxs-lookup"><span data-stu-id="300ac-112">Profiling a CLR application requires more support than profiling conventionally compiled machine code.</span></span> <span data-ttu-id="300ac-113">Důvodem je, že modulu CLR seznámíte se základními pojmy, jako je aplikační domény, uvolňování paměti, spravované zpracování výjimek v běhu (JIT) kompilace kódu (Převod Microsoft převodní jazyk nebo MSIL kódu do nativního kódu počítače) a podobných funkce.</span><span class="sxs-lookup"><span data-stu-id="300ac-113">This is because the CLR introduces concepts such as application domains, garbage collection, managed exception handling, just-in-time (JIT) compilation of code (converting Microsoft intermediate language, or MSIL, code into native machine code), and similar features.</span></span> <span data-ttu-id="300ac-114">Konvenční profilování mechanismy nelze identifikovat nebo poskytují užitečné informace o těchto funkcích.</span><span class="sxs-lookup"><span data-stu-id="300ac-114">Conventional profiling mechanisms cannot identify or provide useful information about these features.</span></span> <span data-ttu-id="300ac-115">Profilace API poskytuje tyto chybějící informace efektivně minimální vliv na výkon modulu CLR a PROFILOVANÉHO aplikace.</span><span class="sxs-lookup"><span data-stu-id="300ac-115">The profiling API provides this missing information efficiently, with minimal effect on the performance of the CLR and the profiled application.</span></span>  
  
 <span data-ttu-id="300ac-116">JIT – kompilace v době běhu poskytuje dobrý příležitosti pro profilace.</span><span class="sxs-lookup"><span data-stu-id="300ac-116">JIT compilation at run time provides good opportunities for profiling.</span></span> <span data-ttu-id="300ac-117">Profilace API umožňuje profileru změnit datový proud MSIL kód v paměti pro rutinu, která předtím, než je kompilována.</span><span class="sxs-lookup"><span data-stu-id="300ac-117">The profiling API enables a profiler to change the in-memory MSIL code stream for a routine before it is JIT-compiled.</span></span> <span data-ttu-id="300ac-118">Tímto způsobem můžete profileru dynamicky přidat kód instrumentace na konkrétní rutiny, které je třeba hlubší rozbor.</span><span class="sxs-lookup"><span data-stu-id="300ac-118">In this manner, the profiler can dynamically add instrumentation code to particular routines that need deeper investigation.</span></span> <span data-ttu-id="300ac-119">I když tento přístup je možné v běžné scénáře, je mnohem snazší implementací pro modulu CLR pomocí rozhraní API pro profilaci.</span><span class="sxs-lookup"><span data-stu-id="300ac-119">Although this approach is possible in conventional scenarios, it is much easier to implement for the CLR by using the profiling API.</span></span>  
  
 <span data-ttu-id="300ac-120">Tento přehled se skládá z následujících částí:</span><span class="sxs-lookup"><span data-stu-id="300ac-120">This overview consists of the following sections:</span></span>  
  
-   [<span data-ttu-id="300ac-121">Rozhraní API pro profilaci</span><span class="sxs-lookup"><span data-stu-id="300ac-121">The Profiling API</span></span>](#profiling_api)  
  
-   [<span data-ttu-id="300ac-122">Podporované funkce</span><span class="sxs-lookup"><span data-stu-id="300ac-122">Supported Features</span></span>](#support)  
  
-   [<span data-ttu-id="300ac-123">Vlákna oznámení</span><span class="sxs-lookup"><span data-stu-id="300ac-123">Notification Threads</span></span>](#notification_threads)  
  
-   [<span data-ttu-id="300ac-124">Zabezpečení</span><span class="sxs-lookup"><span data-stu-id="300ac-124">Security</span></span>](#security)  
  
-   [<span data-ttu-id="300ac-125">Kombinování spravovaných a nespravovaných kód v kódu profileru</span><span class="sxs-lookup"><span data-stu-id="300ac-125">Combining Managed and Unmanaged Code in a Code Profiler</span></span>](#combining_managed_unmanaged)  
  
-   [<span data-ttu-id="300ac-126">Profilace nespravovaného kódu</span><span class="sxs-lookup"><span data-stu-id="300ac-126">Profiling Unmanaged Code</span></span>](#unmanaged)  
  
-   [<span data-ttu-id="300ac-127">Pomocí modelu COM</span><span class="sxs-lookup"><span data-stu-id="300ac-127">Using COM</span></span>](#com)  
  
-   [<span data-ttu-id="300ac-128">Zásobníky volání</span><span class="sxs-lookup"><span data-stu-id="300ac-128">Call stacks</span></span>](#call_stacks)  
  
-   [<span data-ttu-id="300ac-129">Zpětná volání a hloubka zásobníku</span><span class="sxs-lookup"><span data-stu-id="300ac-129">Callbacks and Stack Depth</span></span>](#callbacks)  
  
-   [<span data-ttu-id="300ac-130">Související témata</span><span class="sxs-lookup"><span data-stu-id="300ac-130">Related Topics</span></span>](#related_topics)  
  
<a name="profiling_api"></a>   
## <a name="the-profiling-api"></a><span data-ttu-id="300ac-131">Rozhraní API pro profilaci</span><span class="sxs-lookup"><span data-stu-id="300ac-131">The Profiling API</span></span>  
 <span data-ttu-id="300ac-132">Obvykle profilaci API slouží k zápisu *code profileru*, což je program, který monitoruje spuštění spravované aplikace.</span><span class="sxs-lookup"><span data-stu-id="300ac-132">Typically, the profiling API is used to write a *code profiler*, which is a program that monitors the execution of a managed application.</span></span>  
  
 <span data-ttu-id="300ac-133">Profilace API používá profileru knihovny DLL, který je načten do stejně jako aplikace, která je profilovaný.</span><span class="sxs-lookup"><span data-stu-id="300ac-133">The profiling API is used by a profiler DLL, which is loaded into the same process as the application that is being profiled.</span></span> <span data-ttu-id="300ac-134">Profileru DLL implementuje rozhraní pro zpětné volání ([icorprofilercallback –](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) v rozhraní .NET Framework verze 1.0 a 1.1, [icorprofilercallback2 –](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) ve verzi 2.0 nebo novější).</span><span class="sxs-lookup"><span data-stu-id="300ac-134">The profiler DLL implements a callback interface ([ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) in the .NET Framework version 1.0 and 1.1, [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) in version 2.0 and later).</span></span> <span data-ttu-id="300ac-135">Modul CLR volá metody v tomto rozhraní oznámit profileru událostí v PROFILOVANÉHO procesu.</span><span class="sxs-lookup"><span data-stu-id="300ac-135">The CLR calls the methods in that interface to notify the profiler of events in the profiled process.</span></span> <span data-ttu-id="300ac-136">Profileru můžete volat zpět do modulu runtime podle pomocí metody v [icorprofilerinfo –](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) a [ICorProfilerInfo2 –](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md) rozhraní, které se získat informace o stavu PROFILOVANÉHO aplikace.</span><span class="sxs-lookup"><span data-stu-id="300ac-136">The profiler can call back into the runtime by using the methods in the [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) and [ICorProfilerInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md) interfaces to obtain information about the state of the profiled application.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="300ac-137">Jenom tu část shromažďování dat profileru řešení by měl být spuštěn v rámci jednoho procesu jako PROFILOVANÉHO aplikace.</span><span class="sxs-lookup"><span data-stu-id="300ac-137">Only the data-gathering part of the profiler solution should be running in the same process as the profiled application.</span></span> <span data-ttu-id="300ac-138">Všechny uživatelské rozhraní a data se analyzují jako samostatný proces.</span><span class="sxs-lookup"><span data-stu-id="300ac-138">All user interface and data analysis should be performed in a separate process.</span></span>  
  
 <span data-ttu-id="300ac-139">Následující obrázek znázorňuje interakci profileru DLL se aplikace, která je profilovaný a modulu CLR.</span><span class="sxs-lookup"><span data-stu-id="300ac-139">The following illustration shows how the profiler DLL interacts with the application that is being profiled and the CLR.</span></span>  
  
 <span data-ttu-id="300ac-140">![Profilace architektura](../../../../docs/framework/unmanaged-api/profiling/media/profilingarch.png "ProfilingArch")</span><span class="sxs-lookup"><span data-stu-id="300ac-140">![Profiling Architecture](../../../../docs/framework/unmanaged-api/profiling/media/profilingarch.png "ProfilingArch")</span></span>  
<span data-ttu-id="300ac-141">Architektura profilace</span><span class="sxs-lookup"><span data-stu-id="300ac-141">Profiling architecture</span></span>  
  
### <a name="the-notification-interfaces"></a><span data-ttu-id="300ac-142">Rozhraní oznámení</span><span class="sxs-lookup"><span data-stu-id="300ac-142">The Notification Interfaces</span></span>  
 <span data-ttu-id="300ac-143">[Icorprofilercallback –](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) a [icorprofilercallback2 –](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) lze považovat za rozhraní oznámení.</span><span class="sxs-lookup"><span data-stu-id="300ac-143">[ICorProfilerCallback](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-interface.md) and [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) can be considered notification interfaces.</span></span> <span data-ttu-id="300ac-144">Tato rozhraní se skládají z metod, jako [classloadstarted –](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadstarted-method.md), [classloadfinished –](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadfinished-method.md), a [jitcompilationstarted –](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md).</span><span class="sxs-lookup"><span data-stu-id="300ac-144">These interfaces consist of methods such as [ClassLoadStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadstarted-method.md), [ClassLoadFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-classloadfinished-method.md), and [JITCompilationStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md).</span></span> <span data-ttu-id="300ac-145">Pokaždé, když načtení modulu CLR nebo opuštění třídu, zkompiluje funkce, a atd., volá metodu odpovídající v okna profilování `ICorProfilerCallback` nebo `ICorProfilerCallback2` rozhraní.</span><span class="sxs-lookup"><span data-stu-id="300ac-145">Each time the CLR loads or unloads a class, compiles a function, and so on, it calls the corresponding method in the profiler's `ICorProfilerCallback` or `ICorProfilerCallback2` interface.</span></span>  
  
 <span data-ttu-id="300ac-146">Například může profileru měření výkonu kód prostřednictvím dvě funkce oznámení: [functionenter2 –](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) a [functionleave2 –](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md).</span><span class="sxs-lookup"><span data-stu-id="300ac-146">For example, a profiler could measure code performance through two notification functions: [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) and [FunctionLeave2](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md).</span></span> <span data-ttu-id="300ac-147">Ji jenom časová razítka každého oznámení shromažďuje výsledky a vypíše seznam, která určuje, které funkce použít nejvíce procesoru nebo wall hodiny času při spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="300ac-147">It just time-stamps each notification, accumulates results, and outputs a list that indicates which functions consumed the most CPU or wall-clock time during the execution of the application.</span></span>  
  
### <a name="the-information-retrieval-interfaces"></a><span data-ttu-id="300ac-148">Načítání informací o rozhraní</span><span class="sxs-lookup"><span data-stu-id="300ac-148">The Information Retrieval Interfaces</span></span>  
 <span data-ttu-id="300ac-149">Další zahrnutých v profilaci hlavní rozhraní jsou [icorprofilerinfo –](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) a [ICorProfilerInfo2 –](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md).</span><span class="sxs-lookup"><span data-stu-id="300ac-149">The other main interfaces involved in profiling are [ICorProfilerInfo](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-interface.md) and [ICorProfilerInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-interface.md).</span></span> <span data-ttu-id="300ac-150">Profileru zavolá tato rozhraní podle potřeby získat další informace, které pomohou jeho analýzu.</span><span class="sxs-lookup"><span data-stu-id="300ac-150">The profiler calls these interfaces as required to obtain more information to help its analysis.</span></span> <span data-ttu-id="300ac-151">Vždy, když modul CLR například volá [functionenter2 –](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) funkce, poskytne identifikátor funkce.</span><span class="sxs-lookup"><span data-stu-id="300ac-151">For example, whenever the CLR calls the [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md) function, it supplies a function identifier.</span></span> <span data-ttu-id="300ac-152">Profileru můžete získat další informace o této funkci voláním [ICorProfilerInfo2::getfunctioninfo2 –](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctioninfo2-method.md) metoda zjišťování funkce nadřazené třídy, jeho název a tak dále.</span><span class="sxs-lookup"><span data-stu-id="300ac-152">The profiler can get more information about that function by calling the [ICorProfilerInfo2::GetFunctionInfo2](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-getfunctioninfo2-method.md) method to discover the function's parent class, its name, and so on.</span></span>  
  
 [<span data-ttu-id="300ac-153">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="300ac-153">Back to top</span></span>](#top)  
  
<a name="support"></a>   
## <a name="supported-features"></a><span data-ttu-id="300ac-154">Podporované funkce</span><span class="sxs-lookup"><span data-stu-id="300ac-154">Supported Features</span></span>  
 <span data-ttu-id="300ac-155">Profilace API poskytuje informace o různých události a akce, ke kterým došlo v modulu CLR.</span><span class="sxs-lookup"><span data-stu-id="300ac-155">The profiling API provides information about a variety of events and actions that occur in the common language runtime.</span></span> <span data-ttu-id="300ac-156">Tyto informace můžete použít ke sledování vnitřního chodu procesy a analýza výkonu aplikace .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="300ac-156">You can use this information to monitor the inner workings of processes and to analyze the performance of your .NET Framework application.</span></span>  
  
 <span data-ttu-id="300ac-157">Profilace API načte informace o následující akce a události, ke kterým došlo v modulu CLR:</span><span class="sxs-lookup"><span data-stu-id="300ac-157">The profiling API retrieves information about the following actions and events that occur in the CLR:</span></span>  
  
-   <span data-ttu-id="300ac-158">Události spuštění a vypnutí CLR.</span><span class="sxs-lookup"><span data-stu-id="300ac-158">CLR startup and shutdown events.</span></span>  
  
-   <span data-ttu-id="300ac-159">Vytváření a vypnutí události serveru aplikace domény.</span><span class="sxs-lookup"><span data-stu-id="300ac-159">Application domain creation and shutdown events.</span></span>  
  
-   <span data-ttu-id="300ac-160">Sestavení načítání a uvolňování události.</span><span class="sxs-lookup"><span data-stu-id="300ac-160">Assembly loading and unloading events.</span></span>  
  
-   <span data-ttu-id="300ac-161">Modul načítání a uvolňování události.</span><span class="sxs-lookup"><span data-stu-id="300ac-161">Module loading and unloading events.</span></span>  
  
-   <span data-ttu-id="300ac-162">Vytváření a likvidace události serveru COM vtable.</span><span class="sxs-lookup"><span data-stu-id="300ac-162">COM vtable creation and destruction events.</span></span>  
  
-   <span data-ttu-id="300ac-163">V běhu (JIT) kompilace a kód pitching události.</span><span class="sxs-lookup"><span data-stu-id="300ac-163">Just-in-time (JIT) compilation and code-pitching events.</span></span>  
  
-   <span data-ttu-id="300ac-164">Třídy událostí načtení a odinstalování.</span><span class="sxs-lookup"><span data-stu-id="300ac-164">Class loading and unloading events.</span></span>  
  
-   <span data-ttu-id="300ac-165">Vytváření a likvidace události vláken.</span><span class="sxs-lookup"><span data-stu-id="300ac-165">Thread creation and destruction events.</span></span>  
  
-   <span data-ttu-id="300ac-166">Funkce vstupní a výstupní události.</span><span class="sxs-lookup"><span data-stu-id="300ac-166">Function entry and exit events.</span></span>  
  
-   <span data-ttu-id="300ac-167">Výjimky.</span><span class="sxs-lookup"><span data-stu-id="300ac-167">Exceptions.</span></span>  
  
-   <span data-ttu-id="300ac-168">Přechodů mezi spravovanými a nespravovanými kód provádění.</span><span class="sxs-lookup"><span data-stu-id="300ac-168">Transitions between managed and unmanaged code execution.</span></span>  
  
-   <span data-ttu-id="300ac-169">Přechodů mezi kontexty jiný modul runtime.</span><span class="sxs-lookup"><span data-stu-id="300ac-169">Transitions between different runtime contexts.</span></span>  
  
-   <span data-ttu-id="300ac-170">Informace o pozastavení modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="300ac-170">Information about runtime suspensions.</span></span>  
  
-   <span data-ttu-id="300ac-171">Informace o modulu runtime paměti haldy a uvolňování paměti kolekce aktivity.</span><span class="sxs-lookup"><span data-stu-id="300ac-171">Information about the runtime memory heap and garbage collection activity.</span></span>  
  
 <span data-ttu-id="300ac-172">Profilaci API je možné volat z jakéhokoli jazyka kompatibilní COM (nespravované).</span><span class="sxs-lookup"><span data-stu-id="300ac-172">The profiling API can be called from any (non-managed) COM-compatible language.</span></span>  
  
 <span data-ttu-id="300ac-173">Rozhraní API je efektivní s ohledem na spotřeby procesoru a paměti.</span><span class="sxs-lookup"><span data-stu-id="300ac-173">The API is efficient with regard to CPU and memory consumption.</span></span> <span data-ttu-id="300ac-174">Profilace nezahrnuje změny PROFILOVANÉHO aplikace, které důležité, aby zavádějící výsledky.</span><span class="sxs-lookup"><span data-stu-id="300ac-174">Profiling does not involve changes to the profiled application that are significant enough to cause misleading results.</span></span>  
  
 <span data-ttu-id="300ac-175">Profilace API je užitečné profilery vzorkování i bez vzorkování.</span><span class="sxs-lookup"><span data-stu-id="300ac-175">The profiling API is useful to both sampling and non-sampling profilers.</span></span> <span data-ttu-id="300ac-176">A *vzorkování profileru* zkontroluje profilu v pravidelných počtu taktů Řekněme, na 5 milisekund od sebe.</span><span class="sxs-lookup"><span data-stu-id="300ac-176">A *sampling profiler* inspects the profile at regular clock ticks, say, at 5 milliseconds apart.</span></span> <span data-ttu-id="300ac-177">A *bez vzorkování profileru* informován o událost synchronně vlákno, které způsobí, že událost.</span><span class="sxs-lookup"><span data-stu-id="300ac-177">A *non-sampling profiler* is informed of an event synchronously with the thread that causes the event.</span></span>  
  
### <a name="unsupported-functionality"></a><span data-ttu-id="300ac-178">Nepodporované funkce</span><span class="sxs-lookup"><span data-stu-id="300ac-178">Unsupported Functionality</span></span>  
 <span data-ttu-id="300ac-179">Profilace API nepodporuje následující funkce:</span><span class="sxs-lookup"><span data-stu-id="300ac-179">The profiling API does not support the following functionality:</span></span>  
  
-   <span data-ttu-id="300ac-180">Nespravovaný kód, který musí být profilovaným konvenční metodami Win32.</span><span class="sxs-lookup"><span data-stu-id="300ac-180">Unmanaged code, which must be profiled using conventional Win32 methods.</span></span> <span data-ttu-id="300ac-181">Profileru CLR však obsahuje přechod událostí k určení hranice mezi spravovanými a nespravovanými kódu.</span><span class="sxs-lookup"><span data-stu-id="300ac-181">However, the CLR profiler includes transition events to determine the boundaries between managed and unmanaged code.</span></span>  
  
-   <span data-ttu-id="300ac-182">Samoobslužné úpravy aplikací, které upravit vlastní kód pro účely, například aspekt orientované programování.</span><span class="sxs-lookup"><span data-stu-id="300ac-182">Self-modifying applications that modify their own code for purposes such as aspect-oriented programming.</span></span>  
  
-   <span data-ttu-id="300ac-183">Rozsah kontroly, protože profilaci API neposkytuje tyto informace.</span><span class="sxs-lookup"><span data-stu-id="300ac-183">Bounds checking, because the profiling API does not provide this information.</span></span> <span data-ttu-id="300ac-184">Modul CLR poskytuje vnitřní podporu pro rozsah kontroluje všechny spravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="300ac-184">The CLR provides intrinsic support for bounds checking of all managed code.</span></span>  
  
-   <span data-ttu-id="300ac-185">Vzdálené profilování, což není podporováno z následujících důvodů:</span><span class="sxs-lookup"><span data-stu-id="300ac-185">Remote profiling, which is not supported for the following reasons:</span></span>  
  
    -   <span data-ttu-id="300ac-186">Čas spuštění vzdáleného profilování rozšiřuje.</span><span class="sxs-lookup"><span data-stu-id="300ac-186">Remote profiling extends execution time.</span></span> <span data-ttu-id="300ac-187">Při použití rozhraní profilace musí se tak, aby profilace výsledky nebude mít vliv neoprávněně minimalizovat dobu provádění.</span><span class="sxs-lookup"><span data-stu-id="300ac-187">When you use the profiling interfaces, you must minimize execution time so that profiling results will not be unduly affected.</span></span> <span data-ttu-id="300ac-188">To platí hlavně při provádění výkonu je monitorována.</span><span class="sxs-lookup"><span data-stu-id="300ac-188">This is especially true when execution performance is being monitored.</span></span> <span data-ttu-id="300ac-189">Ale vzdálené profilování není omezení při profilování rozhraní se používají k monitorování využití paměti, nebo se získat informace o běhu o rámce zásobníku, objekty a tak dále.</span><span class="sxs-lookup"><span data-stu-id="300ac-189">However, remote profiling is not a limitation when the profiling interfaces are used to monitor memory usage or to obtain run-time information about stack frames, objects, and so on.</span></span>  
  
    -   <span data-ttu-id="300ac-190">Kód profileru CLR musí zaregistrovat jedno nebo více rozhraní zpětné volání s modulem runtime v místním počítači, na kterém je spuštěný PROFILOVANÉHO aplikace.</span><span class="sxs-lookup"><span data-stu-id="300ac-190">The CLR code profiler must register one or more callback interfaces with the runtime on the local computer on which the profiled application is running.</span></span> <span data-ttu-id="300ac-191">Toto nastavení omezuje schopnost vytvářet profileru vzdáleného kódu.</span><span class="sxs-lookup"><span data-stu-id="300ac-191">This limits the ability to create a remote code profiler.</span></span>  
  
-   <span data-ttu-id="300ac-192">Profilace v produkčním prostředí s vysokou dostupností požadavky.</span><span class="sxs-lookup"><span data-stu-id="300ac-192">Profiling in production environments with high-availability requirements.</span></span> <span data-ttu-id="300ac-193">Profilace API byl vytvořen pro podporu vývoj čas diagnostiky.</span><span class="sxs-lookup"><span data-stu-id="300ac-193">The profiling API was created to support development-time diagnostics.</span></span> <span data-ttu-id="300ac-194">Neprošel přísných testování potřebné k podpoře provozní prostředí.</span><span class="sxs-lookup"><span data-stu-id="300ac-194">It has not undergone the rigorous testing required to support production environments.</span></span>  
  
 [<span data-ttu-id="300ac-195">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="300ac-195">Back to top</span></span>](#top)  
  
<a name="notification_threads"></a>   
## <a name="notification-threads"></a><span data-ttu-id="300ac-196">Vlákna oznámení</span><span class="sxs-lookup"><span data-stu-id="300ac-196">Notification Threads</span></span>  
 <span data-ttu-id="300ac-197">Ve většině případů podproces, který vygeneruje událost, také provede oznámení.</span><span class="sxs-lookup"><span data-stu-id="300ac-197">In most cases, the thread that generates an event also executes notifications.</span></span> <span data-ttu-id="300ac-198">Tato oznámení (například [functionenter –](../../../../docs/framework/unmanaged-api/profiling/functionenter-function.md) a [functionleave –](../../../../docs/framework/unmanaged-api/profiling/functionleave-function.md)) není potřeba zadat explicitní `ThreadID`.</span><span class="sxs-lookup"><span data-stu-id="300ac-198">Such notifications (for example, [FunctionEnter](../../../../docs/framework/unmanaged-api/profiling/functionenter-function.md) and [FunctionLeave](../../../../docs/framework/unmanaged-api/profiling/functionleave-function.md)) do not need to supply the explicit `ThreadID`.</span></span> <span data-ttu-id="300ac-199">Navíc profileru rozhodnout pro ukládání a aktualizujte jeho analysis bloků místo indexování analysis bloky v globální úložiště, na základě používat úložiště thread-local `ThreadID` ovlivněných vlákna.</span><span class="sxs-lookup"><span data-stu-id="300ac-199">Also, the profiler might decide to use thread-local storage to store and update its analysis blocks instead of indexing the analysis blocks in global storage, based on the `ThreadID` of the affected thread.</span></span>  
  
 <span data-ttu-id="300ac-200">Všimněte si, že nejsou serializované tyto zpětných volání.</span><span class="sxs-lookup"><span data-stu-id="300ac-200">Note that these callbacks are not serialized.</span></span> <span data-ttu-id="300ac-201">Uživatelé musí chránit svůj kód tak, že vytvoříte bezpečné pro přístup z více vláken datové struktury a blokováním kód profileru tam, kde je to nutné zabránit paralelní přístup z více vláken.</span><span class="sxs-lookup"><span data-stu-id="300ac-201">Users must protect their code by creating thread-safe data structures and by locking the profiler code where necessary to prevent parallel access from multiple threads.</span></span> <span data-ttu-id="300ac-202">Proto v některých případech může přijímat neobvyklou posloupnost zpětných volání.</span><span class="sxs-lookup"><span data-stu-id="300ac-202">Therefore, in certain cases you can receive an unusual sequence of callbacks.</span></span> <span data-ttu-id="300ac-203">Předpokládejme například, že spravované aplikace je například dvě vláken, které jsou prováděny identické kódu.</span><span class="sxs-lookup"><span data-stu-id="300ac-203">For example, assume that a managed application is spawning two threads that are executing identical code.</span></span> <span data-ttu-id="300ac-204">V takovém případě je možné přijímat [icorprofilercallback::jitcompilationstarted –](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md) událost pro některé funkce z jednoho vlákna a `FunctionEnter` zpětného volání z jiné vlákno před přijetím [ Icorprofilercallback::jitcompilationfinished –](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationfinished-method.md) zpětného volání.</span><span class="sxs-lookup"><span data-stu-id="300ac-204">In this case, it is possible to receive a [ICorProfilerCallback::JITCompilationStarted](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationstarted-method.md) event for some function from one thread and a `FunctionEnter` callback from the other thread before receiving the [ICorProfilerCallback::JITCompilationFinished](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback-jitcompilationfinished-method.md) callback.</span></span> <span data-ttu-id="300ac-205">V takovém případě uživatel obdrží `FunctionEnter` zpětné volání pro funkci, která nemusí být plně v běhu (JIT) ještě zkompilovat.</span><span class="sxs-lookup"><span data-stu-id="300ac-205">In this case, the user will receive a `FunctionEnter` callback for a function that may not have been fully just-in-time (JIT) compiled yet.</span></span>  
  
 [<span data-ttu-id="300ac-206">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="300ac-206">Back to top</span></span>](#top)  
  
<a name="security"></a>   
## <a name="security"></a><span data-ttu-id="300ac-207">Zabezpečení</span><span class="sxs-lookup"><span data-stu-id="300ac-207">Security</span></span>  
 <span data-ttu-id="300ac-208">Profileru DLL je nespravované knihovnu DLL, kterou spouští jako součást běžné spouštěcí modul runtime jazyka.</span><span class="sxs-lookup"><span data-stu-id="300ac-208">A profiler DLL is an unmanaged DLL that runs as part of the common language runtime execution engine.</span></span> <span data-ttu-id="300ac-209">Kód v profileru DLL není podléhá omezením uvedeným v důsledku toho spravovat zabezpečení přístupu kódu.</span><span class="sxs-lookup"><span data-stu-id="300ac-209">As a result, the code in the profiler DLL is not subject to the restrictions of managed code access security.</span></span> <span data-ttu-id="300ac-210">Jediná dvě omezení u profileru DLL jsou způsobené operační systém na uživatele, který je spuštěna PROFILOVANÉHO aplikace.</span><span class="sxs-lookup"><span data-stu-id="300ac-210">The only limitations on the profiler DLL are those imposed by the operating system on the user who is running the profiled application.</span></span>  
  
 <span data-ttu-id="300ac-211">Autoři profileru zabere vhodná bezpečnostní opatření, aby se zabránilo problémy související se zabezpečením.</span><span class="sxs-lookup"><span data-stu-id="300ac-211">Profiler authors should take appropriate precautions to avoid security-related issues.</span></span> <span data-ttu-id="300ac-212">Například během instalace, profileru knihovny DLL musí být přidaní do seznam řízení přístupu (ACL) tak, aby uživatel se zlými úmysly ho nelze změnit.</span><span class="sxs-lookup"><span data-stu-id="300ac-212">For example, during installation, a profiler DLL should be added to an access control list (ACL) so that a malicious user cannot modify it.</span></span>  
  
 [<span data-ttu-id="300ac-213">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="300ac-213">Back to top</span></span>](#top)  
  
<a name="combining_managed_unmanaged"></a>   
## <a name="combining-managed-and-unmanaged-code-in-a-code-profiler"></a><span data-ttu-id="300ac-214">Kombinování spravovaných a nespravovaných kód v kódu profileru</span><span class="sxs-lookup"><span data-stu-id="300ac-214">Combining Managed and Unmanaged Code in a Code Profiler</span></span>  
 <span data-ttu-id="300ac-215">Nesprávně napsaný profileru může způsobit cyklické odkazy na sebe, což vede k nepředvídatelné chování.</span><span class="sxs-lookup"><span data-stu-id="300ac-215">An incorrectly written profiler can cause circular references to itself, resulting in unpredictable behavior.</span></span>  
  
 <span data-ttu-id="300ac-216">O rozhraní API pro profilaci modulu CLR může vytvořit dojem, že napíšete profileru, který obsahuje spravovanými a nespravovanými součásti, které volají navzájem pomocí zprostředkovatele komunikace s objekty nebo nepřímý volání COM.</span><span class="sxs-lookup"><span data-stu-id="300ac-216">A review of the CLR profiling API may create the impression that you can write a profiler that contains managed and unmanaged components that call each other through COM interop or indirect calls.</span></span>  
  
 <span data-ttu-id="300ac-217">I když to je možné z hlediska návrhu, profilaci API nepodporuje spravované součásti.</span><span class="sxs-lookup"><span data-stu-id="300ac-217">Although this is possible from a design perspective, the profiling API does not support managed components.</span></span> <span data-ttu-id="300ac-218">Profileru CLR musí být zcela nespravované.</span><span class="sxs-lookup"><span data-stu-id="300ac-218">A CLR profiler must be completely unmanaged.</span></span> <span data-ttu-id="300ac-219">Pokusy o kombinovat spravovanými a nespravovanými kód v profileru CLR může způsobit narušení přístupu, program selhání nebo zablokování.</span><span class="sxs-lookup"><span data-stu-id="300ac-219">Attempts to combine managed and unmanaged code in a CLR profiler may cause access violations, program failure, or deadlocks.</span></span> <span data-ttu-id="300ac-220">Spravované součásti profileru bude platit události zpět na nespravované součásti, které by následně volání spravované součásti znovu, což vede k cyklické odkazy.</span><span class="sxs-lookup"><span data-stu-id="300ac-220">The managed components of the profiler will fire events back to their unmanaged components, which would subsequently call the managed components again, resulting in circular references.</span></span>  
  
 <span data-ttu-id="300ac-221">V těle Microsoft (MSIL intermediate language) metody je jediným umístěním, kde CLR profileru můžete volat spravovaného kódu bezpečně.</span><span class="sxs-lookup"><span data-stu-id="300ac-221">The only location where a CLR profiler can call managed code safely is in the Microsoft intermediate language (MSIL) body of a method.</span></span> <span data-ttu-id="300ac-222">Doporučený postup pro úpravy textu MSIL je použít metody rekompilace JIT v [icorprofilercallback4 –](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback4-interface.md) rozhraní.</span><span class="sxs-lookup"><span data-stu-id="300ac-222">The recommended practice for modifying the MSIL body is to use the  JIT recompilation methods in the [ICorProfilerCallback4](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback4-interface.md) interface.</span></span>  
  
 <span data-ttu-id="300ac-223">Je také možné použít k úpravě MSIL starší metody instrumentace.</span><span class="sxs-lookup"><span data-stu-id="300ac-223">It is also possible to use the older instrumentation methods to modify MSIL.</span></span> <span data-ttu-id="300ac-224">Před dokončením kompilace v běhu (JIT) funkce profileru můžete vložit spravované volání v těle MSIL metoda a pak JIT – kompilace ho (viz [icorprofilerinfo::getilfunctionbody –](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getilfunctionbody-method.md) metoda).</span><span class="sxs-lookup"><span data-stu-id="300ac-224">Before the just-in-time (JIT) compilation of a function is completed, the profiler can insert managed calls in the MSIL body of a method and then JIT-compile it (see the [ICorProfilerInfo::GetILFunctionBody](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo-getilfunctionbody-method.md) method).</span></span> <span data-ttu-id="300ac-225">Tento postup můžete použít úspěšně pro selektivní instrumentace spravovaného kódu nebo ke shromažďování statistik a výkonu dat o JIT.</span><span class="sxs-lookup"><span data-stu-id="300ac-225">This technique can successfully be used for selective instrumentation of managed code, or to gather statistics and performance data about the JIT.</span></span>  
  
 <span data-ttu-id="300ac-226">Alternativně můžete vložit kód profileru nativní háky v těle MSIL každých spravované funkce, který volá nespravovaný kód.</span><span class="sxs-lookup"><span data-stu-id="300ac-226">Alternatively, a code profiler can insert native hooks in the MSIL body of every managed function that calls into unmanaged code.</span></span> <span data-ttu-id="300ac-227">Tento postup můžete použít pro instrumentace a pokrytí.</span><span class="sxs-lookup"><span data-stu-id="300ac-227">This technique can be used for instrumentation and coverage.</span></span> <span data-ttu-id="300ac-228">Například může profileru kód vložte instrumentace háky po každých MSIL bloku, aby provedl bloku.</span><span class="sxs-lookup"><span data-stu-id="300ac-228">For example, a code profiler could insert instrumentation hooks after every MSIL block to ensure that the block has been executed.</span></span> <span data-ttu-id="300ac-229">Úpravy textu MSIL metodu je velmi citlivé operace a existuje celá řada faktorů, které musí vzít v úvahu.</span><span class="sxs-lookup"><span data-stu-id="300ac-229">The modification of the MSIL body of a method is a very delicate operation, and there are many factors that should be taken into consideration.</span></span>  
  
 [<span data-ttu-id="300ac-230">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="300ac-230">Back to top</span></span>](#top)  
  
<a name="unmanaged"></a>   
## <a name="profiling-unmanaged-code"></a><span data-ttu-id="300ac-231">Profilace nespravovaného kódu</span><span class="sxs-lookup"><span data-stu-id="300ac-231">Profiling Unmanaged Code</span></span>  
 <span data-ttu-id="300ac-232">Modul CLR (CLR) rozhraní API pro profilaci poskytuje minimální podporu pro profilace nespravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="300ac-232">The common language runtime (CLR) profiling API provides minimal support for profiling unmanaged code.</span></span> <span data-ttu-id="300ac-233">Je k dispozici následující funkce:</span><span class="sxs-lookup"><span data-stu-id="300ac-233">The following functionality is provided:</span></span>  
  
-   <span data-ttu-id="300ac-234">Výčet řetězy zásobníku.</span><span class="sxs-lookup"><span data-stu-id="300ac-234">Enumeration of stack chains.</span></span> <span data-ttu-id="300ac-235">Tato funkce umožňuje profileru kódu k určení hranice mezi spravovaného kódu a nespravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="300ac-235">This feature enables a code profiler to determine the boundary between managed code and unmanaged code.</span></span>  
  
-   <span data-ttu-id="300ac-236">Stanovení jestli odpovídá řetězci zásobníku spravovaného kódu nebo nativního kódu.</span><span class="sxs-lookup"><span data-stu-id="300ac-236">Determination whether a stack chain corresponds to managed code or native code.</span></span>  
  
 <span data-ttu-id="300ac-237">V rozhraní .NET Framework verze 1.0 a 1.1 tyto metody jsou k dispozici prostřednictvím v procesu podmnožinu rozhraní API pro ladění modulu CLR.</span><span class="sxs-lookup"><span data-stu-id="300ac-237">In the .NET Framework versions 1.0 and 1.1, these methods are available through the in-process subset of the CLR debugging API.</span></span> <span data-ttu-id="300ac-238">Jsou definovány v souboru CorDebug.idl.</span><span class="sxs-lookup"><span data-stu-id="300ac-238">They are defined in the CorDebug.idl file.</span></span>  
  
 <span data-ttu-id="300ac-239">V rozhraní .NET Framework 2.0 nebo novější, můžete použít [ICorProfilerInfo2::dostacksnapshot –](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) metodu pro tuto funkci.</span><span class="sxs-lookup"><span data-stu-id="300ac-239">In the .NET Framework 2.0 and later, you can use the [ICorProfilerInfo2::DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) method for this functionality.</span></span>  
  
 [<span data-ttu-id="300ac-240">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="300ac-240">Back to top</span></span>](#top)  
  
<a name="com"></a>   
## <a name="using-com"></a><span data-ttu-id="300ac-241">Pomocí modelu COM</span><span class="sxs-lookup"><span data-stu-id="300ac-241">Using COM</span></span>  
 <span data-ttu-id="300ac-242">I když rozhraní profilace jsou definovány jako rozhraní modelu COM, modul CLR (CLR) neinicializuje ve skutečnosti COM k použití těchto rozhraní.</span><span class="sxs-lookup"><span data-stu-id="300ac-242">Although the profiling interfaces are defined as COM interfaces, the common language runtime (CLR) does not actually initialize COM to use these interfaces.</span></span> <span data-ttu-id="300ac-243">Důvodem je, abyste vyloučili, že nastavení modelu vláken pomocí [funkce CoInitialize](http://msdn.microsoft.com/library/windows/desktop/ms678543\(v=vs.85\).aspx) funkce před spravované aplikaci dostal příležitost k určení jeho požadované model vláken.</span><span class="sxs-lookup"><span data-stu-id="300ac-243">The reason is to avoid having to set the threading model by using the [CoInitialize](http://msdn.microsoft.com/library/windows/desktop/ms678543\(v=vs.85\).aspx) function before the managed application has had a chance to specify its desired threading model.</span></span> <span data-ttu-id="300ac-244">Podobně, by neměla volat profileru samotné `CoInitialize`, protože může vybrat model vláken, který není kompatibilní s aplikací profilovaný a může způsobit selhání aplikace.</span><span class="sxs-lookup"><span data-stu-id="300ac-244">Similarly, the profiler itself should not call `CoInitialize`, because it may pick a threading model that is incompatible with the application being profiled and may cause the application to fail.</span></span>  
  
 [<span data-ttu-id="300ac-245">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="300ac-245">Back to top</span></span>](#top)  
  
<a name="call_stacks"></a>   
## <a name="call-stacks"></a><span data-ttu-id="300ac-246">Zásobníky volání</span><span class="sxs-lookup"><span data-stu-id="300ac-246">Call Stacks</span></span>  
 <span data-ttu-id="300ac-247">Profilace API poskytuje dva způsoby, jak získat zásobníky volání: metoda snímku zásobníku, umožňující zhuštěných shromažďování zásobníky volání a metoda stínové zásobníku, která sleduje zásobníku volání v každé rychlých.</span><span class="sxs-lookup"><span data-stu-id="300ac-247">The profiling API provides two ways to obtain call stacks: a stack snapshot method, which enables sparse gathering of call stacks, and a shadow stack method, which tracks the call stack at every instant.</span></span>  
  
### <a name="stack-snapshot"></a><span data-ttu-id="300ac-248">Snímky zásobníku</span><span class="sxs-lookup"><span data-stu-id="300ac-248">Stack Snapshot</span></span>  
 <span data-ttu-id="300ac-249">Snímek zásobníku je trasování zásobníku vlákna na okamžik v čase.</span><span class="sxs-lookup"><span data-stu-id="300ac-249">A stack snapshot is a trace of the stack of a thread at an instant in time.</span></span> <span data-ttu-id="300ac-250">Profilování rozhraní API podporuje trasování spravované funkce v zásobníku, ale ponechá ji trasování nespravovaných funkcí k walkera zásobníku profileru na vlastní.</span><span class="sxs-lookup"><span data-stu-id="300ac-250">The profiling API supports the tracing of managed functions on the stack, but it leaves the tracing of unmanaged functions to the profiler's own stack walker.</span></span>  
  
 <span data-ttu-id="300ac-251">Další informace o tom, jak program profileru vás spravované zásobníky najdete v tématu [ICorProfilerInfo2::dostacksnapshot –](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) metoda v této dokumentaci, a [profileru zásobníku proti v rozhraní .NET Framework 2.0: Základní informace a kromě](http://go.microsoft.com/fwlink/?LinkId=73638).</span><span class="sxs-lookup"><span data-stu-id="300ac-251">For more information about how to program the profiler to walk managed stacks, see the [ICorProfilerInfo2::DoStackSnapshot](../../../../docs/framework/unmanaged-api/profiling/icorprofilerinfo2-dostacksnapshot-method.md) method in this documentation set, and [Profiler Stack Walking in the .NET Framework 2.0: Basics and Beyond](http://go.microsoft.com/fwlink/?LinkId=73638).</span></span>
  
### <a name="shadow-stack"></a><span data-ttu-id="300ac-252">Stínové zásobníku</span><span class="sxs-lookup"><span data-stu-id="300ac-252">Shadow Stack</span></span>  
 <span data-ttu-id="300ac-253">Pomocí metody snímku příliš často můžete rychle vytvořit problém výkonu.</span><span class="sxs-lookup"><span data-stu-id="300ac-253">Using the snapshot method too frequently can quickly create a performance issue.</span></span> <span data-ttu-id="300ac-254">Pokud budete chtít využít trasování zásobníku často, vaše profileru má místo sestavit stínové zásobníku pomocí [functionenter2 –](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md), [functionleave2 –](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md), [functiontailcall2 –](../../../../docs/framework/unmanaged-api/profiling/functiontailcall2-function.md), a [icorprofilercallback2 –](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) zpětná volání výjimek.</span><span class="sxs-lookup"><span data-stu-id="300ac-254">If you want to take stack traces frequently, your profiler should instead build a shadow stack by using the [FunctionEnter2](../../../../docs/framework/unmanaged-api/profiling/functionenter2-function.md), [FunctionLeave2](../../../../docs/framework/unmanaged-api/profiling/functionleave2-function.md), [FunctionTailcall2](../../../../docs/framework/unmanaged-api/profiling/functiontailcall2-function.md), and [ICorProfilerCallback2](../../../../docs/framework/unmanaged-api/profiling/icorprofilercallback2-interface.md) exception callbacks.</span></span> <span data-ttu-id="300ac-255">Zásobník stínové je vždy aktuální a lze rychle zkopírovat do úložiště vždy, když je potřeba snímku zásobníku.</span><span class="sxs-lookup"><span data-stu-id="300ac-255">The shadow stack is always current and can quickly be copied to storage whenever a stack snapshot is needed.</span></span>  
  
 <span data-ttu-id="300ac-256">Zásobník stínové může získat argumenty funkce, návratové hodnoty a informace o obecné konkretizací.</span><span class="sxs-lookup"><span data-stu-id="300ac-256">A shadow stack may obtain function arguments, return values, and information about generic instantiations.</span></span> <span data-ttu-id="300ac-257">Tyto informace je k dispozici pouze prostřednictvím stínové zásobníku a může být získán při řízení je předat funkci.</span><span class="sxs-lookup"><span data-stu-id="300ac-257">This information is available only through the shadow stack and may be obtained when control is handed to a function.</span></span> <span data-ttu-id="300ac-258">Tyto informace však nemusí být k dispozici novější během spuštění funkce.</span><span class="sxs-lookup"><span data-stu-id="300ac-258">However, this information may not be available later during the run of the function.</span></span>  
  
 [<span data-ttu-id="300ac-259">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="300ac-259">Back to top</span></span>](#top)  
  
<a name="callbacks"></a>   
## <a name="callbacks-and-stack-depth"></a><span data-ttu-id="300ac-260">Zpětná volání a hloubka zásobníku</span><span class="sxs-lookup"><span data-stu-id="300ac-260">Callbacks and Stack Depth</span></span>  
 <span data-ttu-id="300ac-261">Ve velmi omezené zásobníku okolností může být vydaný profileru zpětná volání a k přetečení zásobníku v zpětné volání profileru povede k ukončení procesu okamžitě.</span><span class="sxs-lookup"><span data-stu-id="300ac-261">Profiler callbacks may be issued in very stack-constrained circumstances, and a stack overflow in a profiler callback will lead to an immediate process exit.</span></span> <span data-ttu-id="300ac-262">Profileru měli používat jako málo zásobníku nejblíže v reakci na zpětných volání.</span><span class="sxs-lookup"><span data-stu-id="300ac-262">A profiler should make sure to use as little stack as possible in response to callbacks.</span></span> <span data-ttu-id="300ac-263">Pokud profileru je určený pro použití s procesy, které jsou odolnější proti přetečení zásobníku, profileru samotné také Vyhněte se aktivuje přetečení zásobníku.</span><span class="sxs-lookup"><span data-stu-id="300ac-263">If the profiler is intended for use against processes that are robust against stack overflow, the profiler itself should also avoid triggering stack overflow.</span></span>  
  
 [<span data-ttu-id="300ac-264">Zpět na začátek</span><span class="sxs-lookup"><span data-stu-id="300ac-264">Back to top</span></span>](#top)  
  
<a name="related_topics"></a>   
## <a name="related-topics"></a><span data-ttu-id="300ac-265">Související témata</span><span class="sxs-lookup"><span data-stu-id="300ac-265">Related Topics</span></span>  
  
|<span data-ttu-id="300ac-266">Název</span><span class="sxs-lookup"><span data-stu-id="300ac-266">Title</span></span>|<span data-ttu-id="300ac-267">Popis</span><span class="sxs-lookup"><span data-stu-id="300ac-267">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="300ac-268">Nastavení prostředí profilace</span><span class="sxs-lookup"><span data-stu-id="300ac-268">Setting Up a Profiling Environment</span></span>](../../../../docs/framework/unmanaged-api/profiling/setting-up-a-profiling-environment.md)|<span data-ttu-id="300ac-269">Vysvětluje, jak k inicializaci profileru, nastavení oznámení událostí a profilu služby systému Windows.</span><span class="sxs-lookup"><span data-stu-id="300ac-269">Explains how to initialize a profiler, set event notifications, and profile a Windows Service.</span></span>|  
|[<span data-ttu-id="300ac-270">Rozhraní pro profilaci</span><span class="sxs-lookup"><span data-stu-id="300ac-270">Profiling Interfaces</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-interfaces.md)|<span data-ttu-id="300ac-271">Popisuje nespravované rozhraní, která používá profilaci API.</span><span class="sxs-lookup"><span data-stu-id="300ac-271">Describes the unmanaged interfaces that the profiling API uses.</span></span>|  
|[<span data-ttu-id="300ac-272">Globální statické funkce pro profilaci</span><span class="sxs-lookup"><span data-stu-id="300ac-272">Profiling Global Static Functions</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-global-static-functions.md)|<span data-ttu-id="300ac-273">Popisuje nespravované globální statické funkce, které používá profilaci API.</span><span class="sxs-lookup"><span data-stu-id="300ac-273">Describes the unmanaged global static functions that the profiling API uses.</span></span>|  
|[<span data-ttu-id="300ac-274">Výčty pro profilaci</span><span class="sxs-lookup"><span data-stu-id="300ac-274">Profiling Enumerations</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-enumerations.md)|<span data-ttu-id="300ac-275">Popisuje nespravovaná vyčíslení, které používá profilaci API.</span><span class="sxs-lookup"><span data-stu-id="300ac-275">Describes the unmanaged enumerations that the profiling API uses.</span></span>|  
|[<span data-ttu-id="300ac-276">Struktury pro profilaci</span><span class="sxs-lookup"><span data-stu-id="300ac-276">Profiling Structures</span></span>](../../../../docs/framework/unmanaged-api/profiling/profiling-structures.md)|<span data-ttu-id="300ac-277">Popisuje nespravované struktury, které používá profilaci API.</span><span class="sxs-lookup"><span data-stu-id="300ac-277">Describes the unmanaged structures that the profiling API uses.</span></span>|
