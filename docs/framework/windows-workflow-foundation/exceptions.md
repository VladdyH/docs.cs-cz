---
title: Výjimky
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 065205cc-52dd-4f30-9578-b17d8d113136
caps.latest.revision: 26
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 9e78546a10e1a8cdff780c44898fd209ca829c6c
ms.sourcegitcommit: 03ee570f6f528a7d23a4221dcb26a9498edbdf8c
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/28/2018
---
# <a name="exceptions"></a><span data-ttu-id="ba331-102">Výjimky</span><span class="sxs-lookup"><span data-stu-id="ba331-102">Exceptions</span></span>
<span data-ttu-id="ba331-103">Pracovní postupy můžete použít <xref:System.Activities.Statements.TryCatch> aktivity zpracování výjimek, které jsou vyvolány během spouštění pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="ba331-103">Workflows can use the <xref:System.Activities.Statements.TryCatch> activity to handle exceptions that are raised during the execution of a workflow.</span></span> <span data-ttu-id="ba331-104">Tyto odchylky mohou být zpracovány nebo se může být znovu vyvolána, pomocí <xref:System.Activities.Statements.Rethrow> aktivity.</span><span class="sxs-lookup"><span data-stu-id="ba331-104">These exceptions can be handled or they can be re-thrown using the <xref:System.Activities.Statements.Rethrow> activity.</span></span> <span data-ttu-id="ba331-105">Aktivity v <xref:System.Activities.Statements.TryCatch.Finally%2A> části jsou spuštěna při buď <xref:System.Activities.Statements.TryCatch.Try%2A> části nebo <xref:System.Activities.Statements.TryCatch.Catches%2A> části dokončení.</span><span class="sxs-lookup"><span data-stu-id="ba331-105">Activities in the <xref:System.Activities.Statements.TryCatch.Finally%2A> section are executed when either the <xref:System.Activities.Statements.TryCatch.Try%2A> section or the <xref:System.Activities.Statements.TryCatch.Catches%2A> section completes.</span></span> <span data-ttu-id="ba331-106">Pracovní postupy hostované <xref:System.Activities.WorkflowApplication> instance můžete také použít <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> obslužné rutiny události pro zpracování výjimek, které nejsou zpracovávány <xref:System.Activities.Statements.TryCatch> aktivity.</span><span class="sxs-lookup"><span data-stu-id="ba331-106">Workflows hosted by a <xref:System.Activities.WorkflowApplication> instance can also use the <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> event handler to handle exceptions that are not handled by a <xref:System.Activities.Statements.TryCatch> activity.</span></span>  
  
## <a name="causes-of-exceptions"></a><span data-ttu-id="ba331-107">Příčinami výjimek</span><span class="sxs-lookup"><span data-stu-id="ba331-107">Causes of Exceptions</span></span>  
 <span data-ttu-id="ba331-108">V pracovním postupu mohou být výjimky generovány následujícími způsoby:</span><span class="sxs-lookup"><span data-stu-id="ba331-108">In a workflow, exceptions can be generated in the following ways:</span></span>  
  
-   <span data-ttu-id="ba331-109">Časový limit transakcí v <xref:System.Activities.Statements.TransactionScope>.</span><span class="sxs-lookup"><span data-stu-id="ba331-109">A time-out of transactions in <xref:System.Activities.Statements.TransactionScope>.</span></span>  
  
-   <span data-ttu-id="ba331-110">Explicitní výjimka vyvolaná pomocí pracovního postupu <xref:System.Activities.Statements.Throw> aktivity.</span><span class="sxs-lookup"><span data-stu-id="ba331-110">An explicit exception thrown by the workflow using the <xref:System.Activities.Statements.Throw> activity.</span></span>  
  
-   <span data-ttu-id="ba331-111">A [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] došlo k výjimce z aktivity.</span><span class="sxs-lookup"><span data-stu-id="ba331-111">A [!INCLUDE[netfx_current_short](../../../includes/netfx-current-short-md.md)] exception thrown from an activity.</span></span>  
  
-   <span data-ttu-id="ba331-112">Výjimka vyvolaná z externí kódu, například knihovny, komponenty nebo služby, které se používají v pracovním postupu.</span><span class="sxs-lookup"><span data-stu-id="ba331-112">An exception thrown from external code, such as libraries, components, or services that are used in the workflow.</span></span>  
  
## <a name="handling-exceptions"></a><span data-ttu-id="ba331-113">Zpracování výjimek</span><span class="sxs-lookup"><span data-stu-id="ba331-113">Handling Exceptions</span></span>  
 <span data-ttu-id="ba331-114">Pokud je vyvolána aktivitou a neošetřené výjimka, použije se výchozí chování je ukončení instance pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="ba331-114">If an exception is thrown by an activity and is unhandled, the default behavior is to terminate the workflow instance.</span></span> <span data-ttu-id="ba331-115">Pokud vlastní <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> obslužná rutina přítomen, ho můžete přepsat toto výchozí chování.</span><span class="sxs-lookup"><span data-stu-id="ba331-115">If a custom <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> handler is present, it can override this default behavior.</span></span> <span data-ttu-id="ba331-116">Tato obslužná rutina dává možnost poskytnout příslušné zpracování, například vlastní protokolování, přerušení pracovního postupu, pracovní postup zrušení nebo ukončení pracovního postupu vytvořit hostitele pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="ba331-116">This handler gives the workflow host author an opportunity to provide the appropriate handling, such as custom logging, aborting the workflow, canceling the workflow, or terminating the workflow.</span></span>  <span data-ttu-id="ba331-117">Pokud pracovní postup vyvolá výjimku, která nejsou zpracovávány <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> je volána obslužná rutina.</span><span class="sxs-lookup"><span data-stu-id="ba331-117">If a workflow raises an exception that is not handled, the <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> handler is invoked.</span></span> <span data-ttu-id="ba331-118">Existují tři možných akcí, kterou vrátil <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> který určit konečný výsledek pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="ba331-118">There are three possible actions returned from <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> which determine the final outcome of the workflow.</span></span>  
  
-   <span data-ttu-id="ba331-119">**Zrušit** -instanci zrušené pracovního postupu je řádně ukončení provádění firemní pobočky.</span><span class="sxs-lookup"><span data-stu-id="ba331-119">**Cancel** - A cancelled workflow instance is a graceful exit of a branch execution.</span></span> <span data-ttu-id="ba331-120">Zrušení chování můžete model (například pomocí aktivity CancellationScope).</span><span class="sxs-lookup"><span data-stu-id="ba331-120">You can model cancelation behavior (for example, by using a CancellationScope activity).</span></span> <span data-ttu-id="ba331-121">Obslužná rutina dokončeno je vyvolána po dokončení procesu zrušení.</span><span class="sxs-lookup"><span data-stu-id="ba331-121">The Completed handler is invoked when the cancellation process completes.</span></span> <span data-ttu-id="ba331-122">Zrušené pracovní postup je ve stavu zrušeno.</span><span class="sxs-lookup"><span data-stu-id="ba331-122">A cancelled workflow is in the Cancelled state.</span></span>  
  
-   <span data-ttu-id="ba331-123">**Ukončit** -instanci ukončenou pracovního postupu se nedá obnovit nebo restartovat.</span><span class="sxs-lookup"><span data-stu-id="ba331-123">**Terminate** - A terminated workflow instance cannot be resumed or restarted.</span></span>  <span data-ttu-id="ba331-124">Tím se spustí dokončeno událostí, ve kterém můžete zadat výjimku jako důvod, proč byl ukončen.</span><span class="sxs-lookup"><span data-stu-id="ba331-124">This triggers the Completed event in which you can provide an exception as the reason it was terminated.</span></span> <span data-ttu-id="ba331-125">Obslužná rutina ukončeno je vyvolána po dokončení procesu ukončení.</span><span class="sxs-lookup"><span data-stu-id="ba331-125">The Terminated handler is invoked when the termination process completes.</span></span> <span data-ttu-id="ba331-126">Ukončenou pracovní postup je v chybném stavu.</span><span class="sxs-lookup"><span data-stu-id="ba331-126">A terminated workflow is in the Faulted state.</span></span>  
  
-   <span data-ttu-id="ba331-127">**Abort –** -instancí přerušené pracovního postupu můžete obnovit pouze v případě, že byl nakonfigurován jako trvalé.</span><span class="sxs-lookup"><span data-stu-id="ba331-127">**Abort** - An aborted workflow instances can be resumed only if it has been configured to be persistent.</span></span>  <span data-ttu-id="ba331-128">Bez trvalost nelze pokračovat. pracovní postup.</span><span class="sxs-lookup"><span data-stu-id="ba331-128">Without persistence, a workflow cannot be resumed.</span></span>  <span data-ttu-id="ba331-129">V bodě pracovní postup byl přerušen, všechny objem práce (v paměti), od vytvoření posledního bodu trvalost budou ztraceny.</span><span class="sxs-lookup"><span data-stu-id="ba331-129">At the point a workflow is aborted, any work done (in memory) since the last persistence point will be lost.</span></span> <span data-ttu-id="ba331-130">Pro přerušené pracovní postup je vyvolána obslužná rutina bylo přerušeno. pomocí výjimka jako z důvodu, po dokončení procesu přerušení.</span><span class="sxs-lookup"><span data-stu-id="ba331-130">For an aborted workflow, the Aborted handler is invoked using the exception as the reason when the abort process completes.</span></span> <span data-ttu-id="ba331-131">Na rozdíl od zrušeno a ukončeno, ale není vyvolána obslužná rutina dokončeno.</span><span class="sxs-lookup"><span data-stu-id="ba331-131">However, unlike Cancelled and Terminated, the Completed handler is not invoked.</span></span> <span data-ttu-id="ba331-132">Přerušené pracovního postupu je ve stavu bylo přerušeno.</span><span class="sxs-lookup"><span data-stu-id="ba331-132">An aborted workflow is in an Aborted state.</span></span>  
  
 <span data-ttu-id="ba331-133">Následující příklad popisuje vyvolání pracovní postup, který vyvolá výjimku.</span><span class="sxs-lookup"><span data-stu-id="ba331-133">The following example invokes a workflow that throws an exception.</span></span> <span data-ttu-id="ba331-134">V tomto pracovním postupu je neošetřené výjimky a <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> je volána obslužná rutina.</span><span class="sxs-lookup"><span data-stu-id="ba331-134">The exception is unhandled by the workflow and the <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> handler is invoked.</span></span> <span data-ttu-id="ba331-135"><xref:System.Activities.WorkflowApplicationUnhandledExceptionEventArgs> Jsou prozkoumá a poskytují informace o výjimce, a pracovní postup bude ukončen.</span><span class="sxs-lookup"><span data-stu-id="ba331-135">The <xref:System.Activities.WorkflowApplicationUnhandledExceptionEventArgs> are inspected to provide information about the exception, and the workflow is terminated.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#1](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#1)]  
  
### <a name="handling-exceptions-with-the-trycatch-activity"></a><span data-ttu-id="ba331-136">Zpracování výjimek s TryCatch aktivity</span><span class="sxs-lookup"><span data-stu-id="ba331-136">Handling Exceptions with the TryCatch Activity</span></span>  
 <span data-ttu-id="ba331-137">Zpracování výjimek v pracovním postupu se provádí pomocí <xref:System.Activities.Statements.TryCatch> aktivity.</span><span class="sxs-lookup"><span data-stu-id="ba331-137">Handling exceptions inside a workflow is performed with the <xref:System.Activities.Statements.TryCatch> activity.</span></span> <span data-ttu-id="ba331-138"><xref:System.Activities.Statements.TryCatch> Aktivita má <xref:System.Activities.Statements.TryCatch.Catches%2A> kolekce <xref:System.Activities.Statements.Catch> aktivity, které jsou všechny související s konkrétní <xref:System.Exception> typu.</span><span class="sxs-lookup"><span data-stu-id="ba331-138">The <xref:System.Activities.Statements.TryCatch> activity has a <xref:System.Activities.Statements.TryCatch.Catches%2A> collection of <xref:System.Activities.Statements.Catch> activities that are each associated with a specific <xref:System.Exception> type.</span></span> <span data-ttu-id="ba331-139">Pokud výjimky vyvolané aktivitu, která je součástí <xref:System.Activities.Statements.TryCatch.Try%2A> části <xref:System.Activities.Statements.TryCatch> aktivity odpovídá výjimku <xref:System.Activities.Statements.Catch%601> aktivity v <xref:System.Activities.Statements.TryCatch.Catches%2A> zpracovává kolekce a potom výjimka.</span><span class="sxs-lookup"><span data-stu-id="ba331-139">If the exception thrown by an activity that is contained in the <xref:System.Activities.Statements.TryCatch.Try%2A> section of a <xref:System.Activities.Statements.TryCatch> activity matches the exception of a <xref:System.Activities.Statements.Catch%601> activity in the <xref:System.Activities.Statements.TryCatch.Catches%2A> collection, then the exception is handled.</span></span> <span data-ttu-id="ba331-140">Pokud je explicitně znovu vyvolána výjimka nebo novou výjimku pak tato výjimka předá do nadřazené aktivity.</span><span class="sxs-lookup"><span data-stu-id="ba331-140">If the exception is explicitly re-thrown or a new exception is thrown then this exception passes up to the parent activity.</span></span> <span data-ttu-id="ba331-141">Následující příklad kódu ukazuje <xref:System.Activities.Statements.TryCatch> aktivity, která zpracovává <xref:System.ApplicationException> , je vyvolána <xref:System.Activities.Statements.TryCatch.Try%2A> části podle <xref:System.Activities.Statements.Throw> aktivity.</span><span class="sxs-lookup"><span data-stu-id="ba331-141">The following code example shows a <xref:System.Activities.Statements.TryCatch> activity that handles an <xref:System.ApplicationException> that is thrown in the <xref:System.Activities.Statements.TryCatch.Try%2A> section by a <xref:System.Activities.Statements.Throw> activity.</span></span> <span data-ttu-id="ba331-142">Zpráva výjimky je zapsán do konzoly pomocí <xref:System.Activities.Statements.Catch%601> aktivitu a potom zprávu je zapsán do konzoly v <xref:System.Activities.Statements.TryCatch.Finally%2A> části.</span><span class="sxs-lookup"><span data-stu-id="ba331-142">The exception's message is written to the console by the <xref:System.Activities.Statements.Catch%601> activity, and then a message is written to the console in the <xref:System.Activities.Statements.TryCatch.Finally%2A> section.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#33](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#33)]  
  
 <span data-ttu-id="ba331-143">Aktivity v <xref:System.Activities.Statements.TryCatch.Finally%2A> části jsou spuštěna při buď <xref:System.Activities.Statements.TryCatch.Try%2A> části nebo <xref:System.Activities.Statements.TryCatch.Catches%2A> části úspěšně dokončí.</span><span class="sxs-lookup"><span data-stu-id="ba331-143">The activities in the <xref:System.Activities.Statements.TryCatch.Finally%2A> section are executed when either the <xref:System.Activities.Statements.TryCatch.Try%2A> section or the <xref:System.Activities.Statements.TryCatch.Catches%2A> section successfully completes.</span></span> <span data-ttu-id="ba331-144"><xref:System.Activities.Statements.TryCatch.Try%2A> Části úspěšně dokončí, pokud žádné výjimky jsou vyvolány z a <xref:System.Activities.Statements.TryCatch.Catches%2A> části úspěšně dokončí, pokud žádné výjimky jsou vyvolány nebo znovu vyvolány z něj.</span><span class="sxs-lookup"><span data-stu-id="ba331-144">The <xref:System.Activities.Statements.TryCatch.Try%2A> section successfully completes if no exceptions are thrown from it, and the <xref:System.Activities.Statements.TryCatch.Catches%2A> section successfully completes if no exceptions are thrown or rethrown from it.</span></span> <span data-ttu-id="ba331-145">Pokud je vyvolána výjimka <xref:System.Activities.Statements.TryCatch.Try%2A> části <xref:System.Activities.Statements.TryCatch> a není buď zpracovává <xref:System.Activities.Statements.Catch%601> v <xref:System.Activities.Statements.TryCatch.Catches%2A> části nebo je znovu vyvolány z <xref:System.Activities.Statements.TryCatch.Catches%2A>, aktivity v <xref:System.Activities.Statements.TryCatch.Finally%2A> nebude možné provést, dokud nenastane některá z následujících akcí.</span><span class="sxs-lookup"><span data-stu-id="ba331-145">If an exception is thrown in the <xref:System.Activities.Statements.TryCatch.Try%2A> section of a <xref:System.Activities.Statements.TryCatch> and is either not handled by a <xref:System.Activities.Statements.Catch%601> in the <xref:System.Activities.Statements.TryCatch.Catches%2A> section, or is rethrown from the <xref:System.Activities.Statements.TryCatch.Catches%2A>, the activities in the <xref:System.Activities.Statements.TryCatch.Finally%2A> will not be executed unless the one of the following occurs.</span></span>  
  
-   <span data-ttu-id="ba331-146">Výjimka je zachytila na vyšší úrovni <xref:System.Activities.Statements.TryCatch> aktivity v pracovním postupu, bez ohledu na to, jestli je vyvolány z této vyšší úrovni <xref:System.Activities.Statements.TryCatch>.</span><span class="sxs-lookup"><span data-stu-id="ba331-146">The exception is caught by a higher level <xref:System.Activities.Statements.TryCatch> activity in the workflow, regardless of whether it is rethrown from that higher level <xref:System.Activities.Statements.TryCatch>.</span></span>  
  
-   <span data-ttu-id="ba331-147">Výjimka není zpracováván na vyšší úrovni <xref:System.Activities.Statements.TryCatch>, řídicí sekvence kořenu pracovního postupu a pracovní postup je nakonfigurovaný zrušit místo provedení příkazu ukončit nebo přerušení.</span><span class="sxs-lookup"><span data-stu-id="ba331-147">The exception is not handled by a higher level <xref:System.Activities.Statements.TryCatch>, escapes the root of the workflow, and the workflow is configured to cancel instead of terminate or abort.</span></span> <span data-ttu-id="ba331-148">Pracovní postupy, které jsou hostované pomocí <xref:System.Activities.WorkflowApplication> to můžete nakonfigurovat zpracování <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> a vrátí <xref:System.Activities.UnhandledExceptionAction.Cancel>.</span><span class="sxs-lookup"><span data-stu-id="ba331-148">Workflows hosted using <xref:System.Activities.WorkflowApplication> can configure this by handling <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> and returning <xref:System.Activities.UnhandledExceptionAction.Cancel>.</span></span> <span data-ttu-id="ba331-149">Příkladem zpracování <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> je uvedené dříve v tomto tématu.</span><span class="sxs-lookup"><span data-stu-id="ba331-149">An example of handling <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A> is provided previously in this topic.</span></span> <span data-ttu-id="ba331-150">Služby pracovních postupů to můžete nakonfigurovat pomocí <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior> a zadání <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Cancel>.</span><span class="sxs-lookup"><span data-stu-id="ba331-150">Workflow services can configure this by using <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior> and specifying <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionAction.Cancel>.</span></span> <span data-ttu-id="ba331-151">Příklad konfigurace <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior>, najdete v části [rozšíření hostitele služby pracovního postupu](../../../docs/framework/wcf/feature-details/workflow-service-host-extensibility.md).</span><span class="sxs-lookup"><span data-stu-id="ba331-151">For an example of configuring <xref:System.ServiceModel.Activities.Description.WorkflowUnhandledExceptionBehavior>, see [Workflow Service Host Extensibility](../../../docs/framework/wcf/feature-details/workflow-service-host-extensibility.md).</span></span>  
  
## <a name="exception-handling-versus-compensation"></a><span data-ttu-id="ba331-152">Porovnání kompenzace zpracování výjimek</span><span class="sxs-lookup"><span data-stu-id="ba331-152">Exception Handling versus Compensation</span></span>  
 <span data-ttu-id="ba331-153">Rozdíl mezi výjimek a kompenzace je, že při provádění aktivity k výjimek.</span><span class="sxs-lookup"><span data-stu-id="ba331-153">The difference between exception handling and compensation is that exception handling occurs during the execution of an activity.</span></span> <span data-ttu-id="ba331-154">Kompenzace nastane po úspěšném dokončení aktivity.</span><span class="sxs-lookup"><span data-stu-id="ba331-154">Compensation occurs after an activity has successfully completed.</span></span> <span data-ttu-id="ba331-155">Zpracovávání výjimek v jazyce poskytuje možnost Vyčištění po aktivity vyvolá výjimku, zatímco kompenzace poskytuje mechanismus, pomocí kterého lze úspěšně dokončila práci při dříve dokončené aktivity vrátit zpět.</span><span class="sxs-lookup"><span data-stu-id="ba331-155">Exception handling provides an opportunity to clean up after the activity raises the exception, whereas compensation provides a mechanism by which the successfully completed work of a previously completed activity can be undone.</span></span> <span data-ttu-id="ba331-156">Další informace najdete v tématu [kompenzace](../../../docs/framework/windows-workflow-foundation/compensation.md).</span><span class="sxs-lookup"><span data-stu-id="ba331-156">For more information, see [Compensation](../../../docs/framework/windows-workflow-foundation/compensation.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ba331-157">Viz také</span><span class="sxs-lookup"><span data-stu-id="ba331-157">See Also</span></span>  
 <xref:System.Activities.Statements.TryCatch>  
 <xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>  
 <xref:System.Activities.Statements.CompensableActivity>
