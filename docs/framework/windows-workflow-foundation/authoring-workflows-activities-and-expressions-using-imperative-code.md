---
title: "Vytváření pracovních postupů, aktivity a výrazy pomocí imperativní kódu"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: cefc9cfc-2882-4eb9-8c94-7a6da957f2b2
caps.latest.revision: "16"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: 1cdc4327c38de16e8ff472001622f3b25e0fe6f8
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/21/2017
---
# <a name="authoring-workflows-activities-and-expressions-using-imperative-code"></a><span data-ttu-id="1834d-102">Vytváření pracovních postupů, aktivity a výrazy pomocí imperativní kódu</span><span class="sxs-lookup"><span data-stu-id="1834d-102">Authoring Workflows, Activities, and Expressions Using Imperative Code</span></span>
<span data-ttu-id="1834d-103">Definice pracovního postupu je strom objektů nakonfigurované aktivity.</span><span class="sxs-lookup"><span data-stu-id="1834d-103">A workflow definition is a tree of configured activity objects.</span></span> <span data-ttu-id="1834d-104">Tento strom aktivity může být definováno mnoha způsoby, třeba pomocí ruční úpravě XAML nebo pomocí návrháře pracovních postupů k vytvoření XAML.</span><span class="sxs-lookup"><span data-stu-id="1834d-104">This tree of activities can be defined many ways, including by hand-editing XAML or by using the Workflow Designer to produce XAML.</span></span> <span data-ttu-id="1834d-105">Použití jazyka XAML, ale není požadavek.</span><span class="sxs-lookup"><span data-stu-id="1834d-105">Use of XAML, however, is not a requirement.</span></span> <span data-ttu-id="1834d-106">Definice pracovního postupu můžete vytvořit také prostřednictvím kódu programu.</span><span class="sxs-lookup"><span data-stu-id="1834d-106">Workflow definitions can also be created programmatically.</span></span> <span data-ttu-id="1834d-107">Toto téma obsahuje přehled vytvoření definice pracovního postupu, aktivity a výrazy pomocí kódu.</span><span class="sxs-lookup"><span data-stu-id="1834d-107">This topic provides an overview of creating workflow definitions, activities, and expressions by using code.</span></span> <span data-ttu-id="1834d-108">Příklady práci s pracovními postupy XAML pomocí kódu najdete v tématu [serializaci pracovních postupů a aktivit do a z XAML](../../../docs/framework/windows-workflow-foundation/serializing-workflows-and-activities-to-and-from-xaml.md).</span><span class="sxs-lookup"><span data-stu-id="1834d-108">For examples of working with XAML workflows using code, see [Serializing Workflows and Activities to and from XAML](../../../docs/framework/windows-workflow-foundation/serializing-workflows-and-activities-to-and-from-xaml.md).</span></span>  
  
## <a name="creating-workflow-definitions"></a><span data-ttu-id="1834d-109">Vytvoření definice pracovního postupu</span><span class="sxs-lookup"><span data-stu-id="1834d-109">Creating Workflow Definitions</span></span>  
 <span data-ttu-id="1834d-110">Definice pracovního postupu můžete vytvořit pomocí vytvoření instance instanci typu aktivity a vlastnosti aktivity objektu konfigurace.</span><span class="sxs-lookup"><span data-stu-id="1834d-110">A workflow definition can be created by instantiating an instance of an activity type and configuring the activity object’s properties.</span></span> <span data-ttu-id="1834d-111">Pro aktivity, které neobsahují podřízené aktivity můžete to provést pomocí několika řádků kódu.</span><span class="sxs-lookup"><span data-stu-id="1834d-111">For activities that do not contain child activities, this can be accomplished using a few lines of code.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#47](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#47)]  
  
> [!NOTE]
>  <span data-ttu-id="1834d-112">V příkladech v tomto tématu <xref:System.Activities.WorkflowInvoker> ke spouštění pracovních postupů ukázka.</span><span class="sxs-lookup"><span data-stu-id="1834d-112">The examples in this topic use <xref:System.Activities.WorkflowInvoker> to run the sample workflows.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="1834d-113">vyvolání pracovní postupy, předávání argumentů a různé hostování možnosti, které jsou k dispozici, najdete v části [pomocí WorkflowInvoker a WorkflowApplication](../../../docs/framework/windows-workflow-foundation/using-workflowinvoker-and-workflowapplication.md).</span><span class="sxs-lookup"><span data-stu-id="1834d-113"> invoking workflows, passing arguments, and the different hosting choices that are available, see [Using WorkflowInvoker and WorkflowApplication](../../../docs/framework/windows-workflow-foundation/using-workflowinvoker-and-workflowapplication.md).</span></span>  
  
 <span data-ttu-id="1834d-114">V tomto příkladu, pracovní postup, který se skládá z jedné <xref:System.Activities.Statements.WriteLine> vytvoření aktivity.</span><span class="sxs-lookup"><span data-stu-id="1834d-114">In this example, a workflow that consists of a single <xref:System.Activities.Statements.WriteLine> activity is created.</span></span> <span data-ttu-id="1834d-115"><xref:System.Activities.Statements.WriteLine> Aktivity <xref:System.Activities.Statements.WriteLine.Text%2A> argument je nastaven, a je volána pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="1834d-115">The <xref:System.Activities.Statements.WriteLine> activity’s <xref:System.Activities.Statements.WriteLine.Text%2A> argument is set, and the workflow is invoked.</span></span> <span data-ttu-id="1834d-116">Pokud aktivita obsahuje podřízené aktivity, je podobný metodu konstrukce.</span><span class="sxs-lookup"><span data-stu-id="1834d-116">If an activity contains child activities, the method of construction is similar.</span></span> <span data-ttu-id="1834d-117">Následující příklad používá <xref:System.Activities.Statements.Sequence> aktivity, která obsahuje dva <xref:System.Activities.Statements.WriteLine> aktivity.</span><span class="sxs-lookup"><span data-stu-id="1834d-117">The following example uses a <xref:System.Activities.Statements.Sequence> activity that contains two <xref:System.Activities.Statements.WriteLine> activities.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#48](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#48)]  
  
### <a name="using-object-initializers"></a><span data-ttu-id="1834d-118">Pomocí inicializátory objektů</span><span class="sxs-lookup"><span data-stu-id="1834d-118">Using Object Initializers</span></span>  
 <span data-ttu-id="1834d-119">V příkladech v tomto tématu použijte syntaxi inicializace objektu.</span><span class="sxs-lookup"><span data-stu-id="1834d-119">The examples in this topic use object initialization syntax.</span></span> <span data-ttu-id="1834d-120">Syntaxe inicializace objektu může být užitečný způsob, jak vytvořit definice pracovního postupu v kódu, protože poskytuje hierarchické zobrazení aktivity v pracovním postupu a znázorňuje vztah mezi aktivitami.</span><span class="sxs-lookup"><span data-stu-id="1834d-120">Object initialization syntax can be a useful way to create workflow definitions in code because it provides a hierarchical view of the activities in the workflow and shows the relationship between the activities.</span></span> <span data-ttu-id="1834d-121">Neexistuje žádný požadavek na použití syntaxe inicializace objektu při prostřednictvím kódu programu vytváření pracovních postupů.</span><span class="sxs-lookup"><span data-stu-id="1834d-121">There is no requirement to use object initialization syntax when you programmatically create workflows.</span></span> <span data-ttu-id="1834d-122">V následujícím příkladu je funkčně srovnatelný předchozí příklad.</span><span class="sxs-lookup"><span data-stu-id="1834d-122">The following example is functionally equivalent to the previous example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#49](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#49)]  
  
 [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="1834d-123">Inicializátory objektu, najdete v části [postup: inicializovat objekty bez volání konstruktoru (C# Průvodce programováním)](http://go.microsoft.com/fwlink/?LinkId=161015) a [postupy: Deklarace objektu pomocí inicializátoru objektu](http://go.microsoft.com/fwlink/?LinkId=161016).</span><span class="sxs-lookup"><span data-stu-id="1834d-123"> object initializers, see [How to: Initialize Objects without Calling a Constructor (C# Programming Guide)](http://go.microsoft.com/fwlink/?LinkId=161015) and [How to: Declare an Object by Using an Object Initializer](http://go.microsoft.com/fwlink/?LinkId=161016).</span></span>  
  
### <a name="working-with-variables-literal-values-and-expressions"></a><span data-ttu-id="1834d-124">Práce s proměnnými, literálových hodnot a výrazů</span><span class="sxs-lookup"><span data-stu-id="1834d-124">Working with Variables, Literal Values, and Expressions</span></span>  
 <span data-ttu-id="1834d-125">Při vytváření definice pracovního postupu pomocí kódu, zajímat, jaký kód spustí jako součást vytvoření definice pracovního postupu a jaký kód spustí jako součást spuštění instance pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="1834d-125">When creating a workflow definition using code, be aware of what code executes as part of the creation of the workflow definition and what code executes as part of the execution of an instance of that workflow.</span></span> <span data-ttu-id="1834d-126">Například následující pracovní postup slouží ke generování náhodné číslo a zapisuje do konzoly.</span><span class="sxs-lookup"><span data-stu-id="1834d-126">For example, the following workflow is intended to generate a random number and write it to the console.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#50](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#50)]  
  
 <span data-ttu-id="1834d-127">Při spuštění tohoto kódu definice pracovního postupu, volání `Random.Next` přišla a výsledek je uložen v definici pracovního postupu jako hodnota literálu.</span><span class="sxs-lookup"><span data-stu-id="1834d-127">When this workflow definition code is executed, the call to `Random.Next` is made and the result is stored in the workflow definition as a literal value.</span></span> <span data-ttu-id="1834d-128">Počet instancí tento pracovní postup může vyvolat, a všechny by zobrazit stejné číslo.</span><span class="sxs-lookup"><span data-stu-id="1834d-128">Many instances of this workflow can be invoked, and all would display the same number.</span></span> <span data-ttu-id="1834d-129">Tak, aby měl náhodné generování čísel, ke kterým došlo během provádění pracovního postupu, který je použit výraz vyhodnocovány pokaždé, když pracovní postup bude spuštěn.</span><span class="sxs-lookup"><span data-stu-id="1834d-129">To have the random number generation occur during workflow execution, an expression must be used that is evaluated each time the workflow runs.</span></span> <span data-ttu-id="1834d-130">V následujícím příkladu je použit výraz jazyka Visual Basic s <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601>.</span><span class="sxs-lookup"><span data-stu-id="1834d-130">In the following example, a Visual Basic expression is used with a <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601>.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#51](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#51)]  
  
 <span data-ttu-id="1834d-131">Výraz v předchozím příkladu lze také implementovat pomocí <xref:Microsoft.CSharp.Activities.CSharpValue%601> a výraz jazyka C#.</span><span class="sxs-lookup"><span data-stu-id="1834d-131">The expression in the previous example could also be implemented using a <xref:Microsoft.CSharp.Activities.CSharpValue%601> and a C# expression.</span></span>  
  
```csharp  
new Assign<int>  
{  
    To = n,  
    Value = new CSharpValue<int>("new Random().Next(1, 101)")  
}  
```  
  
 <span data-ttu-id="1834d-132">Výrazy jazyka C# musí být zkompilovány, před vyvoláním pracovního postupu, které je obsahují.</span><span class="sxs-lookup"><span data-stu-id="1834d-132">C# expressions must be compiled before the workflow containing them is invoked.</span></span> <span data-ttu-id="1834d-133">Pokud nejsou kompilovány výrazy jazyka C#, <xref:System.NotSupportedException> se vyvolá, když pracovní postup vyvolání zpráva podobná následující: `Expression Activity type 'CSharpValue`1 vyžaduje kompilace aby bylo možné spustit.</span><span class="sxs-lookup"><span data-stu-id="1834d-133">If the C# expressions are not compiled, a <xref:System.NotSupportedException> is thrown when the workflow is invoked with a message similar to the following: `Expression Activity type 'CSharpValue`1' requires compilation in order to run.</span></span>  <span data-ttu-id="1834d-134">Zkontrolujte, že pracovní postup byl zkompilován.' ve většině scénářů zahrnující pracovní postupy vytvořené v sadě Visual Studio jazyka C# jsou výrazy automaticky kompilovat, ale v některých případech, například kód pracovních postupů, musí výrazy jazyka C# ručně kompilována.</span><span class="sxs-lookup"><span data-stu-id="1834d-134">Please ensure that the workflow has been compiled.\` In most scenarios involving workflows created in Visual Studio the C# expressions are compiled automatically, but in some scenarios, such as code workflows, the C# expressions must be manually compiled.</span></span> <span data-ttu-id="1834d-135">Příklad způsob kompilace výrazy jazyka C#, naleznete v části [pomocí jazyka C# výrazy v pracovních postupech kódu](../../../docs/framework/windows-workflow-foundation/csharp-expressions.md#CodeWorkflows) části [výrazy jazyka C#](../../../docs/framework/windows-workflow-foundation/csharp-expressions.md) tématu.</span><span class="sxs-lookup"><span data-stu-id="1834d-135">For an example of how to compile C# expressions, see the [Using C# expressions in code workflows](../../../docs/framework/windows-workflow-foundation/csharp-expressions.md#CodeWorkflows) section of the [C# Expressions](../../../docs/framework/windows-workflow-foundation/csharp-expressions.md) topic.</span></span>  
  
 <span data-ttu-id="1834d-136">A <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> představuje výraz v syntaxi jazyka Visual Basic, který lze použít jako r-value ve výrazu a <xref:Microsoft.CSharp.Activities.CSharpValue%601> představuje výraz v syntaxi C#, který lze použít jako r-value ve výrazu.</span><span class="sxs-lookup"><span data-stu-id="1834d-136">A <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> represents an expression in Visual Basic syntax that can be used as an r-value in an expression, and a <xref:Microsoft.CSharp.Activities.CSharpValue%601> represents an expression in C# syntax that can be used as an r-value in an expression.</span></span> <span data-ttu-id="1834d-137">Tyto výrazy jsou vyhodnocovány pokaždé, když se spustí obsahující aktivitu.</span><span class="sxs-lookup"><span data-stu-id="1834d-137">These expressions are evaluated each time the containing activity is executed.</span></span> <span data-ttu-id="1834d-138">Výsledkem výrazu je přiřazen k proměnné pracovního postupu `n`, a tyto výsledky jsou používány na další aktivitu v pracovním postupu.</span><span class="sxs-lookup"><span data-stu-id="1834d-138">The result of the expression is assigned to the workflow variable `n`, and these results are used by the next activity in the workflow.</span></span> <span data-ttu-id="1834d-139">Pro přístup k hodnotě proměnné pracovního postupu `n` v době běhu <xref:System.Activities.ActivityContext> je vyžadován.</span><span class="sxs-lookup"><span data-stu-id="1834d-139">To access the value of the workflow variable `n` at runtime, the <xref:System.Activities.ActivityContext> is required.</span></span> <span data-ttu-id="1834d-140">To je přístupná pomocí následující výrazu lambda.</span><span class="sxs-lookup"><span data-stu-id="1834d-140">This can be accessed by using the following lambda expression.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1834d-141">Všimněte si, že jsou obě tyto kódu příklady použití jazyka C# jako programovací jazyk, ale jedna používá <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> a jeden používá <xref:Microsoft.CSharp.Activities.CSharpValue%601>.</span><span class="sxs-lookup"><span data-stu-id="1834d-141">Note that both of these code are examples are using C# as the programming language, but one uses a <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> and one uses a <xref:Microsoft.CSharp.Activities.CSharpValue%601>.</span></span> <span data-ttu-id="1834d-142"><xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601>a <xref:Microsoft.CSharp.Activities.CSharpValue%601> lze použít v projektech Visual Basic a C#.</span><span class="sxs-lookup"><span data-stu-id="1834d-142"><xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> and <xref:Microsoft.CSharp.Activities.CSharpValue%601> can be used in both Visual Basic and C# projects.</span></span> <span data-ttu-id="1834d-143">Ve výchozím nastavení výrazy, které jsou vytvořené v Návrháři pracovních postupů s jazykem hostování projektu.</span><span class="sxs-lookup"><span data-stu-id="1834d-143">By default, expressions created in the workflow designer match the language of the hosting project.</span></span> <span data-ttu-id="1834d-144">Při vytváření pracovních postupů v kódu, požadovaný jazyk je uvážení Autor pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="1834d-144">When creating workflows in code, the desired language is at the discretion of the workflow author.</span></span>  
  
 <span data-ttu-id="1834d-145">V těchto příkladech je výsledkem výrazu přiřazenou proměnné pracovního postupu `n`, a tyto výsledky jsou používány na další aktivitu v pracovním postupu.</span><span class="sxs-lookup"><span data-stu-id="1834d-145">In these examples the result of the expression is assigned to the workflow variable `n`, and these results are used by the next activity in the workflow.</span></span> <span data-ttu-id="1834d-146">Pro přístup k hodnotě proměnné pracovního postupu `n` v době běhu <xref:System.Activities.ActivityContext> je vyžadován.</span><span class="sxs-lookup"><span data-stu-id="1834d-146">To access the value of the workflow variable `n` at runtime, the <xref:System.Activities.ActivityContext> is required.</span></span> <span data-ttu-id="1834d-147">To je přístupná pomocí následující výrazu lambda.</span><span class="sxs-lookup"><span data-stu-id="1834d-147">This can be accessed by using the following lambda expression.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#52](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#52)]  
  
 [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="1834d-148">lambda – výrazy, najdete v části [výrazy Lambda (C# Průvodce programováním)](http://go.microsoft.com/fwlink/?LinkID=152436) nebo [výrazy Lambda (Visual Basic)](http://go.microsoft.com/fwlink/?LinkID=152437).</span><span class="sxs-lookup"><span data-stu-id="1834d-148"> lambda expressions, see [Lambda Expressions (C# Programming Guide)](http://go.microsoft.com/fwlink/?LinkID=152436) or [Lambda Expressions (Visual Basic)](http://go.microsoft.com/fwlink/?LinkID=152437).</span></span>  
  
 <span data-ttu-id="1834d-149">Lambda – výrazy nejsou serializovatelný do formátu XAML.</span><span class="sxs-lookup"><span data-stu-id="1834d-149">Lambda expressions are not serializable to XAML format.</span></span> <span data-ttu-id="1834d-150">Pokud se pokus o serializaci pracovního postupu s výrazy lambda, <xref:System.Activities.Expressions.LambdaSerializationException> je vyvolána s následující zprávou: "Tento pracovní postup obsahuje výrazy lambda zadaný v kódu.</span><span class="sxs-lookup"><span data-stu-id="1834d-150">If an attempt to serialize a workflow with lambda expressions is made, a <xref:System.Activities.Expressions.LambdaSerializationException> is thrown with the following message: "This workflow contains lambda expressions specified in code.</span></span> <span data-ttu-id="1834d-151">Tyto výrazy nejsou XAML serializable.</span><span class="sxs-lookup"><span data-stu-id="1834d-151">These expressions are not XAML serializable.</span></span> <span data-ttu-id="1834d-152">Aby bylo možné serializovatelný XAML pracovního postupu, použijte buď VisualBasicValue/VisualBasicReference nebo ExpressionServices.Convert(lambda).</span><span class="sxs-lookup"><span data-stu-id="1834d-152">In order to make your workflow XAML-serializable, either use VisualBasicValue/VisualBasicReference or ExpressionServices.Convert(lambda).</span></span> <span data-ttu-id="1834d-153">To bude vaše výrazy lambda výraz aktivity převést."</span><span class="sxs-lookup"><span data-stu-id="1834d-153">This will convert your lambda expressions into expression activities."</span></span> <span data-ttu-id="1834d-154">Chcete-li tento výraz kompatibilní s XAML, použijte <xref:System.Activities.Expressions.ExpressionServices> a <xref:System.Activities.Expressions.ExpressionServices.Convert%2A>, jak je znázorněno v následujícím příkladu.</span><span class="sxs-lookup"><span data-stu-id="1834d-154">To make this expression compatible with XAML, use <xref:System.Activities.Expressions.ExpressionServices> and <xref:System.Activities.Expressions.ExpressionServices.Convert%2A>, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#53](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#53)]  
  
 <span data-ttu-id="1834d-155">A <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> může také použít.</span><span class="sxs-lookup"><span data-stu-id="1834d-155">A <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> could also be used.</span></span> <span data-ttu-id="1834d-156">Všimněte si, že žádný výraz lambda je potřeba při použití výraz jazyka Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="1834d-156">Note that no lambda expression is required when using a Visual Basic expression.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#54](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#54)]  
  
 <span data-ttu-id="1834d-157">V době běhu jsou výrazy jazyka Visual Basic zkompilovat do LINQ – výrazy.</span><span class="sxs-lookup"><span data-stu-id="1834d-157">At run time, Visual Basic expressions are compiled into LINQ expressions.</span></span> <span data-ttu-id="1834d-158">V předchozích příkladech jsou serializovatelný do jazyka XAML, ale pokud serializovaných XAML slouží jako prohlížet a upravovat v Návrháři pracovních postupů pomocí <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> pro vaše výrazy.</span><span class="sxs-lookup"><span data-stu-id="1834d-158">Both of the previous examples are serializable to XAML, but if the serialized XAML is intended to be viewed and edited in the workflow designer, use <xref:Microsoft.VisualBasic.Activities.VisualBasicValue%601> for your expressions.</span></span> <span data-ttu-id="1834d-159">Pracovní postupy, které používají serializovat `ExpressionServices.Convert` lze otevřít v návrháři, ale hodnota výrazu bude prázdné.</span><span class="sxs-lookup"><span data-stu-id="1834d-159">Serialized workflows that use `ExpressionServices.Convert` can be opened in the designer, but the value of the expression will be blank.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="1834d-160">serializace pracovní postupy pro XAML, najdete v části [serializaci pracovních postupů a aktivit do a z XAML](../../../docs/framework/windows-workflow-foundation/serializing-workflows-and-activities-to-and-from-xaml.md).</span><span class="sxs-lookup"><span data-stu-id="1834d-160"> serializing workflows to XAML, see [Serializing Workflows and Activities to and from XAML](../../../docs/framework/windows-workflow-foundation/serializing-workflows-and-activities-to-and-from-xaml.md).</span></span>  
  
#### <a name="literal-expressions-and-reference-types"></a><span data-ttu-id="1834d-161">Literál výrazy a odkazové typy</span><span class="sxs-lookup"><span data-stu-id="1834d-161">Literal Expressions and Reference Types</span></span>  
 <span data-ttu-id="1834d-162">Literálové výrazy jsou reprezentována v pracovních postupech, pomocí <xref:System.Activities.Expressions.Literal%601> aktivity.</span><span class="sxs-lookup"><span data-stu-id="1834d-162">Literal expressions are represented in workflows by the <xref:System.Activities.Expressions.Literal%601> activity.</span></span> <span data-ttu-id="1834d-163">Následující <xref:System.Activities.Statements.WriteLine> aktivity jsou funkčně rovnocenné.</span><span class="sxs-lookup"><span data-stu-id="1834d-163">The following <xref:System.Activities.Statements.WriteLine> activities are functionally equivalent.</span></span>  
  
```csharp  
new WriteLine  
{  
    Text = "Hello World."  
},  
new WriteLine  
{  
    Text = new Literal<string>("Hello World.")  
}  
```  
  
 <span data-ttu-id="1834d-164">Je neplatné. k chybě při inicializaci literál výrazu s žádným typem odkaz s výjimkou <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="1834d-164">It is invalid to initialize a literal expression with any reference type except <xref:System.String>.</span></span> <span data-ttu-id="1834d-165">V následujícím příkladu se <xref:System.Activities.Statements.Assign> aktivity <xref:System.Activities.Statements.Assign.Value%2A> vlastnost je inicializována pomocí literál výrazu `List<string>`.</span><span class="sxs-lookup"><span data-stu-id="1834d-165">In the following example, an <xref:System.Activities.Statements.Assign> activity's <xref:System.Activities.Statements.Assign.Value%2A> property is initialized with a literal expression using a `List<string>`.</span></span>  
  
```csharp  
new Assign  
{  
    To = new OutArgument<List<string>>(items),  
    Value = new InArgument<List<string>>(new List<string>())  
},  
```  
  
 <span data-ttu-id="1834d-166">Když je pracovní postup obsahující této aktivity ověřit, se vrátí následující chybu ověřování: "literál podporuje pouze typy hodnot a typ neměnné System.String.</span><span class="sxs-lookup"><span data-stu-id="1834d-166">When the workflow containing this activity is validated, the following validation error is returned: "Literal only supports value types and the immutable type System.String.</span></span> <span data-ttu-id="1834d-167">Typ System.Collections.Generic.List'1[System.String] nelze použít jako literál."</span><span class="sxs-lookup"><span data-stu-id="1834d-167">The type System.Collections.Generic.List\`1[System.String] cannot be used as a literal."</span></span> <span data-ttu-id="1834d-168">Pokud je pracovní postup je vyvolána, <xref:System.Activities.InvalidWorkflowException> je vyvolána obsahující text chyby ověření.</span><span class="sxs-lookup"><span data-stu-id="1834d-168">If the workflow is invoked, an <xref:System.Activities.InvalidWorkflowException> is thrown that contains the text of the validation error.</span></span> <span data-ttu-id="1834d-169">Jedná se o chybu ověření, protože vytváření literál výrazu s odkazového typu nevytvoří novou instanci třídy typ odkazu pro každou instanci pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="1834d-169">This is a validation error because creating a literal expression with a reference type does not create a new instance of the reference type for each instance of the workflow.</span></span> <span data-ttu-id="1834d-170">To vyřešit, nahraďte literál výrazu, která vytvoří a vrátí novou instanci typu odkazu.</span><span class="sxs-lookup"><span data-stu-id="1834d-170">To resolve this, replace the literal expression with one that creates and returns a new instance of the reference type.</span></span>  
  
```csharp  
new Assign  
{  
    To = new OutArgument<List<string>>(items),  
    Value = new InArgument<List<string>>(new VisualBasicValue<List<string>>("New List(Of String)"))  
},  
```  
  
 [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="1834d-171">výrazy, najdete v části [výrazy](../../../docs/framework/windows-workflow-foundation/expressions.md).</span><span class="sxs-lookup"><span data-stu-id="1834d-171"> expressions, see [Expressions](../../../docs/framework/windows-workflow-foundation/expressions.md).</span></span>  
  
#### <a name="invoking-methods-on-objects-using-expressions-and-the-invokemethod-activity"></a><span data-ttu-id="1834d-172">Volání metod pro objekty pomocí výrazy a InvokeMethod aktivity</span><span class="sxs-lookup"><span data-stu-id="1834d-172">Invoking Methods on Objects using Expressions and the InvokeMethod Activity</span></span>  
 <span data-ttu-id="1834d-173"><xref:System.Activities.Expressions.InvokeMethod%601> Aktivity slouží k vyvolání statické a instance metody třídy v rozhraní .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="1834d-173">The <xref:System.Activities.Expressions.InvokeMethod%601> activity can be used to invoke static and instance methods of classes in the .NET Framework.</span></span> <span data-ttu-id="1834d-174">V předchozím příkladu v tomto tématu se generuje náhodné číslo, pomocí <xref:System.Random> třídy.</span><span class="sxs-lookup"><span data-stu-id="1834d-174">In a previous example in this topic, a random number was generated using the <xref:System.Random> class.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#51](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#51)]  
  
 <span data-ttu-id="1834d-175"><xref:System.Activities.Expressions.InvokeMethod%601> Aktivity také byl použit k volání <xref:System.Random.Next%2A> metodu <xref:System.Random> třídy.</span><span class="sxs-lookup"><span data-stu-id="1834d-175">The <xref:System.Activities.Expressions.InvokeMethod%601> activity could also have been used to call the <xref:System.Random.Next%2A> method of the <xref:System.Random> class.</span></span>  
  
```csharp  
new InvokeMethod<int>  
{  
    TargetObject = new InArgument<Random>(new VisualBasicValue<Random>("New Random()")),  
    MethodName = "Next",  
    Parameters =   
    {  
        new InArgument<int>(1),  
        new InArgument<int>(101)  
    },  
    Result = n  
}  
```  
  
 <span data-ttu-id="1834d-176">Vzhledem k tomu <xref:System.Random.Next%2A> není statickou metodu, instanci <xref:System.Random> třída poskytnutý <xref:System.Activities.Expressions.InvokeMethod%601.TargetObject%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="1834d-176">Since <xref:System.Random.Next%2A> is not a static method, an instance of the <xref:System.Random> class is supplied for the <xref:System.Activities.Expressions.InvokeMethod%601.TargetObject%2A> property.</span></span> <span data-ttu-id="1834d-177">V tomto příkladu je vytvořena nová instance pomocí výrazu jazyka Visual Basic, ale může také mít byla dříve vytvořili a uložené v proměnné pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="1834d-177">In this example a new instance is created using a Visual Basic expression, but it could also have been created previously and stored in a workflow variable.</span></span> <span data-ttu-id="1834d-178">V tomto příkladu je jednodušší použít <xref:System.Activities.Statements.Assign%601> aktivity místo <xref:System.Activities.Expressions.InvokeMethod%601> aktivity.</span><span class="sxs-lookup"><span data-stu-id="1834d-178">In this example, it would be simpler to use the <xref:System.Activities.Statements.Assign%601> activity instead of the <xref:System.Activities.Expressions.InvokeMethod%601> activity.</span></span> <span data-ttu-id="1834d-179">Pokud volání metody nakonec vyvolat buď <xref:System.Activities.Statements.Assign%601> nebo <xref:System.Activities.Expressions.InvokeMethod%601> aktivit je dlouho spuštěný, <xref:System.Activities.Expressions.InvokeMethod%601> má několik výhod, protože má <xref:System.Activities.Expressions.InvokeMethod%601.RunAsynchronously%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="1834d-179">If the method call ultimately invoked by either the <xref:System.Activities.Statements.Assign%601> or <xref:System.Activities.Expressions.InvokeMethod%601> activities is long running, <xref:System.Activities.Expressions.InvokeMethod%601> has an advantage since it has a <xref:System.Activities.Expressions.InvokeMethod%601.RunAsynchronously%2A> property.</span></span> <span data-ttu-id="1834d-180">Pokud je tato vlastnost nastavená na `true`, vyvolanou metodu se spustí asynchronně s ohledem na pracovním postupu.</span><span class="sxs-lookup"><span data-stu-id="1834d-180">When this property is set to `true`, the invoked method will run asynchronously with regard to the workflow.</span></span> <span data-ttu-id="1834d-181">Pokud ostatní aktivity paralelně, nebude při asynchronně spouští metodu blokován.</span><span class="sxs-lookup"><span data-stu-id="1834d-181">If other activities are in parallel, they will not be blocked while the method is asynchronously executing.</span></span> <span data-ttu-id="1834d-182">Navíc pokud metoda k vyvolání nemá žádnou návratovou hodnotu, pak <xref:System.Activities.Expressions.InvokeMethod%601> je vhodný způsob k vyvolání metody.</span><span class="sxs-lookup"><span data-stu-id="1834d-182">Also, if the method to be invoked has no return value, then <xref:System.Activities.Expressions.InvokeMethod%601> is the appropriate way to invoke the method.</span></span>  
  
## <a name="arguments-and-dynamic-activities"></a><span data-ttu-id="1834d-183">Argumenty a dynamické aktivity</span><span class="sxs-lookup"><span data-stu-id="1834d-183">Arguments and Dynamic Activities</span></span>  
 <span data-ttu-id="1834d-184">Definice pracovního postupu se vytvoří v kódu ty aktivity do strom aktivity a konfigurací všechny vlastnosti a argumenty.</span><span class="sxs-lookup"><span data-stu-id="1834d-184">A workflow definition is created in code by assembling activities into an activity tree and configuring any properties and arguments.</span></span> <span data-ttu-id="1834d-185">Mohou být vázány existující argumenty, ale nové argumenty nelze přidat do aktivity.</span><span class="sxs-lookup"><span data-stu-id="1834d-185">Existing arguments can be bound, but new arguments cannot be added to activities.</span></span> <span data-ttu-id="1834d-186">To zahrnuje předána aktivitě, kořenové argumenty pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="1834d-186">This includes workflow arguments passed to the root activity.</span></span> <span data-ttu-id="1834d-187">V imperativní kódu jsou zadané argumenty pracovního postupu jako vlastnosti na nový typ CLR, a v jazyce XAML jsou deklarovány s použitím `x:Class` a `x:Member`.</span><span class="sxs-lookup"><span data-stu-id="1834d-187">In imperative code, workflow arguments are specified as properties on a new CLR type, and in XAML they are declared by using `x:Class` and `x:Member`.</span></span> <span data-ttu-id="1834d-188">Argumenty nelze přidat, protože neexistuje žádný nový typ CLR vytvořit při vytváření definice pracovního postupu jako strom objektů v paměti.</span><span class="sxs-lookup"><span data-stu-id="1834d-188">Because there is no new CLR type created when a workflow definition is created as a tree of in-memory objects, arguments cannot be added.</span></span> <span data-ttu-id="1834d-189">Argumenty by však mohou být přidány do <xref:System.Activities.DynamicActivity>.</span><span class="sxs-lookup"><span data-stu-id="1834d-189">However, arguments can be added to a <xref:System.Activities.DynamicActivity>.</span></span> <span data-ttu-id="1834d-190">V tomto příkladu <xref:System.Activities.DynamicActivity%601> se vytvoří dva argumenty celé číslo tohoto trvá, společně se přidají a vrátí výsledek.</span><span class="sxs-lookup"><span data-stu-id="1834d-190">In this example, a <xref:System.Activities.DynamicActivity%601> is created that takes two integer arguments, adds them together, and returns the result.</span></span> <span data-ttu-id="1834d-191">A <xref:System.Activities.DynamicActivityProperty> se vytvoří pro každý argument a výsledek operace je přiřazena k <xref:System.Activities.Activity%601.Result%2A> argument <xref:System.Activities.DynamicActivity%601>.</span><span class="sxs-lookup"><span data-stu-id="1834d-191">A <xref:System.Activities.DynamicActivityProperty> is created for each argument, and the result of the operation is assigned to the <xref:System.Activities.Activity%601.Result%2A> argument of the <xref:System.Activities.DynamicActivity%601>.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#55](../../../samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#55)]  
  
 [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="1834d-192">dynamické aktivity, najdete v části [vytváření aktivitu v době běhu](../../../docs/framework/windows-workflow-foundation/creating-an-activity-at-runtime-with-dynamicactivity.md).</span><span class="sxs-lookup"><span data-stu-id="1834d-192"> dynamic activities, see [Creating an Activity at Runtime](../../../docs/framework/windows-workflow-foundation/creating-an-activity-at-runtime-with-dynamicactivity.md).</span></span>  
  
## <a name="compiled-activities"></a><span data-ttu-id="1834d-193">Kompilované aktivity</span><span class="sxs-lookup"><span data-stu-id="1834d-193">Compiled Activities</span></span>  
 <span data-ttu-id="1834d-194">Dynamické aktivity jsou jeden způsob, jak definovat aktivity, která obsahuje argumenty pomocí kódu, ale aktivity také můžete vytvořit v kódu a zkompilovat do typy.</span><span class="sxs-lookup"><span data-stu-id="1834d-194">Dynamic activities are one way to define an activity that contains arguments using code, but activities can also be created in code and compiled into types.</span></span> <span data-ttu-id="1834d-195">Které jsou odvozeny od vytvořením jednoduchého aktivity <xref:System.Activities.CodeActivity>a asynchronní aktivity, které jsou odvozeny od <xref:System.Activities.AsyncCodeActivity>.</span><span class="sxs-lookup"><span data-stu-id="1834d-195">Simple activities can be created that derive from <xref:System.Activities.CodeActivity>, and asynchronous activities that derive from <xref:System.Activities.AsyncCodeActivity>.</span></span> <span data-ttu-id="1834d-196">Tyto aktivity může mít argumenty, návratové hodnoty a definovat jejich logiku pomocí imperativní kódu.</span><span class="sxs-lookup"><span data-stu-id="1834d-196">These activities can have arguments, return values, and define their logic using imperative code.</span></span> <span data-ttu-id="1834d-197">Příklady vytváření tyto typy aktivit najdete v tématu [CodeActivity základní třída](../../../docs/framework/windows-workflow-foundation/workflow-activity-authoring-using-the-codeactivity-class.md) a [vytváření asynchronní aktivity](../../../docs/framework/windows-workflow-foundation/creating-asynchronous-activities-in-wf.md).</span><span class="sxs-lookup"><span data-stu-id="1834d-197">For examples of creating these types of activities, see [CodeActivity Base Class](../../../docs/framework/windows-workflow-foundation/workflow-activity-authoring-using-the-codeactivity-class.md) and [Creating Asynchronous Activities](../../../docs/framework/windows-workflow-foundation/creating-asynchronous-activities-in-wf.md).</span></span>  
  
 <span data-ttu-id="1834d-198">Aktivity, které jsou odvozeny od <xref:System.Activities.NativeActivity> můžete definovat jejich logiku pomocí imperativní kódu a může také obsahovat podřízené aktivity, které definují logiku.</span><span class="sxs-lookup"><span data-stu-id="1834d-198">Activities that derive from <xref:System.Activities.NativeActivity> can define their logic using imperative code and they can also contain child activities that define the logic.</span></span> <span data-ttu-id="1834d-199">Také mají plný přístup k funkcím runtime, jako je například vytváření záložky.</span><span class="sxs-lookup"><span data-stu-id="1834d-199">They also have full access to the features of the runtime such as creating bookmarks.</span></span> <span data-ttu-id="1834d-200">Příklady vytváření <xref:System.Activities.NativeActivity>– na základě aktivity, najdete v části [NativeActivity základní třída](../../../docs/framework/windows-workflow-foundation/nativeactivity-base-class.md), [postupy: vytvoření aktivity](../../../docs/framework/windows-workflow-foundation/how-to-create-an-activity.md)a [vlastní složený pomocí nativní aktivity](../../../docs/framework/windows-workflow-foundation/samples/custom-composite-using-native-activity.md)ukázka.</span><span class="sxs-lookup"><span data-stu-id="1834d-200">For examples of creating a <xref:System.Activities.NativeActivity>-based activity, see [NativeActivity Base Class](../../../docs/framework/windows-workflow-foundation/nativeactivity-base-class.md), [How to: Create an Activity](../../../docs/framework/windows-workflow-foundation/how-to-create-an-activity.md), and the [Custom Composite using Native Activity](../../../docs/framework/windows-workflow-foundation/samples/custom-composite-using-native-activity.md) sample.</span></span>  
  
 <span data-ttu-id="1834d-201">Aktivity, které jsou odvozeny od <xref:System.Activities.Activity> definovat jejich logiku výhradně prostřednictvím podřízené aktivity.</span><span class="sxs-lookup"><span data-stu-id="1834d-201">Activities that derive from <xref:System.Activities.Activity> define their logic solely through the use of child activities.</span></span> <span data-ttu-id="1834d-202">Tyto aktivity jsou obvykle vytvoří pomocí návrháře pracovních postupů, ale lze také definovat pomocí kódu.</span><span class="sxs-lookup"><span data-stu-id="1834d-202">These activities are typically created by using the workflow designer, but can also be defined by using code.</span></span> <span data-ttu-id="1834d-203">V následujícím příkladu `Square` aktivity je definována odvozenou od `Activity<int>`.</span><span class="sxs-lookup"><span data-stu-id="1834d-203">In the following example, a `Square` activity is defined that derives from `Activity<int>`.</span></span> <span data-ttu-id="1834d-204">`Square` Aktivita má jeden <xref:System.Activities.InArgument%601> s názvem `Value`a definuje svou logikou zadáním <xref:System.Activities.Statements.Sequence> aktivity pomocí <xref:System.Activities.Activity.Implementation%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="1834d-204">The `Square` activity has a single <xref:System.Activities.InArgument%601> named `Value`, and defines its logic by specifying a <xref:System.Activities.Statements.Sequence> activity using the <xref:System.Activities.Activity.Implementation%2A> property.</span></span> <span data-ttu-id="1834d-205"><xref:System.Activities.Statements.Sequence> Obsahuje aktivitu <xref:System.Activities.Statements.WriteLine> aktivity a <xref:System.Activities.Statements.Assign%601> aktivity.</span><span class="sxs-lookup"><span data-stu-id="1834d-205">The <xref:System.Activities.Statements.Sequence> activity contains a <xref:System.Activities.Statements.WriteLine> activity and an <xref:System.Activities.Statements.Assign%601> activity.</span></span> <span data-ttu-id="1834d-206">Společně tyto tři aktivity implementovat logiku `Square` aktivity.</span><span class="sxs-lookup"><span data-stu-id="1834d-206">Together, these three activities implement the logic of the `Square` activity.</span></span>  
  
```csharp  
class Square : Activity<int>  
{  
    [RequiredArgument]  
    public InArgument<int> Value { get; set; }  
  
    public Square()  
    {  
        this.Implementation = () => new Sequence  
        {  
            Activities =  
            {  
                new WriteLine  
                {  
                    Text = new InArgument<string>((env) => "Squaring the value: " + this.Value.Get(env))  
                },  
                new Assign<int>  
                {  
                    To = new OutArgument<int>((env) => this.Result.Get(env)),  
                    Value = new InArgument<int>((env) => this.Value.Get(env) * this.Value.Get(env))  
                }  
            }  
        };  
    }  
}  
```  
  
 <span data-ttu-id="1834d-207">V následujícím příkladu, definice pracovního postupu, který se skládá z jedné `Square` aktivity vyvolání pomocí <xref:System.Activities.WorkflowInvoker>.</span><span class="sxs-lookup"><span data-stu-id="1834d-207">In the following example, a workflow definition consisting of a single `Square` activity is invoked using <xref:System.Activities.WorkflowInvoker>.</span></span>  
  
```csharp  
Dictionary<string, object> inputs = new Dictionary<string, object> {{ "Value", 5}};  
int result = WorkflowInvoker.Invoke(new Square(), inputs);  
Console.WriteLine("Result: {0}", result);  
```  
  
 <span data-ttu-id="1834d-208">Po vyvolání pracovního postupu se ke konzole zobrazí následující výstup:</span><span class="sxs-lookup"><span data-stu-id="1834d-208">When the workflow is invoked, the following output is displayed to the console:</span></span>  
  
 <span data-ttu-id="1834d-209">**Umocněním hodnota: 5**</span><span class="sxs-lookup"><span data-stu-id="1834d-209">**Squaring the value: 5**</span></span>  
<span data-ttu-id="1834d-210">**Výsledek: 25**</span><span class="sxs-lookup"><span data-stu-id="1834d-210">**Result: 25**</span></span>
