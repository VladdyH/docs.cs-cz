---
title: SQLStoreExtensibility
ms.date: 03/30/2017
ms.assetid: 5da1b5a3-f144-41ba-b9c4-02818b28b15d
ms.openlocfilehash: f49d05244cf9f65a8e06f39c7e40391aaebd9f77
ms.sourcegitcommit: ad99773e5e45068ce03b99518008397e1299e0d1
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/22/2018
ms.locfileid: "46576967"
---
# <a name="sqlstoreextensibility"></a><span data-ttu-id="7fe37-102">SQLStoreExtensibility</span><span class="sxs-lookup"><span data-stu-id="7fe37-102">SQLStoreExtensibility</span></span>
<span data-ttu-id="7fe37-103">Tato ukázka demonstruje používání a konfiguraci propagované vlastnosti úložiště instancí pracovních postupů SQL.</span><span class="sxs-lookup"><span data-stu-id="7fe37-103">This sample demonstrates the use and configuration of promoted properties in the SQL workflow instance store.</span></span> <span data-ttu-id="7fe37-104">Úložiště instancí pracovních postupů SQL je založený na SQL implementace úložiště instancí.</span><span class="sxs-lookup"><span data-stu-id="7fe37-104">The SQL workflow instance store is a SQL-based implementation of an instance store.</span></span> <span data-ttu-id="7fe37-105">To umožňuje instance pro uložení stavu a načtení stavu do a z databáze systému SQL Server nebo SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="7fe37-105">It allows an instance to save its state and load its state to and from a SQL Server or SQL Server Express database.</span></span> <span data-ttu-id="7fe37-106">Funkce rozšiřitelnost úložiště umožňuje uživateli definovat vlastnosti, které jsou uloženy v úložišti instancí.</span><span class="sxs-lookup"><span data-stu-id="7fe37-106">The store extensibility feature allows the user to define properties that are stored in the instance store.</span></span> <span data-ttu-id="7fe37-107">Tyto vlastnosti jsou zobrazeny v zobrazení propagované vlastnosti, které mu umožní dotazu pro ně.</span><span class="sxs-lookup"><span data-stu-id="7fe37-107">These properties are displayed in a promoted properties view that allows the user to query for them.</span></span>  
  
 <span data-ttu-id="7fe37-108">Tento příklad se skládá z pracovní postup, který implementuje počítání služby.</span><span class="sxs-lookup"><span data-stu-id="7fe37-108">This sample consists of a workflow that implements a counting service.</span></span> <span data-ttu-id="7fe37-109">Po zavolání metody start služby služba se počítá od 0 do 29.</span><span class="sxs-lookup"><span data-stu-id="7fe37-109">Once the service's start method is invoked, the service counts from 0 to 29.</span></span> <span data-ttu-id="7fe37-110">Hodnota čítače se zvýší každé 2 sekundy.</span><span class="sxs-lookup"><span data-stu-id="7fe37-110">The counter is incremented once every 2 seconds.</span></span> <span data-ttu-id="7fe37-111">Po každé počet pracovního postupu trvá.</span><span class="sxs-lookup"><span data-stu-id="7fe37-111">After each count, the workflow persists.</span></span> <span data-ttu-id="7fe37-112">Aktuální hodnota čítače je uložen v úložišti instancí jako propagovanou vlastnost.</span><span class="sxs-lookup"><span data-stu-id="7fe37-112">The current counter value is stored in the instance store as a promoted property.</span></span>  
  
 <span data-ttu-id="7fe37-113">Počítání pracovního postupu je samoobslužně hostovaná od hostitele služby pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="7fe37-113">The Counting Workflow is self-hosted by a Workflow Service Host.</span></span> <span data-ttu-id="7fe37-114">Programu `Main` metoda provede následující akce:</span><span class="sxs-lookup"><span data-stu-id="7fe37-114">The program's `Main` method performs the following actions:</span></span>  
  
-   <span data-ttu-id="7fe37-115">Vytvoří instanci hostitele služby pracovního postupu, který je hostitelem počítání pracovního postupu a definuje koncové body, za kterých se dá kontaktovat počítání pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="7fe37-115">Creates an instance of the Workflow Service Host that hosts the Counting Workflow and defines the endpoints under which the Counting Workflow can be reached.</span></span>  
  
-   <span data-ttu-id="7fe37-116">Definuje SQL pracovního postupu instance úložiště chování, které slouží ke konfiguraci úložiště instancí pracovních postupů SQL.</span><span class="sxs-lookup"><span data-stu-id="7fe37-116">Defines a SQL workflow instance store behavior, which is used to configure the SQL workflow instance store.</span></span> <span data-ttu-id="7fe37-117">Úložiště je nastaven na považovat `CountStatus` jako propagovanou vlastnost.</span><span class="sxs-lookup"><span data-stu-id="7fe37-117">The store is instructed to treat `CountStatus` as a promoted property.</span></span>  
  
-   <span data-ttu-id="7fe37-118">Vytvoří klienta, která volá metodu start počítání pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="7fe37-118">Creates a client that calls the start method of the counting workflow.</span></span>  
  
 <span data-ttu-id="7fe37-119">Po spuštění programu čítač automaticky spustí, počítací.</span><span class="sxs-lookup"><span data-stu-id="7fe37-119">Once the program is started, the counter automatically starts counting.</span></span> <span data-ttu-id="7fe37-120">Všimněte si, že může trvat několik sekund na načtení instance a nakonfigurovat úložiště instancí pracovních postupů SQL.</span><span class="sxs-lookup"><span data-stu-id="7fe37-120">Note that it might take a few seconds to load the instance and configure the SQL workflow instance store.</span></span>  
  
 <span data-ttu-id="7fe37-121">Ke zvýšení úrovně hodnota čítače jako vlastní vlastnost, musí provést následující kroky:</span><span class="sxs-lookup"><span data-stu-id="7fe37-121">To promote the counter value as a custom property, the following steps must be taken:</span></span>  
  
1.  <span data-ttu-id="7fe37-122">Třída `CounterStatus` definuje instanci rozšíření typu <xref:System.Activities.Persistence.PersistenceParticipant>, které používají aktivity slouží k poskytování proměnné stavu.</span><span class="sxs-lookup"><span data-stu-id="7fe37-122">The class `CounterStatus` defines an instance extension of type <xref:System.Activities.Persistence.PersistenceParticipant>, which is used by activities to supply the state variables.</span></span> <span data-ttu-id="7fe37-123">`Count` je definován jako hodnotu pouze pro zápis.</span><span class="sxs-lookup"><span data-stu-id="7fe37-123">`Count` is defined as a write-only value.</span></span> <span data-ttu-id="7fe37-124">Při instance pracovního postupu se dodává s bodem trvalost, rozšíření instance uloží `Count` vlastností do kolekce dat trvalosti.</span><span class="sxs-lookup"><span data-stu-id="7fe37-124">When a workflow instance comes to a persistence point, the instance extension saves the `Count` property into the persistence data collection.</span></span>  
  
2.  <span data-ttu-id="7fe37-125">Při vytváření v úložišti instancí, novou vlastnost `CountStatus`, je definován pomocí `store.Promote()` metody.</span><span class="sxs-lookup"><span data-stu-id="7fe37-125">When creating the instance store, a new property, `CountStatus`, is defined through the `store.Promote()` method.</span></span>  
  
3.  <span data-ttu-id="7fe37-126">Pro pracovní postupy `SaveCounter` aktivity přiřadí aktuální hodnotu do proměnné čítače `Count` pole Stav.</span><span class="sxs-lookup"><span data-stu-id="7fe37-126">The workflow's `SaveCounter` activity assigns the current counter value to the `Count` status field.</span></span>  
  
### <a name="to-use-this-sample"></a><span data-ttu-id="7fe37-127">Pro fungování této ukázky</span><span class="sxs-lookup"><span data-stu-id="7fe37-127">To use this sample</span></span>  
  
1.  <span data-ttu-id="7fe37-128">Vytvoření instance databáze úložiště.</span><span class="sxs-lookup"><span data-stu-id="7fe37-128">Create the instance store database.</span></span>  
  
    1.  <span data-ttu-id="7fe37-129">Otevřít [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="7fe37-129">Open a [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] command prompt.</span></span>  
  
    2.  <span data-ttu-id="7fe37-130">Přejděte do adresáře vzorku (\WF\Basic\Persistence\SqlStoreExtensibility\CS) a spusťte CreateInstanceStore.cmd [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="7fe37-130">Navigate to the sample directory (\WF\Basic\Persistence\SqlStoreExtensibility\CS) and run CreateInstanceStore.cmd in the [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] command prompt.</span></span>  
  
        > [!WARNING]
        >  <span data-ttu-id="7fe37-131">Skript CreateInstanceStore.cmd pokusí vytvořit databázi na výchozí instanci systému SQL Server 2008 Express.</span><span class="sxs-lookup"><span data-stu-id="7fe37-131">The CreateInstanceStore.cmd script attempts to create the database on the default instance of SQL Server 2008 Express.</span></span> <span data-ttu-id="7fe37-132">Pokud chcete nainstalovat databázi na jinou instanci, upravte skript tak učinit.</span><span class="sxs-lookup"><span data-stu-id="7fe37-132">If you want to install the database on a different instance, modify the script to do so.</span></span>  
  
2.  <span data-ttu-id="7fe37-133">Otevřít [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] a načtení řešení SqlStoreExtensibility.sln a sestavte ho stisknutím kombinace kláves CTRL + SHIFT + B.</span><span class="sxs-lookup"><span data-stu-id="7fe37-133">Open [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] and load the SqlStoreExtensibility.sln solution and build it by pressing CTRL+SHIFT+B.</span></span>  
  
    > [!WARNING]
    >  <span data-ttu-id="7fe37-134">Pokud jste nainstalovali databázi na jinou než výchozí instanci systému SQL Server, aktualizujte připojovací řetězec v kódu před sestavením řešení.</span><span class="sxs-lookup"><span data-stu-id="7fe37-134">If you installed the database on a non-default instance of SQL Server, update the connection string in the code prior to building the solution.</span></span>  
  
3.  <span data-ttu-id="7fe37-135">Spusťte ukázku s oprávněními správce tak, že přejdete do adresáře bin projektu (\WF\Basic\Persistence\SqlStoreExtensibility\bin\Debug) v [!INCLUDE[fileExplorer](../../../../includes/fileexplorer-md.md)], SqlStoreExtensibility.exe pravým tlačítkem myši a vyberete **spustit jako Správce**.</span><span class="sxs-lookup"><span data-stu-id="7fe37-135">Run the sample with administrator privileges by navigating to the project’s bin directory (\WF\Basic\Persistence\SqlStoreExtensibility\bin\Debug) in [!INCLUDE[fileExplorer](../../../../includes/fileexplorer-md.md)], right-clicking SqlStoreExtensibility.exe and selecting **Run as Administrator**.</span></span>  
  
### <a name="to-verify-the-sample-is-working-correctly"></a><span data-ttu-id="7fe37-136">Chcete-li ověřit ukázku pracuje správně</span><span class="sxs-lookup"><span data-stu-id="7fe37-136">To verify the sample is working correctly</span></span>  
  
1.  <span data-ttu-id="7fe37-137">Pomocí SQL Server Management Studio zobrazíte obsah tabulky instance tak, že vyberete **databází**, **třídy InstanceStore**a potom  **System.ServiceModel.Activities.DurableInstancing.InstanceTable** v Průzkumníku objektů klikněte pravým tlačítkem na **System.ServiceModel.Activities.DurableInstancing.InstanceTable** a vyberte  **Vybrat prvních 1 000 řádků**.</span><span class="sxs-lookup"><span data-stu-id="7fe37-137">Use SQL Server Management Studio to view the contents of the instance table by selecting **Databases**, **InstanceStore**, and then **System.ServiceModel.Activities.DurableInstancing.InstanceTable** in the Object Explorer, right-click **System.ServiceModel.Activities.DurableInstancing.InstanceTable** and select **Select Top 1000 Rows**.</span></span> <span data-ttu-id="7fe37-138">Další informace o nástroji SQL Server Management Studio najdete v tématu [Představujeme SQL Server Management Studio](https://go.microsoft.com/fwlink/?LinkId=165645)</span><span class="sxs-lookup"><span data-stu-id="7fe37-138">For more information about SQL Server Management Studio, see [Introducing SQL Server Management Studio](https://go.microsoft.com/fwlink/?LinkId=165645)</span></span>  
  
2.  <span data-ttu-id="7fe37-139">Sledujte instancí pracovních postupů, které jsou uvedeny.</span><span class="sxs-lookup"><span data-stu-id="7fe37-139">Observe the workflow instances listed.</span></span>  
  
3.  <span data-ttu-id="7fe37-140">V [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] příkazového řádku, spusťte skript QueryInstanceStore.cmd nachází v adresáři ukázkové (\WF\Basic\Persistence\SqlStoreExtensibility).</span><span class="sxs-lookup"><span data-stu-id="7fe37-140">In a [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] command prompt, run the QueryInstanceStore.cmd script located in the sample directory (\WF\Basic\Persistence\SqlStoreExtensibility).</span></span>  
  
4.  <span data-ttu-id="7fe37-141">Podívejte se hodnota čítače se zobrazí v části **CountStatus**.</span><span class="sxs-lookup"><span data-stu-id="7fe37-141">Observe the counter value displayed under **CountStatus**.</span></span>  
  
5.  <span data-ttu-id="7fe37-142">Spusťte skript několikrát zobrazíte **CountStats** hodnotu změnit.</span><span class="sxs-lookup"><span data-stu-id="7fe37-142">Run the script a few times to see the **CountStats** value change.</span></span>  
  
6.  <span data-ttu-id="7fe37-143">Stiskněte klávesu ENTER k ukončení aplikace pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="7fe37-143">Press ENTER to terminate the workflow application.</span></span>  
  
### <a name="to-uninstall-the-sample"></a><span data-ttu-id="7fe37-144">Chcete-li odinstalovat vzorku</span><span class="sxs-lookup"><span data-stu-id="7fe37-144">To uninstall the sample</span></span>  
  
1.  <span data-ttu-id="7fe37-145">Odeberte instanci databáze úložiště spuštěním skriptu RemoveInstanceStore.cmd nachází v adresáři ukázkové (\WF\Basic\Persistence\SqlStoreExtensibility).</span><span class="sxs-lookup"><span data-stu-id="7fe37-145">Remove the instance store database by running the RemoveInstanceStore.cmd script located in the sample directory (\WF\Basic\Persistence\SqlStoreExtensibility).</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="7fe37-146">Vzorky mohou již být nainstalováno na svém počítači.</span><span class="sxs-lookup"><span data-stu-id="7fe37-146">The samples may already be installed on your machine.</span></span> <span data-ttu-id="7fe37-147">Před pokračováním zkontrolujte následující adresář (výchozí).</span><span class="sxs-lookup"><span data-stu-id="7fe37-147">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="7fe37-148">Pokud tento adresář neexistuje, přejděte na [Windows Communication Foundation (WCF) a ukázky Windows Workflow Foundation (WF) pro rozhraní .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) stáhnout všechny Windows Communication Foundation (WCF) a [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ukázky.</span><span class="sxs-lookup"><span data-stu-id="7fe37-148">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="7fe37-149">Tato ukázka se nachází v následujícím adresáři.</span><span class="sxs-lookup"><span data-stu-id="7fe37-149">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Basic\Persistence\SQLStoreExtensibility`  
  
## <a name="see-also"></a><span data-ttu-id="7fe37-150">Viz také</span><span class="sxs-lookup"><span data-stu-id="7fe37-150">See Also</span></span>  
 [<span data-ttu-id="7fe37-151">Trvalost pracovního postupu</span><span class="sxs-lookup"><span data-stu-id="7fe37-151">Workflow Persistence</span></span>](../../../../docs/framework/windows-workflow-foundation/workflow-persistence.md)  
 [<span data-ttu-id="7fe37-152">Služby pracovních postupů</span><span class="sxs-lookup"><span data-stu-id="7fe37-152">Workflow Services</span></span>](../../../../docs/framework/wcf/feature-details/workflow-services.md)  
 [<span data-ttu-id="7fe37-153">Hostování AppFabric a ukázky trvalosti</span><span class="sxs-lookup"><span data-stu-id="7fe37-153">AppFabric Hosting and Persistence Samples</span></span>](https://go.microsoft.com/fwlink/?LinkId=193961)
