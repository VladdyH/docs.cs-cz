---
title: Zpracované fronty
ms.date: 03/30/2017
ms.assetid: b1b011dd-5e0b-482c-9bb0-9d8727038f14
ms.openlocfilehash: b125158a113079d87eb6926393d5a2b5fe326824
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/04/2018
ms.locfileid: "33519678"
---
# <a name="transacted-queues"></a><span data-ttu-id="f8ee3-102">Zpracované fronty</span><span class="sxs-lookup"><span data-stu-id="f8ee3-102">Transacted Queues</span></span>
<span data-ttu-id="f8ee3-103">Tento příklad ukazuje, jak integrovat front a transakce ve Windows Workflow Foundation (WF) k vytvoření služby spolehlivou a škálovatelnou.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-103">This sample shows how to integrate queues and transactions in Windows Workflow Foundation (WF) to create reliable and scalable services.</span></span> <span data-ttu-id="f8ee3-104">A <!--zz <xref:System.Activities.TransactionScope>--> `System.Activities.TransactionScope` se v pracovním postupu klienta používá k odeslání zprávy do fronty v transakci pomocí <xref:System.ServiceModel.NetMsmqBinding>.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-104">A <!--zz <xref:System.Activities.TransactionScope>--> `System.Activities.TransactionScope` is used in the client workflow to send message to a queue under a transaction using the <xref:System.ServiceModel.NetMsmqBinding>.</span></span> <span data-ttu-id="f8ee3-105">A <xref:System.ServiceModel.Activities.TransactedReceiveScope> se používá na serveru pro příjem zpráv z fronty a aktualizovat stav pracovního postupu ve stejné transakci.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-105">A <xref:System.ServiceModel.Activities.TransactedReceiveScope> is used on the server to receive messages from the queue and update the state of the workflow under the same transaction.</span></span>  
  
## <a name="demonstrates"></a><span data-ttu-id="f8ee3-106">Demonstruje</span><span class="sxs-lookup"><span data-stu-id="f8ee3-106">Demonstrates</span></span>  
 <span data-ttu-id="f8ee3-107"><xref:System.Activities.Statements.TransactionScope>, <xref:System.ServiceModel.Activities.TransactedReceiveScope>, <xref:System.ServiceModel.NetMsmqBinding>, <xref:System.ServiceModel.Activities.Receive>a na základě obsahu korelace.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-107"><xref:System.Activities.Statements.TransactionScope>, <xref:System.ServiceModel.Activities.TransactedReceiveScope>, <xref:System.ServiceModel.NetMsmqBinding>, <xref:System.ServiceModel.Activities.Receive>, and content-based correlation.</span></span>  
  
## <a name="discussion"></a><span data-ttu-id="f8ee3-108">Diskusní</span><span class="sxs-lookup"><span data-stu-id="f8ee3-108">Discussion</span></span>  
 <span data-ttu-id="f8ee3-109">K předvedení funkcí zahrnuté v této ukázce `RewardsPoints` vytvoření služby pracovního postupu, která uchovává informace o body vytvořené a použít pro daný účet.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-109">To demonstrate the features covered in this sample, a `RewardsPoints` workflow service is created, which keeps track of the points earned and used for a given account.</span></span> <span data-ttu-id="f8ee3-110">Klient použije <xref:System.Activities.WorkflowInvoker> k simulaci publikování různé požadavky do fronty.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-110">The client uses <xref:System.Activities.WorkflowInvoker> to simulate posting various requests to the queue.</span></span> <span data-ttu-id="f8ee3-111">Vytvořit zprávu do fronty v rámci transakce, <xref:System.ServiceModel.Activities.Send> aktivity může být umístěna uvnitř <xref:System.Activities.Statements.TransactionScope.Body%2A> z <xref:System.Activities.Statements.TransactionScope>.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-111">To post a message to the queue under a transaction, the <xref:System.ServiceModel.Activities.Send> activity can be placed inside the <xref:System.Activities.Statements.TransactionScope.Body%2A> of a <xref:System.Activities.Statements.TransactionScope>.</span></span> <span data-ttu-id="f8ee3-112">V této ukázce klient spouští první, za nímž následuje serveru, a ukazují, jak ve frontě zpráv můžete oddělit klientské a serverové aplikace.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-112">In this sample, the client runs first, followed by the server, to demonstrate how queued messages can decouple the client and server applications.</span></span>  
  
 <span data-ttu-id="f8ee3-113">Po dokončení klienta služby je nakonfigurovaná a je hostovaná.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-113">Once the client completes, the service is configured and hosted.</span></span> <span data-ttu-id="f8ee3-114">Jakmile se otevře, začne zpracování zprávy, které již byly umístěny do fronty.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-114">As soon as it opens, it starts processing the messages that have already been placed in the queue.</span></span> <span data-ttu-id="f8ee3-115">Každou zprávu přijme a zpracuje ve stejné transakci serveru.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-115">Each message is received and processed under the same server transaction.</span></span> <span data-ttu-id="f8ee3-116">V této ukázce je první přijaté zprávy `CreateAccount` požadavek, který vytvoří instanci a inicializuje obsahu korelace na základě názvu účtu předanou v rámci zprávu požadavku.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-116">In this sample, the first message received is a `CreateAccount` request that creates the instance and initializes the content correlation based on the account name passed as part of the request message.</span></span> <span data-ttu-id="f8ee3-117">Modelování druh služby by se dalo očekávat v reálném světě se následující dva <xref:System.ServiceModel.Activities.TransactedReceiveScope> aktivity, které zpracovávají `AddPoints` a `UsePoints` zpráv ukládány do paralelních větvích v rámci `while` cykly, aby se mohl zpracovávat tyto zprávy opakovaně v libovolném pořadí.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-117">To model the kind of service you might expect in the real world, the following two <xref:System.ServiceModel.Activities.TransactedReceiveScope> activities that process the `AddPoints` and `UsePoints` messages are placed in parallel branches within a `while` loop so that they can process these messages repeatedly in any order.</span></span>  
  
 <span data-ttu-id="f8ee3-118"><xref:System.Activities.Statements.TransactionScope> a <xref:System.ServiceModel.Activities.TransactedReceiveScope> mají bod implicitní trvalost na konci jejich obory, takže pomocí těchto aktivit v [!INCLUDE[wf1](../../../../includes/wf1-md.md)] v kombinaci s front je spolehlivý způsob, jak přesunout z jeden konzistentní stav pracovní postup na další, a zajistit, aby se zprávy nikdy ztratit.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-118"><xref:System.Activities.Statements.TransactionScope> and <xref:System.ServiceModel.Activities.TransactedReceiveScope> each have an implicit persistence point at the end of their scopes, so using these activities in [!INCLUDE[wf1](../../../../includes/wf1-md.md)] combined with queues is a reliable way to move your workflow from one consistent state to the next, while ensuring that messages are never lost.</span></span>  
  
#### <a name="to-set-up-build-and-run-the-sample"></a><span data-ttu-id="f8ee3-119">Pokud chcete nastavit, sestavit a spustit ukázku</span><span class="sxs-lookup"><span data-stu-id="f8ee3-119">To set up, build, and run the sample</span></span>  
  
1.  <span data-ttu-id="f8ee3-120">Instalace a konfigurace služby MSMQ.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-120">Install and configure MSMQ.</span></span> <span data-ttu-id="f8ee3-121">V tématu [instalaci služby Řízení front zpráv](http://go.microsoft.com/fwlink/?LinkId=178526) podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-121">See [Installing Message Queuing](http://go.microsoft.com/fwlink/?LinkId=178526) for details.</span></span>  
  
2.  <span data-ttu-id="f8ee3-122">Ujistěte se, zda je spuštěna služba MSDTC spuštěním následujícího příkazu na příkazovém řádku.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-122">Ensure that MSDTC is running by executing the following command on a command line.</span></span> `net start msdtc`  
  
3.  <span data-ttu-id="f8ee3-123">Kompilace projektu a otevřete spustitelný soubor nebo otevřete projekt ve [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] a vyberte možnost spustit z nabídky ladění.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-123">Compile the project and open the executable, or open the project in [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)] and select a start option from the debug menu.</span></span> <span data-ttu-id="f8ee3-124">Nejprve je vytvářena fronta, pak klient spustí a odešle zprávy do fronty a nakonec spuštění služby a zpracování zprávy.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-124">First, the queue is created, then the client runs and posts messages to the queue, and finally the service starts and the messages are processed.</span></span> <span data-ttu-id="f8ee3-125">Chcete-li program ukončit, stiskněte klávesu ENTER.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-125">To exit the program, press ENTER.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="f8ee3-126">Ukázky může být již nainstalována na váš počítač.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-126">The samples may already be installed on your machine.</span></span> <span data-ttu-id="f8ee3-127">Před pokračováním zkontrolovat na následující adresář (výchozí).</span><span class="sxs-lookup"><span data-stu-id="f8ee3-127">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="f8ee3-128">Pokud tento adresář neexistuje, přejděte na [Windows Communication Foundation (WCF) a ukázky Windows Workflow Foundation (WF) pro rozhraní .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) ke stažení všechny Windows Communication Foundation (WCF) a [!INCLUDE[wf1](../../../../includes/wf1-md.md)] ukázky.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-128">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="f8ee3-129">Tato ukázka se nachází v následujícím adresáři.</span><span class="sxs-lookup"><span data-stu-id="f8ee3-129">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Scenario\Transactions\TransactedQueues`
