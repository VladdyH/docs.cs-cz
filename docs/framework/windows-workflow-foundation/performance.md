---
title: Výkon systému Windows Workflow Foundation 4
ms.date: 03/30/2017
ms.assetid: 67d2b3e8-3777-49f8-9084-abbb33b5a766
ms.openlocfilehash: 5d532cab71dacd4669435ff5afbafb53744953dd
ms.sourcegitcommit: 15109844229ade1c6449f48f3834db1b26907824
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/07/2018
ms.locfileid: "33808722"
---
# <a name="windows-workflow-foundation-4-performance"></a><span data-ttu-id="5150e-102">Výkon systému Windows Workflow Foundation 4</span><span class="sxs-lookup"><span data-stu-id="5150e-102">Windows Workflow Foundation 4 Performance</span></span>
<span data-ttu-id="5150e-103">Dustinu Metzgar</span><span class="sxs-lookup"><span data-stu-id="5150e-103">Dustin Metzgar</span></span>  
  
 <span data-ttu-id="5150e-104">Wenlong Dong</span><span class="sxs-lookup"><span data-stu-id="5150e-104">Wenlong Dong</span></span>  
  
 <span data-ttu-id="5150e-105">V září roku 2010 Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="5150e-105">Microsoft Corporation, September 2010</span></span>  
  
 <span data-ttu-id="5150e-106">Microsoft [!INCLUDE[netfx40_long](../../../includes/netfx40-long-md.md)] obsahuje hlavní revizi Windows Workflow Foundation (WF) s velkou investic ve výkonu.</span><span class="sxs-lookup"><span data-stu-id="5150e-106">Microsoft [!INCLUDE[netfx40_long](../../../includes/netfx40-long-md.md)] includes a major revision of the Windows Workflow Foundation (WF) with heavy investments in performance.</span></span>  <span data-ttu-id="5150e-107">Tato nová revize představuje významné návrhu změny z předchozích verzí [!INCLUDE[wf1](../../../includes/wf1-md.md)] dodávané jako součást rozhraní .NET Framework 3.0 a [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5150e-107">This new revision introduces significant design changes from the previous versions of [!INCLUDE[wf1](../../../includes/wf1-md.md)] that shipped as part of .NET Framework 3.0 and [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)].</span></span> <span data-ttu-id="5150e-108">Byla přepracována ze základní programovací model, modulu runtime a nástrojů výrazně zlepšit výkon a použitelnost.</span><span class="sxs-lookup"><span data-stu-id="5150e-108">It has been re-architected from the core of the programming model, runtime, and tooling to greatly improve performance and usability.</span></span> <span data-ttu-id="5150e-109">Toto téma ukazuje důležité výkonové charakteristiky tyto revize a porovná je s ohledem na předchozí verzi.</span><span class="sxs-lookup"><span data-stu-id="5150e-109">This topic shows the important performance characteristics of these revisions and compares them against those of the previous version.</span></span>  
  
 <span data-ttu-id="5150e-110">Výkon součásti jednotlivé pracovní postup se zvýšila pořadí podle velikosti mezi WF3 a WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-110">Individual workflow component performance has increased by orders of magnitude between WF3 and WF4.</span></span>  <span data-ttu-id="5150e-111">Zůstane mezery mezi zakódovaným na straně služby Windows Communication Foundation (WCF) a služby WCF pracovního postupu poměrně malý.</span><span class="sxs-lookup"><span data-stu-id="5150e-111">This leaves the gap between hand-coded Windows Communication Foundation (WCF) services and WCF workflow services to be quite small.</span></span>  <span data-ttu-id="5150e-112">Latence pracovního postupu byla výrazně snižuje v WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-112">Workflow latency has been significantly reduced in WF4.</span></span>  <span data-ttu-id="5150e-113">Trvalost výkonu zvýšilo faktorem 2.5 3.0.</span><span class="sxs-lookup"><span data-stu-id="5150e-113">Persistence performance has increased by a factor of 2.5 - 3.0.</span></span>  <span data-ttu-id="5150e-114">Monitorování stavu prostřednictvím pracovního postupu pro sledování má výrazně menší režijní náklady.</span><span class="sxs-lookup"><span data-stu-id="5150e-114">Health monitoring by means of workflow tracking has significantly less overhead.</span></span>  <span data-ttu-id="5150e-115">Tyto jsou přesvědčivé migraci na nebo přijmout WF4 ve svých aplikacích.</span><span class="sxs-lookup"><span data-stu-id="5150e-115">These are compelling reasons to migrate to or adopt WF4 in your applications.</span></span>  
  
## <a name="terminology"></a><span data-ttu-id="5150e-116">Terminologie</span><span class="sxs-lookup"><span data-stu-id="5150e-116">Terminology</span></span>  
 <span data-ttu-id="5150e-117">Verze [!INCLUDE[wf1](../../../includes/wf1-md.md)] byla zavedená v [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)] budeme ho označovat jako WF4 pro zbývající část tohoto tématu.</span><span class="sxs-lookup"><span data-stu-id="5150e-117">The version of [!INCLUDE[wf1](../../../includes/wf1-md.md)] introduced in [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)] will be referred to as WF4 for the rest of this topic.</span></span>  [!INCLUDE[wf1](../../../includes/wf1-md.md)]<span data-ttu-id="5150e-118"> bylo zavedeno v rozhraní .net 3.0 a měl několik menších revize prostřednictvím [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] SP1.</span><span class="sxs-lookup"><span data-stu-id="5150e-118"> was introduced in .Net 3.0 and had a few minor revisions through [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] SP1.</span></span> <span data-ttu-id="5150e-119">[!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] Verzi Workflow Foundation budeme ho označovat jako WF3 pro zbývající část tohoto tématu.</span><span class="sxs-lookup"><span data-stu-id="5150e-119">The [!INCLUDE[netfx35_short](../../../includes/netfx35-short-md.md)] version of Workflow Foundation will be referred to as WF3 for the rest of this topic.</span></span> <span data-ttu-id="5150e-120">WF3 se dodává v [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)] -souběžného s WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-120">WF3 is shipped in [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)] side-by-side with WF4.</span></span> <span data-ttu-id="5150e-121">Další informace o migraci artefaktů WF3 a WF4 v tématu: [příručka k migraci 4 Windows Workflow Foundation](http://go.microsoft.com/fwlink/?LinkID=153313)</span><span class="sxs-lookup"><span data-stu-id="5150e-121">For more information about migrating WF3 artifacts to WF4 see: [Windows Workflow Foundation 4 Migration Guide](http://go.microsoft.com/fwlink/?LinkID=153313)</span></span>  
  
 <span data-ttu-id="5150e-122">Windows Communication Foundation (WCF) je jednotný programovací model pro vytváření aplikací orientovaných na služby společnosti Microsoft.</span><span class="sxs-lookup"><span data-stu-id="5150e-122">Windows Communication Foundation (WCF) is Microsoft’s unified programming model for building service-oriented applications.</span></span> <span data-ttu-id="5150e-123">To bylo poprvé dostupné v rámci rozhraní .net 3.0 společně s WF3 a nyní je jedním z klíčových součástí [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5150e-123">It was first introduced as part of .Net 3.0 together with WF3 and now is one of the key components of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span></span>  
  
 <span data-ttu-id="5150e-124">Windows Server AppFabric je sada integrovaných technologií, které usnadňují sestavování, škálování a správu webových a kompozitních aplikací, které běží ve službě IIS.</span><span class="sxs-lookup"><span data-stu-id="5150e-124">Windows Server AppFabric is a set of integrated technologies that make it easier to build, scale and manage Web and composite applications that run on IIS.</span></span> <span data-ttu-id="5150e-125">Poskytuje nástroje pro sledování a správu služeb a pracovních postupů.</span><span class="sxs-lookup"><span data-stu-id="5150e-125">It provides tools for monitoring and managing services and workflows.</span></span> <span data-ttu-id="5150e-126">Další informace najdete v tématu [Windows Server AppFabric](http://msdn.microsoft.com/windowsserver/ee695849.aspx)</span><span class="sxs-lookup"><span data-stu-id="5150e-126">For more information, see [Windows Server AppFabric](http://msdn.microsoft.com/windowsserver/ee695849.aspx)</span></span>  
  
## <a name="goals"></a><span data-ttu-id="5150e-127">Cíle</span><span class="sxs-lookup"><span data-stu-id="5150e-127">Goals</span></span>  
 <span data-ttu-id="5150e-128">Cílem tohoto tématu je zobrazit charakteristiky výkonu už WF4 s daty měří pro různé scénáře.</span><span class="sxs-lookup"><span data-stu-id="5150e-128">The goal of this topic is to show the performance characteristics of WF4 with data measured for different scenarios.</span></span> <span data-ttu-id="5150e-129">Také poskytuje podrobné porovnání mezi WF4 a WF3 a proto zobrazí velký vylepšení, které byly provedeny v této nové revize.</span><span class="sxs-lookup"><span data-stu-id="5150e-129">It also provides detailed comparisons between WF4 and WF3, and thus shows the great improvements that have been made in this new revision.</span></span> <span data-ttu-id="5150e-130">Scénáře a data uvedená v tomto článku vyčíslení základní náklady na různých aspektů WF4 a WF3.</span><span class="sxs-lookup"><span data-stu-id="5150e-130">The scenarios and data presented in this article quantify the underlying cost of different aspects of WF4 and WF3.</span></span> <span data-ttu-id="5150e-131">Tato data jsou užitečné porozumět charakteristiky výkonu už WF4 a mohou být užitečné při plánování migrace z WF3 do WF4 nebo pomocí WF4 při vývoji aplikace.</span><span class="sxs-lookup"><span data-stu-id="5150e-131">This data is useful in understanding the performance characteristics of WF4 and can be helpful in planning migrations from WF3 to WF4 or using WF4 in application development.</span></span> <span data-ttu-id="5150e-132">Nicméně mělo dbát v závěry z data uvedená v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="5150e-132">However, care should be taken in the conclusions drawn from the data presented in this article.</span></span> <span data-ttu-id="5150e-133">Výkon aplikace složené pracovního postupu je vysoce závisí na tom, jak je implementována pracovního postupu a jak různé součásti jsou integrované.</span><span class="sxs-lookup"><span data-stu-id="5150e-133">The performance of a composite workflow application is highly dependent on how the workflow is implemented and how different components are integrated.</span></span> <span data-ttu-id="5150e-134">Jeden musí měřit každá aplikace k určení výkonové charakteristiky této aplikace.</span><span class="sxs-lookup"><span data-stu-id="5150e-134">One must measure each application to determine the performance characteristics of that application.</span></span>  
  
## <a name="overview-of-wf4-performance-enhancements"></a><span data-ttu-id="5150e-135">Přehled WF4 vylepšení výkonu</span><span class="sxs-lookup"><span data-stu-id="5150e-135">Overview of WF4 Performance Enhancements</span></span>  
 <span data-ttu-id="5150e-136">WF4 pečlivě byl navržen a implementuje pomocí vysoký výkon a škálovatelnost, které jsou popsané v následujících částech.</span><span class="sxs-lookup"><span data-stu-id="5150e-136">WF4 was carefully designed and implemented with high performance and scalability which are described in the following sections.</span></span>  
  
### <a name="wf-runtime"></a><span data-ttu-id="5150e-137">Modul Runtime pracovního postupu</span><span class="sxs-lookup"><span data-stu-id="5150e-137">WF Runtime</span></span>  
 <span data-ttu-id="5150e-138">Základem [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime je asynchronní Plánovač, který řídí provádění aktivity v pracovním postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-138">At the core of the [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime is an asynchronous scheduler that drives the execution of the activities in a workflow.</span></span> <span data-ttu-id="5150e-139">Poskytuje původce, předvídatelný spuštění prostředí pro aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-139">It provides a performant, predictable execution environment for activities.</span></span> <span data-ttu-id="5150e-140">Prostředí má kontraktu dobře definovaný pro spuštění, pokračování, dokončení, zrušení, výjimky a předvídatelný model vláken.</span><span class="sxs-lookup"><span data-stu-id="5150e-140">The environment has a well-defined contract for execution, continuation, completion, cancellation, exceptions, and a predictable threading model.</span></span>  
  
 <span data-ttu-id="5150e-141">Oproti WF3 má modul runtime WF4 efektivnější plánovače.</span><span class="sxs-lookup"><span data-stu-id="5150e-141">In comparison to WF3, the WF4 runtime has a more efficient scheduler.</span></span> <span data-ttu-id="5150e-142">Využívá stejný fond vláken vstupně-výstupních operací, který se používá pro WCF, což je velmi efektivní i při provádění dávkové pracovní položky.</span><span class="sxs-lookup"><span data-stu-id="5150e-142">It leverages the same I/O thread pool that is used for WCF, which is very efficient at executing batched work items.</span></span> <span data-ttu-id="5150e-143">Fronta plánovače interní pracovních položek je optimalizovaná pro nejběžnější vzorce používání.</span><span class="sxs-lookup"><span data-stu-id="5150e-143">The internal work item scheduler queue is optimized for most common usage patterns.</span></span> <span data-ttu-id="5150e-144">Modul runtime WF4 také spravuje stavy provádění způsobem, velmi šedé – s minimálním synchronizace a zpracování logiku, zatímco WF3 závisí na události zobrazené – registrace a volání provádět komplexní synchronizace přechodů mezi stavy událostí.</span><span class="sxs-lookup"><span data-stu-id="5150e-144">The WF4 runtime also manages the execution states in a very light-weight way with minimal synchronization and event handling logic, while WF3 depends on heavy-weight event registration and invocation to perform complex synchronization for state transitions.</span></span>  
  
### <a name="data-storage-and-flow"></a><span data-ttu-id="5150e-145">Úložiště dat a toku</span><span class="sxs-lookup"><span data-stu-id="5150e-145">Data Storage and Flow</span></span>  
 <span data-ttu-id="5150e-146">V WF3, se data přidružená k aktivitě s modelováním pomocí vlastností závislostí implementované typ <xref:System.Windows.DependencyProperty>.</span><span class="sxs-lookup"><span data-stu-id="5150e-146">In WF3, data associated with an activity is modeled through dependency properties implemented by the type <xref:System.Windows.DependencyProperty>.</span></span> <span data-ttu-id="5150e-147">Vzor vlastnost závislosti byla zavedena v systému Windows Presentation Foundation (WPF).</span><span class="sxs-lookup"><span data-stu-id="5150e-147">The dependency property pattern was introduced in Windows Presentation Foundation (WPF).</span></span> <span data-ttu-id="5150e-148">Tento vzor je obecně velmi flexibilní podporu snadno datové vazby a dalších funkcí uživatelského rozhraní.</span><span class="sxs-lookup"><span data-stu-id="5150e-148">In general, this pattern is very flexible to support easy data binding and other UI features.</span></span> <span data-ttu-id="5150e-149">Vzor však vyžaduje vlastnosti, které chcete definovat jako statických polí v definici pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-149">However, the pattern requires the properties to be defined as static fields in the workflow definition.</span></span> <span data-ttu-id="5150e-150">Vždy, když [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime Nastaví nebo získá hodnoty vlastností, se týká logiku výraznou vážené hledání.</span><span class="sxs-lookup"><span data-stu-id="5150e-150">Whenever the [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime sets or gets the property values, it involves heavily-weighted look-up logic.</span></span>  
  
 <span data-ttu-id="5150e-151">WF4 používá vymazat data rozsahu logiku k výraznému zlepšení zpracování dat v pracovním postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-151">WF4 uses clear data scoping logic to greatly improve how data is handled in a workflow.</span></span> <span data-ttu-id="5150e-152">Ji odděluje data uložená v aktivitě z data, která je předávaných napříč hranicemi aktivity pomocí dvou různých koncepty: proměnné a argumenty.</span><span class="sxs-lookup"><span data-stu-id="5150e-152">It separates the data stored in an activity from the data that is flowing across the activity boundaries by using two different concepts: variables and arguments.</span></span> <span data-ttu-id="5150e-153">Pomocí zrušte hierarchické obor pro proměnné a argumenty "V/Out nebo InOut" je výrazně snížit složitost dat využití pro aktivity a doba platnosti dat je také automaticky obor.</span><span class="sxs-lookup"><span data-stu-id="5150e-153">By using a clear hierarchical scope for variables and "In/Out/InOut" arguments, the data usage complexity for activities is dramatically reduced and the lifetime of the data is also automatically scoped.</span></span> <span data-ttu-id="5150e-154">Aktivity mají dobře definovaný podpis popsaného její argumenty.</span><span class="sxs-lookup"><span data-stu-id="5150e-154">Activities have a well-defined signature described by its arguments.</span></span> <span data-ttu-id="5150e-155">Jednoduše zkontrolováním aktivitu můžete určit, jaká data se očekává, že pro příjem a jaká data budou vytvořeny ho jako výsledek jeho spuštění.</span><span class="sxs-lookup"><span data-stu-id="5150e-155">By simply inspecting an activity you can determine what data it expects to receive and what data will be produced by it as the result of its execution.</span></span>  
  
 <span data-ttu-id="5150e-156">V WF3 aktivity byly inicializovány při vytvoření pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-156">In WF3 activities were initialized when a workflow was created.</span></span> <span data-ttu-id="5150e-157">4 WF se inicializují aktivity jenom v případě, že jsou prováděny odpovídající aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-157">In WF 4 activities are initialized only when the corresponding activities are executing.</span></span> <span data-ttu-id="5150e-158">To umožňuje jednodušší životního cyklu aktivity bez provádění operací inicializovat/Uninitialize, když se vytvoří novou instanci pracovního postupu a proto má dosáhnout další efektivitu</span><span class="sxs-lookup"><span data-stu-id="5150e-158">This allows a simpler activity lifecycle without performing Initialize/Uninitialize operations when a new workflow instance is created, and thus has achieved more efficiency</span></span>  
  
### <a name="control-flow"></a><span data-ttu-id="5150e-159">Tok řízení</span><span class="sxs-lookup"><span data-stu-id="5150e-159">Control Flow</span></span>  
 <span data-ttu-id="5150e-160">Jako v případě žádný programovací jazyk [!INCLUDE[wf1](../../../includes/wf1-md.md)] poskytuje podporu pro ovládací prvek toky definice pracovního postupu zavedením sadu aktivity toku řízení pro pořadí, ve smyčce, větvení a další.</span><span class="sxs-lookup"><span data-stu-id="5150e-160">Just as in any programming language, [!INCLUDE[wf1](../../../includes/wf1-md.md)] provides support for control flows for workflow definitions by introducing a set of control flow activities for sequencing, looping, branching and other patterns.</span></span> <span data-ttu-id="5150e-161">V WF3, pokud se stejná aktivita je třeba znovu provést, a nové <xref:System.Workflow.ComponentModel.ActivityExecutionContext> je vytvořena a aktivity naklonována prostřednictvím zobrazené – serializace a deserializace logiku, na základě <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter>.</span><span class="sxs-lookup"><span data-stu-id="5150e-161">In WF3, when the same activity needs to be re-executed, a new <xref:System.Workflow.ComponentModel.ActivityExecutionContext> is created and the activity is cloned through a heavy-weight serialization and deserialization logic based on <xref:System.Runtime.Serialization.Formatters.Binary.BinaryFormatter>.</span></span> <span data-ttu-id="5150e-162">Výkon pro iterativní řízení toky je obvykle mnohem nižší než provádění posloupnost aktivit.</span><span class="sxs-lookup"><span data-stu-id="5150e-162">Usually the performance for iterative control flows is much slower than executing a sequence of activities.</span></span>  
  
 <span data-ttu-id="5150e-163">WF4 zpracovává to poměrně jiným způsobem.</span><span class="sxs-lookup"><span data-stu-id="5150e-163">WF4 handles this quite differently.</span></span> <span data-ttu-id="5150e-164">Přebírá šablony aktivit, vytvoří nový objekt vlastnosti ActivityInstance a přidá ji do fronty plánovače.</span><span class="sxs-lookup"><span data-stu-id="5150e-164">It takes the activity template, creates a new ActivityInstance object, and adds it to the scheduler queue.</span></span> <span data-ttu-id="5150e-165">Tento celý proces pouze zahrnuje vytvoření explicitní objektu a je velmi šedé.</span><span class="sxs-lookup"><span data-stu-id="5150e-165">This whole process only involves explicit object creation and is very light-weight.</span></span>  
  
### <a name="asynchronous-programming"></a><span data-ttu-id="5150e-166">Asynchronní programování</span><span class="sxs-lookup"><span data-stu-id="5150e-166">Asynchronous Programming</span></span>  
 <span data-ttu-id="5150e-167">Aplikace obvykle mají lepší výkon a škálovatelnost asynchronní programování distribuovaná výpočetní činností nebo dlouhotrvající blokování operací, jako je vstupně-výstupních operací.</span><span class="sxs-lookup"><span data-stu-id="5150e-167">Applications usually have better performance and scalability with asynchronous programming for long running blocking operations such as I/O or distributed computing operations.</span></span> <span data-ttu-id="5150e-168">Poskytuje asynchronní podpora prostřednictvím základní aktivitě typy WF4 <xref:System.Activities.AsyncCodeActivity>, <xref:System.Activities.AsyncCodeActivity%601>.</span><span class="sxs-lookup"><span data-stu-id="5150e-168">WF4 provides asynchronous support through base activity types <xref:System.Activities.AsyncCodeActivity>, <xref:System.Activities.AsyncCodeActivity%601>.</span></span> <span data-ttu-id="5150e-169">Modul runtime nativně rozumí asynchronní aktivity a proto můžete automaticky umístí instance v zóně no-persist při nezpracovaných asynchronní pracovní.</span><span class="sxs-lookup"><span data-stu-id="5150e-169">The runtime natively understands asynchronous activities and therefore can automatically put the instance in a no-persist zone while the asynchronous work is outstanding.</span></span> <span data-ttu-id="5150e-170">Vlastní aktivity lze odvozovat od tyto typy pro práci asynchronní bez podržte podprocesu plánovače pracovního postupu a blokuje veškeré aktivity, které pravděpodobně bude moci spustit souběžně.</span><span class="sxs-lookup"><span data-stu-id="5150e-170">Custom activities can derive from these types to perform asynchronous work without holding the workflow scheduler thread and blocking any activities that may be able to run in parallel.</span></span>  
  
### <a name="messaging"></a><span data-ttu-id="5150e-171">Zasílání zpráv</span><span class="sxs-lookup"><span data-stu-id="5150e-171">Messaging</span></span>  
 <span data-ttu-id="5150e-172">WF3 měl původně velmi omezená podpora zasílání zpráv prostřednictvím externí události nebo webové služby volání.</span><span class="sxs-lookup"><span data-stu-id="5150e-172">Initially WF3 had very limited messaging support through external events or web services invocations.</span></span> <span data-ttu-id="5150e-173">V rozhraní .net 3.5, může být pracovních implementovaný jako klienti WCF nebo zveřejněné jako služeb WCF přes <xref:System.Workflow.Activities.SendActivity> a <xref:System.Workflow.Activities.ReceiveActivity>.</span><span class="sxs-lookup"><span data-stu-id="5150e-173">In .Net 3.5, workflows could be implemented as WCF clients or exposed as WCF services through <xref:System.Workflow.Activities.SendActivity> and <xref:System.Workflow.Activities.ReceiveActivity>.</span></span> <span data-ttu-id="5150e-174">V WF4 má byla koncept založené na pracovním postupu zasílání zpráv programování další posílit prostřednictvím úzkou integraci služby WCF logiku pro zasílání zpráv do pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-174">In WF4, the concept of workflow-based messaging programming has been further strengthened through the tight integration of WCF messaging logic into WF.</span></span>  
  
 <span data-ttu-id="5150e-175">Jednotná zpráva zpracování kanálu součástí WCF v rozhraní .net 4 pomáhá WF4 služeb má výrazně lepší výkon a škálovatelnost než WF3.</span><span class="sxs-lookup"><span data-stu-id="5150e-175">The unified message processing pipeline provided in WCF in .Net 4 helps WF4 services to have significantly better performance and scalability than WF3.</span></span> <span data-ttu-id="5150e-176">WF4 také poskytuje bohatší zasílání zpráv programovací podporu, který může model komplexní zpráva vzory Exchange (MEPs).</span><span class="sxs-lookup"><span data-stu-id="5150e-176">WF4 also provides richer messaging programming support that can model complex Message Exchange Patterns (MEPs).</span></span> <span data-ttu-id="5150e-177">Vývojáři mohou pomocí buď kontrakty typové služeb k dosažení snadno programování nebo kontrakty beztypové služeb můžete dosáhnout lepšího výkonu bez placení náklady na serializaci.</span><span class="sxs-lookup"><span data-stu-id="5150e-177">Developers can use either typed service contracts to achieve easy programming or un-typed service contracts to achieve better performance without paying serialization costs.</span></span> <span data-ttu-id="5150e-178">Ukládání do mezipaměti podpory prostřednictvím kanálu na straně klienta <xref:System.ServiceModel.Activities.SendMessageChannelCache> třídy v WF4 pomáhá vývojářům vytvářet rychlé aplikace s minimálním úsilím.</span><span class="sxs-lookup"><span data-stu-id="5150e-178">The client-side channel caching support through the <xref:System.ServiceModel.Activities.SendMessageChannelCache> class in WF4 helps developers build fast applications with minimal effort.</span></span> <span data-ttu-id="5150e-179">Další informace najdete v tématu [změna úrovní sdílení mezipaměti pro aktivity odesílání](../../../docs/framework/wcf/feature-details/changing-the-cache-sharing-levels-for-send-activities.md).</span><span class="sxs-lookup"><span data-stu-id="5150e-179">For more information, see [Changing the Cache Sharing Levels for Send Activities](../../../docs/framework/wcf/feature-details/changing-the-cache-sharing-levels-for-send-activities.md).</span></span>  
  
### <a name="declarative-programming"></a><span data-ttu-id="5150e-180">Deklarativní programování</span><span class="sxs-lookup"><span data-stu-id="5150e-180">Declarative Programming</span></span>  
 <span data-ttu-id="5150e-181">WF4 poskytuje vyčištění a jednoduchý deklarativní programovací rozhraní modelu obchodních procesů a služeb.</span><span class="sxs-lookup"><span data-stu-id="5150e-181">WF4 provides a clean and simple declarative programming framework to model business processes and services.</span></span> <span data-ttu-id="5150e-182">Programovací model podporuje plně deklarativního složení aktivity, s žádný kód – vedle, výrazně zjednodušuje vytváření pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-182">The programming model supports fully declarative composition of activities, with no code-beside, greatly simplifying workflow authoring.</span></span> <span data-ttu-id="5150e-183">V [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)], založených na XAML deklarativní programovacím rozhraní má byla unified do jednoho sestavení System.Xaml.dll pro podporu WPF a WF.</span><span class="sxs-lookup"><span data-stu-id="5150e-183">In [!INCLUDE[netfx40_short](../../../includes/netfx40-short-md.md)], the XAML-based declarative programming framework has been unified into the single assembly System.Xaml.dll to support both WPF and WF.</span></span>  
  
 <span data-ttu-id="5150e-184">V WF4 XAML poskytuje skutečně deklarativní prostředí a umožňuje pro celý definici pracovního postupu být definován v kódu XML, odkazující na typy vytvořené pomocí rozhraní .NET a aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-184">In WF4, XAML provides a truly declarative experience and allows for the entire definition of the workflow to be defined in XML markup, referencing activities and types built using .NET.</span></span> <span data-ttu-id="5150e-185">To bylo obtížné dělat v WF3 s formát XOML bez zásahu logiku vlastního kódu.</span><span class="sxs-lookup"><span data-stu-id="5150e-185">This was difficult to do in WF3 with XOML format without involving custom code-behind logic.</span></span> <span data-ttu-id="5150e-186">Novým zásobníkem XAML v rozhraní .net 4 má mnohem lepší výkon při serializaci nebo deserializaci artefakty pracovního postupu a díky deklarativní programování více přitažlivé a plnou.</span><span class="sxs-lookup"><span data-stu-id="5150e-186">The new XAML-stack in .Net 4 has much better performance in serializing/deserializing workflow artifacts and makes declarative programming more attractive and solid.</span></span>  
  
### <a name="workflow-designer"></a><span data-ttu-id="5150e-187">Návrhář postupu provádění</span><span class="sxs-lookup"><span data-stu-id="5150e-187">Workflow Designer</span></span>  
 <span data-ttu-id="5150e-188">Plně deklarativního programování podpora WF4 explicitně ukládá vyšší požadavky pro návrh doba pro velké pracovní postupy.</span><span class="sxs-lookup"><span data-stu-id="5150e-188">Fully declarative programming support for WF4 explicitly imposes higher requirements for design time performance for large workflows.</span></span> <span data-ttu-id="5150e-189">Návrhář postupu provádění v WF4 má mnohem lepší škálovatelnost než pro velké pracovní postupy pro WF3.</span><span class="sxs-lookup"><span data-stu-id="5150e-189">The Workflow designer in WF4 has much better scalability for large workflows than that for WF3.</span></span> <span data-ttu-id="5150e-190">S podporou virtualizace uživatelského rozhraní návrháře můžete snadno načíst velké pracovního postupu aktivit 1000 za několik sekund, i když je téměř možné načíst několik set aktivit pracovního postupu pomocí návrháře WF3.</span><span class="sxs-lookup"><span data-stu-id="5150e-190">With UI virtualization support, the designer can easily load a large workflow of 1000 activities in a few seconds, while it is almost impossible to load a workflow of a few hundred activities with the WF3 designer.</span></span>  
  
## <a name="component-level-performance-comparisons"></a><span data-ttu-id="5150e-191">Porovnání výkonu úrovni součástí</span><span class="sxs-lookup"><span data-stu-id="5150e-191">Component-level Performance Comparisons</span></span>  
 <span data-ttu-id="5150e-192">Tato část obsahuje data na přímé porovnání mezi jednotlivé aktivity v WF3 a WF4 pracovních postupů.</span><span class="sxs-lookup"><span data-stu-id="5150e-192">This section contains data on direct comparisons between individual activities in WF3 and WF4 workflows.</span></span>  <span data-ttu-id="5150e-193">Klíčové oblasti jako trvalost mít více velký dopad na výkon než komponenty jednotlivé aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-193">Key areas like persistence have a more profound impact on performance than the individual activity components.</span></span>  <span data-ttu-id="5150e-194">Vylepšení výkonu v jednotlivých součástí v nástroji WF4 jsou ale důležité, protože se teď dostatečně rychlé proti programového ruční orchestration logiku součásti.</span><span class="sxs-lookup"><span data-stu-id="5150e-194">The performance improvements in individual components in WF4 are important though because the components are now fast enough to be compared against hand-coded orchestration logic.</span></span>  <span data-ttu-id="5150e-195">Následuje příklad je popsaná v následující části: "Service složení scénář."</span><span class="sxs-lookup"><span data-stu-id="5150e-195">An example of which is covered in the next section: "Service Composition Scenario."</span></span>  
  
### <a name="environment-setup"></a><span data-ttu-id="5150e-196">Nastavení prostředí</span><span class="sxs-lookup"><span data-stu-id="5150e-196">Environment Setup</span></span>  
 <span data-ttu-id="5150e-197">![Pracovní postup prostředí pro testování výkonu](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="5150e-197">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
 <span data-ttu-id="5150e-198">Výše uvedené schéma ukazuje konfiguraci počítače používá k měření výkonu úrovni součásti.</span><span class="sxs-lookup"><span data-stu-id="5150e-198">The above figure shows the machine configuration used for component-level performance measurement.</span></span> <span data-ttu-id="5150e-199">Jeden server a pět klienti připojení více než jedno síťové rozhraní sítě Ethernet 1 GB/s.</span><span class="sxs-lookup"><span data-stu-id="5150e-199">A single server and five clients connected over one 1-Gbps Ethernet network interface.</span></span> <span data-ttu-id="5150e-200">Pro snadné měření server konfigurován pro použití jediného jádra dual-proc/čtyřjádrový serveru se systémem Windows Server 2008 x86.</span><span class="sxs-lookup"><span data-stu-id="5150e-200">For easy measurements, the server is configured to use a single core of a dual-proc/quad-core server  running Windows Server 2008 x86.</span></span> <span data-ttu-id="5150e-201">Systém využití procesoru je udržován na úrovni téměř 100 %.</span><span class="sxs-lookup"><span data-stu-id="5150e-201">The system CPU utilization is maintained at nearly 100%.</span></span>  
  
### <a name="test-details"></a><span data-ttu-id="5150e-202">Podrobnosti o testu</span><span class="sxs-lookup"><span data-stu-id="5150e-202">Test Details</span></span>  
 <span data-ttu-id="5150e-203">WF3 <xref:System.Workflow.Activities.CodeActivity> je pravděpodobně nejjednodušší aktivity, který můžete použít v pracovním postupu WF3.</span><span class="sxs-lookup"><span data-stu-id="5150e-203">The WF3 <xref:System.Workflow.Activities.CodeActivity> is likely the simplest activity that can be used in a WF3 workflow.</span></span>  <span data-ttu-id="5150e-204">Aktivity volá metodu v modelu code-behind, programátorů pracovního postupu můžete vložit do vlastní kód.</span><span class="sxs-lookup"><span data-stu-id="5150e-204">The activity calls a method in the code-behind that the workflow programmer can put custom code into.</span></span>  <span data-ttu-id="5150e-205">V WF4, neexistuje žádné přímé analogovým k WF3 <xref:System.Workflow.Activities.CodeActivity> , nabízí stejné funkce.</span><span class="sxs-lookup"><span data-stu-id="5150e-205">In WF4, there is no direct analog to the WF3 <xref:System.Workflow.Activities.CodeActivity> that provides the same functionality.</span></span>  <span data-ttu-id="5150e-206">Všimněte si, že je <xref:System.Activities.CodeActivity> základní třídy v WF4, která nesouvisí se WF3 <xref:System.Workflow.Activities.CodeActivity>.</span><span class="sxs-lookup"><span data-stu-id="5150e-206">Note that there is a <xref:System.Activities.CodeActivity> base class in WF4 that is not related to the WF3 <xref:System.Workflow.Activities.CodeActivity>.</span></span>  <span data-ttu-id="5150e-207">Autoři pracovního postupu se doporučuje vytvořit vlastní aktivity a vytváření pracovních postupů jen XAML.</span><span class="sxs-lookup"><span data-stu-id="5150e-207">Workflow authors are encouraged to create custom activities and build XAML-only workflows.</span></span>  <span data-ttu-id="5150e-208">V testech níže volá aktivita `Comment` použijí se místo prázdnou <xref:System.Workflow.Activities.CodeActivity> v pracovních postupech WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-208">In the tests below, an activity called `Comment` is used in place of an empty <xref:System.Workflow.Activities.CodeActivity> in WF4 workflows.</span></span>  <span data-ttu-id="5150e-209">Kód `Comment` aktivity je následující:</span><span class="sxs-lookup"><span data-stu-id="5150e-209">The code in the `Comment` activity is as follows:</span></span>  
  
```  
[ContentProperty("Body")]  
    public sealed class Comment : CodeActivity  
    {  
        public Comment()  
            : base()  
        {  
        }  
  
        [DefaultValue(null)]  
        public Activity Body  
        {  
            get;  
            set;  
        }  
  
        protected override void Execute(CodeActivityContext context)  
        {  
        }  
    }  
```  
  
### <a name="empty-workflow"></a><span data-ttu-id="5150e-210">Prázdný pracovního postupu</span><span class="sxs-lookup"><span data-stu-id="5150e-210">Empty Workflow</span></span>  
 <span data-ttu-id="5150e-211">Tento test používá pracovní postup pořadí s žádné podřízené aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-211">This test uses a sequence workflow with no child activities.</span></span>  
  
### <a name="single-activity"></a><span data-ttu-id="5150e-212">Jediné aktivity</span><span class="sxs-lookup"><span data-stu-id="5150e-212">Single Activity</span></span>  
 <span data-ttu-id="5150e-213">Pracovní postup je pořadí pracovní postup obsahující jednu podřízenou aktivitu.</span><span class="sxs-lookup"><span data-stu-id="5150e-213">The workflow is a sequence workflow containing one child activity.</span></span>  <span data-ttu-id="5150e-214">Je aktivita <xref:System.Workflow.Activities.CodeActivity> s žádný kód v případě, že WF3 a `Comment` aktivity v případě, že WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-214">The activity is a <xref:System.Workflow.Activities.CodeActivity> with no code in the WF3 case and a `Comment` activity in the WF4 case.</span></span>  
  
### <a name="while-with-1000-iterations"></a><span data-ttu-id="5150e-215">Chvíli s 1000 iterací</span><span class="sxs-lookup"><span data-stu-id="5150e-215">While with 1000 Iterations</span></span>  
 <span data-ttu-id="5150e-216">Pořadí pracovní postup obsahuje jeden <xref:System.Activities.Statements.While> aktivitu jednu podřízenou aktivity ve smyčce, který neprovádí veškerou práci.</span><span class="sxs-lookup"><span data-stu-id="5150e-216">The sequence workflow contains one <xref:System.Activities.Statements.While> activity with one child activity in the loop that does not perform any work.</span></span>  
  
### <a name="replicator-compared-to-parallelforeach"></a><span data-ttu-id="5150e-217">Replikátor ve srovnání s ParallelForEach</span><span class="sxs-lookup"><span data-stu-id="5150e-217">Replicator compared to ParallelForEach</span></span>  
 <span data-ttu-id="5150e-218"><xref:System.Workflow.Activities.ReplicatorActivity> v WF3 má postupného a paralelní provádění režimy.</span><span class="sxs-lookup"><span data-stu-id="5150e-218"><xref:System.Workflow.Activities.ReplicatorActivity> in WF3 has sequential and parallel execution modes.</span></span>  <span data-ttu-id="5150e-219">V režimu sekvenční aktivity výkon je podobná <xref:System.Workflow.Activities.WhileActivity>.</span><span class="sxs-lookup"><span data-stu-id="5150e-219">In sequential mode, the activity’s performance is similar to the <xref:System.Workflow.Activities.WhileActivity>.</span></span>  <span data-ttu-id="5150e-220"><xref:System.Workflow.Activities.ReplicatorActivity> Je nejvhodnější pro paralelní zpracování.</span><span class="sxs-lookup"><span data-stu-id="5150e-220">The <xref:System.Workflow.Activities.ReplicatorActivity> is most useful for parallel execution.</span></span>  <span data-ttu-id="5150e-221">Je analogovým WF4 pro tento <xref:System.Activities.Statements.ParallelForEach%601> aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-221">The WF4 analog for this is the <xref:System.Activities.Statements.ParallelForEach%601> activity.</span></span>  
  
 <span data-ttu-id="5150e-222">Následující diagram znázorňuje použít pro tento test pracovních postupů.</span><span class="sxs-lookup"><span data-stu-id="5150e-222">The following diagram shows the workflows used for this test.</span></span> <span data-ttu-id="5150e-223">Pracovní postup WF3 je na levé straně a pracovní postup WF4 je na pravé straně.</span><span class="sxs-lookup"><span data-stu-id="5150e-223">The WF3 workflow is on the left and the WF4 workflow is on the right.</span></span>  
  
 <span data-ttu-id="5150e-224">![WF3 ReplicatorActivity a WF4 ParallelForEach](../../../docs/framework/windows-workflow-foundation/media/replicatorandparallelforeach.gif "ReplicatorAndParallelForEach")</span><span class="sxs-lookup"><span data-stu-id="5150e-224">![WF3 ReplicatorActivity and WF4 ParallelForEach](../../../docs/framework/windows-workflow-foundation/media/replicatorandparallelforeach.gif "ReplicatorAndParallelForEach")</span></span>  
  
### <a name="sequential-workflow-with-five-activities"></a><span data-ttu-id="5150e-225">Sekvenční pracovní postup s pěti aktivity</span><span class="sxs-lookup"><span data-stu-id="5150e-225">Sequential Workflow with Five Activities</span></span>  
 <span data-ttu-id="5150e-226">Tento test slouží k zobrazení účinku s několika aktivity spustit v pořadí.</span><span class="sxs-lookup"><span data-stu-id="5150e-226">This test is meant to show the effect of having several activities execute in sequence.</span></span>  <span data-ttu-id="5150e-227">V pořadí jsou pět aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-227">There are five activities in the sequence.</span></span>  
  
### <a name="transaction-scope"></a><span data-ttu-id="5150e-228">Oboru transakce</span><span class="sxs-lookup"><span data-stu-id="5150e-228">Transaction Scope</span></span>  
 <span data-ttu-id="5150e-229">Test oboru transakce z jiné testy se mírně liší v, že pro každé iteraci není vytvořena nová instance pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-229">The transaction scope test differs from the other tests slightly in that a new workflow instance is not created for every iteration.</span></span>  <span data-ttu-id="5150e-230">Místo toho strukturovaná pracovního postupu s chvíli obsahující smyčky <xref:System.Activities.Statements.TransactionScope> aktivity obsahující jediné aktivity, která nemá žádné kroky.</span><span class="sxs-lookup"><span data-stu-id="5150e-230">Instead, the workflow is structured with a while loop containing a <xref:System.Activities.Statements.TransactionScope> activity containing a single activity that does no work.</span></span>  <span data-ttu-id="5150e-231">Každé spuštění dávky 50 iterací prostřednictvím klienta při smyčky se počítá jako jednu operaci.</span><span class="sxs-lookup"><span data-stu-id="5150e-231">Each run of a batch of 50 iterations through the while loop is counted as a single operation.</span></span>  
  
### <a name="compensation"></a><span data-ttu-id="5150e-232">kompenzace</span><span class="sxs-lookup"><span data-stu-id="5150e-232">Compensation</span></span>  
 <span data-ttu-id="5150e-233">Pracovní postup WF3 má aktivita jediné aktivity s názvem `WorkScope`.</span><span class="sxs-lookup"><span data-stu-id="5150e-233">The WF3 workflow has a single compensatable activity named `WorkScope`.</span></span>  <span data-ttu-id="5150e-234">Aktivity jednoduše implementuje <xref:System.Workflow.ComponentModel.ICompensatableActivity> rozhraní:</span><span class="sxs-lookup"><span data-stu-id="5150e-234">The activity simply implements the <xref:System.Workflow.ComponentModel.ICompensatableActivity> interface:</span></span>  
  
```  
class WorkScope :   
        CompositeActivity, ICompensatableActivity  
    {  
        public WorkScope() : base() { }  
  
        public WorkScope(string name)  
        {  
            this.Name = name;  
        }  
  
        public ActivityExecutionStatus Compensate(  
            ActivityExecutionContext executionContext)  
        {  
            return ActivityExecutionStatus.Closed;  
        }  
    }  
```  
  
 <span data-ttu-id="5150e-235">Cíle obslužná rutina chyby `WorkScope` aktivity. Pracovní postup WF4 je stejně zneužívající vlastností prohlížeče.</span><span class="sxs-lookup"><span data-stu-id="5150e-235">The fault handler targets the `WorkScope` activity.The WF4 workflow is equally simplistic.</span></span>  <span data-ttu-id="5150e-236">A <xref:System.Activities.Statements.CompensableActivity> má text a kompenzace obslužná rutina.</span><span class="sxs-lookup"><span data-stu-id="5150e-236">A <xref:System.Activities.Statements.CompensableActivity> has a body and a compensation handler.</span></span>  <span data-ttu-id="5150e-237">Explicitní compensate je další v pořadí.</span><span class="sxs-lookup"><span data-stu-id="5150e-237">An explicit compensate is next in the sequence.</span></span>  <span data-ttu-id="5150e-238">Aktivita textu a činnost kompenzace obslužnou rutinu jsou obě prázdný implementace:</span><span class="sxs-lookup"><span data-stu-id="5150e-238">The body activity and compensation handler activity are both empty implementations:</span></span>  
  
```  
public sealed class CompensableActivityEmptyCompensation : CodeActivity  
    {  
        public CompensableActivityEmptyCompensation()  
            : base() { }  
  
        public Activity Body { get; set; }  
  
        protected override void Execute(CodeActivityContext context) { }  
    }  
    public sealed class CompensableActivityEmptyBody : CodeActivity  
    {  
        public CompensableActivityEmptyBody()  
            : base() { }  
  
        public Activity Body { get; set; }  
  
        protected override void Execute(CodeActivityContext context) { }  
    }  
```  
  
 <span data-ttu-id="5150e-239">![Pracovní postupy základní kompenzace WF3 a WF](../../../docs/framework/windows-workflow-foundation/media/basiccompensationworkflows.gif "BasicCompensationWorkflows")</span><span class="sxs-lookup"><span data-stu-id="5150e-239">![WF3 and WF basic compensation workflows](../../../docs/framework/windows-workflow-foundation/media/basiccompensationworkflows.gif "BasicCompensationWorkflows")</span></span>  
  
 <span data-ttu-id="5150e-240">Obrázek 2 – WF3 (vlevo) a pracovních postupů (vpravo) základní kompenzace WF4</span><span class="sxs-lookup"><span data-stu-id="5150e-240">Figure 2 – WF3 (left) and WF4 (right) basic compensation workflows</span></span>  
  
### <a name="performance-test-results"></a><span data-ttu-id="5150e-241">Výsledky testu výkonu</span><span class="sxs-lookup"><span data-stu-id="5150e-241">Performance Test Results</span></span>  
 <span data-ttu-id="5150e-242">![Výsledky testu výkonu](../../../docs/framework/windows-workflow-foundation/media/performancedata.gif "objektů PerformanceData")</span><span class="sxs-lookup"><span data-stu-id="5150e-242">![Performance Test Results](../../../docs/framework/windows-workflow-foundation/media/performancedata.gif "PerformanceData")</span></span>  
  
 <span data-ttu-id="5150e-243">![Graf výkonu testovací Data](../../../docs/framework/windows-workflow-foundation/media/performancetestchart.gif "PerformanceTestChart")</span><span class="sxs-lookup"><span data-stu-id="5150e-243">![Performance Test Data Graph](../../../docs/framework/windows-workflow-foundation/media/performancetestchart.gif "PerformanceTestChart")</span></span>  
  
 <span data-ttu-id="5150e-244">Všechny testy se měří v pracovních postupech za sekundu s výjimkou test oboru transakce.</span><span class="sxs-lookup"><span data-stu-id="5150e-244">All tests are measured in workflows per second with the exception of the transaction scope test.</span></span>  <span data-ttu-id="5150e-245">Jak je vidět výše, [!INCLUDE[wf1](../../../includes/wf1-md.md)] napříč Tabule, hlavně v oblastech, které vyžadují více spuštěních se stejná aktivita jako chvíli je vylepšený výkon modulu runtime smyčky.</span><span class="sxs-lookup"><span data-stu-id="5150e-245">As can be seen above, the [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime performance has improved across the board, especially in areas that require multiple executions of the same activity like the while loop.</span></span>  
  
## <a name="service-composition-scenario"></a><span data-ttu-id="5150e-246">Scénář složení služby</span><span class="sxs-lookup"><span data-stu-id="5150e-246">Service Composition Scenario</span></span>  
 <span data-ttu-id="5150e-247">Jak je znázorněno v předchozí části, "porovnání výkonu úrovni součástí," došlo k výraznému snížení režie mezi WF3 a WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-247">As is shown in the previous section, "Component-level Performance Comparisons," there has been a significant reduction in overhead between WF3 and WF4.</span></span>  <span data-ttu-id="5150e-248">Pracovní postup služby WCF můžete nyní téměř odpovídají výkon programového ruční služeb WCF zároveň mít všechny výhody [!INCLUDE[wf1](../../../includes/wf1-md.md)] modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="5150e-248">WCF workflow services can now almost match the performance of hand-coded WCF services but still have all the benefits of the [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime.</span></span>  <span data-ttu-id="5150e-249">Tento scénář testovací porovná služby WCF pro pracovní postup služby WCF ve WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-249">This test scenario compares a WCF service against a WCF workflow service in WF4.</span></span>  
  
### <a name="online-store-service"></a><span data-ttu-id="5150e-250">Služba online úložiště</span><span class="sxs-lookup"><span data-stu-id="5150e-250">Online Store Service</span></span>  
 <span data-ttu-id="5150e-251">Jednou z výhod modelu Windows Workflow Foundation je schopnost tvoří procesů pomocí několika služeb.</span><span class="sxs-lookup"><span data-stu-id="5150e-251">One of the strengths of Windows Workflow Foundation is the ability to compose processes using several services.</span></span>  <span data-ttu-id="5150e-252">V tomto příkladu je služby online úložiště, které orchestrují dvě volání služby k nákupu pořadí.</span><span class="sxs-lookup"><span data-stu-id="5150e-252">For this example, there is an online store service that orchestrates two service calls to purchase an order.</span></span>  <span data-ttu-id="5150e-253">Prvním krokem je ověřit pomocí služby ověřování pořadí pořadí.</span><span class="sxs-lookup"><span data-stu-id="5150e-253">The first step is to validate the order using an Order Validating Service.</span></span>  <span data-ttu-id="5150e-254">Druhým krokem je k vyplnění pořadí pomocí služby skladu.</span><span class="sxs-lookup"><span data-stu-id="5150e-254">The second step is to fill the order using a Warehouse Service.</span></span>  
  
 <span data-ttu-id="5150e-255">Dvě služby back-end pořadí ověřování služby a služby skladu, zůstávají stejné pro oba testy.</span><span class="sxs-lookup"><span data-stu-id="5150e-255">The two backend services, Order Validating Service and Warehouse Service, remain the same for both tests.</span></span>  <span data-ttu-id="5150e-256">Část, která se změní je Online služba úložiště, která provádí orchestration.</span><span class="sxs-lookup"><span data-stu-id="5150e-256">The part that changes is the Online Store Service that performs the orchestration.</span></span>  <span data-ttu-id="5150e-257">V jednom případě služba je ruční programového jako služby WCF.</span><span class="sxs-lookup"><span data-stu-id="5150e-257">In one case, the service is hand-coded as a WCF service.</span></span>  <span data-ttu-id="5150e-258">V případech služba je zapsána jako pracovní postup služby WCF ve WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-258">For the other case, the service is written as a WCF workflow service in WF4.</span></span> [!INCLUDE[wf1](../../../includes/wf1-md.md)]<span data-ttu-id="5150e-259">-specifické funkce, jako jsou sledování a trvalost jsou vypnuté pro tento test.</span><span class="sxs-lookup"><span data-stu-id="5150e-259">-specific features like tracking and persistence are turned off for this test.</span></span>  
  
### <a name="environment"></a><span data-ttu-id="5150e-260">Prostředí</span><span class="sxs-lookup"><span data-stu-id="5150e-260">Environment</span></span>  
 <span data-ttu-id="5150e-261">![Pracovní postup prostředí pro testování výkonu](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="5150e-261">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
 <span data-ttu-id="5150e-262">Ke službě Online úložiště prostřednictvím protokolu HTTP z několika počítačů jsou vytvářeny požadavky klienta.</span><span class="sxs-lookup"><span data-stu-id="5150e-262">Client requests are made to the Online Store Service via HTTP from multiple computers.</span></span>  <span data-ttu-id="5150e-263">Jeden počítač hostuje všechny tři služby.</span><span class="sxs-lookup"><span data-stu-id="5150e-263">A single computer hosts all three services.</span></span>  <span data-ttu-id="5150e-264">Přenosová vrstva mezi Online úložiště služby a služby back-end je TCP nebo HTTP.</span><span class="sxs-lookup"><span data-stu-id="5150e-264">The transport layer between the Online Store Service and the backend services is TCP or HTTP.</span></span>  <span data-ttu-id="5150e-265">Měření operací za sekundu je založena na počtu dokončené `PurchaseOrder` volání provedená do Online služby úložiště.</span><span class="sxs-lookup"><span data-stu-id="5150e-265">The measurement of operations/second is based on the number of completed `PurchaseOrder` calls made to the Online Store Service.</span></span>  <span data-ttu-id="5150e-266">Sdružování kanál je nová funkce v WF4 k dispozici.</span><span class="sxs-lookup"><span data-stu-id="5150e-266">Channel pooling is a new feature available in WF4.</span></span>  <span data-ttu-id="5150e-267">V WCF část kanál tento test sdružování není k dispozici ihned tak na straně programového Implementace jednoduchého technika sdružování byl použit v Online službě úložiště.</span><span class="sxs-lookup"><span data-stu-id="5150e-267">In the WCF portion of this test channel pooling is not provided out of the box so a hand-coded implementation of a simple pooling technique was used in the Online Store Service.</span></span>  
  
### <a name="performance"></a><span data-ttu-id="5150e-268">Výkon</span><span class="sxs-lookup"><span data-stu-id="5150e-268">Performance</span></span>  
 <span data-ttu-id="5150e-269">![Graf výkonu služby online úložiště](../../../docs/framework/windows-workflow-foundation/media/onlinestoreperfgraph.gif "OnlineStorePerfGraph")</span><span class="sxs-lookup"><span data-stu-id="5150e-269">![Online Store Service Performance Graph](../../../docs/framework/windows-workflow-foundation/media/onlinestoreperfgraph.gif "OnlineStorePerfGraph")</span></span>  
  
 <span data-ttu-id="5150e-270">Připojování k back-end TCP služby bez sdružování kanál, [!INCLUDE[wf1](../../../includes/wf1-md.md)] služby má 17.2 % dopad na propustnost.</span><span class="sxs-lookup"><span data-stu-id="5150e-270">Connecting to backend TCP services without channel pooling, the [!INCLUDE[wf1](../../../includes/wf1-md.md)] service has a 17.2% impact on throughput.</span></span>  <span data-ttu-id="5150e-271">Sdružování kanál, snížení je přibližně 23,8 %.</span><span class="sxs-lookup"><span data-stu-id="5150e-271">With channel pooling, the penalty is about 23.8%.</span></span>  <span data-ttu-id="5150e-272">Pro protokol HTTP, dopad je mnohem menší: % 4.3 bez sdružování a 8.1 % sdružování.</span><span class="sxs-lookup"><span data-stu-id="5150e-272">For HTTP, the impact is much less: 4.3% without pooling and 8.1% with pooling.</span></span>  <span data-ttu-id="5150e-273">Je také důležité si uvědomit, že kanál sdružování poskytuje velmi málo výhodné při použití protokolu HTTP.</span><span class="sxs-lookup"><span data-stu-id="5150e-273">It is also important to note that the channel pooling provides very little benefit when using HTTP.</span></span>  
  
 <span data-ttu-id="5150e-274">Zatímco je režie z modulu runtime WF4 v porovnání s ruční programového služby WCF v tomto testu, se může považovat za nejhoršího.</span><span class="sxs-lookup"><span data-stu-id="5150e-274">While there is overhead from the WF4 runtime compared with a hand-coded WCF service in this test, it could be considered a worst-case scenario.</span></span>  <span data-ttu-id="5150e-275">Tyto dvě služby back-end v tento test provést uživatele příliš mnoho zásahů.</span><span class="sxs-lookup"><span data-stu-id="5150e-275">The two backend services in this test do very little work.</span></span>  <span data-ttu-id="5150e-276">Ve scénáři skutečných začátku do konce by tyto služby provedl nákladnější operací, jako je volání databáze, což dopad na výkon z přenosové vrstvy méně důležité.</span><span class="sxs-lookup"><span data-stu-id="5150e-276">In a real end-to-end scenario, these services would perform more expensive operations like database calls, making the performance impact of the transport layer less important.</span></span>  <span data-ttu-id="5150e-277">To plus výhod funkcí dostupných ve WF4 díky přijatelná volba pro vytváření služeb orchestration Workflow Foundation.</span><span class="sxs-lookup"><span data-stu-id="5150e-277">This plus the benefits of the features available in WF4 makes Workflow Foundation a viable choice for creating orchestration services.</span></span>  
  
## <a name="key-performance-considerations"></a><span data-ttu-id="5150e-278">Faktory ovlivňující výkon klíče</span><span class="sxs-lookup"><span data-stu-id="5150e-278">Key Performance Considerations</span></span>  
 <span data-ttu-id="5150e-279">Oblasti funkcí v této části, s výjimkou zprostředkovatel komunikace s objekty, výrazně změnily mezi WF3 a WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-279">The feature areas in this section, with the exception of interop, have dramatically changed between WF3 and WF4.</span></span>  <span data-ttu-id="5150e-280">Tato akce ovlivní návrhu aplikace pracovního postupu, jakož i výkon.</span><span class="sxs-lookup"><span data-stu-id="5150e-280">This affects the design of workflow applications as well as the performance.</span></span>  
  
#### <a name="workflow-activation-latency"></a><span data-ttu-id="5150e-281">Pracovní postup aktivace latence</span><span class="sxs-lookup"><span data-stu-id="5150e-281">Workflow Activation Latency</span></span>  
 <span data-ttu-id="5150e-282">V aplikaci služby WCF pracovního postupu je důležité, protože může být blokování latence pro spuštění nového pracovního postupu nebo načítání existující pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-282">In a WCF workflow service application, the latency for starting a new workflow or loading an existing workflow is important as it can be blocking.</span></span>  <span data-ttu-id="5150e-283">Tento testovací případ opatření proti WF4 XAMLX hostitele v Typický scénář hostitel WF3 XOML.</span><span class="sxs-lookup"><span data-stu-id="5150e-283">This test case measures a WF3 XOML host against a WF4 XAMLX host in a typical scenario.</span></span>  
  
##### <a name="environment-setup"></a><span data-ttu-id="5150e-284">Nastavení prostředí</span><span class="sxs-lookup"><span data-stu-id="5150e-284">Environment Setup</span></span>  
 <span data-ttu-id="5150e-285">![Nastavení prostředí pro testování latence a propustnosti](../../../docs/framework/windows-workflow-foundation/media/latencyandthroughputenvironment.gif "LatencyAndThroughputEnvironment")</span><span class="sxs-lookup"><span data-stu-id="5150e-285">![Environment setup for latency and throughput tests](../../../docs/framework/windows-workflow-foundation/media/latencyandthroughputenvironment.gif "LatencyAndThroughputEnvironment")</span></span>  
  
##### <a name="test-setup"></a><span data-ttu-id="5150e-286">Nastavení testu</span><span class="sxs-lookup"><span data-stu-id="5150e-286">Test Setup</span></span>  
 <span data-ttu-id="5150e-287">Ve scénáři klientský počítač kontaktuje pracovního postupu služby WCF pomocí korelace na základě kontextu.</span><span class="sxs-lookup"><span data-stu-id="5150e-287">In the scenario, a client computer contacts a WCF workflow service using context-based correlation.</span></span>  <span data-ttu-id="5150e-288">Korelace kontextové vyžaduje speciální kontextu vazby a pomocí kontextu hlavičky nebo soubor cookie se týkají zprávy k instanci pracovního postupu správné.</span><span class="sxs-lookup"><span data-stu-id="5150e-288">Context correlation requires a special context binding and uses a context header or cookie to relate messages to the correct workflow instance.</span></span>  <span data-ttu-id="5150e-289">Má výkonu využívat v tom, že korelace, které Id se nachází v záhlaví zprávy, takže není nutné analyzovat tělo zprávy.</span><span class="sxs-lookup"><span data-stu-id="5150e-289">It has a performance benefit in that the correlation Id is located in the message header so the message body does not need to be parsed.</span></span> <span data-ttu-id="5150e-290">Další informace o kontextu korelace najdete v části [korelace kontextové výměny](../../../docs/framework/wcf/feature-details/context-exchange-correlation.md)</span><span class="sxs-lookup"><span data-stu-id="5150e-290">For more information about context correlation see [Context Exchange Correlation](../../../docs/framework/wcf/feature-details/context-exchange-correlation.md)</span></span>  
  
 <span data-ttu-id="5150e-291">Služba bude vytvoření nového pracovního postupu s požadavkem a odeslat okamžitou reakci, takže měření latence nezahrnuje času stráveného při spuštění pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-291">The service will create a new workflow with the request and send an immediate response so that the measurement of latency does not include the time spent running the workflow.</span></span>  <span data-ttu-id="5150e-292">Pracovní postup WF3 je XOML s kódu na pozadí a je zcela v pracovním postupu WF4 XAML.</span><span class="sxs-lookup"><span data-stu-id="5150e-292">The WF3 workflow is XOML with a code-behind and the WF4 workflow is entirely XAML.</span></span>  <span data-ttu-id="5150e-293">Pracovní postup WF4 vypadá takto:</span><span class="sxs-lookup"><span data-stu-id="5150e-293">The WF4 workflow looks like this:</span></span>  
  
 <span data-ttu-id="5150e-294">![Obor 4 korelace WF](../../../docs/framework/windows-workflow-foundation/media/correlationscopeworkflow.gif "CorrelationScopeWorkflow")</span><span class="sxs-lookup"><span data-stu-id="5150e-294">![WF 4 Correlation Scope](../../../docs/framework/windows-workflow-foundation/media/correlationscopeworkflow.gif "CorrelationScopeWorkflow")</span></span>  
  
 <span data-ttu-id="5150e-295"><xref:System.ServiceModel.Activities.Receive> Aktivity vytvoří instanci pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-295">The <xref:System.ServiceModel.Activities.Receive> activity creates the workflow instance.</span></span>  <span data-ttu-id="5150e-296">Hodnota předaná přijaté zprávy je opakována v odpovědi.</span><span class="sxs-lookup"><span data-stu-id="5150e-296">A value passed in the received message is echoed in the reply message.</span></span>  <span data-ttu-id="5150e-297">Sekvence následující odpovědi obsahuje rest pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-297">A sequence following the reply contains the rest of the workflow.</span></span>  <span data-ttu-id="5150e-298">V případě výše uvedené se zobrazí pouze jeden komentář aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-298">In the above case, only one comment activity is shown.</span></span>  <span data-ttu-id="5150e-299">Počet aktivit, komentář se změní na simulovat složitost pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-299">The number of comment activities is changed to simulate workflow complexity.</span></span>  <span data-ttu-id="5150e-300">Komentář aktivity je ekvivalentní WF3 <xref:System.Workflow.Activities.CodeActivity> který provede žádné kroky.</span><span class="sxs-lookup"><span data-stu-id="5150e-300">A comment activity is equivalent to a WF3 <xref:System.Workflow.Activities.CodeActivity> that performs no work.</span></span> <span data-ttu-id="5150e-301">Další informace o aktivitě komentář najdete v části "porovnání výkonu úrovni součástí" dříve v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="5150e-301">For more information about the comment activity, see the "Component-level Performance Comparison" section earlier in this article.</span></span>  
  
##### <a name="test-results"></a><span data-ttu-id="5150e-302">Výsledky testů</span><span class="sxs-lookup"><span data-stu-id="5150e-302">Test Results</span></span>  
 <span data-ttu-id="5150e-303">![Latence výsledky](../../../docs/framework/windows-workflow-foundation/media/latencyresultsgraph.gif "LatencyResultsGraph")</span><span class="sxs-lookup"><span data-stu-id="5150e-303">![Latency Results](../../../docs/framework/windows-workflow-foundation/media/latencyresultsgraph.gif "LatencyResultsGraph")</span></span>  
  
 <span data-ttu-id="5150e-304">Obrázek 3 – studených a tedy latence pro pracovní postup služby WCF</span><span class="sxs-lookup"><span data-stu-id="5150e-304">Figure 3 – Cold and warm latency for WCF workflow services</span></span>  
  
 <span data-ttu-id="5150e-305">V tomto grafu výše, uloží málo používaná data odkazuje tento případ níž se nachází, není existující <xref:System.ServiceModel.WorkflowServiceHost> pro daný pracovní postup.</span><span class="sxs-lookup"><span data-stu-id="5150e-305">In the graph above, cold refers to the case where there is not an existing <xref:System.ServiceModel.WorkflowServiceHost> for the given workflow.</span></span>  <span data-ttu-id="5150e-306">Studené latence je jinými slovy, když pracovní postup se používá první a XOML nebo XAML, musí být zkompilovány.</span><span class="sxs-lookup"><span data-stu-id="5150e-306">In other words, cold latency is when the workflow is being used for the first time and the XOML or XAML needs to be compiled.</span></span>  <span data-ttu-id="5150e-307">Záložním latence je čas vytvořit novou instanci pracovního postupu, když typ pracovního postupu je již kompilovaná.</span><span class="sxs-lookup"><span data-stu-id="5150e-307">Warm latency is the time to create a new workflow instance when the workflow type has already been compiled.</span></span>  <span data-ttu-id="5150e-308">Složitost pracovního postupu způsobuje velmi malé rozdíly v případě, že WF4, ale má lineární postupu v případě, že WF3.</span><span class="sxs-lookup"><span data-stu-id="5150e-308">The complexity of the workflow makes very little difference in the WF4 case but has a linear progression in the WF3 case.</span></span>  
  
#### <a name="correlation-throughput"></a><span data-ttu-id="5150e-309">Propustnost korelace</span><span class="sxs-lookup"><span data-stu-id="5150e-309">Correlation Throughput</span></span>  
 <span data-ttu-id="5150e-310">WF4 zavádí novou funkci korelace na základě obsahu.</span><span class="sxs-lookup"><span data-stu-id="5150e-310">WF4 introduces a new content-based correlation feature.</span></span>  <span data-ttu-id="5150e-311">WF3 k dispozici pouze na základě kontextu korelace.</span><span class="sxs-lookup"><span data-stu-id="5150e-311">WF3 provided only context-based correlation.</span></span>  <span data-ttu-id="5150e-312">Korelace na základě kontextu může provést jenom přes konkrétní vazby kanálů WCF.</span><span class="sxs-lookup"><span data-stu-id="5150e-312">Context-based correlation could only be done over specific WCF channel bindings.</span></span>  <span data-ttu-id="5150e-313">Při použití těchto vazeb, vloží se Id pracovního postupu do záhlaví zprávy.</span><span class="sxs-lookup"><span data-stu-id="5150e-313">The workflow Id is inserted into the message header when using these bindings.</span></span>  <span data-ttu-id="5150e-314">Modul runtime WF3 by šlo identifikovat pouze pracovní postup pomocí jeho Id.  S korelace na základě obsahu Autor pracovního postupu můžete vytvořit klíč mimo relevantní část dat, jako je číslo účtu nebo zákazníků ID korelace Další informace o korelace na základě obsahu naleznete v části [korelace na základě obsahu](../../../docs/framework/wcf/feature-details/content-based-correlation.md).</span><span class="sxs-lookup"><span data-stu-id="5150e-314">The WF3 runtime could only identify a workflow by its Id.  With content-based correlation, the workflow author can create a correlation key out of a relevant piece of data like an account number or customer Id. For more information about content-based correlation see [Content Based Correlation](../../../docs/framework/wcf/feature-details/content-based-correlation.md).</span></span>  
  
 <span data-ttu-id="5150e-315">Korelace na základě kontextu má výhody výkonu v tomto klíči korelace se nachází v záhlaví zprávy.</span><span class="sxs-lookup"><span data-stu-id="5150e-315">Context-based correlation has a performance advantage in that the correlation key is located in the message header.</span></span>  <span data-ttu-id="5150e-316">Klíče může číst ze zprávy bez deaktivuje-serialization/zpráva kopírování.</span><span class="sxs-lookup"><span data-stu-id="5150e-316">The key can be read from the message without de-serialization/message-copying.</span></span>  <span data-ttu-id="5150e-317">V korelace na základě obsahu korelace klíč uložen v textu zprávy.</span><span class="sxs-lookup"><span data-stu-id="5150e-317">In content-based correlation, the correlation key is stored in the message body.</span></span>  <span data-ttu-id="5150e-318">Výraz XPath je používaná k nalezení klíč.</span><span class="sxs-lookup"><span data-stu-id="5150e-318">An XPath expression is used to locate the key.</span></span>  <span data-ttu-id="5150e-319">Náklady na další zpracování, závisí na velikosti zprávy, hloubku klíče v těle a počet klíčů.</span><span class="sxs-lookup"><span data-stu-id="5150e-319">The cost of this extra processing depends on the size of the message, depth of the key in the body, and the number of keys.</span></span>  <span data-ttu-id="5150e-320">Tento test porovná korelace na základě kontextu a obsahu a také ukazuje snížení výkonu při použití více klíčů.</span><span class="sxs-lookup"><span data-stu-id="5150e-320">This test compares context- and content-based correlation and also shows the performance degradation when using multiple keys.</span></span>  
  
#### <a name="environment-setup"></a><span data-ttu-id="5150e-321">Nastavení prostředí</span><span class="sxs-lookup"><span data-stu-id="5150e-321">Environment Setup</span></span>  
 <span data-ttu-id="5150e-322">![Pracovní postup prostředí pro testování výkonu](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="5150e-322">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
#### <a name="test-setup"></a><span data-ttu-id="5150e-323">Nastavení testu</span><span class="sxs-lookup"><span data-stu-id="5150e-323">Test Setup</span></span>  
 <span data-ttu-id="5150e-324">![Korelace propustnost pracovní postup Test](../../../docs/framework/windows-workflow-foundation/media/correlationthroughputworkflow.gif "CorrelationThroughputWorkflow")</span><span class="sxs-lookup"><span data-stu-id="5150e-324">![Correlation Throughput Workflow Test](../../../docs/framework/windows-workflow-foundation/media/correlationthroughputworkflow.gif "CorrelationThroughputWorkflow")</span></span>  
  
 <span data-ttu-id="5150e-325">Pracovní postup uvedené výše je stejný jako ten, používá v níže uvedené části "Trvalost".</span><span class="sxs-lookup"><span data-stu-id="5150e-325">The workflow shown above is the same one used in the "Persistence" section below.</span></span>  <span data-ttu-id="5150e-326">Pro testy korelace bez trvalost není žádný zprostředkovatel trvalost nainstalován v modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="5150e-326">For the correlation tests without persistence there is no persistence provider installed in the runtime.</span></span>  <span data-ttu-id="5150e-327">Korelace dojde na dvou místech: CreateOrder a CompleteOrder.</span><span class="sxs-lookup"><span data-stu-id="5150e-327">Correlation occurs in two places: CreateOrder and CompleteOrder.</span></span>  
  
#### <a name="test-results"></a><span data-ttu-id="5150e-328">Výsledky testů</span><span class="sxs-lookup"><span data-stu-id="5150e-328">Test Results</span></span>  
 <span data-ttu-id="5150e-329">![Korelace propustnost](../../../docs/framework/windows-workflow-foundation/media/correlationthroughputgraph.gif "CorrelationThroughputGraph")</span><span class="sxs-lookup"><span data-stu-id="5150e-329">![Correlation Throughput](../../../docs/framework/windows-workflow-foundation/media/correlationthroughputgraph.gif "CorrelationThroughputGraph")</span></span>  
  
 <span data-ttu-id="5150e-330">Tento graf znázorňuje k poklesu výkonu jako počet klíčů používaných v zvyšuje korelace na základě obsahu.</span><span class="sxs-lookup"><span data-stu-id="5150e-330">This graph shows a decrease in performance as the number of keys used in content-based correlation increases.</span></span>  <span data-ttu-id="5150e-331">Podobnost v křivek mezi TCP a HTTP označuje režie spojená s tyto protokoly.</span><span class="sxs-lookup"><span data-stu-id="5150e-331">The similarity in the curves between TCP and HTTP indicates the overhead associated with these protocols.</span></span>  
  
#### <a name="correlation-with-persistence"></a><span data-ttu-id="5150e-332">Korelace s trvalost</span><span class="sxs-lookup"><span data-stu-id="5150e-332">Correlation with Persistence</span></span>  
 <span data-ttu-id="5150e-333">V pracovním postupu trvalou zatížení procesoru z korelace na základě obsahu posune z modulu runtime pracovního postupu k databázi SQL.</span><span class="sxs-lookup"><span data-stu-id="5150e-333">With a persisted workflow, the CPU pressure from content-based correlation shifts from the workflow runtime to the SQL database.</span></span>  <span data-ttu-id="5150e-334">Uložené procedury ve zprostředkovateli trvalost SQL práci odpovídající klíče najít odpovídající pracovní postup.</span><span class="sxs-lookup"><span data-stu-id="5150e-334">The stored procedures in the SQL persistence provider do the work of matching the keys to locate the appropriate workflow.</span></span>  
  
 <span data-ttu-id="5150e-335">![Korelace a trvalost výsledků](../../../docs/framework/windows-workflow-foundation/media/correlationandpersistencegraph.gif "CorrelationAndPersistenceGraph")</span><span class="sxs-lookup"><span data-stu-id="5150e-335">![Correlation and persistence results](../../../docs/framework/windows-workflow-foundation/media/correlationandpersistencegraph.gif "CorrelationAndPersistenceGraph")</span></span>  
  
 <span data-ttu-id="5150e-336">Korelace na základě kontextu je stále rychlejší než korelace na základě obsahu.</span><span class="sxs-lookup"><span data-stu-id="5150e-336">Context-based correlation is still faster than content-based correlation.</span></span>  <span data-ttu-id="5150e-337">Rozdíl je ale, že menší vyslovováno jako trvalost má další dopad na výkon než korelace.</span><span class="sxs-lookup"><span data-stu-id="5150e-337">However, the difference is less pronounced as persistence has more impact on performance than correlation.</span></span>  
  
### <a name="complex-workflow-throughput"></a><span data-ttu-id="5150e-338">Komplexní pracovní postup propustnost</span><span class="sxs-lookup"><span data-stu-id="5150e-338">Complex Workflow Throughput</span></span>  
 <span data-ttu-id="5150e-339">Složitost pracovního postupu není měřit pouze počet aktivit.</span><span class="sxs-lookup"><span data-stu-id="5150e-339">The complexity of a workflow is not measured only by the number of activities.</span></span>  <span data-ttu-id="5150e-340">Složené aktivity může obsahovat mnoho podřízené objekty a tyto děti může být také složené aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-340">Composite activities can contain many children and those children can also be composite activities.</span></span>  <span data-ttu-id="5150e-341">Jako počet úrovní vnoření zvyšuje takže nemá počet aktivit, které může být aktuálně ve spuštěném stavu a počet proměnných, které mohou být ve stavu.</span><span class="sxs-lookup"><span data-stu-id="5150e-341">As the number of levels of nesting increases, so does the number of activities that can be currently in the executing state and the number of variables that can be in state.</span></span>  <span data-ttu-id="5150e-342">Tento test porovná propustnost mezi WF3 a WF4 při provádění komplexní pracovní postupy.</span><span class="sxs-lookup"><span data-stu-id="5150e-342">This test compares throughput between WF3 and WF4 when executing complex workflows.</span></span>  
  
### <a name="test-setup"></a><span data-ttu-id="5150e-343">Nastavení testu</span><span class="sxs-lookup"><span data-stu-id="5150e-343">Test Setup</span></span>  
 <span data-ttu-id="5150e-344">Tyto testy byly provedeny u Intel Xeon X5355 @ 2,66 GHz 4 způsob počítače s 4 GB paměti RAM systémem Windows Server 2008 x64.</span><span class="sxs-lookup"><span data-stu-id="5150e-344">These tests were executed on an Intel Xeon X5355 @ 2.66GHz 4-way computer with 4GB RAM running Windows Server 2008 x64.</span></span>  <span data-ttu-id="5150e-345">Spustí kód nástroje test v jediném procesu s jedno vlákno na jeden jádra k dosažení 100 % využití procesoru.</span><span class="sxs-lookup"><span data-stu-id="5150e-345">The test code runs in a single process with one thread per core to reach 100% CPU utilization.</span></span>  
  
 <span data-ttu-id="5150e-346">Pracovní postupy pro tento test generovány mít dvě hlavní proměnné: hloubkou a počet aktivit v každé pořadí.</span><span class="sxs-lookup"><span data-stu-id="5150e-346">The workflows generated for this test have two main variables: depth and number of activities in each sequence.</span></span>  <span data-ttu-id="5150e-347">Každá úroveň hloubky zahrnuje paralelní aktivity, při smyčky, rozhodnutí, přiřazení a pořadí.</span><span class="sxs-lookup"><span data-stu-id="5150e-347">Each depth level includes a parallel activity, while loop, decisions, assignments, and sequences.</span></span>  <span data-ttu-id="5150e-348">V Návrháři WF4 následujících obrázcích je nejvyšší úrovně vývojový diagram obrázku.</span><span class="sxs-lookup"><span data-stu-id="5150e-348">In the WF4 designer pictured below, the top-level flow chart is pictured.</span></span>  <span data-ttu-id="5150e-349">Každá aktivita vývojový diagram vypadá takto: hlavní vývojový diagram.</span><span class="sxs-lookup"><span data-stu-id="5150e-349">Each flowchart activity resembles the main flowchart.</span></span>  <span data-ttu-id="5150e-350">To může být vhodné zamyslet nad fraktálový při picturing tento pracovní postup, kde je omezený na parametry testu hloubka.</span><span class="sxs-lookup"><span data-stu-id="5150e-350">It may be helpful to think of a fractal when picturing this workflow, where the depth is limited to the parameters of the test.</span></span>  
  
 <span data-ttu-id="5150e-351">Počet aktivit v dané testu je dáno hloubkou a počet aktivit na pořadí.</span><span class="sxs-lookup"><span data-stu-id="5150e-351">The number of activities in a given test is determined by the depth and number of activities per sequence.</span></span>  <span data-ttu-id="5150e-352">Následující rovnice vypočítá počet aktivit v testu WF4:</span><span class="sxs-lookup"><span data-stu-id="5150e-352">The following equation computes the number of activities in the WF4 test:</span></span>  
  
 <span data-ttu-id="5150e-353">![Rovnice vypočítat počet aktivit](../../../docs/framework/windows-workflow-foundation/media/numberofactivitiesequation.gif "NumberOfActivitiesEquation")</span><span class="sxs-lookup"><span data-stu-id="5150e-353">![Equation to compute number of activities](../../../docs/framework/windows-workflow-foundation/media/numberofactivitiesequation.gif "NumberOfActivitiesEquation")</span></span>  
  
 <span data-ttu-id="5150e-354">Počet aktivit WF3 test můžete vypočítat se mírně liší rovnice z důvodu navíc pořadí:</span><span class="sxs-lookup"><span data-stu-id="5150e-354">The WF3 test’s activity count can be computed with a slightly different equation due to an extra sequence:</span></span>  
  
 <span data-ttu-id="5150e-355">![Rovnice vypočítat počet aktivit](../../../docs/framework/windows-workflow-foundation/media/w3numberofactivitiesequation.gif "W3NumberOfActivitiesEquation")</span><span class="sxs-lookup"><span data-stu-id="5150e-355">![Equation to compute number of activities](../../../docs/framework/windows-workflow-foundation/media/w3numberofactivitiesequation.gif "W3NumberOfActivitiesEquation")</span></span>  
  
 <span data-ttu-id="5150e-356">Kde d hloubka a je počet aktivit na pořadí.</span><span class="sxs-lookup"><span data-stu-id="5150e-356">Where d is the depth and a is the number of activities per sequence.</span></span>  <span data-ttu-id="5150e-357">Logika za tyto vzorce je, že první konstanta násobí hodnotou a, číslo sekvence a druhý konstanta je statický počet aktivit na aktuální úrovni.</span><span class="sxs-lookup"><span data-stu-id="5150e-357">The logic behind these equations is that the first constant, multiplied by a, is the number of sequences and the second constant is the static number of activities in the current level.</span></span>  <span data-ttu-id="5150e-358">Existují tři vývojový diagram podřízené aktivity v každé vývojový diagram.</span><span class="sxs-lookup"><span data-stu-id="5150e-358">There are three flowchart child activities in each flowchart.</span></span>  <span data-ttu-id="5150e-359">Na nejnižší úrovni hloubka na jiných úrovních jsou kopie hlavní vývojový diagram však tyto vývojových diagramech jsou prázdné.</span><span class="sxs-lookup"><span data-stu-id="5150e-359">At the bottom depth level, these flowcharts are empty but at the other levels they are copies of the main flowchart.</span></span>  <span data-ttu-id="5150e-360">Počet aktivit v každé testovací variace definice pracovního postupu je uvedené v následující tabulce:</span><span class="sxs-lookup"><span data-stu-id="5150e-360">The number of activities in each test variation’s workflow definition is indicated in the following table:</span></span>  
  
 <span data-ttu-id="5150e-361">![Porovná počet aktivit používaných v každém testu](../../../docs/framework/windows-workflow-foundation/media/comparechart.gif "CompareChart")</span><span class="sxs-lookup"><span data-stu-id="5150e-361">![Compares number of activities used in each test](../../../docs/framework/windows-workflow-foundation/media/comparechart.gif "CompareChart")</span></span>  
  
 <span data-ttu-id="5150e-362">Počet aktivit v definici pracovního postupu se zvyšuje prudce s každou úroveň hloubky.</span><span class="sxs-lookup"><span data-stu-id="5150e-362">The number of activities in the workflow definition increases sharply with each depth level.</span></span>  <span data-ttu-id="5150e-363">Se spustí jenom jednu cestu za kritériem při rozhodování, ale v instanci daného pracovního postupu, takže jenom malou část skutečné aktivity provedení.</span><span class="sxs-lookup"><span data-stu-id="5150e-363">But only one path per decision point is executed in a given workflow instance, so only a small subset of the actual activities are executed.</span></span>  
  
 <span data-ttu-id="5150e-364">![Komplexní pracovní postup](../../../docs/framework/windows-workflow-foundation/media/complexworkflowthroughputworkflow.gif "ComplexWorkflowThroughputWorkflow")</span><span class="sxs-lookup"><span data-stu-id="5150e-364">![Complex Workflow](../../../docs/framework/windows-workflow-foundation/media/complexworkflowthroughputworkflow.gif "ComplexWorkflowThroughputWorkflow")</span></span>  
  
 <span data-ttu-id="5150e-365">Ekvivalentní pracovní postup byl vytvořen pro WF3.</span><span class="sxs-lookup"><span data-stu-id="5150e-365">An equivalent workflow was created for WF3.</span></span> <span data-ttu-id="5150e-366">Návrhář WF3 zobrazí celý pracovní postup v oblasti návrhu místo vnoření, proto, že je příliš dlouhý pro zobrazení v tomto tématu.</span><span class="sxs-lookup"><span data-stu-id="5150e-366">The WF3 designer shows the entire workflow in the design area instead of nesting, therefore it is too big to display in this topic.</span></span> <span data-ttu-id="5150e-367">Fragment pracovního postupu jsou uvedeny níže.</span><span class="sxs-lookup"><span data-stu-id="5150e-367">A snippet of the workflow is shown below.</span></span>  
  
 <span data-ttu-id="5150e-368">![WF3 Pracovní postup](../../../docs/framework/windows-workflow-foundation/media/wf3workflow.gif "WF3Workflow")</span><span class="sxs-lookup"><span data-stu-id="5150e-368">![WF3 Workflow](../../../docs/framework/windows-workflow-foundation/media/wf3workflow.gif "WF3Workflow")</span></span>  
  
 <span data-ttu-id="5150e-369">Vykonávat vnoření v extreme případě používá jiný pracovní postup, který je součástí tento test 100 vnořené pořadí.</span><span class="sxs-lookup"><span data-stu-id="5150e-369">To exercise nesting in an extreme case, another workflow that is part of this test uses 100 nested sequences.</span></span>  <span data-ttu-id="5150e-370">V nejvnitřnější pořadí je jediný `Comment` nebo <xref:System.Workflow.Activities.CodeActivity>.</span><span class="sxs-lookup"><span data-stu-id="5150e-370">In the innermost sequence is a single `Comment` or <xref:System.Workflow.Activities.CodeActivity>.</span></span>  
  
 <span data-ttu-id="5150e-371">![Vnořené pořadí](../../../docs/framework/windows-workflow-foundation/media/nestedsequencewf.gif "NestedSequenceWF")</span><span class="sxs-lookup"><span data-stu-id="5150e-371">![Nested sequences](../../../docs/framework/windows-workflow-foundation/media/nestedsequencewf.gif "NestedSequenceWF")</span></span>  
  
 <span data-ttu-id="5150e-372">Sledování a trvalost nejsou použity jako součást tento test.</span><span class="sxs-lookup"><span data-stu-id="5150e-372">Tracking and persistence are not used as part of this test.</span></span>  
  
### <a name="test-results"></a><span data-ttu-id="5150e-373">Výsledky testů</span><span class="sxs-lookup"><span data-stu-id="5150e-373">Test Results</span></span>  
 <span data-ttu-id="5150e-374">![Diagram propustnosti](../../../docs/framework/windows-workflow-foundation/media/testresults1.gif "TestResults1")</span><span class="sxs-lookup"><span data-stu-id="5150e-374">![Throughput Graph](../../../docs/framework/windows-workflow-foundation/media/testresults1.gif "TestResults1")</span></span>  
  
 <span data-ttu-id="5150e-375">I komplexní pracovních s mnoha hloubky a vysoký počet aktivit, výsledky výkonu jsou konzistentní s další propustnost čísla uvedené dříve v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="5150e-375">Even with complex workflows with lots of depth and a high number of activities, the performance results are consistent with other throughput numbers shown earlier in this article.</span></span>  <span data-ttu-id="5150e-376">Propustnost WF4 na pořadí podle velikosti je rychlejší a má být porovnána na logaritmickém měřítku.</span><span class="sxs-lookup"><span data-stu-id="5150e-376">WF4’s throughput is orders of magnitude faster and has to be compared on a logarithmic scale.</span></span>  
  
### <a name="memory"></a><span data-ttu-id="5150e-377">Paměť</span><span class="sxs-lookup"><span data-stu-id="5150e-377">Memory</span></span>  
 <span data-ttu-id="5150e-378">Nároky na paměť modelu Windows Workflow Foundation se měří v dvě klíčové oblasti: pracovní postup složitost a počet definicí pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-378">The memory overhead of Windows Workflow Foundation is measured in two key areas: workflow complexity and number of workflow definitions.</span></span>  <span data-ttu-id="5150e-379">Paměť měření byly provedeny na pracovní stanici 64bitová verze Windows 7.</span><span class="sxs-lookup"><span data-stu-id="5150e-379">Memory measurements were taken on a Windows 7 64-bit workstation.</span></span>  <span data-ttu-id="5150e-380">Existuje mnoho způsobů, jak získat měření velikost pracovní sady například monitorování čítače výkonu, dotazování Environment.WorkingSet nebo pomocí nástroje, například VMMap dostupné z [VMMap](http://technet.microsoft.com/sysinternals/dd535533.aspx).</span><span class="sxs-lookup"><span data-stu-id="5150e-380">There are many ways to obtain the measurement of working set size such as monitoring performance counters, polling Environment.WorkingSet, or using a tool like VMMap available from [VMMap](http://technet.microsoft.com/sysinternals/dd535533.aspx).</span></span> <span data-ttu-id="5150e-381">Kombinaci metod byl použit k získání a ověřte výsledky testu.</span><span class="sxs-lookup"><span data-stu-id="5150e-381">A combination of methods was used to obtain and verify the results of each test.</span></span>  
  
### <a name="workflow-complexity-test"></a><span data-ttu-id="5150e-382">Test složitost pracovního postupu</span><span class="sxs-lookup"><span data-stu-id="5150e-382">Workflow Complexity Test</span></span>  
 <span data-ttu-id="5150e-383">Pracovní postup složitost otestovat míry pracovní nastavena rozdíl podle složitosti pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-383">The workflow complexity test measures the working set difference based on the complexity of the workflow.</span></span>  <span data-ttu-id="5150e-384">Kromě komplexní pracovní postupy použité v předchozí části, se přidají nové varianty pro dvě základní případy: jediné aktivity pracovního postupu a pořadí s aktivitami 1000.</span><span class="sxs-lookup"><span data-stu-id="5150e-384">In addition to the complex workflows used in the previous section, new variations are added to cover two basic cases: a single activity workflow and a sequence with 1000 activities.</span></span>  <span data-ttu-id="5150e-385">Pro tyto testy jsou pracovní postupy inicializován a provést dokončen v jedinou smyčku. sériové po dobu jedné minuty.</span><span class="sxs-lookup"><span data-stu-id="5150e-385">For these tests the workflows are initialized and executed to completion in a single serial loop for a period of one minute.</span></span>  <span data-ttu-id="5150e-386">Každý test variace běží třikrát a data zaznamenaná je průměr těchto tří spustí.</span><span class="sxs-lookup"><span data-stu-id="5150e-386">Each test variation is run three times and the data recorded is the average of those three runs.</span></span>  
  
 <span data-ttu-id="5150e-387">Dva nové základní testy mít pracovní postupy, které vypadají stejně jako vidíte níže:</span><span class="sxs-lookup"><span data-stu-id="5150e-387">The two new basic tests have workflows that look like those shown below:</span></span>  
  
 <span data-ttu-id="5150e-388">![Komplexní pracovní postupy](../../../docs/framework/windows-workflow-foundation/media/complexworkflowboth.gif "ComplexWorkflowBoth")</span><span class="sxs-lookup"><span data-stu-id="5150e-388">![Complex Workflows](../../../docs/framework/windows-workflow-foundation/media/complexworkflowboth.gif "ComplexWorkflowBoth")</span></span>  
  
 <span data-ttu-id="5150e-389">V pracovním postupu WF3 uvedené výše, prázdný <xref:System.Workflow.Activities.CodeActivity> aktivity se používají.</span><span class="sxs-lookup"><span data-stu-id="5150e-389">In the WF3 workflow shown above, empty <xref:System.Workflow.Activities.CodeActivity> activities are used.</span></span>  <span data-ttu-id="5150e-390">Pracovní postup WF4 výše používá `Comment` aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-390">The WF4 workflow above uses `Comment` activities.</span></span>  <span data-ttu-id="5150e-391">`Comment` Aktivita byla popsaný v části porovnání výkonu úrovni součástí výše v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="5150e-391">The `Comment` activity was described in the Component-level Performance Comparisons section earlier in this article.</span></span>  
  
 <span data-ttu-id="5150e-392">![Graf využití paměti](../../../docs/framework/windows-workflow-foundation/media/complexmemoryusage.gif "ComplexMemoryUsage")</span><span class="sxs-lookup"><span data-stu-id="5150e-392">![Memory Usage Graph](../../../docs/framework/windows-workflow-foundation/media/complexmemoryusage.gif "ComplexMemoryUsage")</span></span>  
  
 <span data-ttu-id="5150e-393">Jedním z zrušte trendy Všimněte v tomto grafu je, že vnoření má poměrně minimální dopad na využití paměti v WF3 a WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-393">One of the clear trends to notice in this graph is that nesting has relatively minimal impact on memory usage in both WF3 and WF4.</span></span>  <span data-ttu-id="5150e-394">Nejvýraznější dopad paměti pochází z počet aktivit v daném pracovním postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-394">The most significant memory impact comes from the number of activities in a given workflow.</span></span>  <span data-ttu-id="5150e-395">Vzhledem data z pořadí 1000, komplexní hloubka 5 pořadí 5 a komplexní hloubka 7 pořadí 1 variace, je zřejmé, že jako počet aktivit, zadá tisíců, nárůst využití paměti se více pozná.</span><span class="sxs-lookup"><span data-stu-id="5150e-395">Given the data from the sequence 1000, complex depth 5 sequence 5, and complex depth 7 sequence 1 variations, it is clear that as the number of activities enters the thousands, the memory usage increase becomes more noticeable.</span></span>  <span data-ttu-id="5150e-396">V případě extrémně (hloubku 7 pořadí 1) tam, kde jsou aktivity tisíc ~ 29, WF4 používá téměř 79 % méně paměti, než je WF3.</span><span class="sxs-lookup"><span data-stu-id="5150e-396">In the extreme case (depth 7 sequence 1) where there are ~29K activities, WF4 is using almost 79% less memory than WF3.</span></span>  
  
### <a name="multiple-workflow-definitions-test"></a><span data-ttu-id="5150e-397">Více testů definice pracovního postupu</span><span class="sxs-lookup"><span data-stu-id="5150e-397">Multiple Workflow Definitions Test</span></span>  
 <span data-ttu-id="5150e-398">Měření paměť na definice pracovního postupu je rozdělena na dva různé testy z důvodu dostupné možnosti pro hostování pracovních postupů v WF3 a WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-398">Measuring memory per workflow definition is divided into two different tests because of the available options for hosting workflows in WF3 and WF4.</span></span>  <span data-ttu-id="5150e-399">Testy se spouštějí jiným způsobem než pracovní postup test složitost v, aby instance a provést pouze jednou za definice daného pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-399">The tests are run in a different manner than the workflow complexity test in that a given workflow is instanced and executed only once per definition.</span></span>  <span data-ttu-id="5150e-400">Je to proto, že definice pracovního postupu a jeho hostitel zůstanou v paměti pro dobu životnosti domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="5150e-400">This is because the workflow definition and its host remain in memory for the lifetime of the AppDomain.</span></span>  <span data-ttu-id="5150e-401">Paměť použitá spuštěním instanci daného pracovního postupu by měla být vyčištěna během uvolňování paměti.</span><span class="sxs-lookup"><span data-stu-id="5150e-401">The memory used by running a given workflow instance should be cleaned up during garbage collection.</span></span>  <span data-ttu-id="5150e-402">Migrace pokyny pro WF4 obsahuje podrobnější informace o možnosti hostování.</span><span class="sxs-lookup"><span data-stu-id="5150e-402">The migration guidance for WF4 contains more detailed information on the hosting options.</span></span> <span data-ttu-id="5150e-403">Další informace najdete v tématu [WF migrace kuchařka: pracovní postup hostování](http://go.microsoft.com/fwlink/?LinkID=153313).</span><span class="sxs-lookup"><span data-stu-id="5150e-403">For more information, see [WF Migration Cookbook: Workflow Hosting](http://go.microsoft.com/fwlink/?LinkID=153313).</span></span>  
  
 <span data-ttu-id="5150e-404">Vytváření mnoho definice pracovního postupu pro definici pracovního postupu test lze provést několika způsoby.</span><span class="sxs-lookup"><span data-stu-id="5150e-404">Creating many workflow definitions for a workflow definition test can be done in several ways.</span></span>  <span data-ttu-id="5150e-405">Například jeden pomocí generování kódu můžete vytvořit sadu 1000 pracovní postupy, které jsou stejné s výjimkou v názvu a každý z těchto pracovních postupů uložit do samostatných souborů.</span><span class="sxs-lookup"><span data-stu-id="5150e-405">For instance, one could use code generation to create a set of 1000 workflows that are identical except in name and save each of those workflows into separate files.</span></span>  <span data-ttu-id="5150e-406">Tento přístup, nebyla provedena pro test hostovaných v konzole.</span><span class="sxs-lookup"><span data-stu-id="5150e-406">This approach was taken for the console-hosted test.</span></span>  <span data-ttu-id="5150e-407">V WF3 <xref:System.Workflow.Runtime.WorkflowRuntime> třída se používá ke spouštění definice pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-407">In WF3, the <xref:System.Workflow.Runtime.WorkflowRuntime> class was used to run the workflow definitions.</span></span>  <span data-ttu-id="5150e-408">Můžete buď používat WF4 <xref:System.Activities.WorkflowApplication> k vytvoření instance jednoho pracovního postupu nebo přímo <xref:System.Activities.WorkflowInvoker> ke spuštění aktivity, jako by šlo volání metody.</span><span class="sxs-lookup"><span data-stu-id="5150e-408">WF4 can either use <xref:System.Activities.WorkflowApplication> to create a single workflow instance or directly use <xref:System.Activities.WorkflowInvoker> to run the activity as if it were a method call.</span></span>  <span data-ttu-id="5150e-409"><xref:System.Activities.WorkflowApplication> je hostitelem instance jednoho pracovního postupu a má blíže parity funkcí k <xref:System.Workflow.Runtime.WorkflowRuntime> tak, aby byl použit v tomto testu.</span><span class="sxs-lookup"><span data-stu-id="5150e-409"><xref:System.Activities.WorkflowApplication> is a host of a single workflow instance and has closer feature parity to <xref:System.Workflow.Runtime.WorkflowRuntime> so that was used in this test.</span></span>  
  
 <span data-ttu-id="5150e-410">Při hostování pracovních postupů ve službě IIS je možné použít <xref:System.Web.Hosting.VirtualPathProvider> pro vytvoření nového <xref:System.ServiceModel.WorkflowServiceHost> místo aby generovala všechny soubory XAMLX nebo XOML.</span><span class="sxs-lookup"><span data-stu-id="5150e-410">When hosting workflows in IIS it is possible to use a <xref:System.Web.Hosting.VirtualPathProvider> to create a new <xref:System.ServiceModel.WorkflowServiceHost> instead of generating all of the XAMLX or XOML files.</span></span>  <span data-ttu-id="5150e-411"><xref:System.Web.Hosting.VirtualPathProvider> Zpracuje příchozí požadavek a odpoví "virtuální soubor", lze načíst z databáze nebo, v takovém případě vytvořit za chodu.</span><span class="sxs-lookup"><span data-stu-id="5150e-411">The <xref:System.Web.Hosting.VirtualPathProvider> handles the incoming request and responds with a "virtual file" that can be loaded from a database or, in this case, generated on the fly.</span></span>  <span data-ttu-id="5150e-412">Proto není nutné vytvořit fyzické soubory 1000.</span><span class="sxs-lookup"><span data-stu-id="5150e-412">It is therefore unnecessary to create 1000 physical files.</span></span>  
  
 <span data-ttu-id="5150e-413">Definice pracovního postupu v konzole testu byly jednoduchý sekvenční pracovní postupy pomocí jediné aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-413">The workflow definitions used in the console test were simple sequential workflows with a single activity.</span></span>  <span data-ttu-id="5150e-414">Jediné aktivity byl prázdnou <xref:System.Workflow.Activities.CodeActivity> pro případ WF3 a `Comment` aktivity pro případ WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-414">The single activity was an empty <xref:System.Workflow.Activities.CodeActivity> for the WF3 case and a `Comment` activity for the WF4 case.</span></span>  <span data-ttu-id="5150e-415">Tento případ hostované službou IIS použít pracovní postupy, které začínají na příjem zprávy a end na odeslání odpovědi:</span><span class="sxs-lookup"><span data-stu-id="5150e-415">The IIS-hosted case used workflows that start on receiving a message and end on sending a reply:</span></span>  
  
 <span data-ttu-id="5150e-416">![Služby pracovních postupů v WF3 a WF4](../../../docs/framework/windows-workflow-foundation/media/receiveworkflowboth.gif "ReceiveWorkflowBoth")</span><span class="sxs-lookup"><span data-stu-id="5150e-416">![Workflow Services in WF3 and WF4](../../../docs/framework/windows-workflow-foundation/media/receiveworkflowboth.gif "ReceiveWorkflowBoth")</span></span>  
  
 <span data-ttu-id="5150e-417">Obrázek 4 – pracovní postup WF3 s ReceiveActivity a WF4 pracovního postupu pomocí vzoru požadavků a odpovědí</span><span class="sxs-lookup"><span data-stu-id="5150e-417">Figure 4 – WF3 workflow with ReceiveActivity and WF4 workflow with request/response pattern</span></span>  
  
 <span data-ttu-id="5150e-418">Následující tabulka ukazuje rozdíl v pracovní sadě mezi definici jednoho pracovního postupu a definice 1001:</span><span class="sxs-lookup"><span data-stu-id="5150e-418">The table below shows the delta in working set between a single workflow definition and 1001 definitions:</span></span>  
  
|<span data-ttu-id="5150e-419">Možnosti hostování</span><span class="sxs-lookup"><span data-stu-id="5150e-419">Hosting Options</span></span>|<span data-ttu-id="5150e-420">WF3 Rozdíl pracovní sady</span><span class="sxs-lookup"><span data-stu-id="5150e-420">WF3 Working Set Delta</span></span>|<span data-ttu-id="5150e-421">WF4 Rozdíl pracovní sady</span><span class="sxs-lookup"><span data-stu-id="5150e-421">WF4 Working Set Delta</span></span>|  
|---------------------|---------------------------|---------------------------|  
|<span data-ttu-id="5150e-422">Konzolové aplikace hostované pracovních postupů</span><span class="sxs-lookup"><span data-stu-id="5150e-422">Console Application Hosted Workflows</span></span>|<span data-ttu-id="5150e-423">18 MB</span><span class="sxs-lookup"><span data-stu-id="5150e-423">18 MB</span></span>|<span data-ttu-id="5150e-424">9 MB</span><span class="sxs-lookup"><span data-stu-id="5150e-424">9 MB</span></span>|  
|<span data-ttu-id="5150e-425">Služby pracovních postupů, hostovaná IIS</span><span class="sxs-lookup"><span data-stu-id="5150e-425">IIS Hosted Workflow Services</span></span>|<span data-ttu-id="5150e-426">446 MB</span><span class="sxs-lookup"><span data-stu-id="5150e-426">446 MB</span></span>|<span data-ttu-id="5150e-427">364 MB</span><span class="sxs-lookup"><span data-stu-id="5150e-427">364 MB</span></span>|  
  
 <span data-ttu-id="5150e-428">Hostování definice pracovního postupu ve službě IIS využívá mnohem víc paměti z důvodu <xref:System.ServiceModel.WorkflowServiceHost>, podrobné artefaktů služby WCF a zpracovává logiku spojovanou s hostitelem zprávy.</span><span class="sxs-lookup"><span data-stu-id="5150e-428">Hosting workflow definitions in IIS consumes much more memory due to the <xref:System.ServiceModel.WorkflowServiceHost>, detailed WCF service artifacts, and the message processing logic associated with the host.</span></span>  
  
 <span data-ttu-id="5150e-429">Pro hostování pracovních postupů v WF3 konzolu byly implementovány v kódu místo XOML.</span><span class="sxs-lookup"><span data-stu-id="5150e-429">For console hosting in WF3 the workflows were implemented in code instead of XOML.</span></span>  <span data-ttu-id="5150e-430">Ve výchozím nastavení se v WF4 použít XAML.</span><span class="sxs-lookup"><span data-stu-id="5150e-430">In WF4 the default is to use XAML.</span></span>  <span data-ttu-id="5150e-431">XAML je uložena jako vložený prostředek v sestavení a kompilované za běhu k zajištění implementace pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-431">The XAML is stored as an embedded resource in the assembly and compiled during runtime to provide the implementation of the workflow.</span></span>  <span data-ttu-id="5150e-432">Je některé režijní náklady spojené s tímto procesem.</span><span class="sxs-lookup"><span data-stu-id="5150e-432">There is some overhead associated with this process.</span></span>  <span data-ttu-id="5150e-433">Aby bylo možné správného porovnání mezi WF3 a WF4, programové pracovních používaly místo XAML.</span><span class="sxs-lookup"><span data-stu-id="5150e-433">In order to make a fair comparison between WF3 and WF4, coded workflows were used instead of XAML.</span></span>  <span data-ttu-id="5150e-434">Příklad WF4 pracovních postupů, je zobrazena níže:</span><span class="sxs-lookup"><span data-stu-id="5150e-434">An example of one of the WF4 workflows is shown below:</span></span>  
  
```  
public class Workflow1 : Activity  
{  
    protected override Func<Activity> Implementation  
    {  
        get  
        {  
            return new Func<Activity>(() =>  
            {  
                return new Sequence  
                {  
                    Activities = {  
                        new Comment()  
                    }  
                };  
            });  
        }  
        set  
        {  
            base.Implementation = value;  
        }  
    }  
}  
```  
  
 <span data-ttu-id="5150e-435">Existuje mnoho dalších faktorů, které můžou ovlivnit využití paměti.</span><span class="sxs-lookup"><span data-stu-id="5150e-435">There are many other factors that can affect memory consumption.</span></span> <span data-ttu-id="5150e-436">Stejné Rady pro všechny spravované programy stále platí.</span><span class="sxs-lookup"><span data-stu-id="5150e-436">The same advice for all managed programs still applies.</span></span>  <span data-ttu-id="5150e-437">V prostředích IIS hostované <xref:System.ServiceModel.WorkflowServiceHost> objekt vytvořený pro definici pracovního postupu zůstává v paměti, dokud dojde k recyklování fondu aplikací.</span><span class="sxs-lookup"><span data-stu-id="5150e-437">In IIS-hosted environments, the <xref:System.ServiceModel.WorkflowServiceHost> object created for a workflow definition stays in memory until the application pool is recycled.</span></span>  <span data-ttu-id="5150e-438">To by měly být udržovány na paměti, při zápisu rozšíření.</span><span class="sxs-lookup"><span data-stu-id="5150e-438">This should be kept in mind when writing extensions.</span></span>  <span data-ttu-id="5150e-439">Je také vhodné vyhnout "globální" proměnné (proměnné omezená na celý pracovní postup) a omezit rozsah proměnné, pokud je to možné.</span><span class="sxs-lookup"><span data-stu-id="5150e-439">Also, it is best to avoid "global" variables (variables scoped to the whole workflow) and limit the scope of variables wherever possible.</span></span>  
  
## <a name="workflow-runtime-services"></a><span data-ttu-id="5150e-440">Služby modulu Runtime pracovního postupu</span><span class="sxs-lookup"><span data-stu-id="5150e-440">Workflow Runtime Services</span></span>  
  
### <a name="persistence"></a><span data-ttu-id="5150e-441">Trvalost</span><span class="sxs-lookup"><span data-stu-id="5150e-441">Persistence</span></span>  
 <span data-ttu-id="5150e-442">WF3 a WF4 obě dodávají spolu s trvalost zprostředkovatele SQL.</span><span class="sxs-lookup"><span data-stu-id="5150e-442">WF3 and WF4 both ship with a SQL persistence provider.</span></span>  <span data-ttu-id="5150e-443">Zprostředkovatel trvalost WF3 SQL je jednoduché implementace, který serializuje instance pracovního postupu a ukládá je do objektu BLOB.</span><span class="sxs-lookup"><span data-stu-id="5150e-443">The WF3 SQL persistence provider is a simple implementation that serializes the workflow instance and stores it in a blob.</span></span>  <span data-ttu-id="5150e-444">Z tohoto důvodu výkon tohoto zprostředkovatele výraznou závisí na velikosti k instanci pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-444">For this reason, the performance of this provider depends heavily on the size of the workflow instance.</span></span>  <span data-ttu-id="5150e-445">V WF3 může zvýšit velikost instance z mnoha důvodů, jak je popsané dříve v tomto dokumentu.</span><span class="sxs-lookup"><span data-stu-id="5150e-445">In WF3, the instance size could increase for many reasons, as is discussed previously in this paper.</span></span>  <span data-ttu-id="5150e-446">Mnoho zákazníků rozhodnout použít výchozího poskytovatele trvalost SQL, protože ukládání serializovaných instance v databázi poskytuje žádné přehled o stavu pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-446">Many customers choose not to use the default SQL persistence provider because storing a serialized instance in a database gives no visibility into the state of the workflow.</span></span>  <span data-ttu-id="5150e-447">Chcete-li vyhledat konkrétní pracovní postup bez znalosti id pracovního postupu, jeden musel deserializovat každou trvalou instanci a zkontrolujte obsah.</span><span class="sxs-lookup"><span data-stu-id="5150e-447">In order to find a particular workflow without knowing the workflow id, one would have to deserialize each persisted instance and examine the contents.</span></span>  <span data-ttu-id="5150e-448">Zápis vlastních poskytovatelů trvalost k překonání tuto překážku přednost tomu celá řada vývojářů.</span><span class="sxs-lookup"><span data-stu-id="5150e-448">Many developers prefer to write their own persistence providers to overcome this obstacle.</span></span>  
  
 <span data-ttu-id="5150e-449">Zprostředkovatel trvalost WF4 SQL se pokusila některé tyto problémy vyřešit.</span><span class="sxs-lookup"><span data-stu-id="5150e-449">The WF4 SQL persistence provider has tried to address some of these concerns.</span></span>  <span data-ttu-id="5150e-450">V tabulkách trvalost vystavit určité informace, jako je active záložky a možné zvýšit vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="5150e-450">The persistence tables expose certain information such as the active bookmarks and promotable properties.</span></span>  <span data-ttu-id="5150e-451">Nová funkce korelace na základě obsahu v WF4 nebude provádět i pomocí přístup trvalost WF3 SQL, kde má řízené některé změny v organizaci k instanci pracovního postupu trvalý.</span><span class="sxs-lookup"><span data-stu-id="5150e-451">The new content-based correlation feature in WF4 would not perform well using the WF3 SQL persistence approach, which has driven some change in the organization of the persisted workflow instance.</span></span>  <span data-ttu-id="5150e-452">To usnadňuje složitější úlohy zprostředkovatele trvalosti a vloží navíc přízvuk v databázi.</span><span class="sxs-lookup"><span data-stu-id="5150e-452">This makes the job of the persistence provider more complex and puts extra stress on the database.</span></span>  
  
### <a name="environment-setup"></a><span data-ttu-id="5150e-453">Nastavení prostředí</span><span class="sxs-lookup"><span data-stu-id="5150e-453">Environment Setup</span></span>  
 <span data-ttu-id="5150e-454">![Pracovní postup prostředí pro testování výkonu](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="5150e-454">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
### <a name="test-setup"></a><span data-ttu-id="5150e-455">Nastavení testu</span><span class="sxs-lookup"><span data-stu-id="5150e-455">Test Setup</span></span>  
 <span data-ttu-id="5150e-456">I když sada vylepšené funkcí a lepší souběžnosti zpracování je rychlejší než zprostředkovatele v WF3 trvalost zprostředkovatele SQL v WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-456">Even with an improved feature set and better concurrency handling, the SQL persistence provider in WF4 is faster than the provider in WF3.</span></span>  <span data-ttu-id="5150e-457">K prezentují to, jsou dva pracovní postupy, které provádějí v podstatě stejné operace v WF3 a WF4 porovná níže.</span><span class="sxs-lookup"><span data-stu-id="5150e-457">To showcase this, two workflows that perform essentially the same operations in WF3 and WF4 are compared below.</span></span>  
  
 <span data-ttu-id="5150e-458">![Trvalost pracovních](../../../docs/framework/windows-workflow-foundation/media/persistworkflow.gif "PersistWorkflow")</span><span class="sxs-lookup"><span data-stu-id="5150e-458">![Persistence Workflows](../../../docs/framework/windows-workflow-foundation/media/persistworkflow.gif "PersistWorkflow")</span></span>  
  
 <span data-ttu-id="5150e-459">Obrázek 5 – pracovní postup trvalost v WF3 na levé a WF4 vpravo</span><span class="sxs-lookup"><span data-stu-id="5150e-459">Figure 5 – Persistence workflow in WF3 on left and WF4 on right</span></span>  
  
 <span data-ttu-id="5150e-460">Oba dva pracovní postupy jsou vytvořené pomocí přijaté zprávy.</span><span class="sxs-lookup"><span data-stu-id="5150e-460">The two workflows are both created by a received message.</span></span>  <span data-ttu-id="5150e-461">Po odeslání počáteční odpovědět, je trvalé pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-461">After sending an initial reply, the workflow is persisted.</span></span>  <span data-ttu-id="5150e-462">V případě WF3 prázdnou <xref:System.Workflow.ComponentModel.TransactionScopeActivity> se použilo k zahájení trvalost.</span><span class="sxs-lookup"><span data-stu-id="5150e-462">In the WF3 case, an empty <xref:System.Workflow.ComponentModel.TransactionScopeActivity> is used to initiate the persistence.</span></span>  <span data-ttu-id="5150e-463">Stejné by mohl dosáhnout WF3 označením aktivitu jako "zachovat při zavření."</span><span class="sxs-lookup"><span data-stu-id="5150e-463">The same could be achieved in WF3 by marking an activity as "persist on close."</span></span>  <span data-ttu-id="5150e-464">Druhý, korelační zpráva dokončení pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-464">A second, correlated message completes the workflow.</span></span>  <span data-ttu-id="5150e-465">Pracovní postupy jsou nastavené jako trvalé, ale není odpojeno.</span><span class="sxs-lookup"><span data-stu-id="5150e-465">The workflows are persisted but not unloaded.</span></span>  
  
### <a name="test-results"></a><span data-ttu-id="5150e-466">Výsledky testů</span><span class="sxs-lookup"><span data-stu-id="5150e-466">Test Results</span></span>  
 <span data-ttu-id="5150e-467">![Propustnost trvalost](../../../docs/framework/windows-workflow-foundation/media/throughputpersistence.gif "ThroughputPersistence")</span><span class="sxs-lookup"><span data-stu-id="5150e-467">![Throughput Persistence](../../../docs/framework/windows-workflow-foundation/media/throughputpersistence.gif "ThroughputPersistence")</span></span>  
  
 <span data-ttu-id="5150e-468">Při přenosu mezi klientem a střední vrstvy, je HTTP, zobrazuje trvalost v WF4 zlepšení 2.6 časy.</span><span class="sxs-lookup"><span data-stu-id="5150e-468">When the transport between client and middle tier is HTTP, persistence in WF4 shows an improvement of 2.6 times.</span></span>  <span data-ttu-id="5150e-469">Přenos TCP zvyšuje faktor 3.0 časy.</span><span class="sxs-lookup"><span data-stu-id="5150e-469">The TCP transport increases that factor to 3.0 times.</span></span>  <span data-ttu-id="5150e-470">Ve všech případech je využití procesoru na střední vrstvě 98 % nebo vyšší.</span><span class="sxs-lookup"><span data-stu-id="5150e-470">In all cases, CPU utilization on the middle tier is 98% or higher.</span></span>  <span data-ttu-id="5150e-471">Z důvodu, že WF4 propustnost je větší je z důvodu rychlejší modulu runtime pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-471">The reason that WF4 throughput is greater is due to the faster workflow runtime.</span></span>  <span data-ttu-id="5150e-472">Velikost serializovaných instance je nízké obou případech a není hlavní přispívajících element v této situaci.</span><span class="sxs-lookup"><span data-stu-id="5150e-472">The size of the serialized instance is low for both cases and is not a major contributing element in this situation.</span></span>  
  
 <span data-ttu-id="5150e-473">WF3 i WF4 pracovní postupy v tomto testu použít aktivitu do explicitně o tom, kdy má dojít k trvalost.</span><span class="sxs-lookup"><span data-stu-id="5150e-473">Both the WF3 and WF4 workflows in this test use an activity to explicitly indicate when persistence should occur.</span></span>  <span data-ttu-id="5150e-474">To má výhodu setrvání pracovního postupu bez uvolnění ho.</span><span class="sxs-lookup"><span data-stu-id="5150e-474">This has the benefit of persisting the workflow without unloading it.</span></span>  <span data-ttu-id="5150e-475">V WF3, je také možné zachovat pomocí <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> funkce, ale uvolní instanci pracovního postupu z paměti.</span><span class="sxs-lookup"><span data-stu-id="5150e-475">In WF3, it is also possible to persist using the <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> feature, but this unloads the workflow instance from memory.</span></span>  <span data-ttu-id="5150e-476">Pokud vývojář pomocí WF3 chce Ujistěte se, že pracovní postup přetrvává v určitých bodech, budou mít buď alter definice pracovního postupu nebo zaplacení náklady pro uvolnění a znovu načítání instance pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-476">If a developer using WF3 wants to make sure a workflow persists at certain points, they either have to alter the workflow definition or pay the cost for unloading and re-loading the workflow instance.</span></span>  <span data-ttu-id="5150e-477">Nová funkce v WF4 umožňuje zachovat bez uvolnění: <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A>.</span><span class="sxs-lookup"><span data-stu-id="5150e-477">A new feature in WF4 makes it possible to persist without unloading: <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToPersist%2A>.</span></span>  <span data-ttu-id="5150e-478">Tato funkce umožňuje k instanci pracovního postupu na nastavit jako trvalý v nečinnosti, ale zůstane paměť, dokud <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> dosáhla prahová hodnota nebo provedení obnovení.</span><span class="sxs-lookup"><span data-stu-id="5150e-478">This feature allows the workflow instance to be persisted on idle but stay in memory until the <xref:System.ServiceModel.Activities.Description.WorkflowIdleBehavior.TimeToUnload%2A> threshold is met or execution is resumed.</span></span>  
  
 <span data-ttu-id="5150e-479">Pamatujte, že zprostředkovatel trvalost WF4 SQL další práci v databázové vrstvy.</span><span class="sxs-lookup"><span data-stu-id="5150e-479">Note that the WF4 SQL persistence provider performs more work in the database tier.</span></span>  <span data-ttu-id="5150e-480">Databáze SQL se může stát úzkým místem, je důležité monitorovat existuje využití procesoru a disku.</span><span class="sxs-lookup"><span data-stu-id="5150e-480">The SQL database can become a bottleneck so it is important to monitor the CPU and disk usage there.</span></span>  <span data-ttu-id="5150e-481">Nezapomeňte zahrnout následující čítače výkonu z SQL databáze při testování pracovního postupu aplikace výkonu:</span><span class="sxs-lookup"><span data-stu-id="5150e-481">Be sure to include the following performance counters from the SQL database when performance testing workflow applications:</span></span>  
  
-   <span data-ttu-id="5150e-482">Fyzický disk\\čas čtení disku %</span><span class="sxs-lookup"><span data-stu-id="5150e-482">PhysicalDisk\\%Disk Read Time</span></span>  
  
-   <span data-ttu-id="5150e-483">Fyzický disk\\% času disku</span><span class="sxs-lookup"><span data-stu-id="5150e-483">PhysicalDisk\\% Disk Time</span></span>  
  
-   <span data-ttu-id="5150e-484">Fyzický disk\\disku % času zápisu</span><span class="sxs-lookup"><span data-stu-id="5150e-484">PhysicalDisk\\% Disk Write Time</span></span>  
  
-   <span data-ttu-id="5150e-485">Fyzický disk\\% střední Délka fronty disku</span><span class="sxs-lookup"><span data-stu-id="5150e-485">PhysicalDisk\\% Avg. Disk Queue Length</span></span>  
  
-   <span data-ttu-id="5150e-486">Fyzický. Délka fronty disku pro čtení</span><span class="sxs-lookup"><span data-stu-id="5150e-486">PhysicalDisk\Avg. Disk Read Queue Length</span></span>  
  
-   <span data-ttu-id="5150e-487">Fyzický. Délka fronty disku zápisu</span><span class="sxs-lookup"><span data-stu-id="5150e-487">PhysicalDisk\Avg. Disk Write Queue Length</span></span>  
  
-   <span data-ttu-id="5150e-488">Délka fronty disku PhysicalDisk\Current</span><span class="sxs-lookup"><span data-stu-id="5150e-488">PhysicalDisk\Current Disk Queue Length</span></span>  
  
-   <span data-ttu-id="5150e-489">Informace o procesoru\\% času procesoru</span><span class="sxs-lookup"><span data-stu-id="5150e-489">Processor Information\\% Processor Time</span></span>  
  
-   <span data-ttu-id="5150e-490">Doba čekání západky SQLServer:Latches\Average (ms)</span><span class="sxs-lookup"><span data-stu-id="5150e-490">SQLServer:Latches\Average Latch Wait Time (ms)</span></span>  
  
-   <span data-ttu-id="5150e-491">SQLServer:Latches\Latch počká za sekundu</span><span class="sxs-lookup"><span data-stu-id="5150e-491">SQLServer:Latches\Latch Waits/sec</span></span>  
  
### <a name="tracking"></a><span data-ttu-id="5150e-492">Sledování</span><span class="sxs-lookup"><span data-stu-id="5150e-492">Tracking</span></span>  
 <span data-ttu-id="5150e-493">Pracovní postup sledování umožňuje sledovat průběh pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-493">Workflow tracking can be used to track the progress of a workflow.</span></span>  <span data-ttu-id="5150e-494">Informace, které je součástí sledování událostí je určen podle profil sledování.</span><span class="sxs-lookup"><span data-stu-id="5150e-494">The information that is included in the tracking events is determined by a tracking profile.</span></span>  <span data-ttu-id="5150e-495">Složitější profilem sledování nákladnější sledování se změní.</span><span class="sxs-lookup"><span data-stu-id="5150e-495">The more complex the tracking profile, the more expensive tracking becomes.</span></span>  
  
 <span data-ttu-id="5150e-496">WF3 dodávané se službou sledování na základě SQL.</span><span class="sxs-lookup"><span data-stu-id="5150e-496">WF3 shipped with a SQL-based tracking service.</span></span>  <span data-ttu-id="5150e-497">Tato služba může fungovat v režimech dávkové a jiných-zpracovat v dávce.</span><span class="sxs-lookup"><span data-stu-id="5150e-497">This service could work in batched and non-batched modes.</span></span>  <span data-ttu-id="5150e-498">V režimu bez-zpracovat v dávce sledování událostí se zapisují přímo do databáze.</span><span class="sxs-lookup"><span data-stu-id="5150e-498">In non-batched mode, tracking events are written directly to the database.</span></span>  <span data-ttu-id="5150e-499">V režimu dávkové sledování událostí se shromažďují do dávky stejné jako stav instance pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-499">In batched mode, tracking events are collected into the same batch as the workflow instance state.</span></span>  <span data-ttu-id="5150e-500">Dávkové režim má nejlepší výkon pro širokou škálu návrhů pracovního postupu.</span><span class="sxs-lookup"><span data-stu-id="5150e-500">The batched mode has the best performance for the widest range of workflow designs.</span></span>  <span data-ttu-id="5150e-501">Dávkování však může mít negativním dopadem na výkon Pokud pracovní postup spouští řada aktivit bez zachování a tyto aktivity jsou sledovány.</span><span class="sxs-lookup"><span data-stu-id="5150e-501">However, batching can have a negative performance impact if the workflow runs many activities without persisting and those activities are tracked.</span></span>  <span data-ttu-id="5150e-502">To by běžně se stalo v smyčky a nejlepší způsob, jak se vyhnout tento scénář je k návrhu velké smyčky tak, aby obsahovala bod trvalost.</span><span class="sxs-lookup"><span data-stu-id="5150e-502">This would commonly happen in loops and the best way to avoid this scenario is to design large loops to contain a persistence point.</span></span>  <span data-ttu-id="5150e-503">Úvod do smyčky bod trvalost může mít nepříznivý vliv i výkon, proto je důležité pro měření náklady na jednotlivých a spolu rovnováhu.</span><span class="sxs-lookup"><span data-stu-id="5150e-503">Introducing a persistence point into a loop can negatively affect performance as well so it is important to measure the costs of each and come up with a balance.</span></span>  
  
 <span data-ttu-id="5150e-504">WF4 není součástí SQL služby pro sledování.</span><span class="sxs-lookup"><span data-stu-id="5150e-504">WF4 is not shipped with a SQL tracking service.</span></span>  <span data-ttu-id="5150e-505">Záznam informace o sledování k databázi SQL může být zpracovává lépe ze serveru aplikace nemusí součástí [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5150e-505">Recording tracking information to a SQL database can be handled better from an application server rather than built into the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="5150e-506">Proto sledování SQL je nyní provádí AppFabric.</span><span class="sxs-lookup"><span data-stu-id="5150e-506">Therefore SQL tracking is now handled by AppFabric.</span></span>  <span data-ttu-id="5150e-507">Zprostředkovatel sledování se na pole v WF4 je založena na trasování událostí pro Windows (ETW).</span><span class="sxs-lookup"><span data-stu-id="5150e-507">The out-of-the-box tracking provider in WF4 is based on Event Tracing for Windows (ETW).</span></span>  
  
 <span data-ttu-id="5150e-508">Trasování událostí pro Windows je systém jádra úroveň, s nízkou latencí událostí součástí systému Windows.</span><span class="sxs-lookup"><span data-stu-id="5150e-508">ETW is a kernel-level, low-latency event system built into Windows.</span></span>  <span data-ttu-id="5150e-509">Používá zprostředkovatele nebo příjemce model, který umožňuje pouze způsobit snížení pro trasování událostí, pokud je ve skutečnosti příjemce.</span><span class="sxs-lookup"><span data-stu-id="5150e-509">It uses a provider/consumer model that makes it possible to only incur the penalty for event tracing when there is actually a consumer.</span></span>  <span data-ttu-id="5150e-510">Kromě události kernel například procesoru, disku, paměť a využití sítě mnoho aplikací také využívají trasování událostí pro Windows.</span><span class="sxs-lookup"><span data-stu-id="5150e-510">In addition to kernel events such as processor, disk, memory, and network usage, many applications leverage ETW as well.</span></span>  <span data-ttu-id="5150e-511">Události trasování událostí pro Windows jsou výkonnější než čítače výkonu v této události lze přizpůsobit k aplikaci.</span><span class="sxs-lookup"><span data-stu-id="5150e-511">ETW events are more powerful than performance counters in that events can be customized to the application.</span></span>  <span data-ttu-id="5150e-512">Událost může obsahovat text například ID pracovního postupu nebo informační zpráva.</span><span class="sxs-lookup"><span data-stu-id="5150e-512">An event can contain text such as a workflow ID or an informational message.</span></span>  <span data-ttu-id="5150e-513">Navíc události jsou klasifikovány s bitovou masku tak, aby využívání určité podmnožiny události bude mít menší dopad na výkon než zaznamenávání všechny události.</span><span class="sxs-lookup"><span data-stu-id="5150e-513">Also, events are categorized with bitmasks so that consuming a certain subset of events will have less performance impact than capturing all events.</span></span>  
  
 <span data-ttu-id="5150e-514">Výhody tohoto přístupu pomocí trasování událostí pro Windows pro sledování místo SQL patří:</span><span class="sxs-lookup"><span data-stu-id="5150e-514">Benefits to the approach of using ETW for tracking instead of SQL include:</span></span>  
  
-   <span data-ttu-id="5150e-515">Kolekce sledování událostí je možné oddělit k jinému procesu.</span><span class="sxs-lookup"><span data-stu-id="5150e-515">Collection of tracking events can be separated to another process.</span></span>  <span data-ttu-id="5150e-516">To dává větší flexibilitu v tom, jak události se zaznamenávají.</span><span class="sxs-lookup"><span data-stu-id="5150e-516">This gives greater flexibility in how the events are recorded.</span></span>  
  
-   <span data-ttu-id="5150e-517">Události trasování sledování událostí snadno spolu se události WCF ETW nebo jiných zprostředkovatelů trasování událostí pro Windows, např. zprostředkovatele SQL Server nebo jádra.</span><span class="sxs-lookup"><span data-stu-id="5150e-517">ETW tracking events are easily combined with the WCF ETW events or other ETW providers such as a SQL Server or kernel provider.</span></span>  
  
-   <span data-ttu-id="5150e-518">Autoři pracovního postupu, není potřeba změnit pracovní postup lépe pracovat s konkrétní sledování provádění, například službu sledování WF3 SQL dávkovém režimu.</span><span class="sxs-lookup"><span data-stu-id="5150e-518">Workflow authors do not need to alter a workflow to work better with a particular tracking implementation, such as the WF3 SQL tracking service’s batch mode.</span></span>  
  
-   <span data-ttu-id="5150e-519">Správce může povolit sledování zapnout nebo vypnout bez recyklace procesu hostitele.</span><span class="sxs-lookup"><span data-stu-id="5150e-519">An administrator can turn tracking on or off without recycling the host process.</span></span>  
  
 <span data-ttu-id="5150e-520">Výhody výkonu pro sledování trasování událostí pro Windows jsou součástí nevýhodou.</span><span class="sxs-lookup"><span data-stu-id="5150e-520">The performance benefits to ETW tracking come with a drawback.</span></span>  <span data-ttu-id="5150e-521">Pokud systém je přetížena intenzivního prostředků, může dojít ke ztrátě událostí trasování událostí pro Windows.</span><span class="sxs-lookup"><span data-stu-id="5150e-521">ETW events can be lost if the system is under intense resource pressure.</span></span>  <span data-ttu-id="5150e-522">Zpracování událostí není určena pro blokování spuštění normální programu a proto není zaručeno, že se všechny události trasování událostí pro Windows jejich odběratelům všesměrového vysílání.</span><span class="sxs-lookup"><span data-stu-id="5150e-522">The processing of events is not meant to block normal program execution and therefore it is not guaranteed that all ETW events will be broadcast to their subscribers.</span></span>  <span data-ttu-id="5150e-523">Díky tomu sledování ETW výborně hodí pro sledování stavu, ale není vhodný pro auditování.</span><span class="sxs-lookup"><span data-stu-id="5150e-523">This makes ETW tracking great for health monitoring but not suitable for auditing.</span></span>  
  
 <span data-ttu-id="5150e-524">Při WF4 nemá sledování zprostředkovatele SQL, nemá AppFabric.</span><span class="sxs-lookup"><span data-stu-id="5150e-524">While WF4 does not have a SQL tracking provider, AppFabric does.</span></span>  <span data-ttu-id="5150e-525">Přístup sledování SQL na AppFabric je přihlásit k odběru událostí trasování událostí pro Windows pomocí služby systému Windows, který dávek události a zapisuje je do tabulky SQL určený pro rychlé vložení.</span><span class="sxs-lookup"><span data-stu-id="5150e-525">AppFabric’s SQL tracking approach is to subscribe to ETW events with a Windows Service that batches the events and writes them to a SQL table designed for quick inserts.</span></span>  <span data-ttu-id="5150e-526">Samostatná úloha odstraňuje data z této tabulky a reforms do tabulky, které lze zobrazit na řídicím panelu AppFabric sestav.</span><span class="sxs-lookup"><span data-stu-id="5150e-526">A separate job drains the data from this table and reforms it into reporting tables that can be viewed on the AppFabric dashboard.</span></span>  <span data-ttu-id="5150e-527">To znamená, zpracovává nezávislé pracovního postupu ho pochází a proto nemusí čekat na bod trvalost před zápisem dávky sledování událostí.</span><span class="sxs-lookup"><span data-stu-id="5150e-527">This means that a batch of tracking events is handled independent of the workflow it came from and therefore does not have to wait for a persistence point before being recorded.</span></span>  
  
 <span data-ttu-id="5150e-528">Nástroje, například logman nebo xperf můžete zaznamenat události trasování událostí.</span><span class="sxs-lookup"><span data-stu-id="5150e-528">ETW events can be recorded with tools such as logman or xperf.</span></span>  <span data-ttu-id="5150e-529">Soubor compact ETL můžete převést do čitelnějšího formátu, například XML, s tracerpt nebo zobrazit pomocí některého nástroje, například xperfview.</span><span class="sxs-lookup"><span data-stu-id="5150e-529">The compact ETL file can be viewed with a tool like xperfview or converted to a more readable format, such as XML, with tracerpt.</span></span>  <span data-ttu-id="5150e-530">Jedinou možností pro získání sledování událostí bez databáze SQL WF3, je vytvoření vlastní sledování služby.</span><span class="sxs-lookup"><span data-stu-id="5150e-530">In WF3, the only option for getting tracking events without a SQL database is to create a custom tracking service.</span></span> <span data-ttu-id="5150e-531">Další informace o trasování událostí pro Windows najdete v tématu [služby WCF a trasování událostí pro Windows](../../../docs/framework/wcf/samples/wcf-services-and-event-tracing-for-windows.md) a [trasování událostí pro Windows](http://msdn.microsoft.com/library/ff190903.aspx\)).</span><span class="sxs-lookup"><span data-stu-id="5150e-531">For more information about ETW, see [WCF Services and Event Tracing for Windows](../../../docs/framework/wcf/samples/wcf-services-and-event-tracing-for-windows.md) and [Event Tracing for Windows](http://msdn.microsoft.com/library/ff190903.aspx\)).</span></span>  
  
 <span data-ttu-id="5150e-532">Povolení sledování workflowu bude mít dopad na výkon v různých stupňů.</span><span class="sxs-lookup"><span data-stu-id="5150e-532">Enabling workflow tracking will impact performance in varying degrees.</span></span>  <span data-ttu-id="5150e-533">Níže srovnávacího testu používá nástroj logman k využívat trasování sledování událostí a zapisuje je do souboru ETL.</span><span class="sxs-lookup"><span data-stu-id="5150e-533">The benchmark below uses the logman tool to consume the ETW tracking events and record them to an ETL file.</span></span>  <span data-ttu-id="5150e-534">Náklady na sledování v AppFabric SQL není v oboru tohoto článku.</span><span class="sxs-lookup"><span data-stu-id="5150e-534">The cost of the SQL tracking in AppFabric is not in the scope of this article.</span></span>  <span data-ttu-id="5150e-535">Profil základní sledování, používat i v AppFabric, se zobrazí v této srovnávacího testu.</span><span class="sxs-lookup"><span data-stu-id="5150e-535">The basic tracking profile, also used in AppFabric, is shown in this benchmark.</span></span>  <span data-ttu-id="5150e-536">Také zahrnuty jsou náklady na sledování jenom události sledování stavu.</span><span class="sxs-lookup"><span data-stu-id="5150e-536">Also included is the cost of tracking only health monitoring events.</span></span>  <span data-ttu-id="5150e-537">Tyto události jsou užitečné pro řešení problémů a určení, průměrná propustnost systému.</span><span class="sxs-lookup"><span data-stu-id="5150e-537">These events are useful for troubleshooting problems and determining the average throughput of the system.</span></span>  
  
### <a name="environment-setup"></a><span data-ttu-id="5150e-538">Nastavení prostředí</span><span class="sxs-lookup"><span data-stu-id="5150e-538">Environment Setup</span></span>  
 <span data-ttu-id="5150e-539">![Pracovní postup prostředí pro testování výkonu](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="5150e-539">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
### <a name="test-results"></a><span data-ttu-id="5150e-540">Výsledky testů</span><span class="sxs-lookup"><span data-stu-id="5150e-540">Test Results</span></span>  
 <span data-ttu-id="5150e-541">![Pracovní postup trasování náklady](../../../docs/framework/windows-workflow-foundation/media/workflowtracingcost.gif "WorkflowTracingCost")</span><span class="sxs-lookup"><span data-stu-id="5150e-541">![Workflow Tracing Cost](../../../docs/framework/windows-workflow-foundation/media/workflowtracingcost.gif "WorkflowTracingCost")</span></span>  
  
 <span data-ttu-id="5150e-542">Sledování stavu zhruba má 3 % dopad na propustnost.</span><span class="sxs-lookup"><span data-stu-id="5150e-542">Health monitoring has roughly a 3% impact on throughput.</span></span>  <span data-ttu-id="5150e-543">Náklady na základní profil je přibližně 8 %.</span><span class="sxs-lookup"><span data-stu-id="5150e-543">The basic profile’s cost is around 8%.</span></span>  
  
## <a name="interop"></a><span data-ttu-id="5150e-544">Zprostředkovatel komunikace s objekty</span><span class="sxs-lookup"><span data-stu-id="5150e-544">Interop</span></span>  
 <span data-ttu-id="5150e-545">WF4 je téměř dokončena přepisování z [!INCLUDE[wf1](../../../includes/wf1-md.md)] a proto nejsou přímo kompatibilní s WF4 WF3 pracovních postupů a aktivit.</span><span class="sxs-lookup"><span data-stu-id="5150e-545">WF4 is almost a complete rewrite of [!INCLUDE[wf1](../../../includes/wf1-md.md)] and therefore WF3 workflows and activities are not directly compatible with WF4.</span></span>  <span data-ttu-id="5150e-546">Mnoho zákazníků, které již v rané fázi přijaly modelu Windows Workflow Foundation, bude mít pro WF3 definice pracovního postupu interní nebo třetích stran a vlastní aktivity.</span><span class="sxs-lookup"><span data-stu-id="5150e-546">Many customers that adopted Windows Workflow Foundation early will have in-house or third-party workflow definitions and custom activities for WF3.</span></span>  <span data-ttu-id="5150e-547">Jedním ze způsobů k usnadnění přechodu na WF4 je pomocí zprostředkovatele komunikace s objekty aktivity, které můžete provést WF3 aktivitám v pracovním postupu WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-547">One way to ease the transition to WF4 is to use the Interop activity, which can execute WF3 activities from within a WF4 workflow.</span></span>  <span data-ttu-id="5150e-548">Dále je doporučeno <xref:System.Activities.Statements.Interop> aktivity použít pouze v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="5150e-548">It is recommended that the <xref:System.Activities.Statements.Interop> activity only be used when necessary.</span></span> <span data-ttu-id="5150e-549">Další informace o migraci na WF4 podívejte se [WF4 migrace pokyny](http://go.microsoft.com/fwlink/?LinkID=153313).</span><span class="sxs-lookup"><span data-stu-id="5150e-549">For more information about migrating to WF4 check out the [WF4 Migration Guidance](http://go.microsoft.com/fwlink/?LinkID=153313).</span></span>  
  
### <a name="environment-setup"></a><span data-ttu-id="5150e-550">Nastavení prostředí</span><span class="sxs-lookup"><span data-stu-id="5150e-550">Environment Setup</span></span>  
 <span data-ttu-id="5150e-551">![Pracovní postup prostředí pro testování výkonu](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span><span class="sxs-lookup"><span data-stu-id="5150e-551">![Workflow Performance Test Environment](../../../docs/framework/windows-workflow-foundation/media/wfperfenvironment.gif "WFPerfEnvironment")</span></span>  
  
### <a name="test-results"></a><span data-ttu-id="5150e-552">Výsledky testů</span><span class="sxs-lookup"><span data-stu-id="5150e-552">Test Results</span></span>  
 <span data-ttu-id="5150e-553">Následující tabulka ukazuje výsledky spuštění pracovního postupu obsahující pět aktivity v pořadí, v různých konfiguracích.</span><span class="sxs-lookup"><span data-stu-id="5150e-553">The table below shows the results of running a workflow containing five activities in a sequence in various configurations.</span></span>  
  
|<span data-ttu-id="5150e-554">Test</span><span class="sxs-lookup"><span data-stu-id="5150e-554">Test</span></span>|<span data-ttu-id="5150e-555">Propustnost (pracovních za sekundu)</span><span class="sxs-lookup"><span data-stu-id="5150e-555">Throughput (workflows/sec)</span></span>|  
|----------|-----------------------------------|  
|<span data-ttu-id="5150e-556">Pořadí WF3 v WF3 runtime</span><span class="sxs-lookup"><span data-stu-id="5150e-556">WF3 Sequence in WF3 runtime</span></span>|<span data-ttu-id="5150e-557">1,576</span><span class="sxs-lookup"><span data-stu-id="5150e-557">1,576</span></span>|  
|<span data-ttu-id="5150e-558">Pořadí WF3 v WF4 runtime pomocí zprostředkovatele komunikace</span><span class="sxs-lookup"><span data-stu-id="5150e-558">WF3 Sequence in WF4 runtime using Interop</span></span>|<span data-ttu-id="5150e-559">2,745</span><span class="sxs-lookup"><span data-stu-id="5150e-559">2,745</span></span>|  
|<span data-ttu-id="5150e-560">WF4 pořadí</span><span class="sxs-lookup"><span data-stu-id="5150e-560">WF4 Sequence</span></span>|<span data-ttu-id="5150e-561">153,582</span><span class="sxs-lookup"><span data-stu-id="5150e-561">153,582</span></span>|  
  
 <span data-ttu-id="5150e-562">Je zvýšení výkonu upozorňují na důležité k pomocí zprostředkovatele komunikace přes přímých WF3.</span><span class="sxs-lookup"><span data-stu-id="5150e-562">There is a notable performance increase to using Interop over straight WF3.</span></span>  <span data-ttu-id="5150e-563">Pokud však porovná WF4 aktivity, zvýšení nebude nepatrné.</span><span class="sxs-lookup"><span data-stu-id="5150e-563">However, when compared against WF4 activities, the increase is negligible.</span></span>  
  
## <a name="summary"></a><span data-ttu-id="5150e-564">Souhrn</span><span class="sxs-lookup"><span data-stu-id="5150e-564">Summary</span></span>  
 <span data-ttu-id="5150e-565">Velkou investice do výkon WF4 mít placené v mnoha oblastech zásadní.</span><span class="sxs-lookup"><span data-stu-id="5150e-565">Heavy investments in performance for WF4 have paid off in many crucial areas.</span></span>  <span data-ttu-id="5150e-566">Výkon součásti jednotlivých pracovního postupu se v některých případech stovky rychlejší v porovnání s WF3 kvůli leaner WF4 [!INCLUDE[wf1](../../../includes/wf1-md.md)] modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="5150e-566">Individual workflow component performance is in some cases hundreds of times faster in WF4 compared to WF3 due to a leaner [!INCLUDE[wf1](../../../includes/wf1-md.md)] runtime.</span></span>  <span data-ttu-id="5150e-567">Latence čísla jsou také výrazně lepší.</span><span class="sxs-lookup"><span data-stu-id="5150e-567">Latency numbers are significantly better as well.</span></span>  <span data-ttu-id="5150e-568">To znamená snížení výkonu pro používání [!INCLUDE[wf1](../../../includes/wf1-md.md)] oproti kódování ruční WCF orchestration je velmi malé zvažování přidané výhody použití služby [!INCLUDE[wf1](../../../includes/wf1-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5150e-568">This means the performance penalty for using [!INCLUDE[wf1](../../../includes/wf1-md.md)] as opposed to hand-coding WCF orchestration services is very small considering the added benefits of using [!INCLUDE[wf1](../../../includes/wf1-md.md)].</span></span>  <span data-ttu-id="5150e-569">Trvalost výkonu zvýšilo faktorem 2.5 3.0.</span><span class="sxs-lookup"><span data-stu-id="5150e-569">Persistence performance has increased by a factor of 2.5 - 3.0.</span></span>  <span data-ttu-id="5150e-570">Monitorování stavu prostřednictvím pracovního postupu pro sledování teď má velmi malé režijní náklady.</span><span class="sxs-lookup"><span data-stu-id="5150e-570">Health monitoring by means of workflow tracking now has very little overhead.</span></span>  <span data-ttu-id="5150e-571">Komplexní sadu příručkách pro migraci jsou k dispozici pro ty, které jsou s přesun z WF3 na WF4.</span><span class="sxs-lookup"><span data-stu-id="5150e-571">A comprehensive set of migration guides are available for those that are considering moving from WF3 to WF4.</span></span>  <span data-ttu-id="5150e-572">Všechny tyto měli WF4 atraktivní možnost pro psaní komplexních aplikací.</span><span class="sxs-lookup"><span data-stu-id="5150e-572">All of this should make WF4 an attractive option for writing complex applications.</span></span>  
  
## <a name="acknowledgements"></a><span data-ttu-id="5150e-573">Potvrzení</span><span class="sxs-lookup"><span data-stu-id="5150e-573">Acknowledgements</span></span>  
 <span data-ttu-id="5150e-574">Mnoho díky následující přispěvatelé a recenzenti pro jejich úsilí:</span><span class="sxs-lookup"><span data-stu-id="5150e-574">Many thanks to the following contributors and reviewers for their efforts:</span></span>  
  
-   <span data-ttu-id="5150e-575">Leon Welicki společnost Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="5150e-575">Leon Welicki, Microsoft Corporation</span></span>  
  
-   <span data-ttu-id="5150e-576">Ryszard Kwiecinski, Microsoft Corporation.</span><span class="sxs-lookup"><span data-stu-id="5150e-576">Ryszard Kwiecinski, Microsoft Corporation</span></span>  
  
-   <span data-ttu-id="5150e-577">Emil Velinov společnost Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="5150e-577">Emil Velinov, Microsoft Corporation</span></span>  
  
-   <span data-ttu-id="5150e-578">Jan Talbert společnost Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="5150e-578">Nate Talbert, Microsoft Corporation</span></span>  
  
-   <span data-ttu-id="5150e-579">Bob Schmidt společnost Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="5150e-579">Bob Schmidt, Microsoft Corporation</span></span>  
  
-   <span data-ttu-id="5150e-580">Stefan Batres společnost Microsoft Corporation</span><span class="sxs-lookup"><span data-stu-id="5150e-580">Stefan Batres, Microsoft Corporation</span></span>
