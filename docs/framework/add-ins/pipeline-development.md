---
title: Vývoj kanálu
ms.date: 03/30/2017
helpviewer_keywords:
- add-in pipeline [.NET Framework], segments
- activation path for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], activation path
- communication pipeline for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], about
- add-ins [.NET Framework], pipeline development
ms.assetid: 932788f2-b87d-44cf-82f9-04492a8b2722
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 2d889b7de4bc766deda9b91877ceefb4aebfc551
ms.sourcegitcommit: 11f11ca6cefe555972b3a5c99729d1a7523d8f50
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/03/2018
ms.locfileid: "32744574"
---
# <a name="pipeline-development"></a><span data-ttu-id="34dbc-102">Vývoj kanálu</span><span class="sxs-lookup"><span data-stu-id="34dbc-102">Pipeline Development</span></span>
<span data-ttu-id="34dbc-103">Kanál doplňku je cesta kanálu segmentů, které hostitelskou aplikaci a její add-in musí používat ke komunikaci mezi sebou.</span><span class="sxs-lookup"><span data-stu-id="34dbc-103">The add-in pipeline is the path of pipeline segments that the host application and its add-in must use to communicate with each other.</span></span>  
  
 <span data-ttu-id="34dbc-104">Následující obrázek znázorňuje komunikační kanál a jeho segmentů.</span><span class="sxs-lookup"><span data-stu-id="34dbc-104">The following illustration shows the communication pipeline and its segments.</span></span>  
  
 <span data-ttu-id="34dbc-105">![Přidat&#45;ve model kanálu. ] (../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span><span class="sxs-lookup"><span data-stu-id="34dbc-105">![Add&#45;in pipeline model.](../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span></span>  
<span data-ttu-id="34dbc-106">Kanál doplňku</span><span class="sxs-lookup"><span data-stu-id="34dbc-106">Add-in pipeline</span></span>  
  
 <span data-ttu-id="34dbc-107">Doplněk je na druhém konci hostitelskou aplikaci je na jednom konci kanálu.</span><span class="sxs-lookup"><span data-stu-id="34dbc-107">The host application is at one end of the pipeline and the add-in is at the other end.</span></span> <span data-ttu-id="34dbc-108">Spuštění z obou koncích a přesun do středu, hostitelskou aplikaci i v doplňku mají abstraktní základní třída, která definuje zobrazení objektu modelu, který obě sdílejí.</span><span class="sxs-lookup"><span data-stu-id="34dbc-108">Starting from each end and moving toward the middle, both the host application and the add-in have an abstract base class that defines a view of the object model that they both share.</span></span> <span data-ttu-id="34dbc-109">Tyto typy (třídy) tvoří segmentu kanálu doplněk zobrazení a zobrazení hostitele segmentu doplněk kanálu.</span><span class="sxs-lookup"><span data-stu-id="34dbc-109">These types (classes) make up the add-in view pipeline segment and the host view of the add-in pipeline segment.</span></span> <span data-ttu-id="34dbc-110">Segment kanálu doplněk zobrazení často obsahuje více než jeden abstraktní třídu, ale třídu, která v doplňku dědí z se označuje jako základní add-in.</span><span class="sxs-lookup"><span data-stu-id="34dbc-110">The add-in view pipeline segment often contains more than one abstract class but the class that the add-in inherits from is known as the add-in base.</span></span>  
  
 <span data-ttu-id="34dbc-111">Segment kanálu přidat straně adaptéru a adaptér hostitelské kanálu segment převést toku typy mezi segmenty kanálu jejich zobrazení a segment kanálu kontrakt.</span><span class="sxs-lookup"><span data-stu-id="34dbc-111">The add-in-side adapter pipeline segment and the host-side adapter pipeline segment convert the flow of types between their view pipeline segments and the contract pipeline segment.</span></span> <span data-ttu-id="34dbc-112">Centrální segment kanálu je kontrakt, který je odvozený od <xref:System.AddIn.Contract.IContract> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="34dbc-112">The central segment of the pipeline is a contract that is derived from the <xref:System.AddIn.Contract.IContract> interface.</span></span> <span data-ttu-id="34dbc-113">Tento kontrakt definuje metody, které hostitelskou aplikaci a její doplněk obě použije.</span><span class="sxs-lookup"><span data-stu-id="34dbc-113">This contract defines the methods that the host application and its add-in will both use.</span></span>  
  
 <span data-ttu-id="34dbc-114">Pokud hostitel a doplněk načíst do samostatné aplikační domény, musíte hranici izolace, která odděluje portál oboru hostitelskou aplikaci z oboru add-in.</span><span class="sxs-lookup"><span data-stu-id="34dbc-114">If you load the host and the add-in into separate application domains, you have an isolation boundary that separates the scope of the host application from the scope of the add-in.</span></span> <span data-ttu-id="34dbc-115">Kontrakt je pouze sestavení, který je načten do hostitele a domény doplňku aplikace.</span><span class="sxs-lookup"><span data-stu-id="34dbc-115">The contract is the only assembly that is loaded in both the host and add-in application domains.</span></span> <span data-ttu-id="34dbc-116">Hostitele a doplněk každý se vztahují pouze jejich zobrazení metod kontrakt.</span><span class="sxs-lookup"><span data-stu-id="34dbc-116">The host and the add-in each refer only to their view of the contract methods.</span></span> <span data-ttu-id="34dbc-117">Proto jsou odděleny úroveň abstrakce ze smlouvy.</span><span class="sxs-lookup"><span data-stu-id="34dbc-117">Therefore, they are separated by a layer of abstraction from the contract.</span></span>  
  
 <span data-ttu-id="34dbc-118">Vývoj kanálu segmenty, musíte vytvořit strukturu adresáře, která bude obsahovat.</span><span class="sxs-lookup"><span data-stu-id="34dbc-118">To develop pipeline segments, you must create a directory structure that will contain them.</span></span> <span data-ttu-id="34dbc-119">Další informace o požadavky na vývoj a oboru pokyny najdete v tématu [požadavky na vývoj kanálu](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).</span><span class="sxs-lookup"><span data-stu-id="34dbc-119">For more information about development requirements and scope guidelines, see [Pipeline Development Requirements](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).</span></span>  
  
 <span data-ttu-id="34dbc-120">Následující obrázek znázorňuje typy, které tvoří segmenty kanálu.</span><span class="sxs-lookup"><span data-stu-id="34dbc-120">The following illustration shows the types that make up the pipeline segments.</span></span> <span data-ttu-id="34dbc-121">Názvy typů znázorněno na obrázku jsou libovolný, ale všechny typy s výjimkou hostitele a hostitele zobrazení atributů vyžadovat add-in, může být zjištěny pomocí metody, které vytvořit úložišti informace.</span><span class="sxs-lookup"><span data-stu-id="34dbc-121">The names of the types shown in the illustration are arbitrary, but all types except for the host and the host view of the add-in require attributes so they can be discovered by methods that construct an information store.</span></span>  
  
 <span data-ttu-id="34dbc-122">![Přidat&#45;v modelu s povinné atributy pro typy. ] (../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span><span class="sxs-lookup"><span data-stu-id="34dbc-122">![Add&#45;in model with required attributes on types.](../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span></span>  
<span data-ttu-id="34dbc-123">Doplněk s typy</span><span class="sxs-lookup"><span data-stu-id="34dbc-123">Add-in pipeline with types</span></span>  
  
 <span data-ttu-id="34dbc-124">Následující tabulka popisuje segmenty kanálu pro aktivaci doplňku.</span><span class="sxs-lookup"><span data-stu-id="34dbc-124">The following table describes the pipeline segments for activating an add-in.</span></span> <span data-ttu-id="34dbc-125">Další informace o tyto segmenty najdete v tématu [kontrakty, zobrazení a adaptéry](http://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).</span><span class="sxs-lookup"><span data-stu-id="34dbc-125">For more information about these segments, see [Contracts, Views, and Adapters](http://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).</span></span>  
  
|<span data-ttu-id="34dbc-126">Segment kanálu</span><span class="sxs-lookup"><span data-stu-id="34dbc-126">Pipeline segment</span></span>|<span data-ttu-id="34dbc-127">Popis</span><span class="sxs-lookup"><span data-stu-id="34dbc-127">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="34dbc-128">Hostitel</span><span class="sxs-lookup"><span data-stu-id="34dbc-128">Host</span></span>|<span data-ttu-id="34dbc-129">Sestavení aplikace, které vytvoří instanci v.</span><span class="sxs-lookup"><span data-stu-id="34dbc-129">The application assembly that creates an instance of an add-in.</span></span>|  
|<span data-ttu-id="34dbc-130">Doplněk zobrazení pro hostitele</span><span class="sxs-lookup"><span data-stu-id="34dbc-130">Host view of the add-in</span></span>|<span data-ttu-id="34dbc-131">Představuje hostitelskou aplikaci zobrazení typů objektů a metody používaný ke komunikaci s doplněk.</span><span class="sxs-lookup"><span data-stu-id="34dbc-131">Represents the host application's view of the object types and methods used to communicate with the add-in.</span></span> <span data-ttu-id="34dbc-132">Zobrazení hostitele je abstraktní základní třídu nebo rozhraní.</span><span class="sxs-lookup"><span data-stu-id="34dbc-132">The host view is an abstract base class or interface.</span></span>|  
|<span data-ttu-id="34dbc-133">Adaptér na straně hostitele</span><span class="sxs-lookup"><span data-stu-id="34dbc-133">Host-side adapter</span></span>|<span data-ttu-id="34dbc-134">Sestavení s jednu nebo více tříd, které přizpůsobuje metody do a z kontrakt.</span><span class="sxs-lookup"><span data-stu-id="34dbc-134">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="34dbc-135">Tento kanál segment je určený podle pomocí <xref:System.AddIn.Pipeline.HostAdapterAttribute> atribut.</span><span class="sxs-lookup"><span data-stu-id="34dbc-135">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.HostAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="34dbc-136">Více modul sestavení nejsou podporována.</span><span class="sxs-lookup"><span data-stu-id="34dbc-136">Multi-module assemblies are not supported.</span></span>|  
|<span data-ttu-id="34dbc-137">Kontrakt</span><span class="sxs-lookup"><span data-stu-id="34dbc-137">Contract</span></span>|<span data-ttu-id="34dbc-138">Rozhraní, které je odvozený od <xref:System.AddIn.Contract.IContract> rozhraní a že definuje protokol pro komunikaci mezi hostitelem a jeho doplněk typy.</span><span class="sxs-lookup"><span data-stu-id="34dbc-138">An interface that is derived from the <xref:System.AddIn.Contract.IContract> interface and that defines the protocol for communicating types between the host and its add-in.</span></span><br /><br /> <span data-ttu-id="34dbc-139">Tento kanál segment je určený podle nastavení <xref:System.AddIn.Pipeline.AddInContractAttribute> atribut.</span><span class="sxs-lookup"><span data-stu-id="34dbc-139">This pipeline segment is identified by setting the <xref:System.AddIn.Pipeline.AddInContractAttribute> attribute.</span></span>|  
|<span data-ttu-id="34dbc-140">Přidat straně adaptéru</span><span class="sxs-lookup"><span data-stu-id="34dbc-140">Add-in-side adapter</span></span>|<span data-ttu-id="34dbc-141">Sestavení s jednu nebo více tříd, které přizpůsobuje metody do a z kontrakt.</span><span class="sxs-lookup"><span data-stu-id="34dbc-141">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="34dbc-142">Tento kanál segment je určený podle pomocí <xref:System.AddIn.Pipeline.AddInAdapterAttribute> atribut.</span><span class="sxs-lookup"><span data-stu-id="34dbc-142">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="34dbc-143">Každé sestavení v adresáři přidat straně adaptér, který obsahuje typ, který má <xref:System.AddIn.Pipeline.AddInAdapterAttribute> atribut je načten do doplňku pro doménu aplikace.</span><span class="sxs-lookup"><span data-stu-id="34dbc-143">Each assembly in the add-in-side adapter directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute is loaded into the add-in's application domain.</span></span><br /><br /> <span data-ttu-id="34dbc-144">Každé sestavení v adresáři přidat straně je načíst v jeho vlastní domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="34dbc-144">Each assembly in the add-in-side directory is loaded in its own application domain.</span></span><br /><br /> <span data-ttu-id="34dbc-145">Více modul sestavení nejsou podporovány.</span><span class="sxs-lookup"><span data-stu-id="34dbc-145">Multi-module assemblies are not supported</span></span>|  
|<span data-ttu-id="34dbc-146">Přidejte v zobrazení</span><span class="sxs-lookup"><span data-stu-id="34dbc-146">Add-in view</span></span>|<span data-ttu-id="34dbc-147">Sestavení, které představuje doplněk pro zobrazení typů objektů a metody, které se používají ke komunikaci s hostitelem.</span><span class="sxs-lookup"><span data-stu-id="34dbc-147">An assembly that represents the add-in's view of the object types and methods that are used to communicate with the host.</span></span> <span data-ttu-id="34dbc-148">Na zobrazení je abstraktní základní třídu nebo rozhraní.</span><span class="sxs-lookup"><span data-stu-id="34dbc-148">The add-in view is an abstract base class or interface.</span></span><br /><br /> <span data-ttu-id="34dbc-149">Tento kanál segment je určený podle pomocí <xref:System.AddIn.Pipeline.AddInBaseAttribute> atribut.</span><span class="sxs-lookup"><span data-stu-id="34dbc-149">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="34dbc-150">Každé sestavení v adresáři AddInViews, který obsahuje typ, který má <xref:System.AddIn.Pipeline.AddInBaseAttribute> atribut je načten do doplňku pro doménu aplikace.</span><span class="sxs-lookup"><span data-stu-id="34dbc-150">Each assembly in the AddInViews directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute is loaded into the add-in's application domain.</span></span>|  
|<span data-ttu-id="34dbc-151">doplněk</span><span class="sxs-lookup"><span data-stu-id="34dbc-151">Add-in</span></span>|<span data-ttu-id="34dbc-152">Vytvořenou instanci typ, který provádí služba pro hostitele.</span><span class="sxs-lookup"><span data-stu-id="34dbc-152">An instantiated type that performs a service for the host.</span></span>|  
  
## <a name="pipeline-activation-path"></a><span data-ttu-id="34dbc-153">Aktivační cesta kanálu</span><span class="sxs-lookup"><span data-stu-id="34dbc-153">Pipeline Activation Path</span></span>  
 <span data-ttu-id="34dbc-154">Následující obrázek znázorňuje aktivace typů, když je aktivován doplňku.</span><span class="sxs-lookup"><span data-stu-id="34dbc-154">The following illustration shows the activation of types when an add-in is activated.</span></span> <span data-ttu-id="34dbc-155">Také ukazuje předávání objektů na hostitele, třeba výsledky výpočtu nebo kolekce objektů.</span><span class="sxs-lookup"><span data-stu-id="34dbc-155">It also shows the passing of objects to the host, such as the results of a calculation or a collection of objects.</span></span> <span data-ttu-id="34dbc-156">Toto je Nejobvyklejším scénářem.</span><span class="sxs-lookup"><span data-stu-id="34dbc-156">This is the most typical scenario.</span></span>  
  
 <span data-ttu-id="34dbc-157">![Přidat&#45;v modelu s aktivační cesta. ] (../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span><span class="sxs-lookup"><span data-stu-id="34dbc-157">![Add&#45;in model with activation path.](../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span></span>  
<span data-ttu-id="34dbc-158">Aktivační cesta z v doplňku na hostitele</span><span class="sxs-lookup"><span data-stu-id="34dbc-158">Activation path from the add-in to the host</span></span>  
  
 <span data-ttu-id="34dbc-159">Aktivační cesta kanálu dojde k následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="34dbc-159">The activation path of the pipeline occurs as follows:</span></span>  
  
1.  <span data-ttu-id="34dbc-160">Hostitelskou aplikaci aktivuje doplněk s <xref:System.AddIn.Hosting.AddInToken.Activate%2A> metoda.</span><span class="sxs-lookup"><span data-stu-id="34dbc-160">The host application activates the add-in with the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method.</span></span>  
  
2.  <span data-ttu-id="34dbc-161">Add-in a přidat v zobrazení, přidat straně adaptéru a kontrakt sestavení jsou načteny do doplňku pro doménu aplikace.</span><span class="sxs-lookup"><span data-stu-id="34dbc-161">The add-in, add-in view, add-in-side adapter, and the contract assemblies are loaded into the add-in's application domain.</span></span>  
  
3.  <span data-ttu-id="34dbc-162">Instance adaptéru přidat straně je vytvořený pomocí tohoto zobrazení (pomocí třídy identifikovaný <xref:System.AddIn.Pipeline.AddInBaseAttribute> atribut) jako jeho konstruktoru.</span><span class="sxs-lookup"><span data-stu-id="34dbc-162">An instance of the add-in-side adapter is created using the add-in view (with the class identified by the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute) as its constructor.</span></span> <span data-ttu-id="34dbc-163">Přidat straně adaptér zdědí z kontrakt.</span><span class="sxs-lookup"><span data-stu-id="34dbc-163">The add-in-side adapter inherits from the contract.</span></span>  
  
4.  <span data-ttu-id="34dbc-164">Přidat straně adaptér, který je zadán jako kontrakt, je přes hranici (volitelné) izolace předaný konstruktoru na straně hostitele adaptér.</span><span class="sxs-lookup"><span data-stu-id="34dbc-164">The add-in-side adapter, which is typed as the contract, is passed across the (optional) isolation boundary to the host-side adapter's constructor.</span></span>  
  
5.  <span data-ttu-id="34dbc-165">Zobrazení hostitele add-in, hostitelské adaptéru, a kontrakt sestavení jsou načteny do domény aplikace hostitele.</span><span class="sxs-lookup"><span data-stu-id="34dbc-165">The host view of the add-in, host-side adapter, and the contract assemblies are loaded into the host's application domain.</span></span>  
  
6.  <span data-ttu-id="34dbc-166">Instance adaptéru hostitelské je vytvořený pomocí kontrakt jako jeho konstruktoru.</span><span class="sxs-lookup"><span data-stu-id="34dbc-166">An instance of the host-side adapter is created using the contract as its constructor.</span></span> <span data-ttu-id="34dbc-167">Adaptér hostitelské dědí z pohledu hostitele add-in.</span><span class="sxs-lookup"><span data-stu-id="34dbc-167">The host-side adapter inherits from the host view of the add-in.</span></span>  
  
7.  <span data-ttu-id="34dbc-168">Hostitel má doplněk, který je zadán jako hostitel zobrazit add-in a můžete pokračovat volání její metody.</span><span class="sxs-lookup"><span data-stu-id="34dbc-168">The host has the add-in, which is typed as the host view of the add-in, and can continue calling its methods.</span></span>  
  
## <a name="walkthroughs"></a><span data-ttu-id="34dbc-169">Postupy</span><span class="sxs-lookup"><span data-stu-id="34dbc-169">Walkthroughs</span></span>  
 <span data-ttu-id="34dbc-170">Existují tři návod témata, které popisují, jak vytvořit tak kanály pomocí sady Visual Studio:</span><span class="sxs-lookup"><span data-stu-id="34dbc-170">There are three walkthrough topics that describe how to create pipelines using Visual Studio:</span></span>  
  
-   [<span data-ttu-id="34dbc-171">Návod: Vytváření rozšiřitelné aplikace</span><span class="sxs-lookup"><span data-stu-id="34dbc-171">Walkthrough: Creating an Extensible Application</span></span>](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)  
  
     <span data-ttu-id="34dbc-172">Popisuje doplněk kalkulačky, který provádí sčítání, odčítání, násobení a dělení výpočty pro hostitele.</span><span class="sxs-lookup"><span data-stu-id="34dbc-172">Describes a calculator add-in that performs addition, subtraction, multiplication, and divsion calculations for the host.</span></span>  
  
-   [<span data-ttu-id="34dbc-173">Návod: Povolení zpětné kompatibility jako hostitele změny</span><span class="sxs-lookup"><span data-stu-id="34dbc-173">Walkthrough: Enabling Backward Compatibility as Your Host Changes</span></span>](http://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848)  
  
     <span data-ttu-id="34dbc-174">Popisuje doplněk kalkulačky s možnostmi rozšířené výpočtu a postupy zachování kompatibility s první kalkulačky v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="34dbc-174">Describes a calculator add-in with enhanced calculation capabilities, and how to maintain compatibility with the first calculator add-in.</span></span>  
  
-   [<span data-ttu-id="34dbc-175">Návod: Předávání kolekce mezi hostiteli a doplňky</span><span class="sxs-lookup"><span data-stu-id="34dbc-175">Walkthrough: Passing Collections Between Hosts and Add-Ins</span></span>](http://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5)  
  
     <span data-ttu-id="34dbc-176">Popisuje, jak předat kolekce dat přes kanál pomocí scénáři adresáře úložiště.</span><span class="sxs-lookup"><span data-stu-id="34dbc-176">Describes how to pass data collections over the pipeline using a book store scenario.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="34dbc-177">Viz také</span><span class="sxs-lookup"><span data-stu-id="34dbc-177">See Also</span></span>  
 [<span data-ttu-id="34dbc-178">Scénáře kanál doplňku</span><span class="sxs-lookup"><span data-stu-id="34dbc-178">Add-in Pipeline Scenarios</span></span>](http://msdn.microsoft.com/library/feb70e0b-8734-494c-aeaf-b567f014043e)  
 [<span data-ttu-id="34dbc-179">Doplňky a rozšíření</span><span class="sxs-lookup"><span data-stu-id="34dbc-179">Add-ins and Extensibility</span></span>](../../../docs/framework/add-ins/index.md)
