---
title: Přehled doplňků WPF
ms.date: 03/30/2017
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
ms.openlocfilehash: 2e5d133a4744124723c0373e3d5974b505936190
ms.sourcegitcommit: efff8f331fd9467f093f8ab8d23a203d6ecb5b60
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/01/2018
ms.locfileid: "43402098"
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="3df34-102">Přehled doplňků WPF</span><span class="sxs-lookup"><span data-stu-id="3df34-102">WPF Add-Ins Overview</span></span>
<a name="Introduction"></a> <span data-ttu-id="3df34-103">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Obsahuje doplněk model, pomocí kterých mohou vývojáři vytvářet aplikace, které podporují rozšiřitelnosti doplňku.</span><span class="sxs-lookup"><span data-stu-id="3df34-103">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="3df34-104">Tento model doplňku umožňuje vytvářet doplňky, které integrovat a rozšířit funkce aplikace.</span><span class="sxs-lookup"><span data-stu-id="3df34-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="3df34-105">V některých scénářích aplikací také potřebovat zobrazit [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] , které jsou poskytovány doplňky. Toto téma ukazuje, jak [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] navyšuje [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] modelu doplňku povolit tyto scénáře, architektura jeho, jeho výhody a omezení.</span><span class="sxs-lookup"><span data-stu-id="3df34-105">In some scenarios, applications also need to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are provided by add-ins. This topic shows how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>  
  

  
<a name="Requirements"></a>   
## <a name="prerequisites"></a><span data-ttu-id="3df34-106">Požadavky</span><span class="sxs-lookup"><span data-stu-id="3df34-106">Prerequisites</span></span>  
 <span data-ttu-id="3df34-107">Znalost [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] doplňku je model požadován.</span><span class="sxs-lookup"><span data-stu-id="3df34-107">Familiarity with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is required.</span></span> <span data-ttu-id="3df34-108">Další informace najdete v tématu [doplňků a rozšíření](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="3df34-108">For more information, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="AddInsOverview"></a>   
## <a name="add-ins-overview"></a><span data-ttu-id="3df34-109">Přehled doplňků</span><span class="sxs-lookup"><span data-stu-id="3df34-109">Add-Ins Overview</span></span>  
 <span data-ttu-id="3df34-110">Pokud se chcete vyhnout složitosti rekompilace aplikace a opětovné nasazení k začlenění nové funkce, aplikace implementovat mechanismy rozšiřitelnosti, které umožňují vývojářům (první strany a třetích stran) k vytvoření dalších aplikací, které Integrace s nimi.</span><span class="sxs-lookup"><span data-stu-id="3df34-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="3df34-111">Pomocí doplňků (označované také jako "doplňky" a "moduly plug-in") je nejběžnějším způsobem podporují tento typ rozšíření.</span><span class="sxs-lookup"><span data-stu-id="3df34-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="3df34-112">Mezi příklady z reálného světa aplikací, které zpřístupňují rozšiřitelnosti s doplňky patří:</span><span class="sxs-lookup"><span data-stu-id="3df34-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>  
  
-   <span data-ttu-id="3df34-113">Doplňky aplikace Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="3df34-113">Internet Explorer add-ons.</span></span>  
  
-   <span data-ttu-id="3df34-114">Windows Media Player moduly plug-in.</span><span class="sxs-lookup"><span data-stu-id="3df34-114">Windows Media Player plug-ins.</span></span>  
  
-   <span data-ttu-id="3df34-115">Visual Studio doplňky.</span><span class="sxs-lookup"><span data-stu-id="3df34-115">Visual Studio add-ins.</span></span>  
  
 <span data-ttu-id="3df34-116">Například model doplňku Windows Media Player umožňuje vývojářům třetích stran k implementaci "moduly plug-in", které rozšiřují Windows Media Player v celou řadu způsobů, včetně vytváření dekodérů a kodérů pro formáty multimédií, které nativně nepodporují ve Windows Media Player (například DVD, MP3), zvukové efekty a skinů v šablonách.</span><span class="sxs-lookup"><span data-stu-id="3df34-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="3df34-117">Každý model doplňku je určený pro funkci, která je jedinečné pro aplikace, i když existuje několik entit a chování, které jsou společné pro všechny modely doplňku.</span><span class="sxs-lookup"><span data-stu-id="3df34-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>  
  
 <span data-ttu-id="3df34-118">Jsou tři hlavní entity typické rozšiřitelnosti doplňku řešení *kontrakty*, *doplňky*, a *hostovat aplikace*.</span><span class="sxs-lookup"><span data-stu-id="3df34-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="3df34-119">Kontrakty definovat, jak doplňky integrace s aplikacemi hostitele dvěma způsoby:</span><span class="sxs-lookup"><span data-stu-id="3df34-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>  
  
-   <span data-ttu-id="3df34-120">Doplňky integrace s funkcí, které je implementované Hostování aplikací.</span><span class="sxs-lookup"><span data-stu-id="3df34-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>  
  
-   <span data-ttu-id="3df34-121">Hostování aplikací zpřístupnění funkcí pro doplňky integrovat.</span><span class="sxs-lookup"><span data-stu-id="3df34-121">Host applications expose functionality for add-ins to integrate with.</span></span>  
  
 <span data-ttu-id="3df34-122">Doplňky se použije, hostování aplikací nutné k jejich vyhledání a načtení za běhu.</span><span class="sxs-lookup"><span data-stu-id="3df34-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="3df34-123">Aplikace, které podporují doplňky v důsledku toho vyplývají následující dodatečné povinnosti:</span><span class="sxs-lookup"><span data-stu-id="3df34-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>  
  
-   <span data-ttu-id="3df34-124">**Zjišťování**: hledání doplňků, které se řídí kontrakty nepodporuje hostování aplikací.</span><span class="sxs-lookup"><span data-stu-id="3df34-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>  
  
-   <span data-ttu-id="3df34-125">**Aktivace**: načítání, spuštění a navázání komunikace s doplňky.</span><span class="sxs-lookup"><span data-stu-id="3df34-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>  
  
-   <span data-ttu-id="3df34-126">**Izolace**: vytvoření hranice izolace ochránit aplikace před potenciální problémy zabezpečení a provádění s doplňky pomocí domén aplikace nebo procesy.</span><span class="sxs-lookup"><span data-stu-id="3df34-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>  
  
-   <span data-ttu-id="3df34-127">**Komunikace**: povolení doplňky a hostovat aplikace komunikovat mezi sebou přes hranice izolace pomocí volání metody a předávání dat.</span><span class="sxs-lookup"><span data-stu-id="3df34-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>  
  
-   <span data-ttu-id="3df34-128">**Správa životního cyklu**: načítání a uvolňování domény aplikace a procesy vyčistit a předvídatelným způsobem (viz [aplikačních doménách](../../../../docs/framework/app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="3df34-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../../../docs/framework/app-domains/application-domains.md)).</span></span>  
  
-   <span data-ttu-id="3df34-129">**Správa verzí**: zajištění, že hostovat aplikace a doplňky stále komunikovat při vytváření nové verze buď.</span><span class="sxs-lookup"><span data-stu-id="3df34-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>  
  
 <span data-ttu-id="3df34-130">Nakonec vývoj robustní model doplňku je netriviální podniku.</span><span class="sxs-lookup"><span data-stu-id="3df34-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="3df34-131">Z tohoto důvodu [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] poskytuje infrastrukturu pro vytváření modelů po doplňku.</span><span class="sxs-lookup"><span data-stu-id="3df34-131">For this reason, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides an infrastructure for building add-in models.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3df34-132">Podrobnější informace o doplňcích, najdete v článku [doplňků a rozšíření](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="3df34-132">For more detailed information on add-ins, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="NETFrameworkAddInModelOverview"></a>   
## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="3df34-133">Přehled modelu doplňku rozhraní .NET framework</span><span class="sxs-lookup"><span data-stu-id="3df34-133">.NET Framework Add-In Model Overview</span></span>  
 <span data-ttu-id="3df34-134">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] – Model doplňku, součástí <xref:System.AddIn> obor názvů obsahuje sadu typů, které jsou navržené pro zjednodušení vývoje rozšiřitelnosti doplňku.</span><span class="sxs-lookup"><span data-stu-id="3df34-134">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="3df34-135">Základní jednotku [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] v modelu doplňku je *kontraktu*, která definuje způsob, jakým hostitelskou aplikaci a doplněk komunikovat mezi sebou.</span><span class="sxs-lookup"><span data-stu-id="3df34-135">The fundamental unit of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="3df34-136">Kontrakt je přístupný pro hostitelskou aplikaci používat hostiteli specifické pro aplikaci *zobrazení* kontraktu.</span><span class="sxs-lookup"><span data-stu-id="3df34-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="3df34-137">Podobně přidat v konkrétní *zobrazení* kontraktu je přístupný add-in.</span><span class="sxs-lookup"><span data-stu-id="3df34-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="3df34-138">*Adaptér* slouží k povolení hostitele aplikace a doplněk ke komunikaci mezi jejich příslušných zobrazeních kontraktu.</span><span class="sxs-lookup"><span data-stu-id="3df34-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="3df34-139">Kontrakty, zobrazení a adaptéry jsou označovány jako segmentů a představuje sadu souvisejících segmentů *kanálu*.</span><span class="sxs-lookup"><span data-stu-id="3df34-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="3df34-140">Kanály jsou základem, na kterém [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] doplněk model podporuje zjišťování aktivace, izolace zabezpečení, izolaci spuštění (pomocí domény aplikace a procesy), komunikace, Správa životního cyklu a správy verzí.</span><span class="sxs-lookup"><span data-stu-id="3df34-140">Pipelines are the foundation upon which the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>  
  
 <span data-ttu-id="3df34-141">Součet tato podpora umožňuje vývojářům vytvářet doplňky, které se integrují s funkcemi hostitelskou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3df34-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="3df34-142">Některé scénáře však vyžadují hostování aplikací zobrazíte [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] poskytované doplňky. Protože každý prezentace technologie v [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] má svůj vlastní model pro implementaci [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] doplněk model nepodporuje žádné konkrétní prezentace technologie.</span><span class="sxs-lookup"><span data-stu-id="3df34-142">However, some scenarios require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins. Because each presentation technology in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has its own model for implementing [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="3df34-143">Místo toho [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] rozšiřuje [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] modelu doplňku s [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] podporu pro doplňky.</span><span class="sxs-lookup"><span data-stu-id="3df34-143">Instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support for add-ins.</span></span>  
  
<a name="WPFAddInModel"></a>   
## <a name="wpf-add-ins"></a><span data-ttu-id="3df34-144">Doplňků WPF</span><span class="sxs-lookup"><span data-stu-id="3df34-144">WPF Add-Ins</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="3df34-145">, ve spojení s [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] doplňku v modelu, můžete k vyřešení širokou škálu scénářů, které vyžadují hostování aplikací zobrazíte [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] z doplňků. Konkrétně se tyto scénáře jsou vyřešeny [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] pomocí následujících dvou programovacích modelů:</span><span class="sxs-lookup"><span data-stu-id="3df34-145">, in conjunction with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, allows you to address a wide variety of scenarios that require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] from add-ins. In particular, these scenarios are addressed by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] with the following two programming models:</span></span>  
  
1.  <span data-ttu-id="3df34-146">**Doplněk vrací uživatelské rozhraní**.</span><span class="sxs-lookup"><span data-stu-id="3df34-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="3df34-147">Vrací doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] hostitelské aplikace prostřednictvím volání metody, jak je definováno ve smlouvě.</span><span class="sxs-lookup"><span data-stu-id="3df34-147">An add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="3df34-148">Tento scénář se používá v následujících případech:</span><span class="sxs-lookup"><span data-stu-id="3df34-148">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="3df34-149">Vzhled [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , který je vrácen doplňku je závislá na obou data nebo podmínek, které existují pouze v době běhu, jako například dynamicky generované sestavy.</span><span class="sxs-lookup"><span data-stu-id="3df34-149">The appearance of a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>  
  
    -   <span data-ttu-id="3df34-150">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Služby poskytované doplněk se liší od [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] hostitele aplikací, které můžete použít doplněk.</span><span class="sxs-lookup"><span data-stu-id="3df34-150">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in differs from the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] of the host applications that can use the add-in.</span></span>  
  
    -   <span data-ttu-id="3df34-151">Doplněk primárně provádí služba pro hostitelskou aplikaci a hlásí stav do hostitelské aplikace s [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3df34-151">The add-in primarily performs a service for the host application, and reports status to the host application with a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
2.  <span data-ttu-id="3df34-152">**Doplněk je uživatelským rozhraním**.</span><span class="sxs-lookup"><span data-stu-id="3df34-152">**The add-in is a UI**.</span></span> <span data-ttu-id="3df34-153">Doplněk je [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], jak je definováno ve smlouvě.</span><span class="sxs-lookup"><span data-stu-id="3df34-153">An add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], as defined by the contract.</span></span> <span data-ttu-id="3df34-154">Tento scénář se používá v následujících případech:</span><span class="sxs-lookup"><span data-stu-id="3df34-154">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="3df34-155">Doplněk neposkytuje jinými službami než zobrazení, jako je například reklamu.</span><span class="sxs-lookup"><span data-stu-id="3df34-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>  
  
    -   <span data-ttu-id="3df34-156">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Pro služby poskytované doplňku je společné pro všechny hostitelské aplikace, které můžete použít tento doplněk, jako je například Kalkulačka nebo výběr barvy.</span><span class="sxs-lookup"><span data-stu-id="3df34-156">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>  
  
 <span data-ttu-id="3df34-157">Tyto scénáře vyžadují, aby [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] lze předat objekty mezi hostitele aplikací a domén aplikace doplňku.</span><span class="sxs-lookup"><span data-stu-id="3df34-157">These scenarios require that [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="3df34-158">Protože [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] doplněk modelu spoléhá na vzdálené komunikace pro komunikaci mezi doménami aplikace objekty, které jsou předávány mezi nimi musí být podpory vzdáleného přístupu.</span><span class="sxs-lookup"><span data-stu-id="3df34-158">Since the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>  
  
 <span data-ttu-id="3df34-159">Objekt lze použít vzdáleně je instance třídy, která provádí jeden nebo více z následujících akcí:</span><span class="sxs-lookup"><span data-stu-id="3df34-159">A remotable object is an instance of a class that does one or more of the following:</span></span>  
  
-   <span data-ttu-id="3df34-160">Je odvozen od <xref:System.MarshalByRefObject> třídy.</span><span class="sxs-lookup"><span data-stu-id="3df34-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>  
  
-   <span data-ttu-id="3df34-161">Implementuje <xref:System.Runtime.Serialization.ISerializable> rozhraní.</span><span class="sxs-lookup"><span data-stu-id="3df34-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>  
  
-   <span data-ttu-id="3df34-162">Má <xref:System.SerializableAttribute> atribut.</span><span class="sxs-lookup"><span data-stu-id="3df34-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3df34-163">Další informace týkající se vytváření vzdáleně nastavitelné [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objekty, najdete [provádění lze použít vzdáleně objekty](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span><span class="sxs-lookup"><span data-stu-id="3df34-163">For more information regarding the creation of remotable [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objects, see [Making Objects Remotable](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span></span>  
  
 <span data-ttu-id="3df34-164">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Typy nejsou podpory vzdáleného přístupu.</span><span class="sxs-lookup"><span data-stu-id="3df34-164">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] types are not remotable.</span></span> <span data-ttu-id="3df34-165">K vyřešení problému, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] rozšiřuje [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] modelu doplňku umožňující [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] vytvořil doplňky zobrazený z hostitele aplikací.</span><span class="sxs-lookup"><span data-stu-id="3df34-165">To solve the problem, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="3df34-166">Tato podpora poskytuje [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dva typy: <xref:System.AddIn.Contract.INativeHandleContract> rozhraní a dvě statické metody implementované <xref:System.AddIn.Pipeline.FrameworkElementAdapters> třídy: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> a <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="3df34-166">This support is provided by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="3df34-167">Na vysoké úrovni se používají tyto typy a metody následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="3df34-167">At a high level, these types and methods are used in the following manner:</span></span>  
  
1.  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="3df34-168"> vyžaduje, aby [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] poskytované doplňky jsou třídy, které jsou přímo nebo nepřímo odvozeny z <xref:System.Windows.FrameworkElement>, jako jsou například obrazce, ovládací prvky, uživatelské ovládací prvky, panely rozložení a stránky.</span><span class="sxs-lookup"><span data-stu-id="3df34-168"> requires that [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>  
  
2.  <span data-ttu-id="3df34-169">Bez ohledu na to kontrakt deklaruje, že uživatelské rozhraní se předají mezi doplněk a hostitelskou aplikací, musí být deklarována jako <xref:System.AddIn.Contract.INativeHandleContract> (ne <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> je vzdáleně nastavitelné reprezentace doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , které mohou být předány přes hranice izolace.</span><span class="sxs-lookup"><span data-stu-id="3df34-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that can be passed across isolation boundaries.</span></span>  
  
3.  <span data-ttu-id="3df34-170">Před předáním od doplňku na aplikační domény <xref:System.Windows.FrameworkElement> je zabalený jako <xref:System.AddIn.Contract.INativeHandleContract> voláním <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="3df34-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
4.  <span data-ttu-id="3df34-171">Po předávaný do hostitelské aplikace domény aplikace, <xref:System.AddIn.Contract.INativeHandleContract> musí být vytvořen nový balíček <xref:System.Windows.FrameworkElement> voláním <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="3df34-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>  
  
 <span data-ttu-id="3df34-172">Jak <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, a <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> použijí, závisí na konkrétní scénář.</span><span class="sxs-lookup"><span data-stu-id="3df34-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="3df34-173">Následující části obsahují podrobnosti o jednotlivých programovací model.</span><span class="sxs-lookup"><span data-stu-id="3df34-173">The following sections provide details for each programming model.</span></span>  
  
<a name="ReturnUIFromAddInContract"></a>   
## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="3df34-174">Doplněk vrací uživatelské rozhraní</span><span class="sxs-lookup"><span data-stu-id="3df34-174">Add-In Returns a User Interface</span></span>  
 <span data-ttu-id="3df34-175">Pro doplněk se vraťte [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] pro hostitelskou aplikaci, vyžadují se následující věci:</span><span class="sxs-lookup"><span data-stu-id="3df34-175">For an add-in to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to a host application, the following are required:</span></span>  
  
1.  <span data-ttu-id="3df34-176">Hostitelskou aplikaci a kanál musí vytvořit, jak je popsáno [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [doplňků a rozšíření](../../../../docs/framework/add-ins/index.md) dokumentaci.</span><span class="sxs-lookup"><span data-stu-id="3df34-176">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="3df34-177">Musí implementovat kontrakt <xref:System.AddIn.Contract.IContract> a vrátit [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], kontrakt musí deklarovat metody s návratovou hodnotou typu <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="3df34-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="3df34-178">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , Který je předán mezi doplněk a hostitelem aplikace musí přímo nebo nepřímo odvozovat z: <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="3df34-178">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="3df34-179">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , Který je vrácen doplněk musejí být převedeny z <xref:System.Windows.FrameworkElement> do <xref:System.AddIn.Contract.INativeHandleContract> před překročení hranice izolace.</span><span class="sxs-lookup"><span data-stu-id="3df34-179">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="3df34-180">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , Která je vrácena, musejí být převedeny z <xref:System.AddIn.Contract.INativeHandleContract> k <xref:System.Windows.FrameworkElement> po překročení hranice izolace.</span><span class="sxs-lookup"><span data-stu-id="3df34-180">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="3df34-181">Hostitelská aplikace zobrazí vráceného <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="3df34-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="3df34-182">Příklad, který ukazuje, jak implementovat doplněk, který vrací [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], naleznete v tématu [vytvořit doplňku, který vrací uživatelské rozhraní](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="3df34-182">For an example that demonstrates how to implement an add-in that returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span></span>  
  
<a name="AddInIsAUI"></a>   
## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="3df34-183">Doplněk je uživatelské rozhraní</span><span class="sxs-lookup"><span data-stu-id="3df34-183">Add-In Is a User Interface</span></span>  
 <span data-ttu-id="3df34-184">Když je doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], vyžadují se následující věci:</span><span class="sxs-lookup"><span data-stu-id="3df34-184">When an add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the following are required:</span></span>  
  
1.  <span data-ttu-id="3df34-185">Hostitelskou aplikaci a kanál musí vytvořit, jak je popsáno [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [doplňků a rozšíření](../../../../docs/framework/add-ins/index.md) dokumentaci.</span><span class="sxs-lookup"><span data-stu-id="3df34-185">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="3df34-186">Musí implementovat rozhraní kontraktu pro doplněk <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="3df34-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="3df34-187">Doplněk, který je předán do hostitelské aplikace musí přímo nebo nepřímo odvozovat z: <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="3df34-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="3df34-188">Doplněk musejí být převedeny z <xref:System.Windows.FrameworkElement> do <xref:System.AddIn.Contract.INativeHandleContract> před překročení hranice izolace.</span><span class="sxs-lookup"><span data-stu-id="3df34-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="3df34-189">Doplněk musejí být převedeny z <xref:System.AddIn.Contract.INativeHandleContract> k <xref:System.Windows.FrameworkElement> po překročení hranice izolace.</span><span class="sxs-lookup"><span data-stu-id="3df34-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="3df34-190">Hostitelská aplikace zobrazí vráceného <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="3df34-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="3df34-191">Příklad, který ukazuje, jak implementovat doplňku, který je [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], naleznete v tématu [vytvoření uživatelského rozhraní doplňku, který je](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="3df34-191">For an example that demonstrates how to implement an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Is a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span></span>  
  
<a name="ReturningMultipleUIsFromAnAddIn"></a>   
## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="3df34-192">Vrácení více uživatelských rozhraní z doplňku</span><span class="sxs-lookup"><span data-stu-id="3df34-192">Returning Multiple UIs from an Add-In</span></span>  
 <span data-ttu-id="3df34-193">Doplňky často poskytují více [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] pro hostování aplikací zobrazíte.</span><span class="sxs-lookup"><span data-stu-id="3df34-193">Add-ins often provide multiple [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] for host applications to display.</span></span> <span data-ttu-id="3df34-194">Představte si třeba doplňku, který je [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , který také obsahuje informace o stavu do hostitelské aplikace také jako [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3df34-194">For example, consider an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that also provides status information to the host application, also as a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="3df34-195">Doplněk tímto způsobem můžete implementovat pomocí kombinace postupů z obou [vrátí Add-In uživatelské rozhraní](#ReturnUIFromAddInContract) a [doplňku je uživatelské rozhraní](#AddInIsAUI) modely.</span><span class="sxs-lookup"><span data-stu-id="3df34-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>  
  
<a name="AddInsAndXBAPs"></a>   
## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="3df34-196">Doplňky a aplikace prohlížeče XAML</span><span class="sxs-lookup"><span data-stu-id="3df34-196">Add-Ins and XAML Browser Applications</span></span>  
 <span data-ttu-id="3df34-197">V příkladech zatím hostitelská aplikace byla nainstalovaná samostatná aplikace.</span><span class="sxs-lookup"><span data-stu-id="3df34-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="3df34-198">Ale [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] můžou hostovat taky doplňků, spolu s následující další sestavení a provádění požadavků:</span><span class="sxs-lookup"><span data-stu-id="3df34-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>  
  
-   <span data-ttu-id="3df34-199">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Manifestu aplikace musí být nakonfigurován speciálně pro stahování kanálu (složky a sestavení) a přidejte sestavení do [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] mezipaměti aplikace v klientském počítači ve stejné složce jako [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3df34-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>  
  
-   <span data-ttu-id="3df34-200">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Kód zjišťovat a načíst doplňků musí použít [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] mezipaměti aplikace pro [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] jako umístění a kanálu doplňku.</span><span class="sxs-lookup"><span data-stu-id="3df34-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>  
  
-   <span data-ttu-id="3df34-201">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] Musí načtení doplňku do kontextu zabezpečení speciální Pokud doplněk odkazuje volné soubory, které se nachází v umístění původních; když jsou hostované ve [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], doplňky mohou odkazovat pouze na volné soubory, které jsou umístěné na serveru hostitele aplikace původu.</span><span class="sxs-lookup"><span data-stu-id="3df34-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>  
  
 <span data-ttu-id="3df34-202">Tyto úlohy jsou popsány podrobně v následujících oddílech.</span><span class="sxs-lookup"><span data-stu-id="3df34-202">These tasks are described in detail in the following subsections.</span></span>  
  
### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="3df34-203">Konfigurace kanálu a Add-In pro nasazení ClickOnce</span><span class="sxs-lookup"><span data-stu-id="3df34-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>  
 [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]<span data-ttu-id="3df34-204"> jsou stahovat a spouštět ze složky v nouzovém [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] mezipaměti nasazení.</span><span class="sxs-lookup"><span data-stu-id="3df34-204"> are downloaded to and run from a safe folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment cache.</span></span> <span data-ttu-id="3df34-205">Aby se [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] k hostování doplňku, je nutné stáhnout sestavení kanálu a doplněk ke složce bezpečné.</span><span class="sxs-lookup"><span data-stu-id="3df34-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="3df34-206">K dosažení tohoto cíle, musíte nakonfigurovat manifest aplikace zahrnout kanálu a sestavení doplňku pro stahování.</span><span class="sxs-lookup"><span data-stu-id="3df34-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="3df34-207">To se provádí nejsnadněji v [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], i když sestavení kanálu a doplněk musí být na hostiteli [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] kořenové složce projektu mohl [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] ke zjištění sestavení kanálu.</span><span class="sxs-lookup"><span data-stu-id="3df34-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>  
  
 <span data-ttu-id="3df34-208">V důsledku toho prvním krokem je vytvoření kanálu a sestavení doplňku do [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] kořenové projektu tak, že nastavíte sestavení a přidat do projektů sestavení výstupu sestavení každý kanál.</span><span class="sxs-lookup"><span data-stu-id="3df34-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="3df34-209">V následující tabulce jsou uvedeny výstupní cesta sestavení pro projekty kanálu sestavení a sestavení doplňku v projektu, které jsou ve stejném řešení a kořenové složky jako hostitel [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] projektu.</span><span class="sxs-lookup"><span data-stu-id="3df34-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>  
  
 <span data-ttu-id="3df34-210">Tabulka 1: Vytvořit výstupní cesty pro kanál sestavení, které jsou hostované XBAP</span><span class="sxs-lookup"><span data-stu-id="3df34-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>  
  
|<span data-ttu-id="3df34-211">Projekt sestavení kanálu</span><span class="sxs-lookup"><span data-stu-id="3df34-211">Pipeline assembly project</span></span>|<span data-ttu-id="3df34-212">Výstupní cesta sestavení</span><span class="sxs-lookup"><span data-stu-id="3df34-212">Build output path</span></span>|  
|-------------------------------|-----------------------|  
|<span data-ttu-id="3df34-213">Kontrakt</span><span class="sxs-lookup"><span data-stu-id="3df34-213">Contract</span></span>|`..\HostXBAP\Contracts\`|  
|<span data-ttu-id="3df34-214">Zobrazení doplňku</span><span class="sxs-lookup"><span data-stu-id="3df34-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|  
|<span data-ttu-id="3df34-215">Přidat v-adaptér na straně</span><span class="sxs-lookup"><span data-stu-id="3df34-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|  
|<span data-ttu-id="3df34-216">Adaptér na straně hostitele</span><span class="sxs-lookup"><span data-stu-id="3df34-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|  
|<span data-ttu-id="3df34-217">Add-In</span><span class="sxs-lookup"><span data-stu-id="3df34-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|  
  
 <span data-ttu-id="3df34-218">Dalším krokem je zadání kanálu sestavení a sestavení doplňku jako [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] obsah souborů v [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="3df34-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="3df34-219">Třeba sestavení a kanálu doplňku v projektu tak, že pravým tlačítkem myši na každý kanál složku v Průzkumníku řešení a zvolením **zahrnout do projektu**.</span><span class="sxs-lookup"><span data-stu-id="3df34-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>  
  
2.  <span data-ttu-id="3df34-220">Nastavení **akce sestavení** jednotlivých kanálu sestavení a sestavení doplňku do **obsahu** z **vlastnosti** okna.</span><span class="sxs-lookup"><span data-stu-id="3df34-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>  
  
 <span data-ttu-id="3df34-221">Posledním krokem je konfigurace manifestu aplikace do kanálu soubory sestavení a sestavení doplňku v souboru ke stažení.</span><span class="sxs-lookup"><span data-stu-id="3df34-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="3df34-222">Soubory musíte umístit do složky v kořenové složce v [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] ukládat do mezipaměti, který [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] aplikace zabírá.</span><span class="sxs-lookup"><span data-stu-id="3df34-222">The files should be located in folders at the root of the folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="3df34-223">Konfigurace můžete dosáhnout v [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] následujícím způsobem:</span><span class="sxs-lookup"><span data-stu-id="3df34-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="3df34-224">Klikněte pravým tlačítkem na [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] projektu, klikněte na tlačítko **vlastnosti**, klikněte na tlačítko **publikovat**a potom klikněte na tlačítko **soubory aplikace** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="3df34-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>  
  
2.  <span data-ttu-id="3df34-225">V **soubory aplikace** dialogové okno, nastavte **stav publikování** jednotlivých kanálů a knihovny DLL doplňku **Include (Auto)** a nastavte **skupina pro stažení** pro každý kanál a DLL – doplněk pro **(povinné)**.</span><span class="sxs-lookup"><span data-stu-id="3df34-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>  
  
### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="3df34-226">Použití kanálu a doplněk z základ cesty aplikace</span><span class="sxs-lookup"><span data-stu-id="3df34-226">Using the Pipeline and Add-In from the Application Base</span></span>  
 <span data-ttu-id="3df34-227">Když na kanálu a jsou nakonfigurované pro [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] nasazení, se stáhnou do stejné [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] složku mezipaměti, jako [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3df34-227">When the pipeline and add-in are configured for [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment, they are downloaded to the same [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="3df34-228">Použití kanálu a doplněk z [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] kódu nutné získat aplikace základní.</span><span class="sxs-lookup"><span data-stu-id="3df34-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="3df34-229">Různé typy a členy [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] model doplňku pomocí kanálů a doplňky poskytují zvláštní podporu pro tento scénář.</span><span class="sxs-lookup"><span data-stu-id="3df34-229">The various types and members of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="3df34-230">Za prvé, je identifikován cestu <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> hodnota výčtu.</span><span class="sxs-lookup"><span data-stu-id="3df34-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="3df34-231">Tuto hodnotu použijete s přetížení členů relevantní – doplněk pro práci s kanály, které zahrnují následující:</span><span class="sxs-lookup"><span data-stu-id="3df34-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="3df34-232">Přístup k serveru hostitele původu</span><span class="sxs-lookup"><span data-stu-id="3df34-232">Accessing the Host's Site of Origin</span></span>  
 <span data-ttu-id="3df34-233">Aby bylo zajištěno, že doplněk lze odkazují na soubory webu původu, doplněk musí být načten izolace zabezpečení, který je ekvivalentní k hostitele aplikace.</span><span class="sxs-lookup"><span data-stu-id="3df34-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="3df34-234">Tato úroveň zabezpečení je identifikován <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> hodnota výčtu a předat <xref:System.AddIn.Hosting.AddInToken.Activate%2A> metodu, když se aktivuje doplněk.</span><span class="sxs-lookup"><span data-stu-id="3df34-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>  
  
<a name="WPFAddInModelArchitecture"></a>   
## <a name="wpf-add-in-architecture"></a><span data-ttu-id="3df34-235">Architektura doplňků WPF</span><span class="sxs-lookup"><span data-stu-id="3df34-235">WPF Add-In Architecture</span></span>  
 <span data-ttu-id="3df34-236">Na nejvyšší úrovni jak jsme viděli, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] umožňuje [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] doplňků k implementaci [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (který přímo nebo nepřímo odvodit z <xref:System.Windows.FrameworkElement>) pomocí <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> a <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="3df34-236">At the highest level, as we've seen, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] enables [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-ins to implement [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="3df34-237">Výsledkem je, že se hostitelská aplikace vrátí <xref:System.Windows.FrameworkElement> , která se zobrazí z [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] v hostitelské aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3df34-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] in the host application.</span></span>  
  
 <span data-ttu-id="3df34-238">Pro jednoduché [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] doplněk scénáře, toto je co nejvíce podrobností vývojář potřebuje.</span><span class="sxs-lookup"><span data-stu-id="3df34-238">For simple [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="3df34-239">Pro složitější scénáře, zvláště ta, která pokusí využívat další [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] služby, například rozložení, prostředky a datové vazby, podrobnější znalosti o tom, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] rozšiřuje [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] modelu doplňku s [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Podpora je potřeba pochopit jeho výhody a omezení.</span><span class="sxs-lookup"><span data-stu-id="3df34-239">For more complex scenarios, particularly those that try to utilize additional [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] services such as layout, resources, and data binding, more detailed knowledge of how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support is required to understand its benefits and limitations.</span></span>  
  
 <span data-ttu-id="3df34-240">V podstatě [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] neprojde [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] z doplňku pro hostitelskou aplikaci; místo toho [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] předává popisovač okna Win32 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] pomocí [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] vzájemná funkční spolupráce.</span><span class="sxs-lookup"><span data-stu-id="3df34-240">Fundamentally, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doesn't pass a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in to a host application; instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passes the Win32 window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] by using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] interoperability.</span></span> <span data-ttu-id="3df34-241">Jako takové, když [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] z doplňku je předán do hostitelské aplikace, dojde k následujícímu:</span><span class="sxs-lookup"><span data-stu-id="3df34-241">As such, when a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in is passed to a host application, the following occurs:</span></span>  
  
-   <span data-ttu-id="3df34-242">Na straně doplňku [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] získá popisovač okna pro [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , který se zobrazí hostitelskou aplikací.</span><span class="sxs-lookup"><span data-stu-id="3df34-242">On the add-in side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] acquires a window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that will be displayed by the host application.</span></span> <span data-ttu-id="3df34-243">Popisovač okna jsou zapouzdřena objektem interní [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] třídu odvozenou od <xref:System.Windows.Interop.HwndSource> a implementuje <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="3df34-243">The window handle is encapsulated by an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="3df34-244">Instance této třídy je vrácený <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> a je zařazeno od doplňku na aplikační domény do domény aplikace hostitelskou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3df34-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>  
  
-   <span data-ttu-id="3df34-245">Na straně hostitele aplikace [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] sbalí <xref:System.Windows.Interop.HwndSource> jako interní [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] třídu odvozenou od <xref:System.Windows.Interop.HwndHost> a využívá <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="3df34-245">On the host application side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] repackages the <xref:System.Windows.Interop.HwndSource> as an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="3df34-246">Instance této třídy je vrácený <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> hostitelské aplikace.</span><span class="sxs-lookup"><span data-stu-id="3df34-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>  
  
 <span data-ttu-id="3df34-247"><xref:System.Windows.Interop.HwndHost> existuje zobrazíte [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identifikovaný popisovače okna z [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3df34-247"><xref:System.Windows.Interop.HwndHost> exists to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identified by window handles, from [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="3df34-248">Další informace najdete v tématu [WPF a systému Win32 vzájemná spolupráce grafického subsystému](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span><span class="sxs-lookup"><span data-stu-id="3df34-248">For more information, see [WPF and Win32 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span></span>  
  
 <span data-ttu-id="3df34-249">Stručně řečeno <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, a <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> umožňují popisovač okna pro [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] předat z doplňku pro hostitelskou aplikaci, ve kterém jsou zapouzdřena objektem <xref:System.Windows.Interop.HwndHost> a zobrazí hostitele aplikace [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3df34-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="3df34-250">Protože hostitelská aplikace získá <xref:System.Windows.Interop.HwndHost>, hostitelské aplikace nelze převést na objekt, který je vrácený <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> typu ho je implementováno jako doplněk (například <xref:System.Windows.Controls.UserControl>).</span><span class="sxs-lookup"><span data-stu-id="3df34-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>  
  
 <span data-ttu-id="3df34-251">Svou povahou <xref:System.Windows.Interop.HwndHost> má určitá omezení, které ovlivňují, jak hostovat aplikace je můžete využít.</span><span class="sxs-lookup"><span data-stu-id="3df34-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="3df34-252">Ale [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] rozšiřuje <xref:System.Windows.Interop.HwndHost> s několika možnostmi pro doplněk scénáře.</span><span class="sxs-lookup"><span data-stu-id="3df34-252">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="3df34-253">Tyto výhody a omezení jsou popsané níže.</span><span class="sxs-lookup"><span data-stu-id="3df34-253">These benefits and limitations are described below.</span></span>  
  
<a name="WPFAddInModelBenefits"></a>   
## <a name="wpf-add-in-benefits"></a><span data-ttu-id="3df34-254">WPF – doplněk výhody</span><span class="sxs-lookup"><span data-stu-id="3df34-254">WPF Add-In Benefits</span></span>  
 <span data-ttu-id="3df34-255">Protože [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doplněk [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] zobrazují z hostitele aplikací pomocí vnitřní třída, která je odvozena z <xref:System.Windows.Interop.HwndHost>, které [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] jsou omezeny funkce <xref:System.Windows.Interop.HwndHost> s ohledem na [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] služeb, jako je rozložení, vykreslování, datových vazeb, styly, šablony a prostředky.</span><span class="sxs-lookup"><span data-stu-id="3df34-255">Because [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="3df34-256">Ale [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] posiluje interní <xref:System.Windows.Interop.HwndHost> podtřídy doplněná o funkce, které zahrnují následující:</span><span class="sxs-lookup"><span data-stu-id="3df34-256">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>  
  
-   <span data-ttu-id="3df34-257">Přecházení mezi hostitelskou aplikaci pomocí tabulátoru [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] a doplňku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3df34-257">Tabbing between a host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="3df34-258">Všimněte si, že "je doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programovací model vyžaduje adaptér přidat v na straně přepsat <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> povolit procházení tabulátorem, zda doplněk je plně důvěryhodné nebo částečně důvěryhodné.</span><span class="sxs-lookup"><span data-stu-id="3df34-258">Note that the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>  
  
-   <span data-ttu-id="3df34-259">Aby byla dodržena požadavky na usnadnění přístupu pro doplněk [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] , který se zobrazí z aplikace hostitel [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3df34-259">Honoring accessibility requirements for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host application [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span>  
  
-   <span data-ttu-id="3df34-260">Povolení [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] aplikace, které poběží bezpečně ve scénářích s více domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="3df34-260">Enabling [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications to run safely in multiple application domain scenarios.</span></span>  
  
-   <span data-ttu-id="3df34-261">Neplatný přístup k doplňku brání [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] zpracovává okno při spuštění doplňků izolace zabezpečení (to znamená, sandboxu částečným vztahem důvěryhodnosti zabezpečení).</span><span class="sxs-lookup"><span data-stu-id="3df34-261">Preventing illegal access to add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="3df34-262">Volání <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> zajišťuje toto zabezpečení:</span><span class="sxs-lookup"><span data-stu-id="3df34-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>  
  
    -   <span data-ttu-id="3df34-263">Pro "add-in vrátí [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programovací model, jediný způsob, jak předat popisovač okna pro doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] napříč izolaci hranice je volat <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="3df34-263">For the "add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, the only way to pass the window handle for an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
    -   <span data-ttu-id="3df34-264">Pro "doplněk je [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programovací model, přepisování <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> přidat v vedle adaptéru a volání <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (jak je znázorněno v předchozích ukázkách) je nutné použít, jako je volání adaptér přidat v na straně `QueryContract` implementace z adaptér na straně hostitele.</span><span class="sxs-lookup"><span data-stu-id="3df34-264">For the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>  
  
-   <span data-ttu-id="3df34-265">Poskytování více ochrana provádění domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="3df34-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="3df34-266">Vzhledem k omezením s aplikačními doménami způsobit neošetřené výjimky, které jsou vyvolány v doplňku v aplikačních doménách celé aplikace při selhání, i když existuje oddělovací hranice.</span><span class="sxs-lookup"><span data-stu-id="3df34-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="3df34-267">Ale [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] – model doplňku poskytují jednoduchý způsob, jak tento problém vyřešit a zlepšit stabilita aplikace.</span><span class="sxs-lookup"><span data-stu-id="3df34-267">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] and the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="3df34-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doplněk, který se zobrazí [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] vytvoří <xref:System.Windows.Threading.Dispatcher> pro vlákno, na které domény aplikace poběží, pokud je hostitelská aplikace [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] aplikace.</span><span class="sxs-lookup"><span data-stu-id="3df34-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in that displays a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application.</span></span> <span data-ttu-id="3df34-269">Můžete zjistit všechny neošetřené výjimky, ke kterým dochází v doméně aplikace pomocí manipulace <xref:System.Windows.Threading.Dispatcher.UnhandledException> událost [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doplňku <xref:System.Windows.Threading.Dispatcher>.</span><span class="sxs-lookup"><span data-stu-id="3df34-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="3df34-270">Můžete získat <xref:System.Windows.Threading.Dispatcher> z <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="3df34-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>  
  
<a name="WPFAddInModelLimitations"></a>   
## <a name="wpf-add-in-limitations"></a><span data-ttu-id="3df34-271">WPF – doplněk omezení</span><span class="sxs-lookup"><span data-stu-id="3df34-271">WPF Add-In Limitations</span></span>  
 <span data-ttu-id="3df34-272">Nad rámec výhody, které [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] přidá do výchozí chování poskytnutých <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>a popisovače oken, existují také omezení pro doplněk [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] , který se zobrazí z hostitele aplikací:</span><span class="sxs-lookup"><span data-stu-id="3df34-272">Beyond the benefits that [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host applications:</span></span>  
  
-   <span data-ttu-id="3df34-273">Doplněk [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] zobrazí z hostitele aplikace neodpovídají chování výstřižek hostitelskou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3df34-273">Add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] displayed from a host application do not respect the host application's clipping behavior.</span></span>  
  
-   <span data-ttu-id="3df34-274">Konceptu *vzdušného prostoru* interoperabilitou scénáře platí také pro doplňky (viz [přehled technologických oblastí](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="3df34-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span></span>  
  
-   <span data-ttu-id="3df34-275">Hostitelská aplikace [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] služby, jako je dědičnost prostředků, datové vazby a příkazů, nejsou automaticky dostupné pro doplněk [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3df34-275">A host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="3df34-276">K poskytování těchto služeb add-in, budete muset aktualizovat kanálu.</span><span class="sxs-lookup"><span data-stu-id="3df34-276">To provide these services to the add-in, you need to update the pipeline.</span></span>  
  
-   <span data-ttu-id="3df34-277">Doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] nemůže být otočen, škálovat, zkosený nebo jinak ovlivněná pomocí transformace (viz [transformuje přehled](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="3df34-277">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span></span>  
  
-   <span data-ttu-id="3df34-278">Obsah uvnitř doplněk [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] , který je vykreslen metodou kreslicí operace z <xref:System.Drawing> oboru názvů může zahrnovat alfa míchání.</span><span class="sxs-lookup"><span data-stu-id="3df34-278">Content inside add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="3df34-279">Však obě doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] a hostitelskou aplikaci [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , který obsahuje musí být 100 % neprůhledný; jinými slovy, `Opacity` vlastnost u obou musí být nastavena na hodnotu 1.</span><span class="sxs-lookup"><span data-stu-id="3df34-279">However, both an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and the host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>  
  
-   <span data-ttu-id="3df34-280">Pokud <xref:System.Windows.Window.AllowsTransparency%2A> vlastnost okna v hostiteli aplikace, která obsahuje doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] je nastavena na `true`, doplněk je neviditelné.</span><span class="sxs-lookup"><span data-stu-id="3df34-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="3df34-281">To platí i v případě, doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] je neprůhledný 100 % (to znamená `Opacity` vlastnost má hodnotu 1).</span><span class="sxs-lookup"><span data-stu-id="3df34-281">This is true even if the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>  
  
-   <span data-ttu-id="3df34-282">Doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] musí být uvedena na jiné [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elementy ve stejném okně nejvyšší úrovně.</span><span class="sxs-lookup"><span data-stu-id="3df34-282">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must appear on top of other [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements in the same top-level window.</span></span>  
  
-   <span data-ttu-id="3df34-283">Žádná část doplňku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] může být vykreslen pomocí <xref:System.Windows.Media.VisualBrush>.</span><span class="sxs-lookup"><span data-stu-id="3df34-283">No portion of an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="3df34-284">Místo toho doplněk může pořídit snímek generované [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] vytvořit rastrový obrázek, který lze předat do hostitelské aplikace pomocí metody definované ve smlouvě.</span><span class="sxs-lookup"><span data-stu-id="3df34-284">Instead, the add-in may take a snapshot of the generated [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>  
  
-   <span data-ttu-id="3df34-285">Multimediální soubory nelze přehrát z <xref:System.Windows.Controls.MediaElement> v doplňku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="3df34-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
-   <span data-ttu-id="3df34-286">Myš události vygenerované pro doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] nejsou přijata ani vyvolané hostitelskou aplikaci a `IsMouseOver` vlastnost pro hostitelskou aplikaci [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] má hodnotu `false`.</span><span class="sxs-lookup"><span data-stu-id="3df34-286">Mouse events generated for the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] are neither received nor raised by the host application, and the `IsMouseOver` property for host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] has a value of `false`.</span></span>  
  
-   <span data-ttu-id="3df34-287">Když se pozornost zaměří mezi ovládacími prvky v doplňku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], `GotFocus` a `LostFocus` události nejsou přijata ani vyvolané hostitelskou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3df34-287">When focus shifts between controls in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>  
  
-   <span data-ttu-id="3df34-288">Část aplikace hostitele, který obsahuje doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] se zobrazí bílé po vytištění.</span><span class="sxs-lookup"><span data-stu-id="3df34-288">The portion of a host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] appears white when printed.</span></span>  
  
-   <span data-ttu-id="3df34-289">Všechny dispečerů (naleznete v tématu <xref:System.Windows.Threading.Dispatcher>) vytvořené pomocí doplňku [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] musí být vypnut ručně před doplňku vlastníka je uvolněna, pokud hostitelská aplikace pokračuje v provádění kódu.</span><span class="sxs-lookup"><span data-stu-id="3df34-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="3df34-290">Smlouvy můžete implementovat metody, které umožňují hostitelskou aplikaci na signál doplňku před doplňku je uvolněna, což doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] vypnout jeho dispečerů.</span><span class="sxs-lookup"><span data-stu-id="3df34-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to shut down its dispatchers.</span></span>  
  
-   <span data-ttu-id="3df34-291">Pokud doplněk [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] je <xref:System.Windows.Controls.InkCanvas> nebo obsahuje <xref:System.Windows.Controls.InkCanvas>, není možné uvolnit doplňku.</span><span class="sxs-lookup"><span data-stu-id="3df34-291">If an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>  
  
<a name="PerformanceOptimization"></a>   
## <a name="performance-optimization"></a><span data-ttu-id="3df34-292">Optimalizace výkonu</span><span class="sxs-lookup"><span data-stu-id="3df34-292">Performance Optimization</span></span>  
 <span data-ttu-id="3df34-293">Ve výchozím nastavení, pokud se používá více domén aplikace různé [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] sestavení vyžadované každé aplikace jsou všechny načtené do domény vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="3df34-293">By default, when multiple application domains are used, the various [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="3df34-294">Čas potřebný k vytvoření nové domény aplikace a spouštění aplikací v nich v důsledku toho může ovlivnit výkon.</span><span class="sxs-lookup"><span data-stu-id="3df34-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="3df34-295">Ale [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] poskytuje způsob, jak můžete snížit dobu spuštění tím, že aplikace pro sdílení sestavení napříč doménami aplikace, pokud jsou už načteny.</span><span class="sxs-lookup"><span data-stu-id="3df34-295">However, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="3df34-296">Můžete to provést pomocí <xref:System.LoaderOptimizationAttribute> atribut, který je nutné použít na metodu vstupního bodu (`Main`).</span><span class="sxs-lookup"><span data-stu-id="3df34-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="3df34-297">V takovém případě je nutné použít pouze kód pro implementaci definice aplikace (viz [přehled správy aplikací](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="3df34-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3df34-298">Viz také</span><span class="sxs-lookup"><span data-stu-id="3df34-298">See Also</span></span>  
 <xref:System.LoaderOptimizationAttribute>  
 [<span data-ttu-id="3df34-299">Doplňky a rozšíření</span><span class="sxs-lookup"><span data-stu-id="3df34-299">Add-ins and Extensibility</span></span>](../../../../docs/framework/add-ins/index.md)  
 [<span data-ttu-id="3df34-300">Aplikační domény</span><span class="sxs-lookup"><span data-stu-id="3df34-300">Application Domains</span></span>](../../../../docs/framework/app-domains/application-domains.md)  
 [<span data-ttu-id="3df34-301">Vzdálené komunikace .NET framework – přehled</span><span class="sxs-lookup"><span data-stu-id="3df34-301">.NET Framework Remoting Overview</span></span>](https://msdn.microsoft.com/library/eccb1d31-0a22-417a-97fd-f4f1f3aa4462)  
 [<span data-ttu-id="3df34-302">Vytváření objektů lze používat vzdáleně</span><span class="sxs-lookup"><span data-stu-id="3df34-302">Making Objects Remotable</span></span>](https://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a)  
 [<span data-ttu-id="3df34-303">Témata s postupy</span><span class="sxs-lookup"><span data-stu-id="3df34-303">How-to Topics</span></span>](../../../../docs/framework/wpf/app-development/how-to-topics.md)
