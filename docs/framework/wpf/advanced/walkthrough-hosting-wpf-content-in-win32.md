---
title: 'Návod: Hostování obsahu WPF v Win32'
ms.date: 03/30/2017
dev_langs:
- cpp
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
ms.assetid: 38ce284a-4303-46dd-b699-c9365b22a7dc
ms.openlocfilehash: 429acf6e3b37f5532e031fdef999d252a3aae3cb
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/04/2018
ms.locfileid: "33549448"
---
# <a name="walkthrough-hosting-wpf-content-in-win32"></a><span data-ttu-id="14c55-102">Návod: Hostování obsahu WPF v Win32</span><span class="sxs-lookup"><span data-stu-id="14c55-102">Walkthrough: Hosting WPF Content in Win32</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="14c55-103"> poskytuje bohaté prostředí pro vytváření aplikací.</span><span class="sxs-lookup"><span data-stu-id="14c55-103"> provides a rich environment for creating applications.</span></span> <span data-ttu-id="14c55-104">Pokud však máte významné investice [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] kódu, může být efektivnější přidat [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] funkce do vaší aplikace a nikoli přepisování původní kód.</span><span class="sxs-lookup"><span data-stu-id="14c55-104">However, when you have a substantial investment in [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] code, it might be more effective to add [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] functionality to your application rather than rewriting your original code.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="14c55-105"> Poskytuje přehledné mechanismus pro hostování [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okno.</span><span class="sxs-lookup"><span data-stu-id="14c55-105"> provides a straightforward mechanism for hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span>  
  
 <span data-ttu-id="14c55-106">Tento kurz popisuje, jak psát ukázkové aplikace, [hostování obsahu subsystému WPF v ukázku okno Win32](http://go.microsoft.com/fwlink/?LinkID=160004), že hostitelé [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okno.</span><span class="sxs-lookup"><span data-stu-id="14c55-106">This tutorial describes how to write a sample application, [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004), that hosts [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="14c55-107">Tato ukázka hostování všech můžete rozšířit [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okno.</span><span class="sxs-lookup"><span data-stu-id="14c55-107">You can extend this sample to host any [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="14c55-108">Protože se týká kombinování spravovanými a nespravovanými kódu, aplikace je napsána v [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="14c55-108">Because it involves mixing managed and unmanaged code, the application is written in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span>  
  
 
  
<a name="requirements"></a>   
## <a name="requirements"></a><span data-ttu-id="14c55-109">Požadavky</span><span class="sxs-lookup"><span data-stu-id="14c55-109">Requirements</span></span>  
 <span data-ttu-id="14c55-110">Tento kurz předpokládá základní znalost obou [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programování.</span><span class="sxs-lookup"><span data-stu-id="14c55-110">This tutorial assumes a basic familiarity with both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming.</span></span> <span data-ttu-id="14c55-111">Pro základní informace o [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programování, najdete v části [Začínáme](../../../../docs/framework/wpf/getting-started/index.md).</span><span class="sxs-lookup"><span data-stu-id="14c55-111">For a basic introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming, see [Getting Started](../../../../docs/framework/wpf/getting-started/index.md).</span></span> <span data-ttu-id="14c55-112">Úvod do [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programování, by měl odkazujete některé z mnoha knih na subjektu, zejména *programování Windows* podle Charlese Petzold.</span><span class="sxs-lookup"><span data-stu-id="14c55-112">For an introduction to [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] programming, you should reference any of the numerous books on the subject, in particular *Programming Windows* by Charles Petzold.</span></span>  
  
 <span data-ttu-id="14c55-113">Protože vzorku, který doprovází tento kurz je implementována ve [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], tento kurz předpokládá znalost použití [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] programu [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] [!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] plus představu o programování spravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="14c55-113">Because the sample that accompanies this tutorial is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)], this tutorial assumes familiarity with the use of [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] to program the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)][!INCLUDE[TLA2#tla_api](../../../../includes/tla2sharptla-api-md.md)] plus an understanding of managed code programming.</span></span> <span data-ttu-id="14c55-114">Znalost [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] je užitečné, ale není nezbytné.</span><span class="sxs-lookup"><span data-stu-id="14c55-114">Familiarity with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] is helpful but not essential.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="14c55-115">Tento kurz zahrnuje několik příklady kódu z přidružených ukázky.</span><span class="sxs-lookup"><span data-stu-id="14c55-115">This tutorial includes a number of code examples from the associated sample.</span></span> <span data-ttu-id="14c55-116">Ale čitelnější neobsahuje úplný ukázkový kód.</span><span class="sxs-lookup"><span data-stu-id="14c55-116">However, for readability, it does not include the complete sample code.</span></span> <span data-ttu-id="14c55-117">Úplný ukázkový kód, najdete v části [hostování obsahu WPF ve vzorku okno Win32](http://go.microsoft.com/fwlink/?LinkID=160004).</span><span class="sxs-lookup"><span data-stu-id="14c55-117">For the complete sample code, see [Hosting WPF Content in a Win32 Window Sample](http://go.microsoft.com/fwlink/?LinkID=160004).</span></span>  
  
<a name="basic_procedure"></a>   
## <a name="the-basic-procedure"></a><span data-ttu-id="14c55-118">Základní postup</span><span class="sxs-lookup"><span data-stu-id="14c55-118">The Basic Procedure</span></span>  
 <span data-ttu-id="14c55-119">Tato část popisuje základní postup použijete k hostiteli [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okno.</span><span class="sxs-lookup"><span data-stu-id="14c55-119">This section outlines the basic procedure you use to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window.</span></span> <span data-ttu-id="14c55-120">Zbývající části popisují podrobnosti o jednotlivých kroků.</span><span class="sxs-lookup"><span data-stu-id="14c55-120">The remaining sections explain the details of each step.</span></span>  
  
 <span data-ttu-id="14c55-121">Klíč k hostování [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu na [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] je okno <xref:System.Windows.Interop.HwndSource> třídy.</span><span class="sxs-lookup"><span data-stu-id="14c55-121">The key to hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content on a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="14c55-122">Zabalí tuto třídu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okno, díky kterému jej začlenit do vaší [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] jako podřízeného okna.</span><span class="sxs-lookup"><span data-stu-id="14c55-122">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window, allowing it to be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="14c55-123">Následující metoda kombinuje [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] v jedné aplikaci.</span><span class="sxs-lookup"><span data-stu-id="14c55-123">The following approach combines the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>  
  
1.  <span data-ttu-id="14c55-124">Implementace vaší [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah jako spravovanou třídou.</span><span class="sxs-lookup"><span data-stu-id="14c55-124">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a managed class.</span></span>  
  
2.  <span data-ttu-id="14c55-125">Implementace [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikace s [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="14c55-125">Implement a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application with [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="14c55-126">Pokud jste od verze existující aplikaci a nespravované [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] kódu, můžete obvykle ho povolit volání spravovaného kódu změnou nastavení projektu zahrnout `/clr` příznak kompilátoru.</span><span class="sxs-lookup"><span data-stu-id="14c55-126">If you are starting with an existing application and unmanaged [!INCLUDE[TLA#tla_cpp](../../../../includes/tlasharptla-cpp-md.md)] code, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag.</span></span>  
  
3.  <span data-ttu-id="14c55-127">Nastavte model vláken single-threaded apartment (STA).</span><span class="sxs-lookup"><span data-stu-id="14c55-127">Set the threading model to single-threaded apartment (STA).</span></span>  
  
4.  <span data-ttu-id="14c55-128">Zpracování [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx)oznámení v postupu okno a proveďte následující akce:</span><span class="sxs-lookup"><span data-stu-id="14c55-128">Handle the [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx)notification in your window procedure and do the following:</span></span>  
  
    1.  <span data-ttu-id="14c55-129">Vytvořte novou <xref:System.Windows.Interop.HwndSource> objekt s nadřazeného okna jako jeho `parent` parametr.</span><span class="sxs-lookup"><span data-stu-id="14c55-129">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window as its `parent` parameter.</span></span>  
  
    2.  <span data-ttu-id="14c55-130">Vytvoření instance vaší [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu třídy.</span><span class="sxs-lookup"><span data-stu-id="14c55-130">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>  
  
    3.  <span data-ttu-id="14c55-131">Přiřaďte odkaz na [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu objekt, který má <xref:System.Windows.Interop.HwndSource.RootVisual%2A> vlastnost <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="14c55-131">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
    4.  <span data-ttu-id="14c55-132">Získáte HWND pro obsah.</span><span class="sxs-lookup"><span data-stu-id="14c55-132">Get the HWND for the content.</span></span> <span data-ttu-id="14c55-133"><xref:System.Windows.Interop.HwndSource.Handle%2A> Vlastnost <xref:System.Windows.Interop.HwndSource> objekt obsahuje popisovač okna (HWND).</span><span class="sxs-lookup"><span data-stu-id="14c55-133">The <xref:System.Windows.Interop.HwndSource.Handle%2A> property of the <xref:System.Windows.Interop.HwndSource> object contains the window handle (HWND).</span></span> <span data-ttu-id="14c55-134">Pokud chcete popisovačem HWND, který můžete použít v nespravované součástí aplikace, přetypujte `Handle.ToPointer()` k popisovačem HWND.</span><span class="sxs-lookup"><span data-stu-id="14c55-134">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>  
  
5.  <span data-ttu-id="14c55-135">Implementace spravovaných třídu, která obsahuje statické pole pro uložení odkaz na vaši [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="14c55-135">Implement a managed class that contains a static field to hold a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="14c55-136">Tato třída umožňuje získat odkaz na [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu z vašeho [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kódu.</span><span class="sxs-lookup"><span data-stu-id="14c55-136">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code.</span></span>  
  
6.  <span data-ttu-id="14c55-137">Přiřazení [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu do statického pole.</span><span class="sxs-lookup"><span data-stu-id="14c55-137">Assign the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the static field.</span></span>  
  
7.  <span data-ttu-id="14c55-138">Příjem oznámení z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu připojením obslužné rutiny na jeden nebo více [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] události.</span><span class="sxs-lookup"><span data-stu-id="14c55-138">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events.</span></span>  
  
8.  <span data-ttu-id="14c55-139">Komunikovat s [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu pomocí odkazu, který je uložený v statické pole a nastavte vlastnosti a tak dále.</span><span class="sxs-lookup"><span data-stu-id="14c55-139">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content by using the reference that you stored in the static field to set properties, and so on.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="14c55-140">Můžete také použít [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] implementovat vaše [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="14c55-140">You can also use [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] to implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="14c55-141">Ale je nutné jej zkompilovat samostatně jako [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] a odkaz, který [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] z vaší [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikace.</span><span class="sxs-lookup"><span data-stu-id="14c55-141">However, you will have to compile it separately as a [!INCLUDE[TLA#tla_dll](../../../../includes/tlasharptla-dll-md.md)] and reference that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="14c55-142">Zbytek postupu je podobná uvedených výše.</span><span class="sxs-lookup"><span data-stu-id="14c55-142">The remainder of the procedure is similar to that outlined above.</span></span>  
  
<a name="implementing_the_application"></a>   
## <a name="implementing-the-host-application"></a><span data-ttu-id="14c55-143">Implementace aplikace pro hostitele</span><span class="sxs-lookup"><span data-stu-id="14c55-143">Implementing the Host Application</span></span>  
 <span data-ttu-id="14c55-144">Tato část popisuje, jak hostitele [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu v základní [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikace.</span><span class="sxs-lookup"><span data-stu-id="14c55-144">This section describes how to host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application.</span></span> <span data-ttu-id="14c55-145">Samotný obsah je implementována ve [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] jako spravovanou třídou.</span><span class="sxs-lookup"><span data-stu-id="14c55-145">The content itself is implemented in [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] as a managed class.</span></span> <span data-ttu-id="14c55-146">Ve většině případů je jednoduchá [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programování.</span><span class="sxs-lookup"><span data-stu-id="14c55-146">For the most part, it is straightforward [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] programming.</span></span> <span data-ttu-id="14c55-147">Klíčových aspektů obsahu implementace, které jsou popsané v [implementace obsahu WPF](#implementing_the_wpf_page).</span><span class="sxs-lookup"><span data-stu-id="14c55-147">The key aspects of the content implementation are discussed in [Implementing the WPF Content](#implementing_the_wpf_page).</span></span>  
  
<a name="autoNestedSectionsOUTLINE1"></a>   
-   [<span data-ttu-id="14c55-148">Základní aplikační</span><span class="sxs-lookup"><span data-stu-id="14c55-148">The Basic Application</span></span>](#the_basic_application)  
  
-   [<span data-ttu-id="14c55-149">Hostování obsahu subsystému WPF</span><span class="sxs-lookup"><span data-stu-id="14c55-149">Hosting the WPF Content</span></span>](#hosting_the_wpf_page)  
  
-   [<span data-ttu-id="14c55-150">Podržíte odkaz na obsah WPF</span><span class="sxs-lookup"><span data-stu-id="14c55-150">Holding a Reference to the WPF Content</span></span>](#holding_a_reference)  
  
-   [<span data-ttu-id="14c55-151">Komunikuje s obsahu WPF</span><span class="sxs-lookup"><span data-stu-id="14c55-151">Communicating with the WPF Content</span></span>](#communicating_with_the_page)  
  
<a name="the_basic_application"></a>   
### <a name="the-basic-application"></a><span data-ttu-id="14c55-152">Základní aplikační</span><span class="sxs-lookup"><span data-stu-id="14c55-152">The Basic Application</span></span>  
 <span data-ttu-id="14c55-153">Výchozím bodem pro hostitelskou aplikaci byl k vytvoření [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)] šablony.</span><span class="sxs-lookup"><span data-stu-id="14c55-153">The starting point for the host application was to create a [!INCLUDE[TLA#tla_visualstu2005](../../../../includes/tlasharptla-visualstu2005-md.md)] template.</span></span>  
  
1.  <span data-ttu-id="14c55-154">Otevřete [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)]a vyberte **nový projekt** z **souboru** nabídky.</span><span class="sxs-lookup"><span data-stu-id="14c55-154">Open [!INCLUDE[TLA2#tla_visualstu2005](../../../../includes/tla2sharptla-visualstu2005-md.md)], and select **New Project** from the **File** menu.</span></span>  
  
2.  <span data-ttu-id="14c55-155">Vyberte **Win32** ze seznamu [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] typy projektů.</span><span class="sxs-lookup"><span data-stu-id="14c55-155">Select **Win32** from the list of [!INCLUDE[TLA2#tla_visualcpp](../../../../includes/tla2sharptla-visualcpp-md.md)] project types.</span></span> <span data-ttu-id="14c55-156">Pokud není výchozí jazyk [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], zjistíte, tyto typy projektů v části **jiné jazyky**.</span><span class="sxs-lookup"><span data-stu-id="14c55-156">If your default language is not [!INCLUDE[TLA2#tla_cpp](../../../../includes/tla2sharptla-cpp-md.md)], you will find these project types under **Other Languages**.</span></span>  
  
3.  <span data-ttu-id="14c55-157">Vyberte **projektu Win32** šablony, přiřadit název projektu a klikněte na tlačítko **OK** ke spuštění **Win32 – Průvodce aplikací**.</span><span class="sxs-lookup"><span data-stu-id="14c55-157">Select a **Win32 Project** template, assign a name to the project and click **OK** to launch the **Win32 Application Wizard**.</span></span>  
  
4.  <span data-ttu-id="14c55-158">Přijměte výchozí nastavení v průvodci a klikněte na **Dokončit** a spusťte projekt.</span><span class="sxs-lookup"><span data-stu-id="14c55-158">Accept the wizard's default settings and click **Finish** to start the project.</span></span>  
  
 <span data-ttu-id="14c55-159">Šablona vytvoří základní [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikace, včetně:</span><span class="sxs-lookup"><span data-stu-id="14c55-159">The template creates a basic [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] application, including:</span></span>  
  
-   <span data-ttu-id="14c55-160">Vstupní bod pro aplikaci.</span><span class="sxs-lookup"><span data-stu-id="14c55-160">An entry point for the application.</span></span>  
  
-   <span data-ttu-id="14c55-161">Okno, pomocí procedury okna přidružené (WndProc –).</span><span class="sxs-lookup"><span data-stu-id="14c55-161">A window, with an associated window procedure (WndProc).</span></span>  
  
-   <span data-ttu-id="14c55-162">Nabídku s **soubor** a **pomoci** záhlaví.</span><span class="sxs-lookup"><span data-stu-id="14c55-162">A menu with **File** and **Help** headings.</span></span> <span data-ttu-id="14c55-163">**Soubor** má nabídky **ukončení** položku, která ukončí aplikaci.</span><span class="sxs-lookup"><span data-stu-id="14c55-163">The **File** menu has an **Exit** item that closes the application.</span></span> <span data-ttu-id="14c55-164">**Pomoci** má nabídky **o** položku, která spustí jednoduché dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="14c55-164">The **Help** menu has an **About** item that launches a simple dialog box.</span></span>  
  
 <span data-ttu-id="14c55-165">Než začnete psát kód pro hostitele [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu, budete muset udělat dvě úpravy základní šablony.</span><span class="sxs-lookup"><span data-stu-id="14c55-165">Before you start writing code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, you need to make two modifications to the basic template.</span></span>  
  
 <span data-ttu-id="14c55-166">První je kompilace projektu jako spravovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="14c55-166">The first is to compile the project as managed code.</span></span> <span data-ttu-id="14c55-167">Ve výchozím projektu zkompiluje jako nespravovaný kód.</span><span class="sxs-lookup"><span data-stu-id="14c55-167">By default, the project compiles as unmanaged code.</span></span> <span data-ttu-id="14c55-168">Ale protože [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] je implementována ve spravovaném kódu, musí být projektu zkompilovány odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="14c55-168">However, because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is implemented in managed code, the project must be compiled accordingly.</span></span>  
  
1.  <span data-ttu-id="14c55-169">Klikněte pravým tlačítkem myši na název projektu v **Průzkumníku řešení** a vyberte **vlastnosti** z místní nabídky ke spuštění **stránky vlastností** dialogové okno.</span><span class="sxs-lookup"><span data-stu-id="14c55-169">Right-click the project name in **Solution Explorer** and select **Properties** from the context menu to launch the **Property Pages** dialog box.</span></span>  
  
2.  <span data-ttu-id="14c55-170">Vyberte **vlastnosti konfigurace** z stromové zobrazení v levém podokně.</span><span class="sxs-lookup"><span data-stu-id="14c55-170">Select **Configuration Properties** from the tree view in the left pane.</span></span>  
  
3.  <span data-ttu-id="14c55-171">Vyberte **modul Common Language Runtime** podporují z **výchozí projekt** seznamu v pravém podokně.</span><span class="sxs-lookup"><span data-stu-id="14c55-171">Select **Common Language Runtime** support from the **Project Defaults** list in the right pane.</span></span>  
  
4.  <span data-ttu-id="14c55-172">Vyberte **Common Language Runtime Support (/ clr)** z rozevíracího seznamu.</span><span class="sxs-lookup"><span data-stu-id="14c55-172">Select **Common Language Runtime Support (/clr)** from the drop-down list box.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="14c55-173">Tento příznak kompilátoru umožňuje používat spravovaného kódu v aplikaci, ale nespravovaného kódu stále zkompilovat jako předtím.</span><span class="sxs-lookup"><span data-stu-id="14c55-173">This compiler flag allows you to use managed code in your application, but your unmanaged code will still compile as before.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="14c55-174"> používá jednovláknový (STA) model vláken typu apartment.</span><span class="sxs-lookup"><span data-stu-id="14c55-174"> uses the single-threaded apartment (STA) threading model.</span></span> <span data-ttu-id="14c55-175">Aby bylo možné správně pracovat [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu kód, je nutné nastavit model vláken aplikace na STA použitím atribut vstupní bod.</span><span class="sxs-lookup"><span data-stu-id="14c55-175">In order to work properly with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content code, you must set the application's threading model to STA by applying an attribute to the entry point.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WinMain](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#winmain)]  
  
<a name="hosting_the_wpf_page"></a>   
### <a name="hosting-the-wpf-content"></a><span data-ttu-id="14c55-176">Hostování obsahu subsystému WPF</span><span class="sxs-lookup"><span data-stu-id="14c55-176">Hosting the WPF Content</span></span>  
 <span data-ttu-id="14c55-177">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Obsah je jednoduché adresy vstupní aplikace.</span><span class="sxs-lookup"><span data-stu-id="14c55-177">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is a simple address entry application.</span></span> <span data-ttu-id="14c55-178">Se skládá z několika <xref:System.Windows.Controls.TextBox> ovládací prvky uživatelské jméno, adresu a tak dále.</span><span class="sxs-lookup"><span data-stu-id="14c55-178">It consists of several <xref:System.Windows.Controls.TextBox> controls to take user name, address, and so on.</span></span> <span data-ttu-id="14c55-179">Jsou zde také dva <xref:System.Windows.Controls.Button> ovládací prvky, **OK** a **zrušit**.</span><span class="sxs-lookup"><span data-stu-id="14c55-179">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**.</span></span> <span data-ttu-id="14c55-180">Když uživatel klikne na **OK**, na tlačítko <xref:System.Windows.Controls.Primitives.ButtonBase.Click> obslužné rutiny události shromažďuje data z <xref:System.Windows.Controls.TextBox> ovládací prvky, přiřadí ji k odpovídající vlastnosti a vyvolá vlastní události `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="14c55-180">When the user clicks **OK**, the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler collects the data from the <xref:System.Windows.Controls.TextBox> controls, assigns it to corresponding properties, and raises a custom event, `OnButtonClicked`.</span></span> <span data-ttu-id="14c55-181">Když uživatel klikne na **zrušit**, jednoduše vyvolá obslužnou rutinu `OnButtonClicked`.</span><span class="sxs-lookup"><span data-stu-id="14c55-181">When the user clicks **Cancel**, the handler simply raises `OnButtonClicked`.</span></span> <span data-ttu-id="14c55-182">Objekt argument události pro `OnButtonClicked` obsahuje logické pole, která určuje, které tlačítko bylo kliknuto.</span><span class="sxs-lookup"><span data-stu-id="14c55-182">The event argument object for `OnButtonClicked` contains a Boolean field that indicates which button was clicked.</span></span>  
  
 <span data-ttu-id="14c55-183">Kód pro hostitele [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah je implementována ve obslužnou rutinu pro [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx) oznámení v okně hostitele.</span><span class="sxs-lookup"><span data-stu-id="14c55-183">The code to host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in a handler for the [WM_CREATE](http://msdn.microsoft.com/library/ms632619.aspx) notification on the host window.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCreate](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcreate)]  
  
 <span data-ttu-id="14c55-184">`GetHwnd` Metoda přijímá informace o velikosti a pozice plus nadřazený popisovač okna a vrátí popisovač okna hostované [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="14c55-184">The `GetHwnd` method takes size and position information plus the parent window handle and returns the window handle of the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="14c55-185">Nelze použít `#using` direktivy pro `System::Windows::Interop` oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="14c55-185">You cannot use a `#using` directive for the `System::Windows::Interop` namespace.</span></span> <span data-ttu-id="14c55-186">Kolize názvů mezi vytvoříte tak <xref:System.Windows.Interop.MSG> struktury v daném oboru názvů a struktura MSG deklarované v winuser.</span><span class="sxs-lookup"><span data-stu-id="14c55-186">Doing so creates a name collision between the <xref:System.Windows.Interop.MSG> structure in that namespace and the MSG structure declared in winuser.h.</span></span> <span data-ttu-id="14c55-187">Místo toho musíte použít názvy úplný přístup k obsahu daného oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="14c55-187">You must instead use fully-qualified names to access the contents of that namespace.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#GetHwnd](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#gethwnd)]  
  
 <span data-ttu-id="14c55-188">Nelze hostovat [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu přímo v okně vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="14c55-188">You cannot host the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content directly in your application window.</span></span> <span data-ttu-id="14c55-189">Místo toho je nejprve vytvořit <xref:System.Windows.Interop.HwndSource> objekt zabalit [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="14c55-189">Instead, you first create an <xref:System.Windows.Interop.HwndSource> object to wrap the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="14c55-190">Tento objekt je v podstatě okno, které slouží k hostování [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="14c55-190">This object is basically a window that is designed to host a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="14c55-191">Hostujete <xref:System.Windows.Interop.HwndSource> objektu v okně nadřazené vytvořením jako podřízenou [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] okna, které je součástí vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="14c55-191">You host the <xref:System.Windows.Interop.HwndSource> object in the parent window by creating it as a child of a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] window that is part of your application.</span></span> <span data-ttu-id="14c55-192"><xref:System.Windows.Interop.HwndSource> Konstruktor parametry obsahovat mnohem stejné informace, které by předat CreateWindow při vytváření [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] podřízeného okna.</span><span class="sxs-lookup"><span data-stu-id="14c55-192">The <xref:System.Windows.Interop.HwndSource> constructor parameters contain much the same information that you would pass to CreateWindow when you create a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] child window.</span></span>  
  
 <span data-ttu-id="14c55-193">Vytvoříte další instanci [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] objekt obsahu.</span><span class="sxs-lookup"><span data-stu-id="14c55-193">You next create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="14c55-194">V takovém případě [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah je implementovaný jako samostatné třídy, `WPFPage`pomocí [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span><span class="sxs-lookup"><span data-stu-id="14c55-194">In this case, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented as a separate class, `WPFPage`, using [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)].</span></span> <span data-ttu-id="14c55-195">Může také implementovat [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu s [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="14c55-195">You could also implement the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content with [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="14c55-196">Ale k tomu budete muset nastavit samostatného projektu a sestavení [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah jako [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span><span class="sxs-lookup"><span data-stu-id="14c55-196">However, to do so you need to set up a separate project and build the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content as a [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)].</span></span> <span data-ttu-id="14c55-197">Můžete přidat odkaz na daný [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] k projektu a které odkaz na vytvoření instance [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="14c55-197">You can add a reference to that [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)] to your project, and use that reference to create an instance of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
 <span data-ttu-id="14c55-198">Můžete zobrazit [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu v okně podřízené přiřazením odkaz na [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah <xref:System.Windows.Interop.HwndSource.RootVisual%2A> vlastnost <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="14c55-198">You display the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in your child window by assigning a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to the <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property of the <xref:System.Windows.Interop.HwndSource>.</span></span>  
  
 <span data-ttu-id="14c55-199">Dalším řádku kódu připojí obslužnou rutinu události `WPFButtonClicked`do [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah `OnButtonClicked` událostí.</span><span class="sxs-lookup"><span data-stu-id="14c55-199">The next line of code attaches an event handler, `WPFButtonClicked`, to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content `OnButtonClicked` event.</span></span> <span data-ttu-id="14c55-200">Tato obslužná rutina je volána, když uživatel klikne **OK** nebo **zrušit** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="14c55-200">This handler is called when the user clicks the **OK** or **Cancel** button.</span></span> <span data-ttu-id="14c55-201">V tématu [communicating_with_the_WPF obsah](#communicating_with_the_page) Další informace o této obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="14c55-201">See [communicating_with_the_WPF content](#communicating_with_the_page) for further discussion of this event handler.</span></span>  
  
 <span data-ttu-id="14c55-202">Vrátí popisovač okna (HWND), který je spojen s poslední řádek kódu ukazuje <xref:System.Windows.Interop.HwndSource> objektu.</span><span class="sxs-lookup"><span data-stu-id="14c55-202">The final line of code shown returns the window handle (HWND) that is associated with the <xref:System.Windows.Interop.HwndSource> object.</span></span> <span data-ttu-id="14c55-203">Můžete použít tento popisovač z vaší [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] kódu pro odeslání zprávy do okna hostované, i když vzorku tak neprovádí.</span><span class="sxs-lookup"><span data-stu-id="14c55-203">You can use this handle from your [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] code to send messages to the hosted window, although the sample does not do so.</span></span> <span data-ttu-id="14c55-204"><xref:System.Windows.Interop.HwndSource> Objekt vyvolá událost pokaždé, když obdrží zprávu.</span><span class="sxs-lookup"><span data-stu-id="14c55-204">The <xref:System.Windows.Interop.HwndSource> object raises an event every time it receives a message.</span></span> <span data-ttu-id="14c55-205">Ke zpracování zpráv, volání <xref:System.Windows.Interop.HwndSource.AddHook%2A> metoda připojení obslužné rutiny zpráv a potom zpracování zpráv v této obslužné rutiny.</span><span class="sxs-lookup"><span data-stu-id="14c55-205">To process the messages, call the <xref:System.Windows.Interop.HwndSource.AddHook%2A> method to attach a message handler and then process the messages in that handler.</span></span>  
  
<a name="holding_a_reference"></a>   
### <a name="holding-a-reference-to-the-wpf-content"></a><span data-ttu-id="14c55-206">Podržíte odkaz na obsah WPF</span><span class="sxs-lookup"><span data-stu-id="14c55-206">Holding a Reference to the WPF Content</span></span>  
 <span data-ttu-id="14c55-207">Pro mnoho aplikací, můžete ke komunikaci s [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu později.</span><span class="sxs-lookup"><span data-stu-id="14c55-207">For many applications, you will want to communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content later.</span></span> <span data-ttu-id="14c55-208">Například můžete chtít změnit [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu vlastnosti, nebo třeba mít <xref:System.Windows.Interop.HwndSource> objekt hostitele jiný [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="14c55-208">For example, you might want to modify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, or perhaps have the <xref:System.Windows.Interop.HwndSource> object host different [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="14c55-209">K tomu potřebujete odkaz na <xref:System.Windows.Interop.HwndSource> objekt nebo [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="14c55-209">To do this, you need a reference to the <xref:System.Windows.Interop.HwndSource> object or the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="14c55-210"><xref:System.Windows.Interop.HwndSource> Objekt a jeho přidružený [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah zůstat v paměti, dokud destroy popisovač okna.</span><span class="sxs-lookup"><span data-stu-id="14c55-210">The <xref:System.Windows.Interop.HwndSource> object and its associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content remain in memory until you destroy the window handle.</span></span> <span data-ttu-id="14c55-211">Ale proměnné můžete přiřadit <xref:System.Windows.Interop.HwndSource> objektu se dostala mimo rozsah při návratu z procedury okna.</span><span class="sxs-lookup"><span data-stu-id="14c55-211">However, the variable you assign to the <xref:System.Windows.Interop.HwndSource> object will go out of scope as soon as you return from the window procedure.</span></span> <span data-ttu-id="14c55-212">Obvyklým způsobem, jak zpracovávat tento problém s [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] aplikace je použití statické nebo globální proměnné.</span><span class="sxs-lookup"><span data-stu-id="14c55-212">The customary way to handle this issue with [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications is to use a static or global variable.</span></span> <span data-ttu-id="14c55-213">Bohužel nelze přiřadit spravovaného objektu na tyto typy proměnných.</span><span class="sxs-lookup"><span data-stu-id="14c55-213">Unfortunately, you cannot assign a managed object to those types of variables.</span></span> <span data-ttu-id="14c55-214">Můžete přiřadit popisovač okna přidružené <xref:System.Windows.Interop.HwndSource> objektu globální nebo statické proměnné, ale, že doe neposkytuje přístup odkaz sám na sebe.</span><span class="sxs-lookup"><span data-stu-id="14c55-214">You can assign the window handle associated with <xref:System.Windows.Interop.HwndSource> object to a global or static variable, but that doe not provide access to the object itself.</span></span>  
  
 <span data-ttu-id="14c55-215">Nejjednodušší řešení tohoto problému je implementace spravovaných třídu, která obsahuje sadu statických polí k udržení odkazů na spravované objekty, které potřebují přístup k.</span><span class="sxs-lookup"><span data-stu-id="14c55-215">The simplest solution to this issue is to implement a managed class that contains a set of static fields to hold references to any managed objects that you need access to.</span></span> <span data-ttu-id="14c55-216">Ukázce se používá `WPFPageHost` třída pro uložení odkaz na [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah plus počáteční hodnoty počtu jeho vlastnosti, které může uživatel později změnit.</span><span class="sxs-lookup"><span data-stu-id="14c55-216">The sample uses the `WPFPageHost` class to hold a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, plus the initial values of a number of its properties that might be changed later by the user.</span></span> <span data-ttu-id="14c55-217">To je definováno v hlavičce.</span><span class="sxs-lookup"><span data-stu-id="14c55-217">This is defined in the header.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageHost](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.h#wpfpagehost)]  
  
 <span data-ttu-id="14c55-218">Druhé části `GetHwnd` funkce přiřazuje hodnoty těchto polí pro pozdější použití při `myPage` je stále v oboru.</span><span class="sxs-lookup"><span data-stu-id="14c55-218">The latter part of the `GetHwnd` function assigns values to those fields for later use while `myPage` is still in scope.</span></span>  
  
<a name="communicating_with_the_page"></a>   
### <a name="communicating-with-the-wpf-content"></a><span data-ttu-id="14c55-219">Komunikuje s obsahu WPF</span><span class="sxs-lookup"><span data-stu-id="14c55-219">Communicating with the WPF Content</span></span>  
 <span data-ttu-id="14c55-220">Existují dva typy komunikace s [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="14c55-220">There are two types of communication with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="14c55-221">Aplikace obdrží informace z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu, když uživatel klikne **OK** nebo **zrušit** tlačítka.</span><span class="sxs-lookup"><span data-stu-id="14c55-221">The application receives information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content when the user clicks the **OK** or **Cancel** buttons.</span></span> <span data-ttu-id="14c55-222">Aplikace má také [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , který umožňuje uživatelům změnit různé [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu vlastnosti, jako je například velikost písma barvu nebo výchozí pozadí.</span><span class="sxs-lookup"><span data-stu-id="14c55-222">The application also has a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that allows the user to change various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties, such as the background color or default font size.</span></span>  
  
 <span data-ttu-id="14c55-223">Jak je uvedeno nahoře, když uživatel klikne buď tlačítko [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu vyvolá `OnButtonClicked` událostí.</span><span class="sxs-lookup"><span data-stu-id="14c55-223">As mentioned above, when the user clicks either button the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content raises an `OnButtonClicked` event.</span></span> <span data-ttu-id="14c55-224">Aplikace připojí k této události pro příjem těchto oznámení obslužnou rutinu.</span><span class="sxs-lookup"><span data-stu-id="14c55-224">The application attaches a handler to this event to receive these notifications.</span></span> <span data-ttu-id="14c55-225">Pokud **OK** bylo stisknuto tlačítko, obslužná rutina získá informace o uživateli z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu a zobrazí se v sadě statické ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="14c55-225">If the **OK** button was clicked, the handler gets the user information from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content and displays it in a set of static controls.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wpfbuttonclicked)]  
  
 <span data-ttu-id="14c55-226">Obslužná rutina přijímá objekt argument vlastní události z [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu, `MyPageEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="14c55-226">The handler receives a custom event argument object from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, `MyPageEventArgs`.</span></span> <span data-ttu-id="14c55-227">Objektu `IsOK` je nastavena na `true` Pokud **OK** bylo stisknuto tlačítko, a `false` Pokud **zrušit** bylo stisknuto tlačítko.</span><span class="sxs-lookup"><span data-stu-id="14c55-227">The object's `IsOK` property is set to `true` if the **OK** button was clicked, and `false` if the **Cancel** button was clicked.</span></span>  
  
 <span data-ttu-id="14c55-228">Pokud **OK** bylo stisknuto tlačítko, obslužná rutina získá odkaz na [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu ze třídy kontejneru.</span><span class="sxs-lookup"><span data-stu-id="14c55-228">If the **OK** button was clicked, the handler gets a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content from the container class.</span></span> <span data-ttu-id="14c55-229">Pak shromáždí informace o uživateli, která se nachází přiřazeným [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu vlastnosti a používá statické ovládací prvky pro zobrazení informací v nadřazeném okně.</span><span class="sxs-lookup"><span data-stu-id="14c55-229">It then collects the user information that is held by the associated [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties and uses the static controls to display the information on the parent window.</span></span> <span data-ttu-id="14c55-230">Protože [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu data jsou ve formě řetězce, má být zařazena pro použití [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="14c55-230">Because the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content data is in the form of a managed string, it has to be marshaled for use by a [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] control.</span></span> <span data-ttu-id="14c55-231">Pokud **zrušit** bylo stisknuto tlačítko, obslužná rutina vymaže data z statické ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="14c55-231">If the **Cancel** button was clicked, the handler clears the data from the static controls.</span></span>  
  
 <span data-ttu-id="14c55-232">Aplikace [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] poskytuje sadu přepínačů, který umožní uživatelům změnit barvu pozadí [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah a několik vlastností souvisejících s písma.</span><span class="sxs-lookup"><span data-stu-id="14c55-232">The application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] provides a set of radio buttons that allow the user to modify the background color of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and several font-related properties.</span></span> <span data-ttu-id="14c55-233">Následující příklad je výňatek z procedury okna aplikace (WndProc) a jeho zpracování, který zpráv na jiné zprávy, včetně barvu pozadí nastaví různé vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="14c55-233">The following example is an excerpt from the application's window procedure (WndProc) and its message handling that sets various properties on different messages, including the background color.</span></span> <span data-ttu-id="14c55-234">Ostatní jsou podobné a nejsou zobrazeny.</span><span class="sxs-lookup"><span data-stu-id="14c55-234">The others are similar, and are not shown.</span></span> <span data-ttu-id="14c55-235">Najdete je kompletní ukázka podrobnosti a kontext.</span><span class="sxs-lookup"><span data-stu-id="14c55-235">See the complete sample for details and context.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WMCommandToBG](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/Win32HostingWPFPage.cpp#wmcommandtobg)]  
  
 <span data-ttu-id="14c55-236">Pokud chcete nastavit barvu pozadí, získat odkaz na [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah (`hostedPage`) z `WPFPageHost` a nastavte vlastnost Barva pozadí na požadovanou barvu.</span><span class="sxs-lookup"><span data-stu-id="14c55-236">To set the background color, get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (`hostedPage`) from `WPFPageHost` and set the background color property to the appropriate color.</span></span> <span data-ttu-id="14c55-237">Ukázka používá tři možnosti barev: původní barvu, světle zelená nebo světla losos.</span><span class="sxs-lookup"><span data-stu-id="14c55-237">The sample uses three color options: the original color, light green, or light salmon.</span></span> <span data-ttu-id="14c55-238">Původní barva pozadí se ukládají jako statické pole v `WPFPageHost` třídy.</span><span class="sxs-lookup"><span data-stu-id="14c55-238">The original background color is stored as a static field in the `WPFPageHost` class.</span></span> <span data-ttu-id="14c55-239">Pro nastavení dalších dvou, vytvořte novou <xref:System.Windows.Media.SolidColorBrush> objektu a předat hodnotu statických barvy z konstruktoru <xref:System.Windows.Media.Colors> objektu.</span><span class="sxs-lookup"><span data-stu-id="14c55-239">To set the other two, you create a new <xref:System.Windows.Media.SolidColorBrush> object and pass the constructor a static colors value from the <xref:System.Windows.Media.Colors> object.</span></span>  
  
<a name="implementing_the_wpf_page"></a>   
## <a name="implementing-the-wpf-page"></a><span data-ttu-id="14c55-240">Implementace stránce WPF</span><span class="sxs-lookup"><span data-stu-id="14c55-240">Implementing the WPF Page</span></span>  
 <span data-ttu-id="14c55-241">Můžete hostovat a používat [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu bez znalostí skutečné implementace.</span><span class="sxs-lookup"><span data-stu-id="14c55-241">You can host and use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content without any knowledge of the actual implementation.</span></span> <span data-ttu-id="14c55-242">Pokud [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu byl vytvořen balíček v samostatném [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], se může jsou součástí žádné [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] jazyk.</span><span class="sxs-lookup"><span data-stu-id="14c55-242">If the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content had been packaged in a separate [!INCLUDE[TLA2#tla_dll](../../../../includes/tla2sharptla-dll-md.md)], it could have been built in any [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)] language.</span></span> <span data-ttu-id="14c55-243">Následuje stručný návod [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementace, která se používá v ukázce.</span><span class="sxs-lookup"><span data-stu-id="14c55-243">Following is a brief walkthrough of the [!INCLUDE[TLA#tla_cppcli](../../../../includes/tlasharptla-cppcli-md.md)] implementation that is used in the sample.</span></span> <span data-ttu-id="14c55-244">Tato část obsahuje následující témata.</span><span class="sxs-lookup"><span data-stu-id="14c55-244">This section contains the following subsections.</span></span>  
  
<a name="autoNestedSectionsOUTLINE2"></a>   
-   [<span data-ttu-id="14c55-245">Rozložení</span><span class="sxs-lookup"><span data-stu-id="14c55-245">Layout</span></span>](#page_layout)  
  
-   [<span data-ttu-id="14c55-246">Vrací Data do okna hostitele</span><span class="sxs-lookup"><span data-stu-id="14c55-246">Returning the Data to the Host Window</span></span>](#returning_data_to_window)  
  
-   [<span data-ttu-id="14c55-247">Nastavení vlastností WPF</span><span class="sxs-lookup"><span data-stu-id="14c55-247">Setting the WPF Properties</span></span>](#set_page_properties)  
  
<a name="page_layout"></a>   
### <a name="layout"></a><span data-ttu-id="14c55-248">Rozložení</span><span class="sxs-lookup"><span data-stu-id="14c55-248">Layout</span></span>  
 <span data-ttu-id="14c55-249">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Elementů v [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu se skládá z pěti <xref:System.Windows.Controls.TextBox> řídí, k přiřazen <xref:System.Windows.Controls.Label> ovládacích prvků: jméno, adresu, Město, stavu a Zip.</span><span class="sxs-lookup"><span data-stu-id="14c55-249">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content consist of five <xref:System.Windows.Controls.TextBox> controls, with associated <xref:System.Windows.Controls.Label> controls: Name, Address, City, State, and Zip.</span></span> <span data-ttu-id="14c55-250">Jsou zde také dva <xref:System.Windows.Controls.Button> ovládací prvky, **OK** a **zrušit**</span><span class="sxs-lookup"><span data-stu-id="14c55-250">There are also two <xref:System.Windows.Controls.Button> controls, **OK** and **Cancel**</span></span>  
  
 <span data-ttu-id="14c55-251">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Obsah je implementována ve `WPFPage` třídy.</span><span class="sxs-lookup"><span data-stu-id="14c55-251">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is implemented in the `WPFPage` class.</span></span> <span data-ttu-id="14c55-252">Rozložení je zpracována s <xref:System.Windows.Controls.Grid> element rozložení.</span><span class="sxs-lookup"><span data-stu-id="14c55-252">Layout is handled with a <xref:System.Windows.Controls.Grid> layout element.</span></span> <span data-ttu-id="14c55-253">Třídy dědí z <xref:System.Windows.Controls.Grid>, takže efektivní [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu kořenový element.</span><span class="sxs-lookup"><span data-stu-id="14c55-253">The class inherits from <xref:System.Windows.Controls.Grid>, which effectively makes it the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content root element.</span></span>  
  
 <span data-ttu-id="14c55-254">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Obsahu konstruktor přijímá požadované šířku a výšku a velikosti <xref:System.Windows.Controls.Grid> odpovídajícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="14c55-254">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content constructor takes the required width and height, and sizes the <xref:System.Windows.Controls.Grid> accordingly.</span></span> <span data-ttu-id="14c55-255">Pak definuje základní rozložení tak, že vytvoříte sadu <xref:System.Windows.Controls.ColumnDefinition> a <xref:System.Windows.Controls.RowDefinition> objekty a jejich přidání <xref:System.Windows.Controls.Grid> základní objekt <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> a <xref:System.Windows.Controls.Grid.RowDefinitions%2A> kolekcí, v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="14c55-255">It then defines the basic layout by creating a set of <xref:System.Windows.Controls.ColumnDefinition> and <xref:System.Windows.Controls.RowDefinition> objects and adding them to the <xref:System.Windows.Controls.Grid> object base <xref:System.Windows.Controls.Grid.ColumnDefinitions%2A> and <xref:System.Windows.Controls.Grid.RowDefinitions%2A> collections, respectively.</span></span> <span data-ttu-id="14c55-256">Definuje mřížku pět řádků a sloupců sedm s dimenzemi dáno obsah buněk.</span><span class="sxs-lookup"><span data-stu-id="14c55-256">This defines a grid of five rows and seven columns, with the dimensions determined by the contents of the cells.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorToGridDef](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortogriddef)]  
  
 <span data-ttu-id="14c55-257">V dalším kroku konstruktoru přidá [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elementů <xref:System.Windows.Controls.Grid>.</span><span class="sxs-lookup"><span data-stu-id="14c55-257">Next, the constructor adds the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] elements to the <xref:System.Windows.Controls.Grid>.</span></span> <span data-ttu-id="14c55-258">První prvek je text nadpisu, který je <xref:System.Windows.Controls.Label> ovládací prvek, který je umístěn na střed v prvním řádku mřížky.</span><span class="sxs-lookup"><span data-stu-id="14c55-258">The first element is the title text, which is a <xref:System.Windows.Controls.Label> control that is centered in the first row of the grid.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorTitle](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectortitle)]  
  
 <span data-ttu-id="14c55-259">Na další řádek obsahuje název <xref:System.Windows.Controls.Label> ovládací prvek a jeho přidružených <xref:System.Windows.Controls.TextBox> ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="14c55-259">The next row contains the Name <xref:System.Windows.Controls.Label> control and its associated <xref:System.Windows.Controls.TextBox> control.</span></span> <span data-ttu-id="14c55-260">Protože má stejný kód se používá pro každý pár popisek nebo textové pole, je umístěn v pár soukromých metod a použít pro všechny pět párů popisek nebo textové pole.</span><span class="sxs-lookup"><span data-stu-id="14c55-260">Because the same code is used for each label/textbox pair, it is placed in a pair of private methods and used for all five label/textbox pairs.</span></span> <span data-ttu-id="14c55-261">Vytvořit odpovídající metody řízení a volání <xref:System.Windows.Controls.Grid> statická třída <xref:System.Windows.Controls.Grid.SetColumn%2A> a <xref:System.Windows.Controls.Grid.SetRow%2A> metody umístění ovládacích prvků do příslušné buňky.</span><span class="sxs-lookup"><span data-stu-id="14c55-261">The methods create the appropriate control, and call the <xref:System.Windows.Controls.Grid> class static <xref:System.Windows.Controls.Grid.SetColumn%2A> and <xref:System.Windows.Controls.Grid.SetRow%2A> methods to place the controls in the appropriate cell.</span></span> <span data-ttu-id="14c55-262">Po vytvoření ovládacího prvku ukázka volá <xref:System.Windows.Controls.UIElementCollection.Add%2A> metodu <xref:System.Windows.Controls.Panel.Children%2A> vlastnost <xref:System.Windows.Controls.Grid> přidání ovládacího prvku do mřížky.</span><span class="sxs-lookup"><span data-stu-id="14c55-262">After the control is created, the sample calls the <xref:System.Windows.Controls.UIElementCollection.Add%2A> method on the <xref:System.Windows.Controls.Panel.Children%2A> property of the <xref:System.Windows.Controls.Grid> to add the control to the grid.</span></span> <span data-ttu-id="14c55-263">Je podobný kódu k přidání zbývající páry popisek nebo textové pole.</span><span class="sxs-lookup"><span data-stu-id="14c55-263">The code to add the remaining label/textbox pairs is similar.</span></span> <span data-ttu-id="14c55-264">Najdete ukázkový kód podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="14c55-264">See the sample code for details.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorName](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorname)]  
  
 <span data-ttu-id="14c55-265">Implementace tyto dvě metody vypadá takto:</span><span class="sxs-lookup"><span data-stu-id="14c55-265">The implementation of the two methods is as follows:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCreateHelpers](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagecreatehelpers)]  
  
 <span data-ttu-id="14c55-266">Nakonec ukázka přidá **OK** a **zrušit** tlačítka a připojí obslužné rutiny události pro jejich <xref:System.Windows.Controls.Primitives.ButtonBase.Click> události.</span><span class="sxs-lookup"><span data-stu-id="14c55-266">Finally, the sample adds the **OK** and **Cancel** buttons and attaches an event handler to their <xref:System.Windows.Controls.Primitives.ButtonBase.Click> events.</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageCtorButtonsEvents](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagectorbuttonsevents)]  
  
<a name="returning_data_to_window"></a>   
### <a name="returning-the-data-to-the-host-window"></a><span data-ttu-id="14c55-267">Vrací Data do okna hostitele</span><span class="sxs-lookup"><span data-stu-id="14c55-267">Returning the Data to the Host Window</span></span>  
 <span data-ttu-id="14c55-268">Při kliknutí na tlačítko buď jeho <xref:System.Windows.Controls.Primitives.ButtonBase.Click> událost se vyvolá.</span><span class="sxs-lookup"><span data-stu-id="14c55-268">When either button is clicked, its <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event is raised.</span></span> <span data-ttu-id="14c55-269">Okno hostitele může jednoduše připojit obslužné rutiny na tyto události a získat data přímo z <xref:System.Windows.Controls.TextBox> ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="14c55-269">The host window could simply attach handlers to these events and get the data directly from the <xref:System.Windows.Controls.TextBox> controls.</span></span> <span data-ttu-id="14c55-270">Ukázka používá méně přímý přístup.</span><span class="sxs-lookup"><span data-stu-id="14c55-270">The sample uses a somewhat less direct approach.</span></span> <span data-ttu-id="14c55-271">Zpracovává <xref:System.Windows.Controls.Primitives.ButtonBase.Click> v rámci [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu a potom vydá vlastní události `OnButtonClicked`, upozornit [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsah.</span><span class="sxs-lookup"><span data-stu-id="14c55-271">It handles the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> within the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and then raises a custom event `OnButtonClicked`, to notify the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="14c55-272">To umožňuje [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu udělat některé ověření parametru než oznámí hostitele.</span><span class="sxs-lookup"><span data-stu-id="14c55-272">This allows the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to do some parameter validation before notifying the host.</span></span> <span data-ttu-id="14c55-273">Obslužná rutina načte text z <xref:System.Windows.Controls.TextBox> ovládací prvky a přiřadí ji k veřejné vlastnosti, ze kterých můžete načíst hostitele informace.</span><span class="sxs-lookup"><span data-stu-id="14c55-273">The handler gets the text from the <xref:System.Windows.Controls.TextBox> controls and assigns it to public properties, from which the host can retrieve the information.</span></span>  
  
 <span data-ttu-id="14c55-274">Deklarace událostí v WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="14c55-274">The event declaration, in WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageEventDecl](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpageeventdecl)]  
  
 <span data-ttu-id="14c55-275"><xref:System.Windows.Controls.Primitives.ButtonBase.Click> Obslužné rutiny událostí v WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="14c55-275">The <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler, in WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageButtonClicked](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagebuttonclicked)]  
  
<a name="set_page_properties"></a>   
### <a name="setting-the-wpf-properties"></a><span data-ttu-id="14c55-276">Nastavení vlastností WPF</span><span class="sxs-lookup"><span data-stu-id="14c55-276">Setting the WPF Properties</span></span>  
 <span data-ttu-id="14c55-277">[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] Hostitele umožňuje uživatelům změnit několik [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="14c55-277">The [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] host allows the user to change several [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content properties.</span></span> <span data-ttu-id="14c55-278">Z [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] straně je pouze záležitost změna vlastností.</span><span class="sxs-lookup"><span data-stu-id="14c55-278">From the [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] side, it is simply a matter of changing the properties.</span></span> <span data-ttu-id="14c55-279">Implementace ve [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] obsahu třída je trochu složitější, protože není žádná jednoho globální vlastnost písma pro všechny ovládací prvky pro ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="14c55-279">The implementation in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class is somewhat more complicated, because there is no single global property that controls the fonts for all controls.</span></span> <span data-ttu-id="14c55-280">Místo toho odpovídající vlastnost pro každý ovládací prvek se změní v průvodcem sady vlastností.</span><span class="sxs-lookup"><span data-stu-id="14c55-280">Instead, the appropriate property for each control is changed in the properties' set accessors.</span></span> <span data-ttu-id="14c55-281">Následující příklad ukazuje kód pro `DefaultFontFamily` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="14c55-281">The following example shows the code for the `DefaultFontFamily` property.</span></span> <span data-ttu-id="14c55-282">Nastavení vlastnosti volá soukromá metoda který naopak nastaví <xref:System.Windows.Controls.Control.FontFamily%2A> vlastnosti pro různé ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="14c55-282">Setting the property calls a private method that in turn sets the <xref:System.Windows.Controls.Control.FontFamily%2A> properties for the various controls.</span></span>  
  
 <span data-ttu-id="14c55-283">Z WPFPage.h:</span><span class="sxs-lookup"><span data-stu-id="14c55-283">From WPFPage.h:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageFontFamilyProperty](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.h#wpfpagefontfamilyproperty)]  
  
 <span data-ttu-id="14c55-284">Z WPFPage.cpp:</span><span class="sxs-lookup"><span data-stu-id="14c55-284">From WPFPage.cpp:</span></span>  
  
 [!code-cpp[Win32HostingWPFPage#WPFPageSetFontFamily](../../../../samples/snippets/cpp/VS_Snippets_Wpf/Win32HostingWPFPage/CPP/WPFPage.cpp#wpfpagesetfontfamily)]  
  
## <a name="see-also"></a><span data-ttu-id="14c55-285">Viz také</span><span class="sxs-lookup"><span data-stu-id="14c55-285">See Also</span></span>  
 <xref:System.Windows.Interop.HwndSource>  
 [<span data-ttu-id="14c55-286">Vzájemná spolupráce grafického subsystému WPF a systému Win32</span><span class="sxs-lookup"><span data-stu-id="14c55-286">WPF and Win32 Interoperation</span></span>](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md)
