---
title: "Zdroje a kód"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- keys [WPF], using objects as
- resources [WPF], accessing from procedural code
- procedural code [WPF], creating resources with
- procedural code [WPF], accessing resources from
- resources [WPF], creating with procedural code
ms.assetid: c1cfcddb-e39c-41c8-a7f3-60984914dfae
caps.latest.revision: "14"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 1177f7eeb2b6184ea6ae0a021730658913a4794b
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/21/2017
---
# <a name="resources-and-code"></a><span data-ttu-id="3b115-102">Zdroje a kód</span><span class="sxs-lookup"><span data-stu-id="3b115-102">Resources and Code</span></span>
<span data-ttu-id="3b115-103">Tento přehled soustřeďuje na postupy [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] prostředky můžete přistupovat ani je vytvářet pomocí kódu místo [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntaxe.</span><span class="sxs-lookup"><span data-stu-id="3b115-103">This overview concentrates on how [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] resources can be accessed or created using  code rather than [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] syntax.</span></span> <span data-ttu-id="3b115-104">Další informace o využití obecné prostředků a prostředky z [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntaxe perspektivy, najdete v části [XAML prostředky](../../../../docs/framework/wpf/advanced/xaml-resources.md).</span><span class="sxs-lookup"><span data-stu-id="3b115-104">For more information on general resource usage and resources from a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] syntax perspective, see [XAML Resources](../../../../docs/framework/wpf/advanced/xaml-resources.md).</span></span>  
  
  
  
<a name="accessing"></a>   
## <a name="accessing-resources-from-code"></a><span data-ttu-id="3b115-105">Přístup k prostředkům z kódu</span><span class="sxs-lookup"><span data-stu-id="3b115-105">Accessing Resources from Code</span></span>  
 <span data-ttu-id="3b115-106">Klíče, které označují prostředky, pokud jsou definovány na základě [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] se taky používají k načtení specifické prostředky, pokud požádáte o prostředku v kódu.</span><span class="sxs-lookup"><span data-stu-id="3b115-106">The keys that identify resources if they are defined through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are also used to retrieve specific resources if you request the resource in code.</span></span> <span data-ttu-id="3b115-107">Nejjednodušší způsob, jak načíst prostředek z kódu je volat buď <xref:System.Windows.FrameworkElement.FindResource%2A> nebo <xref:System.Windows.FrameworkElement.TryFindResource%2A> metoda z úrovni rozhraní objektů v aplikaci.</span><span class="sxs-lookup"><span data-stu-id="3b115-107">The simplest way to retrieve a resource from code is to call either the <xref:System.Windows.FrameworkElement.FindResource%2A> or the <xref:System.Windows.FrameworkElement.TryFindResource%2A> method from framework-level objects in your application.</span></span> <span data-ttu-id="3b115-108">Chování rozdíl mezi tyto metody je, co se stane, pokud není nalezen požadovaný klíč.</span><span class="sxs-lookup"><span data-stu-id="3b115-108">The behavioral difference between these methods is what happens if the requested key is not found.</span></span> <span data-ttu-id="3b115-109"><xref:System.Windows.FrameworkElement.FindResource%2A>vyvolá výjimku. <xref:System.Windows.FrameworkElement.TryFindResource%2A> nebude vyvolat výjimku, ale vrátí `null`.</span><span class="sxs-lookup"><span data-stu-id="3b115-109"><xref:System.Windows.FrameworkElement.FindResource%2A> raises an exception; <xref:System.Windows.FrameworkElement.TryFindResource%2A> will not raise an exception but returns `null`.</span></span> <span data-ttu-id="3b115-110">Každá metoda přebírá klíč prostředku jako vstupní parametr a vrátí objekt volného typu.</span><span class="sxs-lookup"><span data-stu-id="3b115-110">Each method takes the resource key as an input parameter, and returns a loosely typed object.</span></span> <span data-ttu-id="3b115-111">Obvykle klíč prostředku je řetězec, ale existují příležitostně neřetězcový použití; najdete v článku [pomocí objektů jako klíče](#objectaskey) podrobnosti.</span><span class="sxs-lookup"><span data-stu-id="3b115-111">Typically, a resource key is a string, but there are occasional nonstring usages; see the [Using Objects as Keys](#objectaskey) section for details.</span></span> <span data-ttu-id="3b115-112">Obvykle by přetypovat na typ vyžadují vlastnost, která nastavíte žádosti o prostředek vráceného objektu.</span><span class="sxs-lookup"><span data-stu-id="3b115-112">Typically you would cast the returned object to the type required by the property that you are setting when requesting the resource.</span></span> <span data-ttu-id="3b115-113">Vyhledávání logiku pro překlad kódu prostředků je stejná jako odkaz na dynamické prostředků [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] případu.</span><span class="sxs-lookup"><span data-stu-id="3b115-113">The lookup logic for code resource resolution is the same as the dynamic resource reference [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] case.</span></span> <span data-ttu-id="3b115-114">Hledat prostředky spustí z volání prvku a potom pokračuje v následných nadřazené elementy v logickém stromu.</span><span class="sxs-lookup"><span data-stu-id="3b115-114">The search for resources starts from the calling element, then continues to successive parent elements in the logical tree.</span></span> <span data-ttu-id="3b115-115">Vyhledávání bude pokračovat a vyšší do prostředky aplikace, motivů a systémové prostředky v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="3b115-115">The lookup continues onwards into application resources, themes, and system resources if necessary.</span></span> <span data-ttu-id="3b115-116">Žádost o kód pro prostředek bude správně účet pro změny v modulu runtime ve slovnících prostředků, které byly provedeny po této slovník prostředků, které jsou načítány z [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]a také pro změny prostředků systému v reálném čase.</span><span class="sxs-lookup"><span data-stu-id="3b115-116">A code request for a resource will properly account for runtime changes in resource dictionaries that might have been made subsequent to that resource dictionary being loaded from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], and also for realtime system resource changes.</span></span>  
  
 <span data-ttu-id="3b115-117">Tady je příklad stručný kódu, který vyhledá prostředku pomocí klíče a používá vrácené hodnoty pro nastavení vlastnosti, implementovaný jako <xref:System.Windows.Controls.Primitives.ButtonBase.Click> obslužné rutiny události.</span><span class="sxs-lookup"><span data-stu-id="3b115-117">The following is a brief code example that finds a resource by key and uses the returned value to set a property, implemented as a <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event handler.</span></span>  
  
 [!code-csharp[PropertiesOvwSupport#ResourceProceduralGet](../../../../samples/snippets/csharp/VS_Snippets_Wpf/PropertiesOvwSupport/CSharp/page3.xaml.cs#resourceproceduralget)]
 [!code-vb[PropertiesOvwSupport#ResourceProceduralGet](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/PropertiesOvwSupport/visualbasic/page3.xaml.vb#resourceproceduralget)]  
  
 <span data-ttu-id="3b115-118">Je to alternativní metoda pro přiřazení odkaz prostředků <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span><span class="sxs-lookup"><span data-stu-id="3b115-118">An alternative method for assigning a resource reference is <xref:System.Windows.FrameworkElement.SetResourceReference%2A>.</span></span> <span data-ttu-id="3b115-119">Tato metoda přebírá dva parametry: klíč prostředek a identifikátor pro vlastnost konkrétní závislosti, který je přítomen v instanci element, ke kterému by se měla přiřadit hodnotu zdroje.</span><span class="sxs-lookup"><span data-stu-id="3b115-119">This method takes two parameters: the key of the resource, and the identifier for a particular dependency property that is present on the element instance to which the resource value should be assigned.</span></span> <span data-ttu-id="3b115-120">Funkčně tato metoda je stejný a nabízí výhodu v podobě které nevyžadují žádné přetypování návratové hodnoty.</span><span class="sxs-lookup"><span data-stu-id="3b115-120">Functionally, this method is the same and has the advantage of not requiring any casting of return values.</span></span>  
  
 <span data-ttu-id="3b115-121">Ještě další způsob, jak přistupovat k prostředkům prostřednictvím kódu programu je pro přístup k obsahu <xref:System.Windows.FrameworkElement.Resources%2A> vlastnost jako slovník.</span><span class="sxs-lookup"><span data-stu-id="3b115-121">Still another way to access resources programmatically is to access the contents of the <xref:System.Windows.FrameworkElement.Resources%2A> property as a dictionary.</span></span> <span data-ttu-id="3b115-122">Přístup slovníku obsažený v této vlastnosti je také jak přidáte nové prostředky do existující kolekce, zkontrolujte, když se už používá daný název klíče v kolekci a další operace slovník nebo kolekce.</span><span class="sxs-lookup"><span data-stu-id="3b115-122">Accessing the dictionary contained by this property is also how you can add new resources to existing collections, check to see if a given key name is already taken in the collection, and other dictionary/collection operations.</span></span> <span data-ttu-id="3b115-123">Pokud píšete [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] aplikaci zcela v kódu, můžete také vytvořit celou kolekci v kódu, přiřadit klíčů a potom přiřadit dokončení kolekce k <xref:System.Windows.FrameworkElement.Resources%2A> vlastnost zavedených elementu.</span><span class="sxs-lookup"><span data-stu-id="3b115-123">If you are writing a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application entirely in code, you can also create the entire collection in code, assign keys to it, and then assign the finished collection to the <xref:System.Windows.FrameworkElement.Resources%2A> property of an established element.</span></span> <span data-ttu-id="3b115-124">To bude popsané v další části.</span><span class="sxs-lookup"><span data-stu-id="3b115-124">This will be described in the next section.</span></span>  
  
 <span data-ttu-id="3b115-125">Mohou indexu v rámci všechny zadané <xref:System.Windows.FrameworkElement.Resources%2A> shromažďování, použití konkrétního klíče jako index, ale měli vědět, že přístup k prostředku tímto způsobem nedodrží normální runtime pravidla prostředků řešení.</span><span class="sxs-lookup"><span data-stu-id="3b115-125">You can index within any given <xref:System.Windows.FrameworkElement.Resources%2A> collection, using a specific key as the index, but you should be aware that accessing the resource in this way does not follow the normal runtime rules of resource resolution.</span></span> <span data-ttu-id="3b115-126">Jsou pouze přístup k této konkrétní kolekce.</span><span class="sxs-lookup"><span data-stu-id="3b115-126">You are only accessing that particular collection.</span></span> <span data-ttu-id="3b115-127">Vyhledávání prostředků nebude možné procházení oboru kořenové nebo aplikace Pokud na požadovaný klíč byl nalezen žádný platný objekt.</span><span class="sxs-lookup"><span data-stu-id="3b115-127">Resource lookup will not be traversing the scope to the root or the application if no valid object was found at the requested key.</span></span> <span data-ttu-id="3b115-128">Tento přístup, ale může mít výhody výkonu v některých případech právě proto rozsah hledání klíče je omezené více.</span><span class="sxs-lookup"><span data-stu-id="3b115-128">However, this approach may have performance advantages in some cases precisely because the scope of the search for the key is more constrained.</span></span> <span data-ttu-id="3b115-129">Najdete v článku <xref:System.Windows.ResourceDictionary> třída další podrobnosti o tom, jak pracovat s slovník prostředků přímo.</span><span class="sxs-lookup"><span data-stu-id="3b115-129">See the <xref:System.Windows.ResourceDictionary> class for more details on how to work with the resource dictionary directly.</span></span>  
  
<a name="creating"></a>   
## <a name="creating-resources-with-code"></a><span data-ttu-id="3b115-130">Vytváření prostředků pomocí kódu</span><span class="sxs-lookup"><span data-stu-id="3b115-130">Creating Resources with Code</span></span>  
 <span data-ttu-id="3b115-131">Pokud chcete vytvořit celou [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] aplikace v kódu, můžete také chtít vytvořit všechny prostředky v této aplikaci v kódu.</span><span class="sxs-lookup"><span data-stu-id="3b115-131">If you want to create an entire [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application in code, you might also want to create any resources in that application in code.</span></span> <span data-ttu-id="3b115-132">Jak toho docílit, vytvořte novou <xref:System.Windows.ResourceDictionary> instance a poté přidejte všechny prostředky do slovníku pomocí následná volání <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3b115-132">To achieve this, create a new <xref:System.Windows.ResourceDictionary> instance, and then add all the resources to the dictionary using successive calls to <xref:System.Windows.ResourceDictionary.Add%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="3b115-133">Potom použít <xref:System.Windows.ResourceDictionary> proto vytvořit nastavit <xref:System.Windows.FrameworkElement.Resources%2A> vlastnost u elementu, který se nachází v oboru stránky, nebo <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3b115-133">Then, use the <xref:System.Windows.ResourceDictionary> thus created to set the <xref:System.Windows.FrameworkElement.Resources%2A> property on an element that is present in a page scope, or the <xref:System.Windows.Application.Resources%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="3b115-134">Můžete také zachovat <xref:System.Windows.ResourceDictionary> jako samostatném objektu bez přidání elementu.</span><span class="sxs-lookup"><span data-stu-id="3b115-134">You could also maintain the <xref:System.Windows.ResourceDictionary> as a standalone object without adding it to an element.</span></span> <span data-ttu-id="3b115-135">Ale pokud to uděláte, můžete musí přístup k prostředkům v něm pomocí klíče položky, jako by šlo obecné slovník.</span><span class="sxs-lookup"><span data-stu-id="3b115-135">However, if you do this, you must access the resources within it by item key, as if it were a generic dictionary.</span></span> <span data-ttu-id="3b115-136">A <xref:System.Windows.ResourceDictionary> , není připojen k elementu `Resources` vlastnost, nebude existovat v rámci stromu elementu a nemá žádný obor v pořadí vyhledávání, které mohou být využívána <xref:System.Windows.FrameworkElement.FindResource%2A> a související metody.</span><span class="sxs-lookup"><span data-stu-id="3b115-136">A <xref:System.Windows.ResourceDictionary> that is not attached to an element `Resources` property would not  exist as part of the element tree and has no scope in a lookup sequence that can be used by <xref:System.Windows.FrameworkElement.FindResource%2A> and related methods.</span></span>  
  
<a name="objectaskey"></a>   
## <a name="using-objects-as-keys"></a><span data-ttu-id="3b115-137">Použití objektů jako klíče</span><span class="sxs-lookup"><span data-stu-id="3b115-137">Using Objects as Keys</span></span>  
 <span data-ttu-id="3b115-138">Většina použití prostředků nastaví klíč na řetězec prostředku.</span><span class="sxs-lookup"><span data-stu-id="3b115-138">Most resource usages will set the key of the resource to be a string.</span></span> <span data-ttu-id="3b115-139">Však různé [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] funkce úmyslně nepoužívají typu string nastavit klíče, místo toho tento parametr je objekt.</span><span class="sxs-lookup"><span data-stu-id="3b115-139">However, various [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features deliberately do not use a string type to specify keys, instead this parameter is an object.</span></span> <span data-ttu-id="3b115-140">Funkce s prostředku s klíči objekt je používán [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Podpora stylu a motivů.</span><span class="sxs-lookup"><span data-stu-id="3b115-140">The capability of having the resource be keyed by an object is used by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] style and theming support.</span></span> <span data-ttu-id="3b115-141">Každý styly v motivy, které se stanou výchozí styl pro ovládací prvek jinak bez stylem jsou klíčovány pomocí <xref:System.Type> ovládacího prvku, který by se měly používat k.</span><span class="sxs-lookup"><span data-stu-id="3b115-141">The styles in themes which become the default style for an otherwise non-styled control are each keyed by the <xref:System.Type> of the control that they should apply to.</span></span> <span data-ttu-id="3b115-142">Probíhá s klíči typu poskytuje spolehlivé vyhledávání mechanismus, který funguje na výchozí instance každé – typ ovládacího prvku a typ můžete zjištěno pomocí reflexe a používá pro určení stylu odvozené třídy, i když odvozený typ, jinak hodnota nemá žádné výchozí styl.</span><span class="sxs-lookup"><span data-stu-id="3b115-142">Being keyed by type provides a reliable lookup mechanism that works on default instances of each control type, and type can be detected by reflection and used for styling derived classes even though the derived type otherwise has no default style.</span></span> <span data-ttu-id="3b115-143">Můžete zadat <xref:System.Type> klíče pro prostředek definované v [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] pomocí [x: Type – rozšíření značek](../../../../docs/framework/xaml-services/x-type-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="3b115-143">You can specify a <xref:System.Type> key for a resource defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] by using the [x:Type Markup Extension](../../../../docs/framework/xaml-services/x-type-markup-extension.md).</span></span> <span data-ttu-id="3b115-144">Podobně jako rozšíření pro další použití klíče neřetězcový, které podporují neexistují [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] funkce, jako například [ComponentResourceKey – rozšíření značek](../../../../docs/framework/wpf/advanced/componentresourcekey-markup-extension.md).</span><span class="sxs-lookup"><span data-stu-id="3b115-144">Similar extensions exist for other nonstring key usages that support [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] features, such as [ComponentResourceKey Markup Extension](../../../../docs/framework/wpf/advanced/componentresourcekey-markup-extension.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3b115-145">Viz také</span><span class="sxs-lookup"><span data-stu-id="3b115-145">See Also</span></span>  
 [<span data-ttu-id="3b115-146">Prostředky XAML</span><span class="sxs-lookup"><span data-stu-id="3b115-146">XAML Resources</span></span>](../../../../docs/framework/wpf/advanced/xaml-resources.md)  
 [<span data-ttu-id="3b115-147">Stylů a ukázka</span><span class="sxs-lookup"><span data-stu-id="3b115-147">Styling and Templating</span></span>](../../../../docs/framework/wpf/controls/styling-and-templating.md)
