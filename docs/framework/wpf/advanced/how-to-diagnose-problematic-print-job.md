---
title: "Postupy: Diagnostika problematické tiskové úlohy"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- troubleshooting print job problems [WPF]
- print jobs [WPF], troubleshooting
- print jobs [WPF], diagnosing problems
ms.assetid: b081a170-84c6-48f9-a487-5766a8d58a82
caps.latest.revision: "7"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: acc757d899da3ff737b2884131b77135265fd197
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/21/2017
---
# <a name="how-to-diagnose-problematic-print-job"></a><span data-ttu-id="c073f-102">Postupy: Diagnostika problematické tiskové úlohy</span><span class="sxs-lookup"><span data-stu-id="c073f-102">How to: Diagnose Problematic Print Job</span></span>
<span data-ttu-id="c073f-103">Správci sítě často pole stížností od uživatelů o tiskové úlohy, které vytisknout nebo vytisknout pomalu.</span><span class="sxs-lookup"><span data-stu-id="c073f-103">Network administrators often field complaints from users about print jobs that do not print or print slowly.</span></span> <span data-ttu-id="c073f-104">Bohatá sada vlastností tiskových úloh v [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] z [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)] poskytují způsob pro provádění rychlé vzdálenou diagnostiku tiskových úloh.</span><span class="sxs-lookup"><span data-stu-id="c073f-104">The rich set of print job properties exposed in the [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] of [!INCLUDE[TLA#tla_winfx](../../../../includes/tlasharptla-winfx-md.md)] provide a means for performing a rapid remote diagnosis of print jobs.</span></span>  
  
## <a name="example"></a><span data-ttu-id="c073f-105">Příklad</span><span class="sxs-lookup"><span data-stu-id="c073f-105">Example</span></span>  
 <span data-ttu-id="c073f-106">Hlavní kroky pro vytvoření tento druh nástroj jsou následující.</span><span class="sxs-lookup"><span data-stu-id="c073f-106">The major steps for creating this kind of utility are as follows.</span></span>  
  
1.  <span data-ttu-id="c073f-107">Identifikujte tiskovou úlohu, která je stěžovat uživatele.</span><span class="sxs-lookup"><span data-stu-id="c073f-107">Identify the print job that the user is complaining about.</span></span> <span data-ttu-id="c073f-108">Uživatelé často nelze provést přesněji.</span><span class="sxs-lookup"><span data-stu-id="c073f-108">Users often cannot do this precisely.</span></span> <span data-ttu-id="c073f-109">Se nemusí znát názvy tiskáren nebo tiskových serverů.</span><span class="sxs-lookup"><span data-stu-id="c073f-109">They may not know the names of the print servers or printers.</span></span> <span data-ttu-id="c073f-110">Oproti nastavení může popisují umístění tiskárny v odlišnou terminologii jeho <xref:System.Printing.PrintQueue.Location%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="c073f-110">They may describe the location of the printer in different terminology than was used in setting its <xref:System.Printing.PrintQueue.Location%2A> property.</span></span> <span data-ttu-id="c073f-111">Proto je vhodné vytvořit seznam uživatele aktuálně předat úlohy.</span><span class="sxs-lookup"><span data-stu-id="c073f-111">Accordingly, it is a good idea to generate a list of the user's currently submitted jobs.</span></span> <span data-ttu-id="c073f-112">Pokud existuje více než jeden, můžete komunikace mezi uživatelem a tiskový systém správce použít ke kotvícímu bodu na úlohu, která má potíže.</span><span class="sxs-lookup"><span data-stu-id="c073f-112">If there is more than one, then communication between the user and the print system administrator can be used to pinpoint the job that is having problems.</span></span> <span data-ttu-id="c073f-113">Dílčích kroků jsou následujícím způsobem.</span><span class="sxs-lookup"><span data-stu-id="c073f-113">The substeps are as follows.</span></span>  
  
    1.  <span data-ttu-id="c073f-114">Získejte seznam všech tiskových serverů.</span><span class="sxs-lookup"><span data-stu-id="c073f-114">Obtain a list of all print servers.</span></span>  
  
    2.  <span data-ttu-id="c073f-115">Projděte serverů, které chcete dotazovat jejich tiskové fronty.</span><span class="sxs-lookup"><span data-stu-id="c073f-115">Loop through the servers to query their print queues.</span></span>  
  
    3.  <span data-ttu-id="c073f-116">V každém průchodu smyčky serveru projděte všechny server fronty k dotazování svou práci</span><span class="sxs-lookup"><span data-stu-id="c073f-116">Within each pass of the server loop, loop through all the server's queues to query their jobs</span></span>  
  
    4.  <span data-ttu-id="c073f-117">V každém průchodu smyčky fronty procházení jeho úlohy a shromážděte identifikační informace o ty, které byly odeslány žalující uživatelem.</span><span class="sxs-lookup"><span data-stu-id="c073f-117">Within each pass of the queue loop, loop through its jobs and gather identifying information about those that were submitted by the complaining user.</span></span>  
  
2.  <span data-ttu-id="c073f-118">Pokud byla zjištěna problematické tiskové úlohy, podívejte se na relevantní vlastnosti chcete zobrazit, co může být problém.</span><span class="sxs-lookup"><span data-stu-id="c073f-118">When the problematic print job has been identified, examine relevant properties to see what might be the problem.</span></span> <span data-ttu-id="c073f-119">Například je úloha ve stavu chyby nebo nebyla tiskárny obsluhy fronty přejít do režimu offline dříve, než může tisknout úlohu?</span><span class="sxs-lookup"><span data-stu-id="c073f-119">For example, is job in an error state or did the printer servicing the queue go offline before the job could print?</span></span>  
  
 <span data-ttu-id="c073f-120">Následující kód je řadu příklady kódu.</span><span class="sxs-lookup"><span data-stu-id="c073f-120">The code below is series of code examples.</span></span> <span data-ttu-id="c073f-121">V prvním příkladu kódu obsahuje cyklus prostřednictvím tiskové fronty.</span><span class="sxs-lookup"><span data-stu-id="c073f-121">The first code example contains the loop through the print queues.</span></span> <span data-ttu-id="c073f-122">(Krok 1c výše). Proměnná `myPrintQueues` je <xref:System.Printing.PrintQueueCollection> objekt pro aktuální tiskový server.</span><span class="sxs-lookup"><span data-stu-id="c073f-122">(Step 1c above.) The variable `myPrintQueues` is the <xref:System.Printing.PrintQueueCollection> object for the current print server.</span></span>  
  
 <span data-ttu-id="c073f-123">Příklad kódu začne aktualizujte aktuální objekt tiskové fronty s <xref:System.Printing.PrintQueue.Refresh%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="c073f-123">The code example begins by refreshing the current print queue object with <xref:System.Printing.PrintQueue.Refresh%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="c073f-124">Tím se zajistí, že vlastností objektu přesně reprezentovat stav fyzické tiskárny, který reprezentuje.</span><span class="sxs-lookup"><span data-stu-id="c073f-124">This ensures that the object's properties accurately represent the state of the physical printer that it represents.</span></span> <span data-ttu-id="c073f-125">Pak aplikace získá kolekci tiskové úlohy aktuálně v tiskové frontě pomocí <xref:System.Printing.PrintQueue.GetPrintJobInfoCollection%2A>.</span><span class="sxs-lookup"><span data-stu-id="c073f-125">Then the application gets the collection of print jobs currently in the print queue by using <xref:System.Printing.PrintQueue.GetPrintJobInfoCollection%2A>.</span></span>  
  
 <span data-ttu-id="c073f-126">Další aplikace projde <xref:System.Printing.PrintSystemJobInfo> kolekce a porovnává <xref:System.Printing.PrintSystemJobInfo.Submitter%2A> vlastnost s aliasem žalující uživatele.</span><span class="sxs-lookup"><span data-stu-id="c073f-126">Next the application loops through the <xref:System.Printing.PrintSystemJobInfo> collection and compares each <xref:System.Printing.PrintSystemJobInfo.Submitter%2A> property with the alias of the complaining user.</span></span> <span data-ttu-id="c073f-127">Pokud se shodují, aplikace přidá řetězec, který zobrazí identifikační informace o úloze.</span><span class="sxs-lookup"><span data-stu-id="c073f-127">If they match, the application adds identifying information about the job to the string that will be presented.</span></span> <span data-ttu-id="c073f-128">( `userName` a `jobList` proměnné se inicializují dříve v aplikaci.)</span><span class="sxs-lookup"><span data-stu-id="c073f-128">(The `userName` and `jobList` variables are initialized earlier in the application.)</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#enumeratejobsinqueues)]
 [!code-csharp[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#enumeratejobsinqueues)]
 [!code-vb[DiagnoseProblematicPrintJob#EnumerateJobsInQueues](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#enumeratejobsinqueues)]  
  
 <span data-ttu-id="c073f-129">Další příklad kódu převezme aplikace v kroku 2.</span><span class="sxs-lookup"><span data-stu-id="c073f-129">The next code example picks up the application at Step 2.</span></span> <span data-ttu-id="c073f-130">(Viz výše). Byla zjištěna problematické úlohy a aplikace vyzve k zadání informací, které bude identifikovat.</span><span class="sxs-lookup"><span data-stu-id="c073f-130">(See above.) The problematic job has been identified and the application prompts for the information that will identify it.</span></span> <span data-ttu-id="c073f-131">Z těchto informací vytvoří <xref:System.Printing.PrintServer>, <xref:System.Printing.PrintQueue>, a <xref:System.Printing.PrintSystemJobInfo> objekty.</span><span class="sxs-lookup"><span data-stu-id="c073f-131">From this information it creates <xref:System.Printing.PrintServer>, <xref:System.Printing.PrintQueue>, and <xref:System.Printing.PrintSystemJobInfo> objects.</span></span>  
  
 <span data-ttu-id="c073f-132">V tomto okamžiku aplikace obsahuje větvení struktura odpovídající na dva způsoby, jak kontrolovat stav tiskové úlohy:</span><span class="sxs-lookup"><span data-stu-id="c073f-132">At this point the application contains a branching structure corresponding to the two ways of checking a print job's status:</span></span>  
  
-   <span data-ttu-id="c073f-133">Příznaky systému si můžete přečíst <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> vlastnost, která je typu <xref:System.Printing.PrintJobStatus>.</span><span class="sxs-lookup"><span data-stu-id="c073f-133">You can read the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property which is of type <xref:System.Printing.PrintJobStatus>.</span></span>  
  
-   <span data-ttu-id="c073f-134">Můžete si přečíst každé příslušné vlastnosti, jako <xref:System.Printing.PrintSystemJobInfo.IsBlocked%2A> a <xref:System.Printing.PrintSystemJobInfo.IsInError%2A>.</span><span class="sxs-lookup"><span data-stu-id="c073f-134">You can read each relevant property such as <xref:System.Printing.PrintSystemJobInfo.IsBlocked%2A> and <xref:System.Printing.PrintSystemJobInfo.IsInError%2A>.</span></span>  
  
 <span data-ttu-id="c073f-135">Tento příklad ukazuje obě metody tak, aby byl uživatel dříve zobrazí výzva, kterou metodu použít a odpověděla s "Y", pokud mu chtěli použít příznaky z <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="c073f-135">This example demonstrates both methods, so the user was previously prompted as to which method to use and responded with "Y" if he or she wanted to use the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property.</span></span> <span data-ttu-id="c073f-136">Níže naleznete podrobnosti o tyto dvě metody.</span><span class="sxs-lookup"><span data-stu-id="c073f-136">See below for the details of the two methods.</span></span> <span data-ttu-id="c073f-137">Nakonec aplikace používá metodu s názvem **ReportQueueAndJobAvailability** zprávu o tom, jestli může úloha vytištěna v tuto chvíli den.</span><span class="sxs-lookup"><span data-stu-id="c073f-137">Finally, the application uses a method called **ReportQueueAndJobAvailability** to report on whether the job can be printed at this time of day.</span></span> <span data-ttu-id="c073f-138">Tato metoda je popsána v [zjistit, jestli tiskových úlohy můžete být vytisknout v tento čas z den](../../../../docs/framework/wpf/advanced/how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day.md).</span><span class="sxs-lookup"><span data-stu-id="c073f-138">This method is discussed in [Discover Whether a Print Job Can Be Printed At This Time of Day](../../../../docs/framework/wpf/advanced/how-to-discover-whether-a-print-job-can-be-printed-at-this-time-of-day.md).</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#identifyanddiagnoseproblematicjob)]
 [!code-csharp[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#identifyanddiagnoseproblematicjob)]
 [!code-vb[DiagnoseProblematicPrintJob#IdentifyAndDiagnoseProblematicJob](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#identifyanddiagnoseproblematicjob)]  
  
 <span data-ttu-id="c073f-139">Zkontrolujte stav tiskové úlohy s použitím příznaků z <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> vlastnost, zkontrolujte každý relevantní příznak, pokud je nastavena.</span><span class="sxs-lookup"><span data-stu-id="c073f-139">To check print job status using the flags of the <xref:System.Printing.PrintSystemJobInfo.JobStatus%2A> property, you check each relevant flag to see if it is set.</span></span> <span data-ttu-id="c073f-140">Standardní způsob, jak zobrazit, pokud je v sadě bitové příznaky nastavit jeden bit je logické a operace sadou příznaky jako jeden operand a příznak sám sebe jako na druhý.</span><span class="sxs-lookup"><span data-stu-id="c073f-140">The standard way to see if one bit is set in a set of bit flags is to perform a logical AND operation with the set of flags as one operand and the flag itself as the other.</span></span> <span data-ttu-id="c073f-141">Vzhledem k tomu, že příznak samotné má jenom jeden bit, nastavit, výsledek logické a je, že, maximálně Tento stejný bit nastavený.</span><span class="sxs-lookup"><span data-stu-id="c073f-141">Since the flag itself has only one bit set, the result of the logical AND is that, at most, that same bit is set.</span></span> <span data-ttu-id="c073f-142">Pokud chcete zjistit, zda je nebo není, porovnejte právě výsledek logické a s příznakem sám sebe.</span><span class="sxs-lookup"><span data-stu-id="c073f-142">To find out whether it is or not, just compare the result of the logical AND with the flag itself.</span></span> <span data-ttu-id="c073f-143">Další informace najdete v tématu <xref:System.Printing.PrintJobStatus>, [& – operátor (referenční dokumentace jazyka C#)](~/docs/csharp/language-reference/operators/and-operator.md), a <xref:System.FlagsAttribute>.</span><span class="sxs-lookup"><span data-stu-id="c073f-143">For more information, see <xref:System.Printing.PrintJobStatus>, the [& Operator (C# Reference)](~/docs/csharp/language-reference/operators/and-operator.md), and <xref:System.FlagsAttribute>.</span></span>  
  
 <span data-ttu-id="c073f-144">Pro každý atribut, jehož bit nastaven kód to sestavy k obrazovce konzoly a někdy navrhne způsob, jak reagovat.</span><span class="sxs-lookup"><span data-stu-id="c073f-144">For each attribute whose bit is set, the code reports this to the console screen and sometimes suggests a way to respond.</span></span> <span data-ttu-id="c073f-145">( **HandlePausedJob** metoda, která je volána, když je pozastavená úloha nebo fronty jsou uvedeny níže.)</span><span class="sxs-lookup"><span data-stu-id="c073f-145">(The **HandlePausedJob** method that is called if the job or queue is paused is discussed below.)</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobattributes)]
 [!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobattributes)]
 [!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobAttributes](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobattributes)]  
  
 <span data-ttu-id="c073f-146">Ke kontrole stavu tiskové úlohy pomocí samostatných vlastnosti, jednoduše číst každou vlastnost a pokud je vlastnost `true`, sestavy k obrazovce konzoly a případně Navrhněte způsob, jak reagovat.</span><span class="sxs-lookup"><span data-stu-id="c073f-146">To check print job status using separate properties, you simply read each property and, if the property is `true`, report to the console screen and possibly suggest a way to respond.</span></span> <span data-ttu-id="c073f-147">( **HandlePausedJob** metoda, která je volána, když je pozastavená úloha nebo fronty jsou uvedeny níže.)</span><span class="sxs-lookup"><span data-stu-id="c073f-147">(The **HandlePausedJob** method that is called if the job or queue is paused is discussed below.)</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#spottroubleusingjobproperties)]
 [!code-csharp[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#spottroubleusingjobproperties)]
 [!code-vb[DiagnoseProblematicPrintJob#SpotTroubleUsingJobProperties](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#spottroubleusingjobproperties)]  
  
 <span data-ttu-id="c073f-148">**HandlePausedJob** metoda umožňuje uživatelům aplikace vzdáleně obnovit pozastavené úlohy.</span><span class="sxs-lookup"><span data-stu-id="c073f-148">The **HandlePausedJob** method enables the application's user to remotely resume paused jobs.</span></span> <span data-ttu-id="c073f-149">Vzhledem k tomu může být dobrým důvod, proč byla pozastavena tiskové fronty, metoda začíná výzvy pro uživatele rozhodnutí o tom, jestli ho obnoví.</span><span class="sxs-lookup"><span data-stu-id="c073f-149">Because there might be a good reason why the print queue was paused, the method begins by prompting for a user decision about whether to resume it.</span></span> <span data-ttu-id="c073f-150">Je-li odpověď "Y", pak se <xref:System.Printing.PrintQueue.Resume%2A?displayProperty=nameWithType> metoda je volána.</span><span class="sxs-lookup"><span data-stu-id="c073f-150">If the answer is "Y", then the <xref:System.Printing.PrintQueue.Resume%2A?displayProperty=nameWithType> method is called.</span></span>  
  
 <span data-ttu-id="c073f-151">Potom bude uživatel vyzván k rozhodování, pokud úlohy sám by byl obnoven, jen v případě, že je pozastavený nezávisle na tiskovou frontu.</span><span class="sxs-lookup"><span data-stu-id="c073f-151">Next the user is prompted to decide if the job itself should be resumed, just in case it is paused independently of the print queue.</span></span> <span data-ttu-id="c073f-152">(Porovnat <xref:System.Printing.PrintQueue.IsPaused%2A?displayProperty=nameWithType> a <xref:System.Printing.PrintSystemJobInfo.IsPaused%2A?displayProperty=nameWithType>.) Pokud je odpověď "Y", pak <xref:System.Printing.PrintSystemJobInfo.Resume%2A?displayProperty=nameWithType> je jinak <xref:System.Printing.PrintSystemJobInfo.Cancel%2A> je volána.</span><span class="sxs-lookup"><span data-stu-id="c073f-152">(Compare <xref:System.Printing.PrintQueue.IsPaused%2A?displayProperty=nameWithType> and <xref:System.Printing.PrintSystemJobInfo.IsPaused%2A?displayProperty=nameWithType>.) If the answer is "Y", then <xref:System.Printing.PrintSystemJobInfo.Resume%2A?displayProperty=nameWithType> is called; otherwise <xref:System.Printing.PrintSystemJobInfo.Cancel%2A> is called.</span></span>  
  
 [!code-cpp[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/cpp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CPP/Program.cpp#handlepausedjob)]
 [!code-csharp[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/csharp/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/CSharp/Program.cs#handlepausedjob)]
 [!code-vb[DiagnoseProblematicPrintJob#HandlePausedJob](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/DiagnoseProblematicPrintJob/visualbasic/program.vb#handlepausedjob)]  
  
## <a name="see-also"></a><span data-ttu-id="c073f-153">Viz také</span><span class="sxs-lookup"><span data-stu-id="c073f-153">See Also</span></span>  
 <xref:System.Printing.PrintJobStatus>  
 <xref:System.Printing.PrintSystemJobInfo>  
 <xref:System.FlagsAttribute>  
 <xref:System.Printing.PrintQueue>  
 [<span data-ttu-id="c073f-154">& – Operátor (referenční dokumentace jazyka C#)</span><span class="sxs-lookup"><span data-stu-id="c073f-154">& Operator (C# Reference)</span></span>](~/docs/csharp/language-reference/operators/and-operator.md)  
 [<span data-ttu-id="c073f-155">Dokumenty v grafickém subsystému WPF</span><span class="sxs-lookup"><span data-stu-id="c073f-155">Documents in WPF</span></span>](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)  
 [<span data-ttu-id="c073f-156">Tisk – přehled</span><span class="sxs-lookup"><span data-stu-id="c073f-156">Printing Overview</span></span>](../../../../docs/framework/wpf/advanced/printing-overview.md)
