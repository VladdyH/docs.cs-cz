---
title: 'Optimalizace výkonu: Rozložení a návrh'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- layout [WPF], optimizing performance
- design considerations [WPF]
- layout pass [WPF]
ms.assetid: 005f4cda-a849-448b-916b-38d14d9a96fe
ms.openlocfilehash: 9c9921e664d69038480e73ee6779ca9e48b81c7a
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/04/2018
ms.locfileid: "33547833"
---
# <a name="optimizing-performance-layout-and-design"></a><span data-ttu-id="6ea37-102">Optimalizace výkonu: Rozložení a návrh</span><span class="sxs-lookup"><span data-stu-id="6ea37-102">Optimizing Performance: Layout and Design</span></span>
<span data-ttu-id="6ea37-103">Návrh vašeho [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] aplikace může mít vliv na jeho výkon vytvořením nárokům v Výpočet rozložení a ověření odkazy na objekty.</span><span class="sxs-lookup"><span data-stu-id="6ea37-103">The design of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application can impact its performance by creating unnecessary overhead in calculating layout and validating object references.</span></span> <span data-ttu-id="6ea37-104">Konstrukce objektů, zejména v době běhu může ovlivnit výkonové charakteristiky vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="6ea37-104">The construction of objects, particularly at run time, can affect the performance characteristics of your application.</span></span>  
  
 <span data-ttu-id="6ea37-105">Toto téma obsahuje doporučení pro optimální výkon v těchto oblastech.</span><span class="sxs-lookup"><span data-stu-id="6ea37-105">This topic provides performance recommendations in these areas.</span></span>  
  
## <a name="layout"></a><span data-ttu-id="6ea37-106">Rozložení</span><span class="sxs-lookup"><span data-stu-id="6ea37-106">Layout</span></span>  
 <span data-ttu-id="6ea37-107">Termín "rozložení průchodu" popisuje proces měření a uspořádání členů <xref:System.Windows.Controls.Panel>-odvozené kolekce objektu podřízené objekty a pak kreslení je na obrazovce.</span><span class="sxs-lookup"><span data-stu-id="6ea37-107">The term "layout pass" describes the process of measuring and arranging the members of a <xref:System.Windows.Controls.Panel>-derived object's collection of children, and then drawing them onscreen.</span></span> <span data-ttu-id="6ea37-108">Rozložení průchodu je proces matematicky náročných – větší počet podřízených prvků v kolekci, tím větší je počet výpočty potřebné.</span><span class="sxs-lookup"><span data-stu-id="6ea37-108">The layout pass is a mathematically-intensive process—the larger the number of children in the collection, the greater the number of calculations required.</span></span> <span data-ttu-id="6ea37-109">Například pokaždé, když podřízené <xref:System.Windows.UIElement> objekt v kolekci změní pozici, má potenciál k aktivaci nového průchodu systémem rozložení.</span><span class="sxs-lookup"><span data-stu-id="6ea37-109">For example, each time a child <xref:System.Windows.UIElement> object in the collection changes its position, it has the potential to trigger a new pass by the layout system.</span></span> <span data-ttu-id="6ea37-110">Z důvodu zavřít vztah mezi objekt charakteristiky a chování rozložení je důležité si uvědomit, typ události, které můžete vyvolat rozložení systému.</span><span class="sxs-lookup"><span data-stu-id="6ea37-110">Because of the close relationship between object characteristics and layout behavior, it's important to understand the type of events that can invoke the layout system.</span></span> <span data-ttu-id="6ea37-111">Aplikace budou líp fungovat snížením co nejvíce že předat všechny nepotřebné volání rozložení.</span><span class="sxs-lookup"><span data-stu-id="6ea37-111">Your application will perform better by reducing as much as possible any unnecessary invocations of the layout pass.</span></span>  
  
 <span data-ttu-id="6ea37-112">Rozložení systému dokončení dva předává pro každý podřízený člen v kolekci: průchodu měr a předejte uspořádání.</span><span class="sxs-lookup"><span data-stu-id="6ea37-112">The layout system completes two passes for each child member in a collection: a measure pass, and an arrange pass.</span></span> <span data-ttu-id="6ea37-113">Každý podřízený objekt poskytuje vlastní přepsaného implementaci <xref:System.Windows.UIElement.Measure%2A> a <xref:System.Windows.UIElement.Arrange%2A> metody s cílem poskytnout vlastní rozložení konkrétní chování.</span><span class="sxs-lookup"><span data-stu-id="6ea37-113">Each child object provides its own overridden implementation of the <xref:System.Windows.UIElement.Measure%2A> and <xref:System.Windows.UIElement.Arrange%2A> methods in order to provide its own specific layout behavior.</span></span> <span data-ttu-id="6ea37-114">V nejjednodušším rozložení je rekurzivní systém, který vede k element stal velikosti, umístěný a vykreslovány na obrazovce.</span><span class="sxs-lookup"><span data-stu-id="6ea37-114">At its simplest, layout is a recursive system that leads to an element being sized, positioned, and drawn onscreen.</span></span>  
  
-   <span data-ttu-id="6ea37-115">Podřízená <xref:System.Windows.UIElement> objekt zahájí proces rozložení tak, že první jeho základní vlastnosti měří.</span><span class="sxs-lookup"><span data-stu-id="6ea37-115">A child <xref:System.Windows.UIElement> object begins the layout process by first having its core properties measured.</span></span>  
  
-   <span data-ttu-id="6ea37-116">Objektu <xref:System.Windows.FrameworkElement> vlastnosti, které souvisí s velikostí, jako například <xref:System.Windows.FrameworkElement.Width%2A>, <xref:System.Windows.FrameworkElement.Height%2A>, a <xref:System.Windows.FrameworkElement.Margin%2A>, jsou vyhodnocovány.</span><span class="sxs-lookup"><span data-stu-id="6ea37-116">The object's <xref:System.Windows.FrameworkElement> properties that are related to size, such as <xref:System.Windows.FrameworkElement.Width%2A>, <xref:System.Windows.FrameworkElement.Height%2A>, and <xref:System.Windows.FrameworkElement.Margin%2A>, are evaluated.</span></span>  
  
-   <span data-ttu-id="6ea37-117"><xref:System.Windows.Controls.Panel>-určitou logiku platí, jako <xref:System.Windows.Controls.DockPanel.Dock%2A> vlastnost <xref:System.Windows.Controls.DockPanel>, nebo <xref:System.Windows.Controls.StackPanel.Orientation%2A> vlastnost <xref:System.Windows.Controls.StackPanel>.</span><span class="sxs-lookup"><span data-stu-id="6ea37-117"><xref:System.Windows.Controls.Panel>-specific logic is applied, such as the <xref:System.Windows.Controls.DockPanel.Dock%2A> property of the <xref:System.Windows.Controls.DockPanel>, or the <xref:System.Windows.Controls.StackPanel.Orientation%2A> property of the <xref:System.Windows.Controls.StackPanel>.</span></span>  
  
-   <span data-ttu-id="6ea37-118">Obsah je uspořádané nebo umístěný po měří všechny podřízené objekty.</span><span class="sxs-lookup"><span data-stu-id="6ea37-118">Content is arranged, or positioned, after all child objects have been measured.</span></span>  
  
-   <span data-ttu-id="6ea37-119">Kolekce podřízených objektů je znázorněna na obrazovku.</span><span class="sxs-lookup"><span data-stu-id="6ea37-119">The collection of child objects is drawn to the screen.</span></span>  
  
 <span data-ttu-id="6ea37-120">Proces průchodu rozložení je volána znovu, pokud dojde k některé z následujících akcí:</span><span class="sxs-lookup"><span data-stu-id="6ea37-120">The layout pass process is invoked again if any of the following actions occur:</span></span>  
  
-   <span data-ttu-id="6ea37-121">Podřízený objekt se přidá do kolekce.</span><span class="sxs-lookup"><span data-stu-id="6ea37-121">A child object is added to the collection.</span></span>  
  
-   <span data-ttu-id="6ea37-122">A <xref:System.Windows.FrameworkElement.LayoutTransform%2A> se použije pro podřízený objekt.</span><span class="sxs-lookup"><span data-stu-id="6ea37-122">A <xref:System.Windows.FrameworkElement.LayoutTransform%2A> is applied to the child object.</span></span>  
  
-   <span data-ttu-id="6ea37-123"><xref:System.Windows.UIElement.UpdateLayout%2A> Metoda je volána pro podřízený objekt.</span><span class="sxs-lookup"><span data-stu-id="6ea37-123">The <xref:System.Windows.UIElement.UpdateLayout%2A> method is called for the child object.</span></span>  
  
-   <span data-ttu-id="6ea37-124">Když dojde ke změně na hodnotu vlastnosti závislosti, které je označené jako metadat, které mají vliv na míru nebo uspořádat předává.</span><span class="sxs-lookup"><span data-stu-id="6ea37-124">When a change occurs to the value of a dependency property that is marked with metadata affecting the measure or arrange passes.</span></span>  
  
### <a name="use-the-most-efficient-panel-where-possible"></a><span data-ttu-id="6ea37-125">Použijte nejúčinnější Panel, kde je to možné</span><span class="sxs-lookup"><span data-stu-id="6ea37-125">Use the Most Efficient Panel where Possible</span></span>  
 <span data-ttu-id="6ea37-126">Složitost proces rozložení přímo podle chování rozložení <xref:System.Windows.Controls.Panel>-odvozené elementy, které používáte.</span><span class="sxs-lookup"><span data-stu-id="6ea37-126">The complexity of the layout process is directly based on the layout behavior of the <xref:System.Windows.Controls.Panel>-derived elements you use.</span></span> <span data-ttu-id="6ea37-127">Například <xref:System.Windows.Controls.Grid> nebo <xref:System.Windows.Controls.StackPanel> řízení poskytuje mnohem více funkcí než <xref:System.Windows.Controls.Canvas> ovládacího prvku.</span><span class="sxs-lookup"><span data-stu-id="6ea37-127">For example, a <xref:System.Windows.Controls.Grid> or <xref:System.Windows.Controls.StackPanel> control provides much more functionality than a <xref:System.Windows.Controls.Canvas> control.</span></span> <span data-ttu-id="6ea37-128">Ceny pro toto větší zvýšení funkce je větší zvýšení výkonu nákladů.</span><span class="sxs-lookup"><span data-stu-id="6ea37-128">The price for this greater increase in functionality is a greater increase in performance costs.</span></span> <span data-ttu-id="6ea37-129">Ale pokud nechcete, aby funkce, <xref:System.Windows.Controls.Grid> poskytuje ovládací prvek, byste měli používat levněji alternativy, jako například <xref:System.Windows.Controls.Canvas> nebo vlastní panel.</span><span class="sxs-lookup"><span data-stu-id="6ea37-129">However, if you do not require the functionality that a <xref:System.Windows.Controls.Grid> control provides, you should use the less costly alternatives, such as a <xref:System.Windows.Controls.Canvas> or a custom panel.</span></span>  
  
 <span data-ttu-id="6ea37-130">Další informace najdete v tématu [přehled panelů](../../../../docs/framework/wpf/controls/panels-overview.md).</span><span class="sxs-lookup"><span data-stu-id="6ea37-130">For more information, see [Panels Overview](../../../../docs/framework/wpf/controls/panels-overview.md).</span></span>  
  
### <a name="update-rather-than-replace-a-rendertransform"></a><span data-ttu-id="6ea37-131">Aktualizovat spíše než náhradou RenderTransform</span><span class="sxs-lookup"><span data-stu-id="6ea37-131">Update Rather than Replace a RenderTransform</span></span>  
 <span data-ttu-id="6ea37-132">Může být možné aktualizovat <xref:System.Windows.Media.Transform> místo nahrazení jako hodnotu <xref:System.Windows.UIElement.RenderTransform%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="6ea37-132">You may be able to update a <xref:System.Windows.Media.Transform> rather than replacing it as the value of a <xref:System.Windows.UIElement.RenderTransform%2A> property.</span></span> <span data-ttu-id="6ea37-133">To platí hlavně v situacích, které obsahují animace.</span><span class="sxs-lookup"><span data-stu-id="6ea37-133">This is particularly true in scenarios that involve animation.</span></span> <span data-ttu-id="6ea37-134">Při aktualizaci existující <xref:System.Windows.Media.Transform>, se vyhnout inicializaci výpočtu nepotřebné rozložení.</span><span class="sxs-lookup"><span data-stu-id="6ea37-134">By updating an existing <xref:System.Windows.Media.Transform>, you avoid initiating an unnecessary layout calculation.</span></span>  
  
### <a name="build-your-tree-top-down"></a><span data-ttu-id="6ea37-135">Sestavení vaší shora dolů stromu</span><span class="sxs-lookup"><span data-stu-id="6ea37-135">Build Your Tree Top-Down</span></span>  
 <span data-ttu-id="6ea37-136">Pokud uzel je přidat nebo odebrat z logického stromu, vlastnost invalidations jsou vyvolané nadřazeného uzlu a všechny její podřízené položky.</span><span class="sxs-lookup"><span data-stu-id="6ea37-136">When a node is added or removed from the logical tree, property invalidations are raised on the node's parent and all its children.</span></span> <span data-ttu-id="6ea37-137">Vzor konstrukce shora dolů v důsledku toho by měla vždycky dodržet předejdete náklady nepotřebné invalidations na uzly, které již byly ověřeny.</span><span class="sxs-lookup"><span data-stu-id="6ea37-137">As a result, a top-down construction pattern should always be followed to avoid the cost of unnecessary invalidations on nodes that have already been validated.</span></span> <span data-ttu-id="6ea37-138">Následující tabulka ukazuje rozdíl v provádění rychlost mezi vytváření stromu shora dolů a zdola nahoru, kde je stromu 150 úrovní do hloubky s jedním <xref:System.Windows.Controls.TextBlock> a <xref:System.Windows.Controls.DockPanel> na každé úrovni.</span><span class="sxs-lookup"><span data-stu-id="6ea37-138">The following table shows the difference in execution speed between building a tree top-down versus bottom-up, where the tree is 150 levels deep with a single <xref:System.Windows.Controls.TextBlock> and <xref:System.Windows.Controls.DockPanel> at each level.</span></span>  
  
|<span data-ttu-id="6ea37-139">**Akce**</span><span class="sxs-lookup"><span data-stu-id="6ea37-139">**Action**</span></span>|<span data-ttu-id="6ea37-140">**Strom sestavování (v ms)**</span><span class="sxs-lookup"><span data-stu-id="6ea37-140">**Tree building (in ms)**</span></span>|<span data-ttu-id="6ea37-141">**Vykreslení – zahrnuje stromu sestavování (v ms)**</span><span class="sxs-lookup"><span data-stu-id="6ea37-141">**Render—includes tree building (in ms)**</span></span>|  
|----------------|---------------------------------|-------------------------------------------------|  
|<span data-ttu-id="6ea37-142">Zdola nahoru</span><span class="sxs-lookup"><span data-stu-id="6ea37-142">Bottom-up</span></span>|<span data-ttu-id="6ea37-143">366</span><span class="sxs-lookup"><span data-stu-id="6ea37-143">366</span></span>|<span data-ttu-id="6ea37-144">454</span><span class="sxs-lookup"><span data-stu-id="6ea37-144">454</span></span>|  
|<span data-ttu-id="6ea37-145">Shora dolů</span><span class="sxs-lookup"><span data-stu-id="6ea37-145">Top-down</span></span>|<span data-ttu-id="6ea37-146">11</span><span class="sxs-lookup"><span data-stu-id="6ea37-146">11</span></span>|<span data-ttu-id="6ea37-147">96</span><span class="sxs-lookup"><span data-stu-id="6ea37-147">96</span></span>|  
  
 <span data-ttu-id="6ea37-148">Následující příklad kódu ukazuje, jak vytvořit top stromu dolů.</span><span class="sxs-lookup"><span data-stu-id="6ea37-148">The following code example demonstrates how to create a tree top down.</span></span>  
  
 [!code-csharp[Performance#PerformanceSnippet1](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/Window1.xaml.cs#performancesnippet1)]
 [!code-vb[Performance#PerformanceSnippet1](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/Performance/visualbasic/window1.xaml.vb#performancesnippet1)]  
  
 <span data-ttu-id="6ea37-149">Další informace o logickém stromu najdete v tématu [stromy v grafickém subsystému WPF](../../../../docs/framework/wpf/advanced/trees-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="6ea37-149">For more information on the logical tree, see [Trees in WPF](../../../../docs/framework/wpf/advanced/trees-in-wpf.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6ea37-150">Viz také</span><span class="sxs-lookup"><span data-stu-id="6ea37-150">See Also</span></span>  
 [<span data-ttu-id="6ea37-151">Optimalizace výkonu aplikace WPF</span><span class="sxs-lookup"><span data-stu-id="6ea37-151">Optimizing WPF Application Performance</span></span>](../../../../docs/framework/wpf/advanced/optimizing-wpf-application-performance.md)  
 [<span data-ttu-id="6ea37-152">Plánování výkonu aplikace</span><span class="sxs-lookup"><span data-stu-id="6ea37-152">Planning for Application Performance</span></span>](../../../../docs/framework/wpf/advanced/planning-for-application-performance.md)  
 [<span data-ttu-id="6ea37-153">Využití výhod hardwaru</span><span class="sxs-lookup"><span data-stu-id="6ea37-153">Taking Advantage of Hardware</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-taking-advantage-of-hardware.md)  
 [<span data-ttu-id="6ea37-154">2D grafika a obrázky</span><span class="sxs-lookup"><span data-stu-id="6ea37-154">2D Graphics and Imaging</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-2d-graphics-and-imaging.md)  
 [<span data-ttu-id="6ea37-155">Chování objektu</span><span class="sxs-lookup"><span data-stu-id="6ea37-155">Object Behavior</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-object-behavior.md)  
 [<span data-ttu-id="6ea37-156">Prostředky aplikace</span><span class="sxs-lookup"><span data-stu-id="6ea37-156">Application Resources</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-application-resources.md)  
 [<span data-ttu-id="6ea37-157">Text</span><span class="sxs-lookup"><span data-stu-id="6ea37-157">Text</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-text.md)  
 [<span data-ttu-id="6ea37-158">Datová vazba</span><span class="sxs-lookup"><span data-stu-id="6ea37-158">Data Binding</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-data-binding.md)  
 [<span data-ttu-id="6ea37-159">Další výkonnostní doporučení</span><span class="sxs-lookup"><span data-stu-id="6ea37-159">Other Performance Recommendations</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-other-recommendations.md)  
 [<span data-ttu-id="6ea37-160">Rozložení</span><span class="sxs-lookup"><span data-stu-id="6ea37-160">Layout</span></span>](../../../../docs/framework/wpf/advanced/layout.md)
