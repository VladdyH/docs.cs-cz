---
title: Konfigurace parametrů a datové typy parametrů
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-ado
ms.tgt_pltfrm: ''
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
caps.latest.revision: 6
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload:
- dotnet
ms.openlocfilehash: cdb6efb428f5c096178895f95fe1256846e9c1e5
ms.sourcegitcommit: 86adcc06e35390f13c1e372c36d2e044f1fc31ef
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/26/2018
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="f5797-102">Konfigurace parametrů a datové typy parametrů</span><span class="sxs-lookup"><span data-stu-id="f5797-102">Configuring Parameters and Parameter Data Types</span></span>
<span data-ttu-id="f5797-103">Příkaz objekty používají parametry k předání hodnoty do příkazů SQL nebo uložené procedury, kontrola typu a ověření.</span><span class="sxs-lookup"><span data-stu-id="f5797-103">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="f5797-104">Na rozdíl od text příkazu parametr vstup považovat za literálovou hodnotou, ne jako spustitelný kód.</span><span class="sxs-lookup"><span data-stu-id="f5797-104">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="f5797-105">To pomáhá chránit před útoky "Injektáž SQL", ve kterých útočník vloží příkaz tohoto ohrožení zabezpečení na serveru do příkazu SQL.</span><span class="sxs-lookup"><span data-stu-id="f5797-105">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>  
  
 <span data-ttu-id="f5797-106">Parametrizované příkazy můžete také zvýšit výkon provádění dotazů, protože mohou pomoci přesně odpovídat příchozí příkaz s plán správné uložené v mezipaměti dotazu databázový server.</span><span class="sxs-lookup"><span data-stu-id="f5797-106">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="f5797-107">Další informace najdete v tématu [provádění plánování ukládání do mezipaměti a opětovné používání](http://go.microsoft.com/fwlink/?LinkId=120424) a [parametry a provádění plánování opakovaně používat](http://go.microsoft.com/fwlink/?LinkId=120423) v SQL Server Books Online.</span><span class="sxs-lookup"><span data-stu-id="f5797-107">For more information, see [Execution Plan Caching and Reuse](http://go.microsoft.com/fwlink/?LinkId=120424) and [Parameters and Execution Plan Reuse](http://go.microsoft.com/fwlink/?LinkId=120423) in SQL Server Books Online.</span></span> <span data-ttu-id="f5797-108">Kromě výhody zabezpečení a výkonu parametrizované příkazy poskytují vhodnou metodu pro uspořádání předaných ke zdroji dat hodnot.</span><span class="sxs-lookup"><span data-stu-id="f5797-108">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>  
  
 <span data-ttu-id="f5797-109">A <xref:System.Data.Common.DbParameter> objekt může být vytvořen pomocí jeho konstruktoru, nebo jejím přidáním do <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> voláním `Add` metodu <xref:System.Data.Common.DbParameterCollection> kolekce.</span><span class="sxs-lookup"><span data-stu-id="f5797-109">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="f5797-110">`Add` Metoda bude trvat jako vstupní argumenty konstruktoru nebo existujícího objektu parametr, v závislosti na zprostředkovateli data.</span><span class="sxs-lookup"><span data-stu-id="f5797-110">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>  
  
## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="f5797-111">Poskytnutí vlastnost ParameterDirection</span><span class="sxs-lookup"><span data-stu-id="f5797-111">Supplying the ParameterDirection Property</span></span>  
 <span data-ttu-id="f5797-112">Při přidávání parametrů, je nutné zadat <xref:System.Data.ParameterDirection> vlastnost pro parametry než vstupní parametry.</span><span class="sxs-lookup"><span data-stu-id="f5797-112">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="f5797-113">Následující tabulce je zobrazena `ParameterDirection` hodnoty, které můžete použít s <xref:System.Data.ParameterDirection> výčtu.</span><span class="sxs-lookup"><span data-stu-id="f5797-113">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>  
  
|<span data-ttu-id="f5797-114">Název členu</span><span class="sxs-lookup"><span data-stu-id="f5797-114">Member name</span></span>|<span data-ttu-id="f5797-115">Popis</span><span class="sxs-lookup"><span data-stu-id="f5797-115">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="f5797-116">Parametr je vstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="f5797-116">The parameter is an input parameter.</span></span> <span data-ttu-id="f5797-117">Toto nastavení je výchozí.</span><span class="sxs-lookup"><span data-stu-id="f5797-117">This is the default.</span></span>|  
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="f5797-118">Parametr můžete provádět vstup a výstup.</span><span class="sxs-lookup"><span data-stu-id="f5797-118">The parameter can perform both input and output.</span></span>|  
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="f5797-119">Parametr je výstupní parametr.</span><span class="sxs-lookup"><span data-stu-id="f5797-119">The parameter is an output parameter.</span></span>|  
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="f5797-120">Parametr reprezentuje návratovou hodnotu z operace jako jsou uložené procedury, integrovaná funkce nebo uživatelsky definované funkce.</span><span class="sxs-lookup"><span data-stu-id="f5797-120">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|  
  
## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="f5797-121">Práce se zástupnými symboly parametru</span><span class="sxs-lookup"><span data-stu-id="f5797-121">Working with Parameter Placeholders</span></span>  
 <span data-ttu-id="f5797-122">Syntaxe parametru zástupné symboly závisí na zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="f5797-122">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="f5797-123">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Zprostředkovatelé dat zpracování pojmenování a určení parametrů a zástupné symboly parametrů jinak.</span><span class="sxs-lookup"><span data-stu-id="f5797-123">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="f5797-124">Tuto syntaxi upravit tak, aby konkrétní zdroj dat., jak je popsáno v následující tabulce.</span><span class="sxs-lookup"><span data-stu-id="f5797-124">This syntax is customized to a specific data source, as described in the following table.</span></span>  
  
|<span data-ttu-id="f5797-125">Zprostředkovatel dat</span><span class="sxs-lookup"><span data-stu-id="f5797-125">Data provider</span></span>|<span data-ttu-id="f5797-126">Syntaxe parametru pojmenování</span><span class="sxs-lookup"><span data-stu-id="f5797-126">Parameter naming syntax</span></span>|  
|-------------------|-----------------------------|  
|<xref:System.Data.SqlClient>|<span data-ttu-id="f5797-127">Používá pojmenované parametry ve formátu `@` *parametername*.</span><span class="sxs-lookup"><span data-stu-id="f5797-127">Uses named parameters in the format `@`*parametername*.</span></span>|  
|<xref:System.Data.OleDb>|<span data-ttu-id="f5797-128">Používá značky poziční parametr indikován otazník (`?`).</span><span class="sxs-lookup"><span data-stu-id="f5797-128">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.Odbc>|<span data-ttu-id="f5797-129">Používá značky poziční parametr indikován otazník (`?`).</span><span class="sxs-lookup"><span data-stu-id="f5797-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.OracleClient>|<span data-ttu-id="f5797-130">Používá pojmenované parametry ve formátu `:` *parmname* (nebo *parmname*).</span><span class="sxs-lookup"><span data-stu-id="f5797-130">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|  
  
## <a name="specifying-parameter-data-types"></a><span data-ttu-id="f5797-131">Zadání parametru datové typy</span><span class="sxs-lookup"><span data-stu-id="f5797-131">Specifying Parameter Data Types</span></span>  
 <span data-ttu-id="f5797-132">Datový typ parametru je specifické pro [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] dat zprostředkovatele.</span><span class="sxs-lookup"><span data-stu-id="f5797-132">The data type of a parameter is specific to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider.</span></span> <span data-ttu-id="f5797-133">Určení typu převede hodnotu `Parameter` k [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] typ zprostředkovatele dat před předáním hodnota ke zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="f5797-133">Specifying the type converts the value of the `Parameter` to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type before passing the value to the data source.</span></span> <span data-ttu-id="f5797-134">Můžete také určit typ `Parameter` obecné způsobem nastavením `DbType` vlastnost `Parameter` objekt, který má určitý <xref:System.Data.DbType>.</span><span class="sxs-lookup"><span data-stu-id="f5797-134">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>  
  
 <span data-ttu-id="f5797-135">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Datový typ zprostředkovatele `Parameter` objektu je odvozeno z [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] typ `Value` z `Parameter` objekt, nebo z `DbType` z `Parameter` objektu.</span><span class="sxs-lookup"><span data-stu-id="f5797-135">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type of a `Parameter` object is inferred from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="f5797-136">V následující tabulce jsou uvedeny odvozené `Parameter` typ založen na objekt předaný jako `Parameter` hodnotu nebo zadaný `DbType`.</span><span class="sxs-lookup"><span data-stu-id="f5797-136">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>  
  
|<span data-ttu-id="f5797-137">Typ rozhraní .NET Framework</span><span class="sxs-lookup"><span data-stu-id="f5797-137">.NET Framework type</span></span>|<span data-ttu-id="f5797-138">DbType</span><span class="sxs-lookup"><span data-stu-id="f5797-138">DbType</span></span>|<span data-ttu-id="f5797-139">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="f5797-139">SqlDbType</span></span>|<span data-ttu-id="f5797-140">OleDbType</span><span class="sxs-lookup"><span data-stu-id="f5797-140">OleDbType</span></span>|<span data-ttu-id="f5797-141">OdbcType</span><span class="sxs-lookup"><span data-stu-id="f5797-141">OdbcType</span></span>|<span data-ttu-id="f5797-142">OracleType</span><span class="sxs-lookup"><span data-stu-id="f5797-142">OracleType</span></span>|  
|-------------------------|------------|---------------|---------------|--------------|----------------|  
|<xref:System.Boolean>|<span data-ttu-id="f5797-143">Boolean</span><span class="sxs-lookup"><span data-stu-id="f5797-143">Boolean</span></span>|<span data-ttu-id="f5797-144">Bit</span><span class="sxs-lookup"><span data-stu-id="f5797-144">Bit</span></span>|<span data-ttu-id="f5797-145">Boolean</span><span class="sxs-lookup"><span data-stu-id="f5797-145">Boolean</span></span>|<span data-ttu-id="f5797-146">Bit</span><span class="sxs-lookup"><span data-stu-id="f5797-146">Bit</span></span>|<span data-ttu-id="f5797-147">Byte</span><span class="sxs-lookup"><span data-stu-id="f5797-147">Byte</span></span>|  
|<xref:System.Byte>|<span data-ttu-id="f5797-148">Byte</span><span class="sxs-lookup"><span data-stu-id="f5797-148">Byte</span></span>|<span data-ttu-id="f5797-149">TinyInt</span><span class="sxs-lookup"><span data-stu-id="f5797-149">TinyInt</span></span>|<span data-ttu-id="f5797-150">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="f5797-150">UnsignedTinyInt</span></span>|<span data-ttu-id="f5797-151">TinyInt</span><span class="sxs-lookup"><span data-stu-id="f5797-151">TinyInt</span></span>|<span data-ttu-id="f5797-152">Byte</span><span class="sxs-lookup"><span data-stu-id="f5797-152">Byte</span></span>|  
|<span data-ttu-id="f5797-153">Byte</span><span class="sxs-lookup"><span data-stu-id="f5797-153">byte[]</span></span>|<span data-ttu-id="f5797-154">binární</span><span class="sxs-lookup"><span data-stu-id="f5797-154">Binary</span></span>|<span data-ttu-id="f5797-155">VarBinary`.` tento implicitní převod se nezdaří, pokud bajtové pole je větší než maximální velikost parametru VarBinary, což je 8 000 bajtů. Bajtová pole větší než 8 000 bajtů, explicitně nastavit <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="f5797-155">VarBinary`.` This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="f5797-156">VarBinary</span><span class="sxs-lookup"><span data-stu-id="f5797-156">VarBinary</span></span>|<span data-ttu-id="f5797-157">binární</span><span class="sxs-lookup"><span data-stu-id="f5797-157">Binary</span></span>|<span data-ttu-id="f5797-158">Nezpracovaná</span><span class="sxs-lookup"><span data-stu-id="f5797-158">Raw</span></span>|  
|<xref:System.Char>|``|<span data-ttu-id="f5797-159">Odvození <xref:System.Data.SqlDbType> z char není podporován.</span><span class="sxs-lookup"><span data-stu-id="f5797-159">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="f5797-160">Char</span><span class="sxs-lookup"><span data-stu-id="f5797-160">Char</span></span>|<span data-ttu-id="f5797-161">Char</span><span class="sxs-lookup"><span data-stu-id="f5797-161">Char</span></span>|<span data-ttu-id="f5797-162">Byte</span><span class="sxs-lookup"><span data-stu-id="f5797-162">Byte</span></span>|  
|<xref:System.DateTime>|<span data-ttu-id="f5797-163">DateTime</span><span class="sxs-lookup"><span data-stu-id="f5797-163">DateTime</span></span>|<span data-ttu-id="f5797-164">DateTime</span><span class="sxs-lookup"><span data-stu-id="f5797-164">DateTime</span></span>|<span data-ttu-id="f5797-165">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="f5797-165">DBTimeStamp</span></span>|<span data-ttu-id="f5797-166">DateTime</span><span class="sxs-lookup"><span data-stu-id="f5797-166">DateTime</span></span>|<span data-ttu-id="f5797-167">DateTime</span><span class="sxs-lookup"><span data-stu-id="f5797-167">DateTime</span></span>|  
|<xref:System.DateTimeOffset>|<span data-ttu-id="f5797-168">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="f5797-168">DateTimeOffset</span></span>|<span data-ttu-id="f5797-169">Datový typ DateTimeOffset v systému SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="f5797-169">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="f5797-170">Odvození <xref:System.Data.SqlDbType> z DateTimeOffset není podporována ve verzích systému SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="f5797-170">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="f5797-171">DateTime</span><span class="sxs-lookup"><span data-stu-id="f5797-171">DateTime</span></span>|  
|<xref:System.Decimal>|<span data-ttu-id="f5797-172">Desetinné číslo</span><span class="sxs-lookup"><span data-stu-id="f5797-172">Decimal</span></span>|<span data-ttu-id="f5797-173">Desetinné číslo</span><span class="sxs-lookup"><span data-stu-id="f5797-173">Decimal</span></span>|<span data-ttu-id="f5797-174">Desetinné číslo</span><span class="sxs-lookup"><span data-stu-id="f5797-174">Decimal</span></span>|<span data-ttu-id="f5797-175">číselné</span><span class="sxs-lookup"><span data-stu-id="f5797-175">Numeric</span></span>|<span data-ttu-id="f5797-176">Číslo</span><span class="sxs-lookup"><span data-stu-id="f5797-176">Number</span></span>|  
|<xref:System.Double>|<span data-ttu-id="f5797-177">Double</span><span class="sxs-lookup"><span data-stu-id="f5797-177">Double</span></span>|<span data-ttu-id="f5797-178">Plovoucí desetinná čárka</span><span class="sxs-lookup"><span data-stu-id="f5797-178">Float</span></span>|<span data-ttu-id="f5797-179">Double</span><span class="sxs-lookup"><span data-stu-id="f5797-179">Double</span></span>|<span data-ttu-id="f5797-180">Double</span><span class="sxs-lookup"><span data-stu-id="f5797-180">Double</span></span>|<span data-ttu-id="f5797-181">Double</span><span class="sxs-lookup"><span data-stu-id="f5797-181">Double</span></span>|  
|<xref:System.Single>|<span data-ttu-id="f5797-182">Single</span><span class="sxs-lookup"><span data-stu-id="f5797-182">Single</span></span>|<span data-ttu-id="f5797-183">Skutečné</span><span class="sxs-lookup"><span data-stu-id="f5797-183">Real</span></span>|<span data-ttu-id="f5797-184">Single</span><span class="sxs-lookup"><span data-stu-id="f5797-184">Single</span></span>|<span data-ttu-id="f5797-185">Skutečné</span><span class="sxs-lookup"><span data-stu-id="f5797-185">Real</span></span>|<span data-ttu-id="f5797-186">Plovoucí desetinná čárka</span><span class="sxs-lookup"><span data-stu-id="f5797-186">Float</span></span>|  
|<xref:System.Guid>|<span data-ttu-id="f5797-187">Identifikátor GUID</span><span class="sxs-lookup"><span data-stu-id="f5797-187">Guid</span></span>|<span data-ttu-id="f5797-188">Typ UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="f5797-188">UniqueIdentifier</span></span>|<span data-ttu-id="f5797-189">Identifikátor GUID</span><span class="sxs-lookup"><span data-stu-id="f5797-189">Guid</span></span>|<span data-ttu-id="f5797-190">Typ UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="f5797-190">UniqueIdentifier</span></span>|<span data-ttu-id="f5797-191">Nezpracovaná</span><span class="sxs-lookup"><span data-stu-id="f5797-191">Raw</span></span>|  
|<xref:System.Int16 >|<span data-ttu-id="f5797-192">Int16</span><span class="sxs-lookup"><span data-stu-id="f5797-192">Int16</span></span>|<span data-ttu-id="f5797-193">SmallInt</span><span class="sxs-lookup"><span data-stu-id="f5797-193">SmallInt</span></span>|<span data-ttu-id="f5797-194">SmallInt</span><span class="sxs-lookup"><span data-stu-id="f5797-194">SmallInt</span></span>|<span data-ttu-id="f5797-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="f5797-195">SmallInt</span></span>|<span data-ttu-id="f5797-196">Int16</span><span class="sxs-lookup"><span data-stu-id="f5797-196">Int16</span></span>|  
|<xref:System.Int32>|<span data-ttu-id="f5797-197">Int32</span><span class="sxs-lookup"><span data-stu-id="f5797-197">Int32</span></span>|<span data-ttu-id="f5797-198">celá čísla</span><span class="sxs-lookup"><span data-stu-id="f5797-198">Int</span></span>|<span data-ttu-id="f5797-199">celá čísla</span><span class="sxs-lookup"><span data-stu-id="f5797-199">Int</span></span>|<span data-ttu-id="f5797-200">celá čísla</span><span class="sxs-lookup"><span data-stu-id="f5797-200">Int</span></span>|<span data-ttu-id="f5797-201">Int32</span><span class="sxs-lookup"><span data-stu-id="f5797-201">Int32</span></span>|  
|<xref:System.Int64>|<span data-ttu-id="f5797-202">Int64</span><span class="sxs-lookup"><span data-stu-id="f5797-202">Int64</span></span>|<span data-ttu-id="f5797-203">BigInt</span><span class="sxs-lookup"><span data-stu-id="f5797-203">BigInt</span></span>|<span data-ttu-id="f5797-204">BigInt</span><span class="sxs-lookup"><span data-stu-id="f5797-204">BigInt</span></span>|<span data-ttu-id="f5797-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="f5797-205">BigInt</span></span>|<span data-ttu-id="f5797-206">Číslo</span><span class="sxs-lookup"><span data-stu-id="f5797-206">Number</span></span>|  
|<xref:System.Object>|<span data-ttu-id="f5797-207">Objekt</span><span class="sxs-lookup"><span data-stu-id="f5797-207">Object</span></span>|<span data-ttu-id="f5797-208">Variant</span><span class="sxs-lookup"><span data-stu-id="f5797-208">Variant</span></span>|<span data-ttu-id="f5797-209">Variant</span><span class="sxs-lookup"><span data-stu-id="f5797-209">Variant</span></span>|<span data-ttu-id="f5797-210">Odvození OdbcType: z objektu není podporováno.</span><span class="sxs-lookup"><span data-stu-id="f5797-210">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="f5797-211">Objekt BLOB</span><span class="sxs-lookup"><span data-stu-id="f5797-211">Blob</span></span>|  
|<xref:System.String>|<span data-ttu-id="f5797-212">String</span><span class="sxs-lookup"><span data-stu-id="f5797-212">String</span></span>|<span data-ttu-id="f5797-213">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="f5797-213">NVarChar.</span></span> <span data-ttu-id="f5797-214">Tento implicitní převod se nezdaří, pokud řetězec je větší než maximální velikost NVarChar, což je 4 000 znaků.</span><span class="sxs-lookup"><span data-stu-id="f5797-214">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="f5797-215">Pro větší než 4 000 znaků řetězce, explicitně nastavit <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="f5797-215">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="f5797-216">VarWChar</span><span class="sxs-lookup"><span data-stu-id="f5797-216">VarWChar</span></span>|<span data-ttu-id="f5797-217">NVarChar</span><span class="sxs-lookup"><span data-stu-id="f5797-217">NVarChar</span></span>|<span data-ttu-id="f5797-218">NVarChar</span><span class="sxs-lookup"><span data-stu-id="f5797-218">NVarChar</span></span>|  
|<xref:System.TimeSpan>|<span data-ttu-id="f5797-219">Čas</span><span class="sxs-lookup"><span data-stu-id="f5797-219">Time</span></span>|<span data-ttu-id="f5797-220">Čas v systému SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="f5797-220">Time in SQL Server 2008.</span></span> <span data-ttu-id="f5797-221">Odvození <xref:System.Data.SqlDbType> z časový interval, není podporována ve verzích systému SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="f5797-221">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="f5797-222">DBTime</span><span class="sxs-lookup"><span data-stu-id="f5797-222">DBTime</span></span>|<span data-ttu-id="f5797-223">Čas</span><span class="sxs-lookup"><span data-stu-id="f5797-223">Time</span></span>|<span data-ttu-id="f5797-224">DateTime</span><span class="sxs-lookup"><span data-stu-id="f5797-224">DateTime</span></span>|  
|<xref:System.UInt16>|<span data-ttu-id="f5797-225">UInt16</span><span class="sxs-lookup"><span data-stu-id="f5797-225">UInt16</span></span>|<span data-ttu-id="f5797-226">Odvození <xref:System.Data.SqlDbType> z UInt16 není podporován.</span><span class="sxs-lookup"><span data-stu-id="f5797-226">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="f5797-227">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="f5797-227">UnsignedSmallInt</span></span>|<span data-ttu-id="f5797-228">celá čísla</span><span class="sxs-lookup"><span data-stu-id="f5797-228">Int</span></span>|<span data-ttu-id="f5797-229">UInt16</span><span class="sxs-lookup"><span data-stu-id="f5797-229">UInt16</span></span>|  
|<xref:System.UInt32>|<span data-ttu-id="f5797-230">UInt32</span><span class="sxs-lookup"><span data-stu-id="f5797-230">UInt32</span></span>|<span data-ttu-id="f5797-231">Odvození <xref:System.Data.SqlDbType> z UInt32 není podporován.</span><span class="sxs-lookup"><span data-stu-id="f5797-231">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="f5797-232">celé číslo bez znaménka</span><span class="sxs-lookup"><span data-stu-id="f5797-232">UnsignedInt</span></span>|<span data-ttu-id="f5797-233">BigInt</span><span class="sxs-lookup"><span data-stu-id="f5797-233">BigInt</span></span>|<span data-ttu-id="f5797-234">UInt32</span><span class="sxs-lookup"><span data-stu-id="f5797-234">UInt32</span></span>|  
|<xref:System.UInt64>|<span data-ttu-id="f5797-235">UInt64</span><span class="sxs-lookup"><span data-stu-id="f5797-235">UInt64</span></span>|<span data-ttu-id="f5797-236">Odvození <xref:System.Data.SqlDbType> z UInt64 není podporován.</span><span class="sxs-lookup"><span data-stu-id="f5797-236">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="f5797-237">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="f5797-237">UnsignedBigInt</span></span>|<span data-ttu-id="f5797-238">číselné</span><span class="sxs-lookup"><span data-stu-id="f5797-238">Numeric</span></span>|<span data-ttu-id="f5797-239">Číslo</span><span class="sxs-lookup"><span data-stu-id="f5797-239">Number</span></span>|  
||<span data-ttu-id="f5797-240">AnsiString</span><span class="sxs-lookup"><span data-stu-id="f5797-240">AnsiString</span></span>|<span data-ttu-id="f5797-241">VarChar</span><span class="sxs-lookup"><span data-stu-id="f5797-241">VarChar</span></span>|<span data-ttu-id="f5797-242">VarChar</span><span class="sxs-lookup"><span data-stu-id="f5797-242">VarChar</span></span>|<span data-ttu-id="f5797-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="f5797-243">VarChar</span></span>|<span data-ttu-id="f5797-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="f5797-244">VarChar</span></span>|  
||<span data-ttu-id="f5797-245">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="f5797-245">AnsiStringFixedLength</span></span>|<span data-ttu-id="f5797-246">Char</span><span class="sxs-lookup"><span data-stu-id="f5797-246">Char</span></span>|<span data-ttu-id="f5797-247">Char</span><span class="sxs-lookup"><span data-stu-id="f5797-247">Char</span></span>|<span data-ttu-id="f5797-248">Char</span><span class="sxs-lookup"><span data-stu-id="f5797-248">Char</span></span>|<span data-ttu-id="f5797-249">Char</span><span class="sxs-lookup"><span data-stu-id="f5797-249">Char</span></span>|  
|``|<span data-ttu-id="f5797-250">Měna</span><span class="sxs-lookup"><span data-stu-id="f5797-250">Currency</span></span>|<span data-ttu-id="f5797-251">peníze</span><span class="sxs-lookup"><span data-stu-id="f5797-251">Money</span></span>|<span data-ttu-id="f5797-252">Měna</span><span class="sxs-lookup"><span data-stu-id="f5797-252">Currency</span></span>|<span data-ttu-id="f5797-253">Odvození `OdbcType` z `Currency` není podporován.</span><span class="sxs-lookup"><span data-stu-id="f5797-253">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="f5797-254">Číslo</span><span class="sxs-lookup"><span data-stu-id="f5797-254">Number</span></span>|  
|``|<span data-ttu-id="f5797-255">Datum</span><span class="sxs-lookup"><span data-stu-id="f5797-255">Date</span></span>|<span data-ttu-id="f5797-256">Datum v systému SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="f5797-256">Date in SQL Server 2008.</span></span> <span data-ttu-id="f5797-257">Odvození <xref:System.Data.SqlDbType> od data není podporována ve verzích systému SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="f5797-257">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="f5797-258">DBDate</span><span class="sxs-lookup"><span data-stu-id="f5797-258">DBDate</span></span>|<span data-ttu-id="f5797-259">Datum</span><span class="sxs-lookup"><span data-stu-id="f5797-259">Date</span></span>|<span data-ttu-id="f5797-260">DateTime</span><span class="sxs-lookup"><span data-stu-id="f5797-260">DateTime</span></span>|  
|``|<span data-ttu-id="f5797-261">SByte</span><span class="sxs-lookup"><span data-stu-id="f5797-261">SByte</span></span>|<span data-ttu-id="f5797-262">Odvození <xref:System.Data.SqlDbType> z SByte není podporován.</span><span class="sxs-lookup"><span data-stu-id="f5797-262">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="f5797-263">TinyInt</span><span class="sxs-lookup"><span data-stu-id="f5797-263">TinyInt</span></span>|<span data-ttu-id="f5797-264">Odvození `OdbcType` z SByte není podporován.</span><span class="sxs-lookup"><span data-stu-id="f5797-264">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="f5797-265">SByte</span><span class="sxs-lookup"><span data-stu-id="f5797-265">SByte</span></span>|  
||<span data-ttu-id="f5797-266">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="f5797-266">StringFixedLength</span></span>|<span data-ttu-id="f5797-267">NChar</span><span class="sxs-lookup"><span data-stu-id="f5797-267">NChar</span></span>|<span data-ttu-id="f5797-268">WChar</span><span class="sxs-lookup"><span data-stu-id="f5797-268">WChar</span></span>|<span data-ttu-id="f5797-269">NChar</span><span class="sxs-lookup"><span data-stu-id="f5797-269">NChar</span></span>|<span data-ttu-id="f5797-270">NChar</span><span class="sxs-lookup"><span data-stu-id="f5797-270">NChar</span></span>|  
||<span data-ttu-id="f5797-271">Čas</span><span class="sxs-lookup"><span data-stu-id="f5797-271">Time</span></span>|<span data-ttu-id="f5797-272">Čas v systému SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="f5797-272">Time in SQL Server 2008.</span></span> <span data-ttu-id="f5797-273">Odvození <xref:System.Data.SqlDbType> od času není podporována ve verzích systému SQL Server starších než SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="f5797-273">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="f5797-274">DBTime</span><span class="sxs-lookup"><span data-stu-id="f5797-274">DBTime</span></span>|<span data-ttu-id="f5797-275">Čas</span><span class="sxs-lookup"><span data-stu-id="f5797-275">Time</span></span>|<span data-ttu-id="f5797-276">DateTime</span><span class="sxs-lookup"><span data-stu-id="f5797-276">DateTime</span></span>|  
||<span data-ttu-id="f5797-277">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="f5797-277">VarNumeric</span></span>|<span data-ttu-id="f5797-278">Odvození <xref:System.Data.SqlDbType> z VarNumeric není podporován.</span><span class="sxs-lookup"><span data-stu-id="f5797-278">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="f5797-279">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="f5797-279">VarNumeric</span></span>|<span data-ttu-id="f5797-280">Odvození `OdbcType` z VarNumeric není podporován.</span><span class="sxs-lookup"><span data-stu-id="f5797-280">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="f5797-281">Číslo</span><span class="sxs-lookup"><span data-stu-id="f5797-281">Number</span></span>|  
|<span data-ttu-id="f5797-282">uživatelem definovaný typ (objekt s <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span><span class="sxs-lookup"><span data-stu-id="f5797-282">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="f5797-283">Objekt nebo řetězec, v závislosti zprostředkovatele (SqlClient vždy vrátí hodnotu, k objektu, Odbc vždy vrátí řetězec, zprostředkovatele služeb OleDb spravovaná data můžete zobrazit buď</span><span class="sxs-lookup"><span data-stu-id="f5797-283">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="f5797-284">SqlDbType.Udt Pokud <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> je přítomen, jinak hodnota typu Variant</span><span class="sxs-lookup"><span data-stu-id="f5797-284">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="f5797-285">OleDbType.VarWChar (Pokud je hodnota null) jinak OleDbType.Variant.</span><span class="sxs-lookup"><span data-stu-id="f5797-285">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="f5797-286">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="f5797-286">OdbcType.NVarChar</span></span>|<span data-ttu-id="f5797-287">Nepodporuje se</span><span class="sxs-lookup"><span data-stu-id="f5797-287">not supported</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="f5797-288">Převody z decimal na jiné typy jsou zužující převody, které zaokrouhlit Desítková hodnota směrem k nule na nejbližší celé číslo.</span><span class="sxs-lookup"><span data-stu-id="f5797-288">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="f5797-289">Pokud není výsledek převodu reprezentovat cílového typu, <xref:System.OverflowException> je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="f5797-289">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f5797-290">Hodnota null parametru odešlete na server, je nutné zadat <xref:System.DBNull>, nikoli `null` (`Nothing` v jazyce Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="f5797-290">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="f5797-291">Nulová hodnota v systému je prázdný objekt, který nemá žádnou hodnotu.</span><span class="sxs-lookup"><span data-stu-id="f5797-291">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="f5797-292"><xref:System.DBNull> slouží k reprezentaci hodnoty null.</span><span class="sxs-lookup"><span data-stu-id="f5797-292"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="f5797-293">Další informace o hodnoty Null databáze najdete v tématu [zpracování hodnot Null](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="f5797-293">For more information about database nulls, see [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span></span>  
  
## <a name="deriving-parameter-information"></a><span data-ttu-id="f5797-294">Odvozování informace o parametrech</span><span class="sxs-lookup"><span data-stu-id="f5797-294">Deriving Parameter Information</span></span>  
 <span data-ttu-id="f5797-295">Parametry lze také odvodit z pomocí uložené procedury `DbCommandBuilder` třídy.</span><span class="sxs-lookup"><span data-stu-id="f5797-295">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="f5797-296">Jak `SqlCommandBuilder` a `OleDbCommandBuilder` třídy zadejte statickou metodu `DeriveParameters`, který automaticky naplní kolekci parametrů příkazu objektu, který používá informace o parametrech z uložené procedury.</span><span class="sxs-lookup"><span data-stu-id="f5797-296">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="f5797-297">Všimněte si, že `DeriveParameters` přepíše všechny stávající informace o parametr pro příkaz.</span><span class="sxs-lookup"><span data-stu-id="f5797-297">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f5797-298">Odvozování informace o parametrech způsobuje snížení výkonu, protože vyžaduje další odezvy ke zdroji dat a načte informace.</span><span class="sxs-lookup"><span data-stu-id="f5797-298">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="f5797-299">Pokud se informace o parametrech označuje v době návrhu, může zvýšit výkon vaší aplikace explicitně nastavením parametry.</span><span class="sxs-lookup"><span data-stu-id="f5797-299">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>  
  
 <span data-ttu-id="f5797-300">Další informace najdete v tématu [generování příkazů s CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="f5797-300">For more information, see [Generating Commands with CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span></span>  
  
## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="f5797-301">Použití parametrů SqlCommand a uložené procedury</span><span class="sxs-lookup"><span data-stu-id="f5797-301">Using Parameters with a SqlCommand and a Stored Procedure</span></span>  
 <span data-ttu-id="f5797-302">Uložené procedury nabízí celou řadu výhod v datové aplikace.</span><span class="sxs-lookup"><span data-stu-id="f5797-302">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="f5797-303">Pomocí uložené procedury databázových operací může být zapouzdřené v příkazu, optimalizované pro nejlepší výkon a rozšířené o zvýšení zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="f5797-303">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="f5797-304">I když uložené procedury nelze volat pomocí předání název uložené procedury následuje argumenty parametrů jako příkaz SQL pomocí <xref:System.Data.Common.DbCommand.Parameters%2A> kolekce [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> objektu umožňuje více explicitně definovat uložené Parametry procedur a pro přístup k výstupní parametry a návratové hodnoty.</span><span class="sxs-lookup"><span data-stu-id="f5797-304">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f5797-305">Parametrizované příkazy jsou spouštěny na serveru pomocí `sp_executesql,` což umožňuje pro opakované použití plánu dotazu.</span><span class="sxs-lookup"><span data-stu-id="f5797-305">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="f5797-306">Místní kurzory nebo proměnných v `sp_executesql` dávky nejsou viditelné pro dávky, která volá `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="f5797-306">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="f5797-307">Změny v kontextu databáze poslední pouze na konci `sp_executesql` příkaz.</span><span class="sxs-lookup"><span data-stu-id="f5797-307">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="f5797-308">Další informace najdete v tématu SQL Server Books Online.</span><span class="sxs-lookup"><span data-stu-id="f5797-308">For more information, see SQL Server Books Online.</span></span>  
  
 <span data-ttu-id="f5797-309">Při použití parametrů s <xref:System.Data.SqlClient.SqlCommand> spuštění systému SQL Server uložené procedury, názvy parametrů přidán do <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> kolekce musí odpovídat názvům značek parametrů v uložené proceduře.</span><span class="sxs-lookup"><span data-stu-id="f5797-309">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="f5797-310">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider pro SQL Server nepodporuje zástupné znaky otazníku (?) pro předávání parametrů příkazu SQL nebo uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="f5797-310">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="f5797-311">Ho pracuje s parametry v uložené proceduře jako pojmenované parametry a hledá odpovídající parametr značek.</span><span class="sxs-lookup"><span data-stu-id="f5797-311">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="f5797-312">Například `CustOrderHist` uložená procedura se definuje pomocí parametr s názvem `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="f5797-312">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="f5797-313">Když váš kód provede uloženou proceduru, musíte také použít parametr s názvem `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="f5797-313">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>  
  
```  
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)  
```  
  
### <a name="example"></a><span data-ttu-id="f5797-314">Příklad</span><span class="sxs-lookup"><span data-stu-id="f5797-314">Example</span></span>  
 <span data-ttu-id="f5797-315">Tento příklad ukazuje, jak volání procedury, SQL Server, které jsou uložené `Northwind` ukázkové databáze.</span><span class="sxs-lookup"><span data-stu-id="f5797-315">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="f5797-316">Název uložené procedury je `dbo.SalesByCategory` a má vstupní parametr s názvem `@CategoryName` s typem dat `nvarchar(15)`.</span><span class="sxs-lookup"><span data-stu-id="f5797-316">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="f5797-317">Kód vytvoří novou <xref:System.Data.SqlClient.SqlConnection> uvnitř pomocí blokovat tak, aby připojení je uvolněno při ukončení procesu.</span><span class="sxs-lookup"><span data-stu-id="f5797-317">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="f5797-318"><xref:System.Data.SqlClient.SqlCommand> a <xref:System.Data.SqlClient.SqlParameter> objekty jsou vytvořené a nastavte jejich vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="f5797-318">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="f5797-319">A <xref:System.Data.SqlClient.SqlDataReader> provede `SqlCommand` a vrátí výsledek nastavit z uložené procedury, zobrazení výstupu v okně konzoly.</span><span class="sxs-lookup"><span data-stu-id="f5797-319">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f5797-320">Místo vytváření `SqlCommand` a `SqlParameter` objekty a pak nastavení vlastnosti v samostatných příkazů, můžete místo toho vybrat, zda použít jednu z přetížené konstruktory pro nastavení více vlastností v jediném příkazu.</span><span class="sxs-lookup"><span data-stu-id="f5797-320">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>  
  
 [!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
 [!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]  
  
## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="f5797-321">Pomocí parametrů s OleDbCommand nebo OdbcCommand</span><span class="sxs-lookup"><span data-stu-id="f5797-321">Using Parameters with an OleDbCommand or OdbcCommand</span></span>  
 <span data-ttu-id="f5797-322">Při použití parametrů s <xref:System.Data.OleDb.OleDbCommand> nebo <xref:System.Data.Odbc.OdbcCommand>, pořadí parametrů přidán do `Parameters` kolekce musí odpovídat pořadí parametrů definovaných v uložené proceduře.</span><span class="sxs-lookup"><span data-stu-id="f5797-322">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="f5797-323">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Zprostředkovatele dat pro OLE DB a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] zprostředkovatele dat pro ODBC zpracování parametrů v uložené proceduře jako zástupné symboly a použít hodnoty parametrů v pořadí.</span><span class="sxs-lookup"><span data-stu-id="f5797-323">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="f5797-324">Kromě toho vrátí parametry s hodnotou musí být první parametry přidán do `Parameters` kolekce.</span><span class="sxs-lookup"><span data-stu-id="f5797-324">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>  
  
 <span data-ttu-id="f5797-325">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Zprostředkovatele dat pro OLE DB a [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] zprostředkovatele dat pro ODBC nepodporují pojmenované parametry pro předávání parametrů příkazu SQL nebo uloženou proceduru.</span><span class="sxs-lookup"><span data-stu-id="f5797-325">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="f5797-326">V takovém případě musíte použít zástupné znaky otazníku (?), jako v následujícím příkladu.</span><span class="sxs-lookup"><span data-stu-id="f5797-326">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>  
  
```  
SELECT * FROM Customers WHERE CustomerID = ?  
```  
  
 <span data-ttu-id="f5797-327">V důsledku toho, v jakém pořadí `Parameter` objekty jsou přidány na `Parameters` kolekce musí odpovídat přímo pozici?</span><span class="sxs-lookup"><span data-stu-id="f5797-327">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="f5797-328">Zástupný symbol pro parametr.</span><span class="sxs-lookup"><span data-stu-id="f5797-328">placeholder for the parameter.</span></span>  
  
### <a name="oledb-example"></a><span data-ttu-id="f5797-329">Příklad OleDb</span><span class="sxs-lookup"><span data-stu-id="f5797-329">OleDb Example</span></span>  
  
```vb  
Dim command As OleDbCommand = New OleDbCommand( _  
  "SampleProc", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OleDbParameter = command.Parameters.Add( _  
  "RETURN_VALUE", OleDbType.Integer)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OleDbType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OleDbType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OleDbCommand command = new OleDbCommand("SampleProc", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OleDbParameter parameter = command.Parameters.Add(  
  "RETURN_VALUE", OleDbType.Integer);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add(  
  "@InputParm", OleDbType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add(  
  "@OutputParm", OleDbType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="odbc-example"></a><span data-ttu-id="f5797-330">Příklad rozhraní ODBC</span><span class="sxs-lookup"><span data-stu-id="f5797-330">Odbc Example</span></span>  
  
```vb  
Dim command As OdbcCommand = New OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OdbcCommand command = new OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OdbcParameter parameter = command.Parameters.Add( _  
  "RETURN_VALUE", OdbcType.Int);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="see-also"></a><span data-ttu-id="f5797-331">Viz také</span><span class="sxs-lookup"><span data-stu-id="f5797-331">See Also</span></span>  
 [<span data-ttu-id="f5797-332">Příkazy a parametry</span><span class="sxs-lookup"><span data-stu-id="f5797-332">Commands and Parameters</span></span>](../../../../docs/framework/data/adonet/commands-and-parameters.md)  
 [<span data-ttu-id="f5797-333">Parametry adaptéru dat</span><span class="sxs-lookup"><span data-stu-id="f5797-333">DataAdapter Parameters</span></span>](../../../../docs/framework/data/adonet/dataadapter-parameters.md)  
 [<span data-ttu-id="f5797-334">Mapování datového typu v ADO.NET</span><span class="sxs-lookup"><span data-stu-id="f5797-334">Data Type Mappings in ADO.NET</span></span>](../../../../docs/framework/data/adonet/data-type-mappings-in-ado-net.md)  
 [<span data-ttu-id="f5797-335">ADO.NET spravované zprostředkovatelé a středisku pro vývojáře datové sady</span><span class="sxs-lookup"><span data-stu-id="f5797-335">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
