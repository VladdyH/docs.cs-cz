---
title: 'Postupy: uložení a znovu používat dotazy'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: a012bd79-1809-45e3-adea-0229532396cc
ms.openlocfilehash: a2d16cd5dce033c563783a0882f3de73194cf2d1
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/04/2018
ms.locfileid: "33360135"
---
# <a name="how-to-store-and-reuse-queries"></a><span data-ttu-id="ca997-102">Postupy: uložení a znovu používat dotazy</span><span class="sxs-lookup"><span data-stu-id="ca997-102">How to: Store and Reuse Queries</span></span>
<span data-ttu-id="ca997-103">Když máte aplikaci, která provádí mnohokrát strukturálně podobné dotazy, můžete zvýšit výkon často kompilování dotazu jednou a spouštění s odlišnými parametry několikrát.</span><span class="sxs-lookup"><span data-stu-id="ca997-103">When you have an application that executes structurally similar queries many times, you can often increase performance by compiling the query one time and executing it several times with different parameters.</span></span> <span data-ttu-id="ca997-104">Například aplikace může mít načíst všechny zákazníky, kteří jsou z určitého města, kde je zadán Město v době běhu uživatelem ve formuláři.</span><span class="sxs-lookup"><span data-stu-id="ca997-104">For example, an application might have to retrieve all the customers who are in a particular city, where the city is specified at runtime by the user in a form.</span></span> [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="ca997-105"> podporuje použití *zkompilovat dotazy* pro tento účel.</span><span class="sxs-lookup"><span data-stu-id="ca997-105"> supports the use of *compiled queries* for this purpose.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ca997-106">Tento vzor využití představuje nejčastěji používá pro kompilované dotazy.</span><span class="sxs-lookup"><span data-stu-id="ca997-106">This pattern of usage represents the most common use for compiled queries.</span></span> <span data-ttu-id="ca997-107">Jiné postupy je možné.</span><span class="sxs-lookup"><span data-stu-id="ca997-107">Other approaches are possible.</span></span> <span data-ttu-id="ca997-108">Například kompilované dotazy mohou být uloženy jako statické členy na částečné třídu, která rozšiřuje kód vygenerovaný návrháře.</span><span class="sxs-lookup"><span data-stu-id="ca997-108">For example, compiled queries can be stored as static members on a partial class that extends the code generated by the designer.</span></span>  
  
## <a name="example"></a><span data-ttu-id="ca997-109">Příklad</span><span class="sxs-lookup"><span data-stu-id="ca997-109">Example</span></span>  
 <span data-ttu-id="ca997-110">V mnoha případech můžete chtít znovu používat dotazy napříč hranicemi přístup z více vláken.</span><span class="sxs-lookup"><span data-stu-id="ca997-110">In many scenarios you might want to reuse the queries across thread boundaries.</span></span> <span data-ttu-id="ca997-111">V takových případech je zvláště efektivní ukládání kompilované dotazy v statické proměnné.</span><span class="sxs-lookup"><span data-stu-id="ca997-111">In such cases, storing the compiled queries in static variables is especially effective.</span></span> <span data-ttu-id="ca997-112">Následující příklad kódu předpokládá `Queries` třída určená k uložení zkompilovat dotazy a předpokládá Northwind třída, která představuje silného typu <xref:System.Data.Linq.DataContext>.</span><span class="sxs-lookup"><span data-stu-id="ca997-112">The following code example assumes a `Queries` class designed to store compiled queries, and assumes a Northwind class that represents a strongly typed <xref:System.Data.Linq.DataContext>.</span></span>  
  
 [!code-csharp[DLinqQuerying#6](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#6)]
 [!code-vb[DLinqQuerying#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#6)]  
  
 [!code-csharp[DLinqQuerying#7](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#7)]
 [!code-vb[DLinqQuerying#7](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#7)]  
  
## <a name="example"></a><span data-ttu-id="ca997-113">Příklad</span><span class="sxs-lookup"><span data-stu-id="ca997-113">Example</span></span>  
 <span data-ttu-id="ca997-114">Nemůžete aktuálně dotazy úložiště (v statické proměnné), které vracejí *anonymního typu*, protože typ nemá název zajistit jako obecný argument.</span><span class="sxs-lookup"><span data-stu-id="ca997-114">You cannot currently store (in static variables) queries that return an *anonymous type*, because type has no name to provide as a generic argument.</span></span> <span data-ttu-id="ca997-115">Následující příklad ukazuje, jak můžete tento problém obejít tím, že vytvoříte typ, který může představovat výsledek a použít jej jako obecný argument.</span><span class="sxs-lookup"><span data-stu-id="ca997-115">The following example shows how you can work around the issue by creating a type that can represent the result, and then use it as a generic argument.</span></span>  
  
 [!code-csharp[DLinqQuerying#8](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqQuerying/cs/Program.cs#8)]
 [!code-vb[DLinqQuerying#8](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqQuerying/vb/Module1.vb#8)]  
  
## <a name="see-also"></a><span data-ttu-id="ca997-116">Viz také</span><span class="sxs-lookup"><span data-stu-id="ca997-116">See Also</span></span>  
 <xref:System.Data.Linq.CompiledQuery>  
 [<span data-ttu-id="ca997-117">Koncepty dotazů</span><span class="sxs-lookup"><span data-stu-id="ca997-117">Query Concepts</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/query-concepts.md)  
 [<span data-ttu-id="ca997-118">Dotazování na databázi</span><span class="sxs-lookup"><span data-stu-id="ca997-118">Querying the Database</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md)
