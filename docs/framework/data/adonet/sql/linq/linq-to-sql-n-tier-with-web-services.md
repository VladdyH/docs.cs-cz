---
title: "Technologie LINQ to SQL N-vrstvá s webovými službami"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 9cb10eb8-957f-4beb-a271-5f682016fed2
caps.latest.revision: "3"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: 79b9b1270f99720dec6b6369706f8a2f601d249e
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/19/2018
---
# <a name="linq-to-sql-n-tier-with-web-services"></a><span data-ttu-id="fd6ac-102">Technologie LINQ to SQL N-vrstvá s webovými službami</span><span class="sxs-lookup"><span data-stu-id="fd6ac-102">LINQ to SQL N-Tier with Web Services</span></span>
[!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="fd6ac-103">je určený pro použití na střední vrstvy v vrstva přístupu k datům volně vázány (DAL), třeba webové služby.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-103"> is designed especially for use on the middle tier in a loosely-coupled data access layer (DAL) such as a Web service.</span></span> <span data-ttu-id="fd6ac-104">Pokud prezentační vrstvou se webovou stránku ASP.NET, pak použijete <xref:System.Web.UI.WebControls.LinqDataSource> ovládacího prvku webového serveru ke správě přenosů dat mezi uživatelské rozhraní a [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] na střední vrstvě.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-104">If the presentation tier is an ASP.NET Web page, then you use the <xref:System.Web.UI.WebControls.LinqDataSource> Web server control to manage the data transfer between the user interface and [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] on the middle-tier.</span></span> <span data-ttu-id="fd6ac-105">Pokud prezentační vrstvou není stránku ASP.NET, pak střední vrstvě a prezentační vrstvou musí používat ke správě serializace a deserializace dat některé další kroky.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-105">If the presentation tier is not an ASP.NET page, then both the middle-tier and the presentation tier must do some additional work to manage the serialization and deserialization of data.</span></span>  
  
## <a name="setting-up-linq-to-sql-on-the-middle-tier"></a><span data-ttu-id="fd6ac-106">Nastavení technologie LINQ to SQL na střední vrstvy</span><span class="sxs-lookup"><span data-stu-id="fd6ac-106">Setting up LINQ to SQL on the Middle Tier</span></span>  
 <span data-ttu-id="fd6ac-107">Ve webové služby nebo vícevrstvé aplikace bude prostřední vrstva obsahuje kontextu dat a tříd entit.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-107">In a Web service or n-tier application, the middle tier contains the data context and the entity classes.</span></span> <span data-ttu-id="fd6ac-108">Tyto třídy můžete vytvořit ručně nebo pomocí buď SQLMetal.exe nebo [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] jak je popsáno na jiném místě v dokumentaci.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-108">You can create these classes manually, or by using either SQLMetal.exe or the [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)] as described elsewhere in the documentation.</span></span> <span data-ttu-id="fd6ac-109">V době návrhu máte možnost provést serializovatelné třídy entity.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-109">At design time, you have the option to make the entity classes serializable.</span></span> <span data-ttu-id="fd6ac-110">Další informace najdete v tématu [postup: Zkontrolujte serializovatelný entity](../../../../../../docs/framework/data/adonet/sql/linq/how-to-make-entities-serializable.md).</span><span class="sxs-lookup"><span data-stu-id="fd6ac-110">For more information, see [How to: Make Entities Serializable](../../../../../../docs/framework/data/adonet/sql/linq/how-to-make-entities-serializable.md).</span></span> <span data-ttu-id="fd6ac-111">Další možností je vytvořit samostatnou sadu tříd, které zapouzdření serializaci dat, a poté projektu do těchto Serializovatelné typy po vrácení dat ve vašem [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] dotazy.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-111">Another option is to create a separate set of classes that encapsulate the data to be serialized, and then project into those serializable types when you return data in your [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] queries.</span></span>  
  
 <span data-ttu-id="fd6ac-112">Potom definovat rozhraní s metody, které klienti zavolá načíst, insert a aktualizovat data.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-112">You then define the interface with the methods that the clients will call to retrieve, insert and update data.</span></span> <span data-ttu-id="fd6ac-113">Metody rozhraní zabalení vaší [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] dotazy.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-113">The interface methods wrap your [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] queries.</span></span> <span data-ttu-id="fd6ac-114">Pro zpracování volání vzdálené metody a serializace dat můžete použít jakýkoli druh mechanismu serializace.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-114">You can use any kind of serialization mechanism to handle the remote method calls and the serialization of data.</span></span> <span data-ttu-id="fd6ac-115">Jediným požadavkem je, že pokud máte cyklická nebo obousměrné relace v objektu modelu, jako je například, že mezi zákazníci a objednávky v modelu objektu standardní Northwind, pak musíte použít serializátor, která ho podporuje.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-115">The only requirement is that if you have cyclic or bi-directional relationships in your object model, such as that between Customers and Orders in the standard Northwind object model, then you must use a serializer that supports it.</span></span> <span data-ttu-id="fd6ac-116">Windows Communication Foundation (WCF) <xref:System.Runtime.Serialization.DataContractSerializer> vztahů obousměrná podporuje, ale XmlSerializer, který se používá s WCF webové služby neexistuje.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-116">The Windows Communication Foundation (WCF) <xref:System.Runtime.Serialization.DataContractSerializer> supports bi-directional relationships but the XmlSerializer that is used with non-WCF Web services does not.</span></span> <span data-ttu-id="fd6ac-117">Pokud si zvolíte používání třídy XmlSerializer, pak je musí ověřit, objektový model nemá žádné cyklické relace.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-117">If you select to use the XmlSerializer, then you must make sure that your object model has no cyclic relationships.</span></span>  
  
 <span data-ttu-id="fd6ac-118">Další informace o Windows Communication Foundation, najdete v části [služby Windows Communication Foundation a služby WCF Data Services v sadě Visual Studio](/visualstudio/data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio).</span><span class="sxs-lookup"><span data-stu-id="fd6ac-118">For more information about Windows Communication Foundation, see [Windows Communication Foundation Services and WCF Data Services in Visual Studio](/visualstudio/data-tools/windows-communication-foundation-services-and-wcf-data-services-in-visual-studio).</span></span>  
  
 <span data-ttu-id="fd6ac-119">Implementovat obchodní pravidla nebo jiné specifické pro doménu logiky pomocí částečné třídy a metody na <xref:System.Data.Linq.DataContext> a tříd entit, připojí do [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] události modulu runtime.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-119">Implement your business rules or other domain-specific logic by using the partial classes and methods on the <xref:System.Data.Linq.DataContext> and entity classes to hook into [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] runtime events.</span></span> <span data-ttu-id="fd6ac-120">Další informace najdete v tématu [implementace vícevrstvé obchodní logiky](../../../../../../docs/framework/data/adonet/sql/linq/implementing-business-logic-linq-to-sql.md).</span><span class="sxs-lookup"><span data-stu-id="fd6ac-120">For more information, see [Implementing N-Tier Business Logic](../../../../../../docs/framework/data/adonet/sql/linq/implementing-business-logic-linq-to-sql.md).</span></span>  
  
## <a name="defining-the-serializable-types"></a><span data-ttu-id="fd6ac-121">Definování Serializovatelné typy</span><span class="sxs-lookup"><span data-stu-id="fd6ac-121">Defining the Serializable Types</span></span>  
 <span data-ttu-id="fd6ac-122">Klient nebo prezentační vrstva musí mít definic typů pro třídy, které bude moci přijmout ze střední vrstvy.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-122">The client or presentation tier must have type definitions for the classes that it will be receiving from the middle tier.</span></span> <span data-ttu-id="fd6ac-123">Mohou být tyto typy tříd entit, sami nebo speciální třídy, které balí pouze určitá pole z tříd entit pro vzdálenou komunikaci.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-123">Those types may be the entity classes themselves, or special classes that wrap only certain fields from the entity classes for remoting.</span></span> <span data-ttu-id="fd6ac-124">V každém případě [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] je zcela unconcerned o tom, jak prezentační vrstvou získá tyto definice typů.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-124">In any case, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] is completely unconcerned about how the presentation tier acquires those type definitions.</span></span> <span data-ttu-id="fd6ac-125">Například prezentační vrstvou využít WCF ke generování typy automaticky, nebo ho může mít kopie knihovny DLL, ve kterém jsou definovány tyto typy nebo jej může pouze definuje vlastní verzích typy.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-125">For example, the presentation tier could use WCF to generate the types automatically, or it could have a copy of a DLL in which those types are defined, or it could just define its own versions of the types.</span></span>  
  
## <a name="retrieving-and-inserting-data"></a><span data-ttu-id="fd6ac-126">Načítání a vkládání dat</span><span class="sxs-lookup"><span data-stu-id="fd6ac-126">Retrieving and Inserting Data</span></span>  
 <span data-ttu-id="fd6ac-127">Střední vrstva definuje rozhraní, které určuje, jak prezentační vrstvou přistupuje k datům.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-127">The middle tier defines an interface that specifies how the presentation tier accesses the data.</span></span> <span data-ttu-id="fd6ac-128">Například `GetProductByID(int productID)`, nebo `GetCustomers()`.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-128">For example `GetProductByID(int productID)`, or `GetCustomers()`.</span></span> <span data-ttu-id="fd6ac-129">Na střední vrstvy, metoda text obvykle vytvoří novou instanci třídy <xref:System.Data.Linq.DataContext>, provede dotaz na jeden nebo více jeho tabulky.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-129">On the middle tier, the method body typically creates a new instance of the <xref:System.Data.Linq.DataContext>, executes a query against one or more of its table.</span></span> <span data-ttu-id="fd6ac-130">Střední vrstva pak vrátí výsledek jako <xref:System.Collections.Generic.IEnumerable%601>, kde `T` třídu entity nebo jiný typ, který se používá pro serializaci.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-130">The middle tier then returns the result as an <xref:System.Collections.Generic.IEnumerable%601>, where `T` is either an entity class or another type that is used for serialization.</span></span> <span data-ttu-id="fd6ac-131">Prezentační vrstva nikdy odeslání nebo přijetí proměnné dotazu přímo do nebo z střední vrstvy.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-131">The presentation tier never sends or receives query variables directly to or from the middle tier.</span></span> <span data-ttu-id="fd6ac-132">Hodnoty, objektů a kolekcí konkrétní dat systému exchange dvěma vrstvami.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-132">The two tiers exchange values, objects, and collections of concrete data.</span></span> <span data-ttu-id="fd6ac-133">Po přijetí kolekci, můžete použít prezentační vrstvou [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] pro objekty, které chcete zadat dotaz v případě potřeby.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-133">After it has received a collection, the presentation tier can use [!INCLUDE[vbteclinq](../../../../../../includes/vbteclinq-md.md)] to Objects to query it if necessary.</span></span>  
  
 <span data-ttu-id="fd6ac-134">Při vkládání dat, můžete vytvořit nový objekt a odešle střední vrstva prezentační vrstvy, nebo může mít střední vrstvy vytvořit objekt založené na hodnotách, které poskytuje.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-134">When inserting data, the presentation tier can construct a new object and send it to the middle tier, or it can have the middle tier construct the object based on values that it provides.</span></span> <span data-ttu-id="fd6ac-135">Obecně platí načítání a vkládání dat do vícevrstvé aplikace není lišit od procesu aplikace vrstvy 2.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-135">In general, retrieving and inserting data in n-tier applications does not differ much from the process in 2-tier applications.</span></span> <span data-ttu-id="fd6ac-136">Další informace najdete v tématu [dotazování databáze](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md) a [provádění a odeslání změn dat](../../../../../../docs/framework/data/adonet/sql/linq/making-and-submitting-data-changes.md).</span><span class="sxs-lookup"><span data-stu-id="fd6ac-136">For more information, see [Querying the Database](../../../../../../docs/framework/data/adonet/sql/linq/querying-the-database.md) and [Making and Submitting Data Changes](../../../../../../docs/framework/data/adonet/sql/linq/making-and-submitting-data-changes.md).</span></span>  
  
## <a name="tracking-changes-for-updates-and-deletes"></a><span data-ttu-id="fd6ac-137">Sledování změn pro aktualizace a odstranění</span><span class="sxs-lookup"><span data-stu-id="fd6ac-137">Tracking Changes for Updates and Deletes</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="fd6ac-138">podporuje optimistickou metodu souběžného založená na časová razítka (nazývaná také RowVersions) a na původní hodnoty.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-138"> supports optimistic concurrency based on timestamps (also named RowVersions) and on original values.</span></span> <span data-ttu-id="fd6ac-139">Pokud tabulky databáze, které mají časová razítka, pak aktualizace a odstranění vyžadují málo další práci na střední vrstvě nebo prezentační vrstvy.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-139">If the database tables have timestamps, then updates and deletions require little extra work on either the middle-tier or presentation tier.</span></span> <span data-ttu-id="fd6ac-140">Ale pokud je nutné použít původní hodnoty pro optimistickou metodu souběžného kontroly, pak prezentační vrstvou zodpovídá za sledování tyto hodnoty a jejich odesláním zpět v případě, že umožňuje aktualizace.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-140">However, if you must use original values for optimistic concurrency checks, then the presentation tier is responsible for tracking those values and sending them back when it makes updates.</span></span> <span data-ttu-id="fd6ac-141">Je to proto, že nejsou ve střední vrstvě sledovat změny, které byly provedeny entity v prezentační vrstvě.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-141">This is because changes that were made to entities on the presentation tier are not tracked on the middle tier.</span></span> <span data-ttu-id="fd6ac-142">Ve skutečnosti původní načtení entity a případné aktualizace provedené na ni se obvykle provádí dvě zcela samostatné instance <xref:System.Data.Linq.DataContext>.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-142">In fact, the original retrieval of an entity, and the eventual update made to it are typically performed by two completely separate instances of the <xref:System.Data.Linq.DataContext>.</span></span>  
  
 <span data-ttu-id="fd6ac-143">Větší počet změn, které provede prezentační vrstvy, tím složitější bude sledovat tyto změny a balíček, který je zpět do střední vrstvy.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-143">The greater the number of changes that the presentation tier makes, the more complex it becomes to track those changes and package them back to the middle tier.</span></span> <span data-ttu-id="fd6ac-144">Implementace mechanismus, který komunikuje změny je zcela až aplikace.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-144">The implementation of a mechanism for communicating changes is completely up to the application.</span></span> <span data-ttu-id="fd6ac-145">Jediným požadavkem je, že [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] musí mít tyto původní hodnoty, které jsou požadovány pro optimistickou metodu souběžného kontroly.</span><span class="sxs-lookup"><span data-stu-id="fd6ac-145">The only requirement is that [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] must be given those original values that are required for optimistic concurrency checks.</span></span>  
  
 <span data-ttu-id="fd6ac-146">Další informace najdete v tématu [operace vytvoření ve víceúrovňových aplikacích (technologie LINQ to SQL) a načítání dat ze](../../../../../../docs/framework/data/adonet/sql/linq/data-retrieval-and-cud-operations-in-n-tier-applications.md).</span><span class="sxs-lookup"><span data-stu-id="fd6ac-146">For more information, see [Data Retrieval and CUD Operations in N-Tier Applications (LINQ to SQL)](../../../../../../docs/framework/data/adonet/sql/linq/data-retrieval-and-cud-operations-in-n-tier-applications.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fd6ac-147">Viz také</span><span class="sxs-lookup"><span data-stu-id="fd6ac-147">See Also</span></span>  
 [<span data-ttu-id="fd6ac-148">N-vrstvé a vzdálené aplikace s LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="fd6ac-148">N-Tier and Remote Applications with LINQ to SQL</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/n-tier-and-remote-applications-with-linq-to-sql.md)  
 [<span data-ttu-id="fd6ac-149">NIB: LinqDataSource webového serveru – Přehled ovládacího prvku</span><span class="sxs-lookup"><span data-stu-id="fd6ac-149">NIB: LinqDataSource Web Server Control Overview</span></span>](http://msdn.microsoft.com/library/104cfc3f-7385-47d3-8a51-830dfa791136)
