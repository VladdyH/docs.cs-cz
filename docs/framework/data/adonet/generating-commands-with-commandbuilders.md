---
title: "Generování příkazů s CommandBuilders"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 6e3fb8b5-373b-4f9e-ab03-a22693df8e91
caps.latest.revision: "6"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.openlocfilehash: 0e945b4b6c646a0210f781d1ba43b5cd931cfef6
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/21/2017
---
# <a name="generating-commands-with-commandbuilders"></a><span data-ttu-id="d8f00-102">Generování příkazů s CommandBuilders</span><span class="sxs-lookup"><span data-stu-id="d8f00-102">Generating Commands with CommandBuilders</span></span>
<span data-ttu-id="d8f00-103">Když `SelectCommand` dynamicky zadána vlastnost za běhu, například pomocí nástroje dotazu, který přebírá textový příkaz od uživatele, nemusí být možné zadat příslušné `InsertCommand`, `UpdateCommand`, nebo `DeleteCommand` v době návrhu.</span><span class="sxs-lookup"><span data-stu-id="d8f00-103">When the `SelectCommand` property is dynamically specified at run time, such as through a query tool that takes a textual command from the user, you may not be able to specify the appropriate `InsertCommand`, `UpdateCommand`, or `DeleteCommand` at design time.</span></span> <span data-ttu-id="d8f00-104">Pokud vaše <xref:System.Data.DataTable> mapuje nebo se vygeneruje z jedné tabulky databáze, můžete využít výhod <xref:System.Data.Common.DbCommandBuilder> objekt, který má automaticky generovat `DeleteCommand`, `InsertCommand`, a `UpdateCommand` z <xref:System.Data.Common.DbDataAdapter>.</span><span class="sxs-lookup"><span data-stu-id="d8f00-104">If your <xref:System.Data.DataTable> maps to or is generated from a single database table, you can take advantage of the <xref:System.Data.Common.DbCommandBuilder> object to automatically generate the `DeleteCommand`, `InsertCommand`, and `UpdateCommand` of the <xref:System.Data.Common.DbDataAdapter>.</span></span>  
  
 <span data-ttu-id="d8f00-105">Jako minimální požadavek, je nutné nastavit `SelectCommand` vlastnost v pořadí pro příkaz Automatické generování pracovat.</span><span class="sxs-lookup"><span data-stu-id="d8f00-105">As a minimum requirement, you must set the `SelectCommand` property in order for automatic command generation to work.</span></span> <span data-ttu-id="d8f00-106">Načíst schéma tabulky `SelectCommand` vlastnost určuje syntaxe automaticky generované příkazy INSERT, UPDATE a DELETE.</span><span class="sxs-lookup"><span data-stu-id="d8f00-106">The table schema retrieved by the `SelectCommand` property determines the syntax of the automatically generated INSERT, UPDATE, and DELETE statements.</span></span>  
  
 <span data-ttu-id="d8f00-107"><xref:System.Data.Common.DbCommandBuilder> Musí být spuštěn `SelectCommand` cílem vrátit metadata potřebná k vytvoření příkazy INSERT, UPDATE a odstranit SQL.</span><span class="sxs-lookup"><span data-stu-id="d8f00-107">The <xref:System.Data.Common.DbCommandBuilder> must execute the `SelectCommand` in order to return the metadata necessary to construct the INSERT, UPDATE, and DELETE SQL commands.</span></span> <span data-ttu-id="d8f00-108">V důsledku toho je nezbytné další cesty ke zdroji dat, a to může bránit ve výkonu.</span><span class="sxs-lookup"><span data-stu-id="d8f00-108">As a result, an extra trip to the data source is necessary, and this can hinder performance.</span></span> <span data-ttu-id="d8f00-109">K dosažení optimálního výkonu, zadejte příkazech explicitně spíše než <xref:System.Data.Common.DbCommandBuilder>.</span><span class="sxs-lookup"><span data-stu-id="d8f00-109">To achieve optimal performance, specify your commands explicitly rather than using the <xref:System.Data.Common.DbCommandBuilder>.</span></span>  
  
 <span data-ttu-id="d8f00-110">`SelectCommand` Musí vracet také alespoň jeden primární klíč nebo jedinečné sloupec.</span><span class="sxs-lookup"><span data-stu-id="d8f00-110">The `SelectCommand` must also return at least one primary key or unique column.</span></span> <span data-ttu-id="d8f00-111">Pokud žádný není přítomný, `InvalidOperation` se vygeneruje výjimka, a nejsou generované příkazy.</span><span class="sxs-lookup"><span data-stu-id="d8f00-111">If none are present, an `InvalidOperation` exception is generated, and the commands are not generated.</span></span>  
  
 <span data-ttu-id="d8f00-112">Pokud jsou přidruženy `DataAdapter`, <xref:System.Data.Common.DbCommandBuilder> automaticky vygeneruje `InsertCommand`, `UpdateCommand`, a `DeleteCommand` vlastnosti `DataAdapter` Pokud jsou odkazy s hodnotou null.</span><span class="sxs-lookup"><span data-stu-id="d8f00-112">When associated with a `DataAdapter`, the <xref:System.Data.Common.DbCommandBuilder> automatically generates the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties of the `DataAdapter` if they are null references.</span></span> <span data-ttu-id="d8f00-113">Pokud `Command` již existuje pro vlastnost, existující `Command` se používá.</span><span class="sxs-lookup"><span data-stu-id="d8f00-113">If a `Command` already exists for a property, the existing `Command` is used.</span></span>  
  
 <span data-ttu-id="d8f00-114">Zobrazení databáze, které jsou vytvořené pomocí spojení dvou nebo více tabulek nejsou považovány za jedné tabulky databáze.</span><span class="sxs-lookup"><span data-stu-id="d8f00-114">Database views that are created by joining two or more tables together are not considered a single database table.</span></span> <span data-ttu-id="d8f00-115">V této instanci nelze použít <xref:System.Data.Common.DbCommandBuilder> k automatickému generování příkazy; je nutné explicitně zadat příkazech.</span><span class="sxs-lookup"><span data-stu-id="d8f00-115">In this instance you cannot use the <xref:System.Data.Common.DbCommandBuilder> to automatically generate commands; you must specify your commands explicitly.</span></span> <span data-ttu-id="d8f00-116">Informace o nastavení explicitně příkazy vyřešit aktualizací `DataSet` zpět do zdroje dat, najdete v části [aktualizace zdroje dat s DataAdapters](../../../../docs/framework/data/adonet/updating-data-sources-with-dataadapters.md).</span><span class="sxs-lookup"><span data-stu-id="d8f00-116">For information about explicitly setting commands to resolve updates to a `DataSet` back to the data source, see [Updating Data Sources with DataAdapters](../../../../docs/framework/data/adonet/updating-data-sources-with-dataadapters.md).</span></span>  
  
 <span data-ttu-id="d8f00-117">Můžete chtít mapování výstupní parametry zpátky na aktualizovaný řádek `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="d8f00-117">You might want to map output parameters back to the updated row of a `DataSet`.</span></span> <span data-ttu-id="d8f00-118">Běžných úloh by být načítání hodnotu pole automaticky generované identity nebo časové razítko z datového zdroje.</span><span class="sxs-lookup"><span data-stu-id="d8f00-118">One common task would be retrieving the value of an automatically generated identity field or time stamp from the data source.</span></span> <span data-ttu-id="d8f00-119"><xref:System.Data.Common.DbCommandBuilder> Nebude namapovat výstupní parametry sloupce v aktualizované řádek ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="d8f00-119">The <xref:System.Data.Common.DbCommandBuilder> will not map output parameters to columns in an updated row by default.</span></span> <span data-ttu-id="d8f00-120">V této instanci je nutné explicitně zadat příkazu.</span><span class="sxs-lookup"><span data-stu-id="d8f00-120">In this instance you must specify your command explicitly.</span></span> <span data-ttu-id="d8f00-121">Příklad mapování pole automaticky generované identity zpět ke sloupci vloženého řádku, naleznete v části [načítání Identity nebo automatické číslování hodnoty](../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="d8f00-121">For an example of mapping an automatically generated identity field back to a column of an inserted row, see [Retrieving Identity or Autonumber Values](../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span></span>  
  
## <a name="rules-for-automatically-generated-commands"></a><span data-ttu-id="d8f00-122">Pravidla pro automaticky generované příkazy</span><span class="sxs-lookup"><span data-stu-id="d8f00-122">Rules for Automatically Generated Commands</span></span>  
 <span data-ttu-id="d8f00-123">Následující tabulka uvádí pravidla pro jak automaticky vygenerovat, že jsou generovány příkazy.</span><span class="sxs-lookup"><span data-stu-id="d8f00-123">The following table shows the rules for how automatically generated commands are generated.</span></span>  
  
|<span data-ttu-id="d8f00-124">Příkaz</span><span class="sxs-lookup"><span data-stu-id="d8f00-124">Command</span></span>|<span data-ttu-id="d8f00-125">Pravidlo</span><span class="sxs-lookup"><span data-stu-id="d8f00-125">Rule</span></span>|  
|-------------|----------|  
|`InsertCommand`|<span data-ttu-id="d8f00-126">Vloží řádek ve zdroji dat pro všechny řádky v tabulce s <xref:System.Data.DataRow.RowState%2A> z <xref:System.Data.DataRowState.Added>.</span><span class="sxs-lookup"><span data-stu-id="d8f00-126">Inserts a row at the data source for all rows in the table with a <xref:System.Data.DataRow.RowState%2A> of <xref:System.Data.DataRowState.Added>.</span></span> <span data-ttu-id="d8f00-127">Vloží hodnoty pro všechny sloupce, které jsou v aktualizovatelné (ale ne sloupce například identit, výrazy nebo časová razítka).</span><span class="sxs-lookup"><span data-stu-id="d8f00-127">Inserts values for all columns that are updateable (but not columns such as identities, expressions, or timestamps).</span></span>|  
|`UpdateCommand`|<span data-ttu-id="d8f00-128">Aktualizace řádků ve zdroji dat pro všechny řádky v tabulce s `RowState` z <xref:System.Data.DataRowState.Modified>.</span><span class="sxs-lookup"><span data-stu-id="d8f00-128">Updates rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="d8f00-129">Aktualizace hodnoty všechny sloupce kromě sloupce, které nejsou v aktualizovatelné, jako je například identity nebo výrazů.</span><span class="sxs-lookup"><span data-stu-id="d8f00-129">Updates the values of all columns except for columns that are not updateable, such as identities or expressions.</span></span> <span data-ttu-id="d8f00-130">Aktualizuje všechny řádky hodnoty sloupce ve zdroji dat shodují s hodnotami sloupec primárního klíče řádku a zbývající sloupce ve zdroji dat se shodují původní hodnoty řádku.</span><span class="sxs-lookup"><span data-stu-id="d8f00-130">Updates all rows where the column values at the data source match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="d8f00-131">Další informace najdete v tématu "Optimistickou metodu souběžného zpracování modelu pro aktualizace a odstraní," dál v tomto tématu.</span><span class="sxs-lookup"><span data-stu-id="d8f00-131">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
|`DeleteCommand`|<span data-ttu-id="d8f00-132">Odstraní řádků ve zdroji dat pro všechny řádky v tabulce s `RowState` z <xref:System.Data.DataRowState.Deleted>.</span><span class="sxs-lookup"><span data-stu-id="d8f00-132">Deletes rows at the data source for all rows in the table with a `RowState` of <xref:System.Data.DataRowState.Deleted>.</span></span> <span data-ttu-id="d8f00-133">Odstraní všechny řádky, sloupce hodnoty shodují s hodnotami sloupec primárního klíče řádku a zbývající sloupce ve zdroji dat se shodují původní hodnoty řádku.</span><span class="sxs-lookup"><span data-stu-id="d8f00-133">Deletes all rows where the column values match the primary key column values of the row, and where the remaining columns at the data source match the original values of the row.</span></span> <span data-ttu-id="d8f00-134">Další informace najdete v tématu "Optimistickou metodu souběžného zpracování modelu pro aktualizace a odstraní," dál v tomto tématu.</span><span class="sxs-lookup"><span data-stu-id="d8f00-134">For more information, see "Optimistic Concurrency Model for Updates and Deletes," later in this topic.</span></span>|  
  
## <a name="optimistic-concurrency-model-for-updates-and-deletes"></a><span data-ttu-id="d8f00-135">Model optimistickou metodu souběžného pro aktualizace a odstranění</span><span class="sxs-lookup"><span data-stu-id="d8f00-135">Optimistic Concurrency Model for Updates and Deletes</span></span>  
 <span data-ttu-id="d8f00-136">Logiku pro generování příkazy automaticky pro příkazy UPDATE a DELETE je založena na *optimistickou metodu souběžného*– to znamená, záznamy nejsou zamčené pro úpravy a mohou být upravena jiné uživatele nebo procesy v každém okamžiku.</span><span class="sxs-lookup"><span data-stu-id="d8f00-136">The logic for generating commands automatically for UPDATE and DELETE statements is based on *optimistic concurrency*--that is, records are not locked for editing and can be modified by other users or processes at any time.</span></span> <span data-ttu-id="d8f00-137">Vzhledem k tomu, že záznam mohl změnit po byla vrácena z příkaz SELECT, ale před vydáním příkazu UPDATE nebo DELETE, automaticky generovaný příkaz UPDATE nebo DELETE obsahuje klauzuli WHERE, určující, zda řádek hodnota aktualizuje jenom Pokud je obsahuje všechny původní hodnoty a ze zdroje dat nebyl odstraněn.</span><span class="sxs-lookup"><span data-stu-id="d8f00-137">Because a record could have been modified after it was returned from the SELECT statement, but before the UPDATE or DELETE statement is issued, the automatically generated UPDATE or DELETE statement contains a WHERE clause, specifying that a row is only updated if it contains all original values and has not been deleted from the data source.</span></span> <span data-ttu-id="d8f00-138">Děje se tak aby nedošlo k přepsání nová data.</span><span class="sxs-lookup"><span data-stu-id="d8f00-138">This is done to avoid overwriting new data.</span></span> <span data-ttu-id="d8f00-139">Kde pokusí aktualizovat řádek, který byl odstraněn nebo neobsahuje původní hodnoty zjištěné v aktualizaci automaticky generovaný <xref:System.Data.DataSet>, příkaz nemá vliv na všechny záznamy a <xref:System.Data.DBConcurrencyException> je vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="d8f00-139">Where an automatically generated update attempts to update a row that has been deleted or that does not contain the original values found in the <xref:System.Data.DataSet>, the command does not affect any records, and a <xref:System.Data.DBConcurrencyException> is thrown.</span></span>  
  
 <span data-ttu-id="d8f00-140">Pokud chcete dokončit bez ohledu na původní hodnoty na aktualizaci nebo odstranění, musíte explicitně nastavit `UpdateCommand` pro `DataAdapter` a nespoléhala se na příkaz automatického generování.</span><span class="sxs-lookup"><span data-stu-id="d8f00-140">If you want the UPDATE or DELETE to complete regardless of original values, you must explicitly set the `UpdateCommand` for the `DataAdapter` and not rely on automatic command generation.</span></span>  
  
## <a name="limitations-of-automatic-command-generation-logic"></a><span data-ttu-id="d8f00-141">Omezení příkaz Automatické generování logiky</span><span class="sxs-lookup"><span data-stu-id="d8f00-141">Limitations of Automatic Command Generation Logic</span></span>  
 <span data-ttu-id="d8f00-142">Automatické příkaz generace platí následující omezení.</span><span class="sxs-lookup"><span data-stu-id="d8f00-142">The following limitations apply to automatic command generation.</span></span>  
  
### <a name="unrelated-tables-only"></a><span data-ttu-id="d8f00-143">Pouze nesouvisejících tabulek</span><span class="sxs-lookup"><span data-stu-id="d8f00-143">Unrelated Tables Only</span></span>  
 <span data-ttu-id="d8f00-144">Příkaz Automatické generování logiku generuje vložit, aktualizovat a odstraňovat příkazy pro samostatné tabulky bez ohledu na všechny vztahy s jinými tabulkami ve zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="d8f00-144">The automatic command generation logic generates INSERT, UPDATE, or DELETE statements for stand-alone tables without taking into account any relationships to other tables at the data source.</span></span> <span data-ttu-id="d8f00-145">V důsledku toho může dojde k chybě při volání metody `Update` k odeslání změn pro sloupec, který je součástí omezení cizího klíče v databázi.</span><span class="sxs-lookup"><span data-stu-id="d8f00-145">As a result, you may encounter a failure when calling `Update` to submit changes for a column that participates in a foreign key constraint in the database.</span></span> <span data-ttu-id="d8f00-146">Chcete-li se vyhnout této výjimky, nepoužívejte <xref:System.Data.Common.DbCommandBuilder> pro aktualizace sloupců, které se účastní omezení cizího klíče; místo toho explicitně zadat příkazy, které používá k provedení operace.</span><span class="sxs-lookup"><span data-stu-id="d8f00-146">To avoid this exception, do not use the <xref:System.Data.Common.DbCommandBuilder> for updating columns involved in a foreign key constraint; instead, explicitly specify the statements used to perform the operation.</span></span>  
  
### <a name="table-and-column-names"></a><span data-ttu-id="d8f00-147">Tabulka a názvy sloupců</span><span class="sxs-lookup"><span data-stu-id="d8f00-147">Table and Column Names</span></span>  
 <span data-ttu-id="d8f00-148">Příkaz Automatické generování logiku může selhat v případě, že názvy sloupců nebo názvy tabulek obsahovat žádné speciální znaky, jako je například mezery, tečky, uvozovek nebo jiných nealfanumerické znaky, i v případě, že oddělený závorkami.</span><span class="sxs-lookup"><span data-stu-id="d8f00-148">Automatic command generation logic may fail if column names or table names contain any special characters, such as spaces, periods, quotation marks, or other nonalphanumeric characters, even if delimited by brackets.</span></span> <span data-ttu-id="d8f00-149">V závislosti na zprostředkovateli nastavení parametrů QuotePrefix a QuoteSuffix může povolit generování logika pro proces mezery, ale nelze použít uvozování speciální znaky.</span><span class="sxs-lookup"><span data-stu-id="d8f00-149">Depending on the provider, setting the QuotePrefix and QuoteSuffix parameters may allow the generation logic to process spaces, but it cannot escape special characters.</span></span> <span data-ttu-id="d8f00-150">Plně kvalifikované názvy tabulek ve formě *catalog.schema.table* jsou podporovány.</span><span class="sxs-lookup"><span data-stu-id="d8f00-150">Fully qualified table names in the form of *catalog.schema.table* are supported.</span></span>  
  
## <a name="using-the-commandbuilder-to-automatically-generate-an-sql-statement"></a><span data-ttu-id="d8f00-151">Pomocí CommandBuilder k automatickému generování příkazu SQL</span><span class="sxs-lookup"><span data-stu-id="d8f00-151">Using the CommandBuilder to Automatically Generate an SQL Statement</span></span>  
 <span data-ttu-id="d8f00-152">K automatickému generování příkazů SQL pro `DataAdapter`, nastavte nejprve `SelectCommand` vlastnost `DataAdapter`, pak vytvořte `CommandBuilder` objektu a zadat jako argument `DataAdapter` pro kterou `CommandBuilder` bude automaticky Generovat příkazů SQL.</span><span class="sxs-lookup"><span data-stu-id="d8f00-152">To automatically generate SQL statements for a `DataAdapter`, first set the `SelectCommand` property of the `DataAdapter`, then create a `CommandBuilder` object, and specify as an argument the `DataAdapter` for which the `CommandBuilder` will automatically generate SQL statements.</span></span>  
  
```vb  
' Assumes that connection is a valid SqlConnection object   
' inside of a Using block.  
Dim adapter As SqlDataAdapter = New SqlDataAdapter( _  
  "SELECT * FROM dbo.Customers", connection)  
Dim builder As SqlCommandBuilder = New SqlCommandBuilder(adapter)  
builder.QuotePrefix = "["  
builder.QuoteSuffix = "]"  
```  
  
```csharp  
// Assumes that connection is a valid SqlConnection object  
// inside of a using block.  
SqlDataAdapter adapter = new SqlDataAdapter(  
  "SELECT * FROM dbo.Customers", connection);  
SqlCommandBuilder builder = new SqlCommandBuilder(adapter);  
builder.QuotePrefix = "[";  
builder.QuoteSuffix = "]";  
```  
  
## <a name="modifying-the-selectcommand"></a><span data-ttu-id="d8f00-153">Úprava vlastnosti SelectCommand</span><span class="sxs-lookup"><span data-stu-id="d8f00-153">Modifying the SelectCommand</span></span>  
 <span data-ttu-id="d8f00-154">Pokud změníte `CommandText` z `SelectCommand` po byly automaticky generovány příkazy INSERT, UPDATE nebo DELETE, může dojít k výjimce.</span><span class="sxs-lookup"><span data-stu-id="d8f00-154">If you modify the `CommandText` of the `SelectCommand` after the INSERT, UPDATE, or DELETE commands have been automatically generated, an exception may occur.</span></span> <span data-ttu-id="d8f00-155">Pokud upravený `SelectCommand.CommandText` obsahuje informace o schématu, který není konzistentní s `SelectCommand.CommandText` použít při vložení, aktualizaci nebo odstranění příkazy byly automaticky generované, budoucí volání `DataAdapter.Update` metoda může pokus o přístup sloupců, již existuje v aktuální tabulce odkazuje `SelectCommand`, a bude vyvolána výjimka.</span><span class="sxs-lookup"><span data-stu-id="d8f00-155">If the modified `SelectCommand.CommandText` contains schema information that is inconsistent with the `SelectCommand.CommandText` used when the insert, update, or delete commands were automatically generated, future calls to the `DataAdapter.Update` method may attempt to access columns that no longer exist in the current table referenced by the `SelectCommand`, and an exception will be thrown.</span></span>  
  
 <span data-ttu-id="d8f00-156">Můžete obnovit informace o schématu používané `CommandBuilder` k automatickému generování příkazy voláním `RefreshSchema` metodu `CommandBuilder`.</span><span class="sxs-lookup"><span data-stu-id="d8f00-156">You can refresh the schema information used by the `CommandBuilder` to automatically generate commands by calling the `RefreshSchema` method of the `CommandBuilder`.</span></span>  
  
 <span data-ttu-id="d8f00-157">Pokud chcete vědět, jaké příkaz byla automaticky vygenerována, můžete získat odkaz na automaticky generovaný příkazy pomocí `GetInsertCommand`, `GetUpdateCommand`, a `GetDeleteCommand` metody `CommandBuilder` objektu a kontrolu `CommandText`vlastnost přidružené příkazu.</span><span class="sxs-lookup"><span data-stu-id="d8f00-157">If you want to know what command was automatically generated, you can obtain a reference to the automatically generated commands by using the `GetInsertCommand`, `GetUpdateCommand`, and `GetDeleteCommand` methods of the `CommandBuilder` object and checking the `CommandText` property of the associated command.</span></span>  
  
 <span data-ttu-id="d8f00-158">Následující příklad kódu zapíše do konzoly aktualizace příkaz, který byl automaticky vygenerován.</span><span class="sxs-lookup"><span data-stu-id="d8f00-158">The following code example writes to the console the update command that was automatically generated.</span></span>  
  
```  
Console.WriteLine(builder.GetUpdateCommand().CommandText)  
```  
  
 <span data-ttu-id="d8f00-159">Následující příklad vytvoří `Customers` tabulky v `custDS` datovou sadu.</span><span class="sxs-lookup"><span data-stu-id="d8f00-159">The following example recreates the `Customers` table in the `custDS` dataset.</span></span> <span data-ttu-id="d8f00-160">**RefreshSchema** metoda je volána k aktualizaci automaticky generované příkazů pomocí této nové informace o sloupci.</span><span class="sxs-lookup"><span data-stu-id="d8f00-160">The **RefreshSchema** method is called to refresh the automatically generated commands with this new column information.</span></span>  
  
```vb  
' Assumes an open SqlConnection and SqlDataAdapter inside of a Using block.  
adapter.SelectCommand.CommandText = _  
  "SELECT CustomerID, ContactName FROM dbo.Customers"  
builder.RefreshSchema()  
  
custDS.Tables.Remove(custDS.Tables("Customers"))  
adapter.Fill(custDS, "Customers")  
```  
  
```csharp  
// Assumes an open SqlConnection and SqlDataAdapter inside of a using block.  
adapter.SelectCommand.CommandText =   
  "SELECT CustomerID, ContactName FROM dbo.Customers";  
builder.RefreshSchema();  
  
custDS.Tables.Remove(custDS.Tables["Customers"]);  
adapter.Fill(custDS, "Customers");  
```  
  
## <a name="see-also"></a><span data-ttu-id="d8f00-161">Viz také</span><span class="sxs-lookup"><span data-stu-id="d8f00-161">See Also</span></span>  
 [<span data-ttu-id="d8f00-162">Příkazy a parametry</span><span class="sxs-lookup"><span data-stu-id="d8f00-162">Commands and Parameters</span></span>](../../../../docs/framework/data/adonet/commands-and-parameters.md)  
 [<span data-ttu-id="d8f00-163">Spouštění příkazu</span><span class="sxs-lookup"><span data-stu-id="d8f00-163">Executing a Command</span></span>](../../../../docs/framework/data/adonet/executing-a-command.md)  
 [<span data-ttu-id="d8f00-164">Připojení DbConnection, DbCommand a dbexception –</span><span class="sxs-lookup"><span data-stu-id="d8f00-164">DbConnection, DbCommand and DbException</span></span>](../../../../docs/framework/data/adonet/dbconnection-dbcommand-and-dbexception.md)  
 [<span data-ttu-id="d8f00-165">ADO.NET spravované zprostředkovatelé a středisku pro vývojáře datové sady</span><span class="sxs-lookup"><span data-stu-id="d8f00-165">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
