---
title: "Slučování obsah datové sady"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: e5e9309a-3ebb-4a9c-9d78-21c4e2bafc5b
caps.latest.revision: "4"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: 26b351b314d82c2b9e602d1ea629bbcf379d9284
ms.sourcegitcommit: ed26cfef4e18f6d93ab822d8c29f902cff3519d1
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 01/17/2018
---
# <a name="merging-dataset-contents"></a><span data-ttu-id="62c72-102">Slučování obsah datové sady</span><span class="sxs-lookup"><span data-stu-id="62c72-102">Merging DataSet Contents</span></span>
<span data-ttu-id="62c72-103">Můžete použít <xref:System.Data.DataSet.Merge%2A> metoda sloučit obsah <xref:System.Data.DataSet>, <xref:System.Data.DataTable>, nebo <xref:System.Data.DataRow> pole do existující `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="62c72-103">You can use the <xref:System.Data.DataSet.Merge%2A> method to merge the contents of a <xref:System.Data.DataSet>, <xref:System.Data.DataTable>, or <xref:System.Data.DataRow> array into an existing `DataSet`.</span></span> <span data-ttu-id="62c72-104">Několik možnosti a faktory ovlivňují jak nová data sloučí existující `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="62c72-104">Several factors and options affect how new data is merged into an existing `DataSet`.</span></span>  
  
## <a name="primary-keys"></a><span data-ttu-id="62c72-105">Primární klíče</span><span class="sxs-lookup"><span data-stu-id="62c72-105">Primary Keys</span></span>  
 <span data-ttu-id="62c72-106">Pokud v tabulce příjem nových dat a schéma z sloučení má primární klíč, nové řádky z příchozích dat jsou přiřazeny stávající řádky, které mají stejnou <xref:System.Data.DataRowVersion.Original> primární klíč hodnoty jako v příchozí data.</span><span class="sxs-lookup"><span data-stu-id="62c72-106">If the table receiving new data and schema from a merge has a primary key, new rows from the incoming data are matched with existing rows that have the same <xref:System.Data.DataRowVersion.Original> primary key values as those in the incoming data.</span></span> <span data-ttu-id="62c72-107">Pokud sloupce z příchozí schématu odpovídají existující schéma, data v existujících řádků je upravit.</span><span class="sxs-lookup"><span data-stu-id="62c72-107">If the columns from the incoming schema match those of the existing schema, the data in the existing rows is modified.</span></span> <span data-ttu-id="62c72-108">Sloupce, které neodpovídají žádné existující schématu jsou ignorovány nebo přidány na základě <xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A> parametr.</span><span class="sxs-lookup"><span data-stu-id="62c72-108">Columns that do not match the existing schema are either ignored or added based on the <xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A> parameter.</span></span> <span data-ttu-id="62c72-109">Nové záznamy s hodnotami primárního klíče, které neodpovídají žádné existující řádky jsou připojena k existující tabulce.</span><span class="sxs-lookup"><span data-stu-id="62c72-109">New rows with primary key values that do not match any existing rows are appended to the existing table.</span></span>  
  
 <span data-ttu-id="62c72-110">Pokud příchozí nebo stávající řádky mají stavu řádek <xref:System.Data.DataRowState.Added>, jejich hodnot primárního klíče se splní použitím <xref:System.Data.DataRowVersion.Current> hodnota primárního klíče `Added` řádek, protože žádné `Original` verze řádku existuje.</span><span class="sxs-lookup"><span data-stu-id="62c72-110">If incoming or existing rows have a row state of <xref:System.Data.DataRowState.Added>, their primary key values are matched using the <xref:System.Data.DataRowVersion.Current> primary key value of the `Added` row because no `Original` row version exists.</span></span>  
  
 <span data-ttu-id="62c72-111">Pokud příchozí tabulky a existující tabulky obsahují sloupec se stejným názvem, ale s různými datovými typy, je vyvolána výjimka a <xref:System.Data.DataSet.MergeFailed> události `DataSet` je vyvolána.</span><span class="sxs-lookup"><span data-stu-id="62c72-111">If an incoming table and an existing table contain a column with the same name but different data types, an exception is thrown and the <xref:System.Data.DataSet.MergeFailed> event of the `DataSet` is raised.</span></span> <span data-ttu-id="62c72-112">Pokud příchozí tabulky a existující tabulky definovaly klíče, ale primární klíče, které jsou pro různé sloupce, je vyvolána výjimka a `MergeFailed` události `DataSet` je vyvolána.</span><span class="sxs-lookup"><span data-stu-id="62c72-112">If an incoming table and an existing table both have defined keys, but the primary keys are for different columns, an exception is thrown and the `MergeFailed` event of the `DataSet` is raised.</span></span>  
  
 <span data-ttu-id="62c72-113">Pokud v tabulce přijímá nová data od sloučení nemá primární klíč, nové řádky z příchozích dat nelze namapovat na existující řádky v tabulce a místo toho se připojí k existující tabulce.</span><span class="sxs-lookup"><span data-stu-id="62c72-113">If the table receiving new data from a merge does not have a primary key, new rows from the incoming data cannot be matched to existing rows in the table and are instead appended to the existing table.</span></span>  
  
## <a name="table-names-and-namespaces"></a><span data-ttu-id="62c72-114">Názvy tabulek a obory názvů</span><span class="sxs-lookup"><span data-stu-id="62c72-114">Table Names and Namespaces</span></span>  
 <span data-ttu-id="62c72-115"><xref:System.Data.DataTable>objekty lze volitelně přiřadit <xref:System.Data.DataTable.Namespace%2A> hodnotu vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="62c72-115"><xref:System.Data.DataTable> objects can optionally be assigned a <xref:System.Data.DataTable.Namespace%2A> property value.</span></span> <span data-ttu-id="62c72-116">Když <xref:System.Data.DataTable.Namespace%2A> přiřazené hodnoty, <xref:System.Data.DataSet> může obsahovat více <xref:System.Data.DataTable> objektů se stejným <xref:System.Data.DataTable.TableName%2A> hodnotu.</span><span class="sxs-lookup"><span data-stu-id="62c72-116">When <xref:System.Data.DataTable.Namespace%2A> values are assigned, a <xref:System.Data.DataSet> can contain multiple <xref:System.Data.DataTable> objects with the same <xref:System.Data.DataTable.TableName%2A> value.</span></span> <span data-ttu-id="62c72-117">Během operace sloučení obě <xref:System.Data.DataTable.TableName%2A> a <xref:System.Data.DataTable.Namespace%2A> slouží k identifikaci cílové sloučení.</span><span class="sxs-lookup"><span data-stu-id="62c72-117">During merge operations, both <xref:System.Data.DataTable.TableName%2A> and <xref:System.Data.DataTable.Namespace%2A> are used to identify the target of a merge.</span></span> <span data-ttu-id="62c72-118">Pokud žádné <xref:System.Data.DataTable.Namespace%2A> byl přiřazen, jenom <xref:System.Data.DataTable.TableName%2A> se používá k identifikaci cílové sloučení.</span><span class="sxs-lookup"><span data-stu-id="62c72-118">If no <xref:System.Data.DataTable.Namespace%2A> has been assigned, only the <xref:System.Data.DataTable.TableName%2A> is used to identify the target of a merge.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62c72-119">Toto chování změnit v rozhraní .NET Framework verze 2.0.</span><span class="sxs-lookup"><span data-stu-id="62c72-119">This behavior changed in version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="62c72-120">Obory názvů v verze 1.1, byly podporovány ale během operace sloučení byly ignorovány.</span><span class="sxs-lookup"><span data-stu-id="62c72-120">In version 1.1, namespaces were supported but were ignored during merge operations.</span></span> <span data-ttu-id="62c72-121">Z tohoto důvodu <xref:System.Data.DataSet> používající <xref:System.Data.DataTable.Namespace%2A> hodnoty vlastností bude mít různé chování v závislosti na tom, kterou verzi rozhraní .NET Framework, kterou používáte.</span><span class="sxs-lookup"><span data-stu-id="62c72-121">For this reason, a <xref:System.Data.DataSet> that uses <xref:System.Data.DataTable.Namespace%2A> property values will have different behaviors depending on which version of the .NET Framework you are running.</span></span> <span data-ttu-id="62c72-122">Předpokládejme například, máte dva `DataSets` obsahující `DataTables` se stejným <xref:System.Data.DataTable.TableName%2A> hodnoty vlastnosti, ale odlišným <xref:System.Data.DataTable.Namespace%2A> hodnot vlastností.</span><span class="sxs-lookup"><span data-stu-id="62c72-122">For example, suppose you have two `DataSets` containing `DataTables` with the same <xref:System.Data.DataTable.TableName%2A> property values but different <xref:System.Data.DataTable.Namespace%2A> property values.</span></span> <span data-ttu-id="62c72-123">V rozhraní .NET Framework různé verze 1.1 <xref:System.Data.DataTable.Namespace%2A> názvy budou ignorovány, při sloučení dvou <xref:System.Data.DataSet> objekty.</span><span class="sxs-lookup"><span data-stu-id="62c72-123">In version 1.1 of the .NET Framework, the different <xref:System.Data.DataTable.Namespace%2A> names will be ignored when merging the two <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="62c72-124">Však od verze 2.0, slučování příčiny dva nové `DataTables` mají být vytvořeny v cílové <xref:System.Data.DataSet>.</span><span class="sxs-lookup"><span data-stu-id="62c72-124">However, starting with version 2.0, merging causes two new `DataTables` to be created in the target <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="62c72-125">Původní `DataTables` bude mít vliv na sloučení.</span><span class="sxs-lookup"><span data-stu-id="62c72-125">The original `DataTables` will be unaffected by the merge.</span></span>  
  
## <a name="preservechanges"></a><span data-ttu-id="62c72-126">PreserveChanges</span><span class="sxs-lookup"><span data-stu-id="62c72-126">PreserveChanges</span></span>  
 <span data-ttu-id="62c72-127">Pokud předáte `DataSet`, `DataTable`, nebo `DataRow` pole na `Merge` metodu, můžete zahrnout volitelné parametry, které určují, zda chcete zachovat změny v existující `DataSet`a jak zpracovat nové prvky schématu nalezen v příchozí data.</span><span class="sxs-lookup"><span data-stu-id="62c72-127">When you pass a `DataSet`, `DataTable`, or `DataRow` array to the `Merge` method, you can include optional parameters that specify whether or not to preserve changes in the existing `DataSet`, and how to handle new schema elements found in the incoming data.</span></span> <span data-ttu-id="62c72-128">První z těchto parametrů po příchozích dat je logický příznak <xref:System.Data.LoadOption.PreserveChanges>, která určuje, zda chcete zachovat změny v existující `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="62c72-128">The first of these parameters after the incoming data is a Boolean flag, <xref:System.Data.LoadOption.PreserveChanges>, which specifies whether or not to preserve the changes in the existing `DataSet`.</span></span> <span data-ttu-id="62c72-129">Pokud `PreserveChanges` je příznak nastaven na `true`, hodnoty příchozích Nepřepisovat stávající hodnoty v `Current` řádek verzi stávající řádek.</span><span class="sxs-lookup"><span data-stu-id="62c72-129">If the `PreserveChanges` flag is set to `true`, incoming values do not overwrite existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="62c72-130">Pokud `PreserveChanges` je příznak nastaven na `false`, hodnoty příchozích přepsat existující hodnoty `Current` řádek verzi stávající řádek.</span><span class="sxs-lookup"><span data-stu-id="62c72-130">If the `PreserveChanges` flag is set to `false`, incoming values do overwrite the existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="62c72-131">Pokud `PreserveChanges` příznak není zadán, je nastaven na hodnotu `false` ve výchozím nastavení.</span><span class="sxs-lookup"><span data-stu-id="62c72-131">If the `PreserveChanges` flag is not specified, it is set to `false` by default.</span></span> <span data-ttu-id="62c72-132">Další informace o verzích řádek najdete v tématu [stavy řádků a verze řádku](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md).</span><span class="sxs-lookup"><span data-stu-id="62c72-132">For more information about row versions, see [Row States and Row Versions](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md).</span></span>  
  
 <span data-ttu-id="62c72-133">Při `PreserveChanges` je `true`, data z existující řádek se udržuje v <xref:System.Data.DataRowVersion.Current> verze řádku existující řádku při data z <xref:System.Data.DataRowVersion.Original> řádek verzi stávající řádek se přepíše daty z `Original` řádek verze příchozí řádku.</span><span class="sxs-lookup"><span data-stu-id="62c72-133">When `PreserveChanges` is `true`, the data from the existing row is maintained in the <xref:System.Data.DataRowVersion.Current> row version of the existing row, while the data from the <xref:System.Data.DataRowVersion.Original> row version of the existing row is overwritten with the data from the `Original` row version of the incoming row.</span></span> <span data-ttu-id="62c72-134"><xref:System.Data.DataRow.RowState%2A> Existující řádku je nastaven na <xref:System.Data.DataRowState.Modified>.</span><span class="sxs-lookup"><span data-stu-id="62c72-134">The <xref:System.Data.DataRow.RowState%2A> of the existing row is set to <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="62c72-135">Se vztahují tyto výjimky:</span><span class="sxs-lookup"><span data-stu-id="62c72-135">The following exceptions apply:</span></span>  
  
-   <span data-ttu-id="62c72-136">Pokud stávající řádek má `RowState` z `Deleted`tento `RowState` zůstává `Deleted` a není nastavený na `Modified`.</span><span class="sxs-lookup"><span data-stu-id="62c72-136">If the existing row has a `RowState` of `Deleted`, this `RowState` remains `Deleted` and is not set to `Modified`.</span></span> <span data-ttu-id="62c72-137">V takovém případě data z příchozí řádek stále se uloží v `Original` řádek verzi stávající řádek přepsal `Original` řádek verzi stávající řádek (Pokud má příchozí řádek `RowState` z `Added`).</span><span class="sxs-lookup"><span data-stu-id="62c72-137">In this case, the data from the incoming row will still be stored in the `Original` row version of the existing row, overwriting the `Original` row version of the existing row (unless the incoming row has a `RowState` of `Added`).</span></span>  
  
-   <span data-ttu-id="62c72-138">Pokud má příchozí řádek `RowState` z `Added`, data z `Original` řádek verzi stávající řádek nedojde k přepsání s daty z příchozí řádek, protože příchozí řádek nemá `Original` verze řádku.</span><span class="sxs-lookup"><span data-stu-id="62c72-138">If the incoming row has a `RowState` of `Added`, the data from the `Original` row version of the existing row will not be overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>  
  
 <span data-ttu-id="62c72-139">Při `PreserveChanges` je `false`, i `Current` a `Original` budou přepsána verze řádek ve stávající řádek s daty z příchozí řádku a `RowState` existující řádku je nastaven na `RowState` příchozí řádku.</span><span class="sxs-lookup"><span data-stu-id="62c72-139">When `PreserveChanges` is `false`, both the `Current` and `Original` row versions in the existing row are overwritten with the data from the incoming row, and the `RowState` of the existing row is set to the `RowState` of the incoming row.</span></span> <span data-ttu-id="62c72-140">Se vztahují tyto výjimky:</span><span class="sxs-lookup"><span data-stu-id="62c72-140">The following exceptions apply:</span></span>  
  
-   <span data-ttu-id="62c72-141">Pokud má příchozí řádek `RowState` z `Unchanged` a stávající řádek má `RowState` z `Modified`, `Deleted`, nebo `Added`, `RowState` existující řádku je nastaven na `Modified`.</span><span class="sxs-lookup"><span data-stu-id="62c72-141">If the incoming row has a `RowState` of `Unchanged` and the existing row has a `RowState` of `Modified`, `Deleted`, or `Added`, the `RowState` of the existing row is set to `Modified`.</span></span>  
  
-   <span data-ttu-id="62c72-142">Pokud má příchozí řádek `RowState` z `Added`, a stávající řádek má `RowState` z `Unchanged`, `Modified`, nebo `Deleted`, `RowState` existující řádku je nastaven na `Modified`.</span><span class="sxs-lookup"><span data-stu-id="62c72-142">If the incoming row has a `RowState` of `Added`, and the existing row has a `RowState` of `Unchanged`, `Modified`, or `Deleted`, the `RowState` of the existing row is set to `Modified`.</span></span> <span data-ttu-id="62c72-143">Také data z `Original` řádek verzi stávající řádek není přepsán pomocí dat z příchozí řádek, protože příchozí řádek nemá `Original` verze řádku.</span><span class="sxs-lookup"><span data-stu-id="62c72-143">Also, the data from the `Original` row version of the existing row is not overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>  
  
## <a name="missingschemaaction"></a><span data-ttu-id="62c72-144">MissingSchemaAction</span><span class="sxs-lookup"><span data-stu-id="62c72-144">MissingSchemaAction</span></span>  
 <span data-ttu-id="62c72-145">Můžete použít nepovinný <xref:System.Data.MissingSchemaAction> parametr `Merge` metody určíte, jak `Merge` zpracuje elementů schématu v příchozích dat, které nejsou součástí existující `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="62c72-145">You can use the optional <xref:System.Data.MissingSchemaAction> parameter of the `Merge` method to specify how `Merge` will handle schema elements in the incoming data that are not part of the existing `DataSet`.</span></span>  
  
 <span data-ttu-id="62c72-146">Následující tabulka popisuje možnosti `MissingSchemaAction`.</span><span class="sxs-lookup"><span data-stu-id="62c72-146">The following table describes the options for `MissingSchemaAction`.</span></span>  
  
|<span data-ttu-id="62c72-147">Možnost MissingSchemaAction</span><span class="sxs-lookup"><span data-stu-id="62c72-147">MissingSchemaAction option</span></span>|<span data-ttu-id="62c72-148">Popis</span><span class="sxs-lookup"><span data-stu-id="62c72-148">Description</span></span>|  
|--------------------------------|-----------------|  
|<xref:System.Data.MissingSchemaAction.Add>|<span data-ttu-id="62c72-149">Přidat nové informace o schématu pro `DataSet` a naplnit nové sloupce příchozí hodnotami.</span><span class="sxs-lookup"><span data-stu-id="62c72-149">Add the new schema information to the `DataSet` and populate the new columns with the incoming values.</span></span> <span data-ttu-id="62c72-150">Toto nastavení je výchozí.</span><span class="sxs-lookup"><span data-stu-id="62c72-150">This is the default.</span></span>|  
|<xref:System.Data.MissingSchemaAction.AddWithKey>|<span data-ttu-id="62c72-151">Přidejte nové schéma a primární klíče informace, které `DataSet` a naplnit nové sloupce příchozí hodnotami.</span><span class="sxs-lookup"><span data-stu-id="62c72-151">Add the new schema and primary key information to the `DataSet` and populate the new columns with the incoming values.</span></span>|  
|<xref:System.Data.MissingSchemaAction.Error>|<span data-ttu-id="62c72-152">Způsobí výjimku, pokud je zjištěna neshoda schématu informace.</span><span class="sxs-lookup"><span data-stu-id="62c72-152">Throw an exception if mismatched schema information is encountered.</span></span>|  
|<xref:System.Data.MissingSchemaAction.Ignore>|<span data-ttu-id="62c72-153">Ignorujte nové informace o schématu.</span><span class="sxs-lookup"><span data-stu-id="62c72-153">Ignore the new schema information.</span></span>|  
  
## <a name="constraints"></a><span data-ttu-id="62c72-154">Omezení</span><span class="sxs-lookup"><span data-stu-id="62c72-154">Constraints</span></span>  
 <span data-ttu-id="62c72-155">Pomocí `Merge` metody omezení nejsou zkontrolován, dokud všechny nové data byla přidána ke stávající `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="62c72-155">With the `Merge` method, constraints are not checked until all new data has been added to the existing `DataSet`.</span></span> <span data-ttu-id="62c72-156">Po přidání dat, jsou na aktuální hodnoty v vynucena omezení `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="62c72-156">Once the data has been added, constraints are enforced on the current values in the `DataSet`.</span></span> <span data-ttu-id="62c72-157">Je nutné zajistit, že váš kód zpracovává všechny výjimky, které mohou být vyvolány kvůli narušení omezení.</span><span class="sxs-lookup"><span data-stu-id="62c72-157">You must ensure that your code handles any exceptions that might be thrown due to constraint violations.</span></span>  
  
 <span data-ttu-id="62c72-158">Představte si případ, kde stávající řádek v `DataSet` je `Unchanged` řádek s hodnotu primárního klíče 1.</span><span class="sxs-lookup"><span data-stu-id="62c72-158">Consider a case where an existing row in a `DataSet` is an `Unchanged` row with a primary key value of 1.</span></span> <span data-ttu-id="62c72-159">Během operace sloučení s `Modified` příchozí řádek s `Original` hodnotu primárního klíče 2 a `Current` hodnotu primárního klíče 1, stávající řádek a příchozí řádek nejsou považovány za shodují, protože `Original` hodnot primárního klíče lišit.</span><span class="sxs-lookup"><span data-stu-id="62c72-159">During a merge operation with a `Modified` incoming row with an `Original` primary key value of 2 and a `Current` primary key value of 1, the existing row and the incoming row are not considered matching because the `Original` primary key values differ.</span></span> <span data-ttu-id="62c72-160">Však při dokončení sloučení a omezení jsou zaškrtnutá políčka, bude vyvolána výjimka protože `Current` hodnot primárního klíče porušují jedinečné omezení pro sloupec primárního klíče.</span><span class="sxs-lookup"><span data-stu-id="62c72-160">However, when the merge is completed and constraints are checked, an exception will be thrown because the `Current` primary key values violate the unique constraint for the primary key column.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="62c72-161">Když řádky jsou vloženy do tabulky databáze obsahující zvyšování sloupec jako sloupec identity automaticky, hodnota sloupce identity vrácený úlohy insert nemusí odpovídat hodnotě v `DataSet`, způsobuje vrácený řádky, které se připojí místo sloučit.</span><span class="sxs-lookup"><span data-stu-id="62c72-161">When rows are inserted into a database table containing an auto incrementing column such as an identity column, the identity column value returned by the insert may not match the value in the `DataSet`, causing the returned rows to be appended instead of merged.</span></span> <span data-ttu-id="62c72-162">Další informace najdete v tématu [načítání Identity nebo automatické číslování hodnoty](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="62c72-162">For more information, see [Retrieving Identity or Autonumber Values](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md).</span></span>  
  
 <span data-ttu-id="62c72-163">Následující příklad kódu Sloučí dvě `DataSet` objekty s differents schématy do jednoho `DataSet` s kombinované schémata dva příchozí `DataSet` objekty.</span><span class="sxs-lookup"><span data-stu-id="62c72-163">The following code example merges two `DataSet` objects with differents schemas into one `DataSet` with the combined schemas of the two incoming `DataSet` objects.</span></span>  
  
 [!code-csharp[DataWorks DataSet.Merge#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/CS/source.cs#1)]
 [!code-vb[DataWorks DataSet.Merge#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/VB/source.vb#1)]  
  
 <span data-ttu-id="62c72-164">Následující příklad kódu trvá existující `DataSet` s aktualizacemi a předává ty aktualizace `DataAdapter` mají být zpracovány ve zdroji dat.</span><span class="sxs-lookup"><span data-stu-id="62c72-164">The following code example takes an existing `DataSet` with updates and passes those updates to a `DataAdapter` to be processed at the data source.</span></span> <span data-ttu-id="62c72-165">Výsledky jsou pak sloučeny do původní `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="62c72-165">The results are then merged into the original `DataSet`.</span></span> <span data-ttu-id="62c72-166">Po odmítat změny, které vedly k chybě, jsou sloučené změny potvrzeny s `AcceptChanges`.</span><span class="sxs-lookup"><span data-stu-id="62c72-166">After rejecting changes that resulted in an error, the merged changes are committed with `AcceptChanges`.</span></span>  
  
 [!code-csharp[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#1)]
 [!code-vb[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#1)]  
  
 [!code-csharp[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#2)]
 [!code-vb[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#2)]  
  
## <a name="see-also"></a><span data-ttu-id="62c72-167">Viz také</span><span class="sxs-lookup"><span data-stu-id="62c72-167">See Also</span></span>  
 [<span data-ttu-id="62c72-168">Datové sady, datové tabulky a datová zobrazení</span><span class="sxs-lookup"><span data-stu-id="62c72-168">DataSets, DataTables, and DataViews</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)  
 [<span data-ttu-id="62c72-169">Stavy řádků a verze řádků</span><span class="sxs-lookup"><span data-stu-id="62c72-169">Row States and Row Versions</span></span>](../../../../../docs/framework/data/adonet/dataset-datatable-dataview/row-states-and-row-versions.md)  
 [<span data-ttu-id="62c72-170">Adaptéry a čtečky dat</span><span class="sxs-lookup"><span data-stu-id="62c72-170">DataAdapters and DataReaders</span></span>](../../../../../docs/framework/data/adonet/dataadapters-and-datareaders.md)  
 [<span data-ttu-id="62c72-171">Načítání a úpravy dat v ADO.NET</span><span class="sxs-lookup"><span data-stu-id="62c72-171">Retrieving and Modifying Data in ADO.NET</span></span>](../../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)  
 [<span data-ttu-id="62c72-172">Načítání hodnot identity nebo automatického číslování</span><span class="sxs-lookup"><span data-stu-id="62c72-172">Retrieving Identity or Autonumber Values</span></span>](../../../../../docs/framework/data/adonet/retrieving-identity-or-autonumber-values.md)  
 [<span data-ttu-id="62c72-173">ADO.NET spravované zprostředkovatelé a středisku pro vývojáře datové sady</span><span class="sxs-lookup"><span data-stu-id="62c72-173">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
