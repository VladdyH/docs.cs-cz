---
title: Data trasování v technologii ADO.NET
ms.date: 03/30/2017
ms.assetid: a6a752a5-d2a9-4335-a382-b58690ccb79f
ms.openlocfilehash: 6dd385cd58d1c8400c45139492d84e6ca4fe1bd7
ms.sourcegitcommit: 11f11ca6cefe555972b3a5c99729d1a7523d8f50
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/03/2018
ms.locfileid: "32758500"
---
# <a name="data-tracing-in-adonet"></a><span data-ttu-id="06e51-102">Data trasování v technologii ADO.NET</span><span class="sxs-lookup"><span data-stu-id="06e51-102">Data Tracing in ADO.NET</span></span>
<span data-ttu-id="06e51-103">ADO.NET funkce integrované data trasování funkce, které podporuje zprostředkovatele dat .NET pro SQL Server, Oracle, technologie OLE DB a rozhraní ODBC, jakož i technologie ADO.NET <xref:System.Data.DataSet>a protokoly sítě systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="06e51-103">ADO.NET features built-in data tracing functionality that is supported by the .NET data providers for SQL Server, Oracle, OLE DB and ODBC, as well as the ADO.NET <xref:System.Data.DataSet>, and the SQL Server network protocols.</span></span>  
  
 <span data-ttu-id="06e51-104">Data trasování volání rozhraní API přístup může pomoci diagnostikovat následující problémy:</span><span class="sxs-lookup"><span data-stu-id="06e51-104">Tracing data access API calls can help diagnose the following problems:</span></span>  
  
-   <span data-ttu-id="06e51-105">Neshoda schémat mezi program klienta a databází.</span><span class="sxs-lookup"><span data-stu-id="06e51-105">Schema mismatch between client program and the database.</span></span>  
  
-   <span data-ttu-id="06e51-106">Databáze nedostupnosti nebo síťové problémy knihovny.</span><span class="sxs-lookup"><span data-stu-id="06e51-106">Database unavailability or network library problems.</span></span>  
  
-   <span data-ttu-id="06e51-107">Nesprávný SQL zda pevného programového nebo generovaných aplikací.</span><span class="sxs-lookup"><span data-stu-id="06e51-107">Incorrect SQL whether hard coded or generated by an application.</span></span>  
  
-   <span data-ttu-id="06e51-108">Nesprávný programovací logiku.</span><span class="sxs-lookup"><span data-stu-id="06e51-108">Incorrect programming logic.</span></span>  
  
-   <span data-ttu-id="06e51-109">Problémy vyplývající z interakce mezi více součástí ADO.NET nebo mezi ADO.NET a vlastní součásti.</span><span class="sxs-lookup"><span data-stu-id="06e51-109">Issues resulting from the interaction between multiple ADO.NET components or between ADO.NET and your own components.</span></span>  
  
 <span data-ttu-id="06e51-110">Pro podporu různých trasování technologie, je rozšiřitelný, trasování, takže vývojáři mohou sledovat potíže na libovolnou úroveň zásobníku aplikace.</span><span class="sxs-lookup"><span data-stu-id="06e51-110">To support different trace technologies, tracing is extensible, so a developer can trace a problem at any level of the application stack.</span></span> <span data-ttu-id="06e51-111">I když trasování není funkce pouze ADO.NET, zprostředkovatelé Microsoft využít výhod zobecněný trasování a instrumentace rozhraní API.</span><span class="sxs-lookup"><span data-stu-id="06e51-111">Although tracing is not an ADO.NET-only feature, Microsoft providers take advantage of generalized tracing and instrumentation APIs.</span></span>  
  
 <span data-ttu-id="06e51-112">Další informace o nastavení a konfigurace spravovaných trasování v ADO.NET najdete v tématu [přístup k datům trasování](http://msdn.microsoft.com/library/hh880086.aspx).</span><span class="sxs-lookup"><span data-stu-id="06e51-112">For more information about setting and configuring managed tracing in ADO.NET, see [Tracing Data Access](http://msdn.microsoft.com/library/hh880086.aspx).</span></span>  
  
## <a name="accessing-diagnostic-information-in-the-extended-events-log"></a><span data-ttu-id="06e51-113">Přístup k diagnostické informace v protokolu rozšířené události</span><span class="sxs-lookup"><span data-stu-id="06e51-113">Accessing Diagnostic Information in the Extended Events Log</span></span>  
 <span data-ttu-id="06e51-114">V [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider pro SQL Server, přístup k datům trasování ([Data trasování přístup](http://msdn.microsoft.com/library/hh880086.aspx)) byl aktualizovaný, aby bylo snazší snazší ke korelaci událostí klienta s diagnostické informace, jako je například selhání připojení z připojení k serveru prstence vyrovnávací paměti a aplikace informace o výkonu v rozšířené události protokolu.</span><span class="sxs-lookup"><span data-stu-id="06e51-114">In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server, data access tracing ([Data Access Tracing](http://msdn.microsoft.com/library/hh880086.aspx)) has been updated to make it easier to easier to correlate client events with diagnostic information, such as connection failures, from the server's connectivity ring buffer and application performance information in the extended events log.</span></span> <span data-ttu-id="06e51-115">Informace o čtení protokolu rozšířených událostí najdete v tématu [Data relace události zobrazení](http://msdn.microsoft.com/library/hh710068\(SQL.110\).aspx).</span><span class="sxs-lookup"><span data-stu-id="06e51-115">For information about reading the extended events log, see [View Event Session Data](http://msdn.microsoft.com/library/hh710068\(SQL.110\).aspx).</span></span>  
  
 <span data-ttu-id="06e51-116">Pro operace připojení ADO.NET odešle klient ID připojení.</span><span class="sxs-lookup"><span data-stu-id="06e51-116">For connection operations, ADO.NET will send a client connection ID.</span></span> <span data-ttu-id="06e51-117">Pokud se nepovede připojit, dostanete cyklické vyrovnávací paměti připojení ([řešení potíží s připojením v systému SQL Server 2008 s cyklické vyrovnávací paměti připojení](http://go.microsoft.com/fwlink/?LinkId=207752)) a najděte `ClientConnectionID` pole a získání diagnostických informací připojení se nezdařilo.</span><span class="sxs-lookup"><span data-stu-id="06e51-117">If the connection fails, you can access the connectivity ring buffer ([Connectivity troubleshooting in SQL Server 2008 with the Connectivity Ring Buffer](http://go.microsoft.com/fwlink/?LinkId=207752)) and find the `ClientConnectionID` field and get diagnostic information about the connection failure.</span></span> <span data-ttu-id="06e51-118">ID připojení klienta jsou protokolovány v cyklické vyrovnávací paměti pouze v případě, že dojde k chybě.</span><span class="sxs-lookup"><span data-stu-id="06e51-118">Client connection IDs are logged in the ring buffer only if an error occurs.</span></span> <span data-ttu-id="06e51-119">(V případě selhání připojení před odesláním paketu před přihlašováním, který nebude vygenerováno ID připojení klienta.) ID připojení klienta je identifikátor GUID 16 bajtů.</span><span class="sxs-lookup"><span data-stu-id="06e51-119">(If a connection fails before sending the prelogin packet, a client connection ID will not be generated.) The client connection ID is a 16-byte GUID.</span></span> <span data-ttu-id="06e51-120">Můžete také získat připojení klienta ID ve výstupu cíl rozšířených událostí, pokud `client_connection_id` akce se přidá k událostem v relaci rozšířených událostí.</span><span class="sxs-lookup"><span data-stu-id="06e51-120">You can also find the client connection ID in the extended events target output, if the `client_connection_id` action is added to events in an extended events session.</span></span> <span data-ttu-id="06e51-121">Můžete povolit přístup k trasování dat a znovu spusťte příkaz připojení a sledovat `ClientConnectionID` pole přístup do dat trasování, pokud potřebujete další pomoc diagnostiky ovladače klienta.</span><span class="sxs-lookup"><span data-stu-id="06e51-121">You can enable data access tracing and rerun the connection command and observe the `ClientConnectionID` field in the data access trace, if you need further client driver diagnostic assistance.</span></span>  
  
 <span data-ttu-id="06e51-122">Můžete získat klienta ID připojení prostřednictvím kódu programu pomocí `SqlConnection.ClientConnectionID` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="06e51-122">You can get the client connection ID programmatically by using the `SqlConnection.ClientConnectionID` property.</span></span>  
  
 <span data-ttu-id="06e51-123">`ClientConnectionID` Je k dispozici pro <xref:System.Data.SqlClient.SqlConnection> objekt, který úspěšně naváže připojení.</span><span class="sxs-lookup"><span data-stu-id="06e51-123">The `ClientConnectionID` is available for a <xref:System.Data.SqlClient.SqlConnection> object that successfully establishes  a connection.</span></span> <span data-ttu-id="06e51-124">Pokud se nezdaří pokus o připojení, `ClientConnectionID` mohou být k dispozici prostřednictvím `SqlException.ToString`.</span><span class="sxs-lookup"><span data-stu-id="06e51-124">If a connection attempt fails, `ClientConnectionID` may be available via `SqlException.ToString`.</span></span>  
  
 <span data-ttu-id="06e51-125">ADO.NET rovněž odesílá ID aktivity specifické pro vlákno</span><span class="sxs-lookup"><span data-stu-id="06e51-125">ADO.NET also sends a thread-specific activity ID.</span></span> <span data-ttu-id="06e51-126">Pokud jsou spuštěné relace s povolenou možností TRACK_CAUSAILITY ID aktivity zachytí ve relace rozšířených událostí.</span><span class="sxs-lookup"><span data-stu-id="06e51-126">The activity ID is captured in the extended events sessions if the sessions are started with the TRACK_CAUSAILITY option enabled.</span></span> <span data-ttu-id="06e51-127">Pro problémy s výkonem s aktivním připojení, můžete získat ID aktivity trasování přístup dat klienta (`ActivityID` pole) a poté vyhledejte ID aktivity ve výstupu rozšířené události.</span><span class="sxs-lookup"><span data-stu-id="06e51-127">For performance issues with an active connection, you can get the activity ID from the client's data access trace (`ActivityID` field) and then locate the activity ID in the extended events output.</span></span> <span data-ttu-id="06e51-128">ID aktivity v rozšířených událostí je 16 bajtů GUID (není stejný jako identifikátor GUID pro ID připojení klienta), do spolu s čtyř bajtů pořadové číslo.</span><span class="sxs-lookup"><span data-stu-id="06e51-128">The activity ID in extended events is a 16-byte GUID (not the same as the GUID for the client connection ID) appended with a four-byte sequence number.</span></span> <span data-ttu-id="06e51-129">Pořadové číslo představuje pořadí žádost v rámci vlákna a určuje relativní řazení batch a příkazy RPC pro vlákno.</span><span class="sxs-lookup"><span data-stu-id="06e51-129">The sequence number represents the order of a request within a thread and indicates the relative ordering of batch and RPC statements for the thread.</span></span> <span data-ttu-id="06e51-130">`ActivityID` Je aktuálně volitelně odeslán pro batch příkazů jazyka SQL a žádosti RPC při zapnutém trasování přístup dat na a 18 bit ve službě data access trasování word konfigurace je zapnutý.</span><span class="sxs-lookup"><span data-stu-id="06e51-130">The `ActivityID` is currently optionally sent for SQL batch statements and RPC requests when data access tracing is enabled on and the 18th bit in the data access tracing configuration word is turned ON.</span></span>  
  
 <span data-ttu-id="06e51-131">Tady je ukázka, která používá [!INCLUDE[tsql](../../../../includes/tsql-md.md)] zahájíte relaci rozšířených událostí, která se uloží na cyklické vyrovnávací paměti a budou si poznamenejte ID aktivity odeslaných z klienta na RPC a dávkové operace.</span><span class="sxs-lookup"><span data-stu-id="06e51-131">The following is a sample that uses [!INCLUDE[tsql](../../../../includes/tsql-md.md)] to start an extended events session that will be stored in a ring buffer and will record the activity ID sent from a client on RPC and batch operations.</span></span>  
  
```  
create event session MySession on server   
add event connectivity_ring_buffer_recorded,   
add event sql_statement_starting (action (client_connection_id)),   
add event sql_statement_completed (action (client_connection_id)),   
add event rpc_starting (action (client_connection_id)),   
add event rpc_completed (action (client_connection_id))  
add target ring_buffer with (track_causality=on)  
```  
  
## <a name="see-also"></a><span data-ttu-id="06e51-132">Viz také</span><span class="sxs-lookup"><span data-stu-id="06e51-132">See Also</span></span>  
 [<span data-ttu-id="06e51-133">Trasování sítě v rozhraní .NET Framework</span><span class="sxs-lookup"><span data-stu-id="06e51-133">Network Tracing in the .NET Framework</span></span>](../../../../docs/framework/network-programming/network-tracing.md)  
 [<span data-ttu-id="06e51-134">Trasování a instrumentace aplikací</span><span class="sxs-lookup"><span data-stu-id="06e51-134">Tracing and Instrumenting Applications</span></span>](../../../../docs/framework/debug-trace-profile/tracing-and-instrumenting-applications.md)  
 [<span data-ttu-id="06e51-135">ADO.NET spravované zprostředkovatelé a středisku pro vývojáře datové sady</span><span class="sxs-lookup"><span data-stu-id="06e51-135">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
