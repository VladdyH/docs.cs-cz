---
title: Usnadnění ladění obrázku
ms.date: 03/30/2017
helpviewer_keywords:
- images [.NET Framework], debugging
- executable image for debugging
- debugging [.NET Framework], executable images for
ms.assetid: 7d90ea7a-150f-4f97-98a7-f9c26541b9a3
author: mairaw
ms.author: mairaw
ms.openlocfilehash: c58008bc621ea95fbb2e4cc5e7d4521576aca37c
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/04/2018
ms.locfileid: "33391043"
---
# <a name="making-an-image-easier-to-debug"></a><span data-ttu-id="1f8e6-102">Usnadnění ladění obrázku</span><span class="sxs-lookup"><span data-stu-id="1f8e6-102">Making an Image Easier to Debug</span></span>
<span data-ttu-id="1f8e6-103">Při kompilaci nespravovaného kódu je možné nakonfigurovat spustitelnou bitovou kopii pro ladění nastavením přepínačů IDE nebo parametrů příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-103">When compiling unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="1f8e6-104">Například můžete použít nebo**Zi** možnost příkazového řádku v jazyce Visual C++ a požádejte ho pro vydávání soubory ladění symbolu (.pdb přípona souboru).</span><span class="sxs-lookup"><span data-stu-id="1f8e6-104">For example, you can use the /**Zi** command-line option in Visual C++ to ask it to emit debug symbol files (file extension .pdb).</span></span> <span data-ttu-id="1f8e6-105">Podobně /**Od** říká možnost příkazového řádku kompilátoru zakázat optimalizace.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-105">Similarly, the /**Od** command-line option tells the compiler to disable optimization.</span></span> <span data-ttu-id="1f8e6-106">Výsledný kód pracuje pomaleji, ale je snadnější v něm v případě potřeby provádět ladění.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-106">The resulting code runs more slowly, but is easier to debug, should this be necessary.</span></span>  
  
 <span data-ttu-id="1f8e6-107">Při kompilaci spravovaného kódu rozhraní .NET Framework kompilují kompilátory jazyků jako Visual C++, Visual Basic a C# vlastní zdrojové programy do jazyka MSIL (Microsoft Intermediate Language).</span><span class="sxs-lookup"><span data-stu-id="1f8e6-107">When compiling .NET Framework managed code, compilers such as Visual C++, Visual Basic, and C# compile their source program into Microsoft Intermediate Language (MSIL).</span></span> <span data-ttu-id="1f8e6-108">Jazyk MSIL je následně těsně před spuštěním překompilován JIT kompilátorem do nativního strojového kódu.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-108">MSIL is subsequently JIT-compiled, just before execution, into native machine code.</span></span> <span data-ttu-id="1f8e6-109">Stejně jako u nespravovaného kódu je možné nakonfigurovat spustitelnou bitovou kopii pro ladění nastavením přepínačů IDE nebo parametrů příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-109">As with unmanaged code, you can configure an executable image for debugging by setting IDE switches or command-line options.</span></span> <span data-ttu-id="1f8e6-110">Kromě toho lze kompilaci JIT nastavit pro ladění v podstatě stejným způsobem.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-110">In addition, you can configure the JIT compilation for debugging in much the same way.</span></span>  
  
 <span data-ttu-id="1f8e6-111">Tato konfigurace JIT má dva aspekty:</span><span class="sxs-lookup"><span data-stu-id="1f8e6-111">This JIT configuration has two aspects:</span></span>  
  
-   <span data-ttu-id="1f8e6-112">Je možné požadovat po JIT kompilátoru generování informací o sledování.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-112">You can request the JIT-compiler to generate tracking information.</span></span> <span data-ttu-id="1f8e6-113">To umožňuje ladicímu programu nalézt shodu se svým protějškem strojového kódu řetězce jazyka MSIL a sledovat, kde jsou uloženy místní proměnné a argumenty funkce.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-113">This makes it possible for the debugger to match up a chain of MSIL with its machine code counterpart, and to track where local variables and function arguments are stored.</span></span>  <span data-ttu-id="1f8e6-114">V rozhraní .NET Framework 2.0 bude kompilátor JIT vždy generovat informace o sledování, a není tedy nutné o ně žádat.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-114">In the .NET Framework version 2.0, the JIT compiler will always generate tracking information, so there is no need to request it.</span></span>  
  
-   <span data-ttu-id="1f8e6-115">Je možné požadovat po kompilátoru JIT, aby neprováděl optimalizaci výsledného strojového kódu.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-115">You can request the JIT-compiler to not optimize the resulting machine code.</span></span>  
  
 <span data-ttu-id="1f8e6-116">Za normálních okolností kompilátoru, která generuje MSIL nastaví tyto možnosti JIT kompilátoru správně, na základě přepínačů IDE nebo možnosti příkazového řádku zadáte, například /**Od**.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-116">Normally, the compiler that generates the MSIL sets these JIT-compiler options appropriately, based upon the IDE switches or command-line options you specify, for example, /**Od**.</span></span>  
  
 <span data-ttu-id="1f8e6-117">V některých případech bude zapotřebí změnit chování kompilátoru JIT tak, aby bylo možné strojový kód, který generuje, snadněji ladit.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-117">In some cases, you might want to change the behavior of the JIT compiler so that the machine code it generates is easier to debug.</span></span> <span data-ttu-id="1f8e6-118">Například může být třeba generovat informace o sledování JIT pro sestavení prodejní verze nebo pro optimalizaci řízení.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-118">For example, you might want to generate JIT tracking information for a retail build or control optimization.</span></span> <span data-ttu-id="1f8e6-119">To lze provést pomocí inicializačního souboru (.ini).</span><span class="sxs-lookup"><span data-stu-id="1f8e6-119">You can do so with an initialization (.ini) file.</span></span>  
  
 <span data-ttu-id="1f8e6-120">Pokud se například sestavení, které je třeba ladit, nazývá MyApp.exe, je možné vytvořit textový soubor s názvem MyApp.ini ve stejné složce jako MyApp.exe, který bude obsahovat tyto tři řádky:</span><span class="sxs-lookup"><span data-stu-id="1f8e6-120">For example, if the assembly you want to debug is called MyApp.exe, then you can create a text file named MyApp.ini, in the same folder as MyApp.exe, which contains these three lines:</span></span>  
  
```  
[.NET Framework Debugging Control]  
GenerateTrackingInfo=1  
AllowOptimize=0  
```  
  
 <span data-ttu-id="1f8e6-121">Hodnotu každé možnosti lze nastavit na 0 nebo 1 a chybějící možnost bude mít výchozí hodnotu 0.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-121">You can set the value of each option to 0 or 1, and any absent option defaults to 0.</span></span> <span data-ttu-id="1f8e6-122">Nastavení volby `GenerateTrackingInfo` na hodnotu 1 a volby `AllowOptimize` na hodnotu 0 poskytuje nejjednodušší ladění.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-122">Setting `GenerateTrackingInfo` to 1 and `AllowOptimize` to 0 provides the easiest debugging.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f8e6-123">V rozhraní .NET Framework 2.0 bude JIT kompilátor vždy generovat informace o sledování bez ohledu na hodnotu volby `GenerateTrackingInfo`, nicméně hodnota volby `AllowOptimize` má účinek.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-123">In the .NET Framework version 2.0, the JIT compiler always generates tracking information regardless of the value for `GenerateTrackingInfo`; however, the `AllowOptimize` value still has an effect.</span></span> <span data-ttu-id="1f8e6-124">Při použití [Ngen.exe (Generátor nativních obrázků)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) předkompilovat Nativní bitová kopie bez optimalizace, musí být soubor .ini v cílové složce s `AllowOptimize=0` při Ngen.exe provede.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-124">When using the [Ngen.exe (Native Image Generator)](../../../docs/framework/tools/ngen-exe-native-image-generator.md) to precompile the native image without optimization, the .ini file must be present in the target folder with `AllowOptimize=0` when Ngen.exe executes.</span></span> <span data-ttu-id="1f8e6-125">Pokud máte předkompilovaných sestavení bez optimalizace, musíte odebrat předkompilovaných kódu pomocí NGen.exe **/ uninstall** možnost před opětovným spuštěním Ngen.exe předkompilovat kód jako optimalizované.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-125">If you have precompiled an assembly without optimization, you must remove the precompiled code using the NGen.exe **/uninstall** option before rerunning Ngen.exe to precompile the code as optimized.</span></span> <span data-ttu-id="1f8e6-126">Není-li ve složce k dispozici soubor .ini, provede soubor Ngen.exe předkompilování kódu jako optimalizovaného.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-126">If the .ini file is not present in the folder, by default Ngen.exe precompiles the code as optimized.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f8e6-127"><xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> určuje nastavení sestavení.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-127">The <xref:System.Diagnostics.DebuggableAttribute?displayProperty=nameWithType> controls the settings for an assembly.</span></span> <span data-ttu-id="1f8e6-128">**Atribut DebuggableAttribute** zahrnuje dvě pole, které záznam nastavení pro zda by měl optimalizace kompilátoru za běhu, a generovat informace o sledování.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-128">**DebuggableAttribute** includes two fields that record the settings for whether the JIT compiler should optimize, and/or generate tracking information.</span></span> <span data-ttu-id="1f8e6-129">V rozhraní .NET Framework 2.0 bude JIT kompilátor vždy generovat informace o sledování.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-129">In the .NET Framework version 2.0, the JIT compiler will always generate tracking information.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f8e6-130">Pro maloobchodní sestavení, kompilátory není nastaveno žádné **atribut DebuggableAttribute**.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-130">For a retail build, compilers do not set any **DebuggableAttribute**.</span></span> <span data-ttu-id="1f8e6-131">Výchozím chováním JIT kompilátoru je generování nejvyššího výkonu strojového kódu s nejtěžší možností ladění.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-131">The JIT-compiler default behavior is to generate the highest performance, hardest to debug machine code.</span></span> <span data-ttu-id="1f8e6-132">Povolením JIT sledování se snižuje výkon a vypnutím optimalizace se výkon razantně snižuje.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-132">Enabling JIT tracking lowers performance a little, and disabling optimization lowers performance a lot.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f8e6-133">**Atribut DebuggableAttribute** se vztahují na celé sestavení v čase, nikoli na jednotlivé moduly v rámci sestavení.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-133">The **DebuggableAttribute** applies to a whole assembly at a time, not to individual modules within the assembly.</span></span> <span data-ttu-id="1f8e6-134">Nástroje pro vývoj musí proto přiřadit vlastní atributy token metadata sestavení, pokud sestavení se již byly vytvořeny, nebo k třídě volá **System.Runtime.CompilerServices.AssemblyAttributesGoHere**.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-134">Development tools must therefore attach custom attributes to the assembly metadata token, if an assembly has already been created, or to the class called **System.Runtime.CompilerServices.AssemblyAttributesGoHere**.</span></span> <span data-ttu-id="1f8e6-135">Nástroj ALink bude povýšit, pak tyto **atribut DebuggableAttribute** atributů z modulů sestavení stanou součástí.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-135">The ALink tool will then promote these **DebuggableAttribute** attributes from each module to the assembly they become a part of.</span></span> <span data-ttu-id="1f8e6-136">Pokud dojde ke konfliktu, operace nástroje ALink se nezdaří.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-136">If there is a conflict, the ALink operation will fail.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="1f8e6-137">V rozhraní .NET Framework verze 1.0, Microsoft Visual C++ compiler přidá **atribut DebuggableAttribute** při **/CLR** a **/Zi** – možnosti kompilátoru nejsou zadány.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-137">In version 1.0 of the .NET Framework, the Microsoft Visual C++ compiler adds the **DebuggableAttribute** when the **/clr** and **/Zi** compiler options are specified.</span></span> <span data-ttu-id="1f8e6-138">V rozhraní .NET Framework verze 1.1, musíte buď přidat **DebugabbleAttribute** ručně v kódu nebo použití **/ASSEMBLYDEBUG** – možnost linkeru.</span><span class="sxs-lookup"><span data-stu-id="1f8e6-138">In version 1.1 of the .NET Framework, you must either add the **DebugabbleAttribute** manually in your code or use the **/ASSEMBLYDEBUG** linker option.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1f8e6-139">Viz také</span><span class="sxs-lookup"><span data-stu-id="1f8e6-139">See Also</span></span>  
 [<span data-ttu-id="1f8e6-140">Ladění, trasování a profilace</span><span class="sxs-lookup"><span data-stu-id="1f8e6-140">Debugging, Tracing, and Profiling</span></span>](../../../docs/framework/debug-trace-profile/index.md)  
 [<span data-ttu-id="1f8e6-141">Povolení JIT – ladění Attach</span><span class="sxs-lookup"><span data-stu-id="1f8e6-141">Enabling JIT-Attach Debugging</span></span>](../../../docs/framework/debug-trace-profile/enabling-jit-attach-debugging.md)  
 [<span data-ttu-id="1f8e6-142">Povolení profilace</span><span class="sxs-lookup"><span data-stu-id="1f8e6-142">Enabling Profiling</span></span>](http://msdn.microsoft.com/library/3b669676-f0e0-4ebf-8674-68986dd2020d)
