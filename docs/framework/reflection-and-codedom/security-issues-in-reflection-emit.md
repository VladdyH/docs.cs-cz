---
title: "Bezpečnostní problémy v generování reflexe"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- partially trusted code
- emitting dynamic assemblies, security
- reflection emit, security
- reflection emit, partial trust scenarios
- partial trust,emitting dynamic methods
- anonymously hosted dynamic methods [.NET Framework]
- emitting dynamic assemblies,partial trust scenarios
- dynamic assemblies, security
ms.assetid: 0f8bf8fa-b993-478f-87ab-1a1a7976d298
caps.latest.revision: "18"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.openlocfilehash: d143798c4344b385d954cc64bd63c8f81eb48750
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/21/2017
---
# <a name="security-issues-in-reflection-emit"></a><span data-ttu-id="61a13-102">Bezpečnostní problémy v generování reflexe</span><span class="sxs-lookup"><span data-stu-id="61a13-102">Security Issues in Reflection Emit</span></span>
<span data-ttu-id="61a13-103">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] Poskytuje tři způsoby, jak emitování Microsoft mezilehlé jazyk MSIL, každou s vlastním problémy se zabezpečením:</span><span class="sxs-lookup"><span data-stu-id="61a13-103">The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] provides three ways to emit Microsoft intermediate language (MSIL), each with its own security issues:</span></span>  
  
-   [<span data-ttu-id="61a13-104">Dynamická sestavení</span><span class="sxs-lookup"><span data-stu-id="61a13-104">Dynamic assemblies</span></span>](#Dynamic_Assemblies)  
  
-   [<span data-ttu-id="61a13-105">Anonymně hostované dynamické metody</span><span class="sxs-lookup"><span data-stu-id="61a13-105">Anonymously hosted dynamic methods</span></span>](#Anonymously_Hosted_Dynamic_Methods)  
  
-   [<span data-ttu-id="61a13-106">Dynamické metody, které jsou přidružené k existující sestavení</span><span class="sxs-lookup"><span data-stu-id="61a13-106">Dynamic methods associated with existing assemblies</span></span>](#Dynamic_Methods_Associated_with_Existing_Assemblies)  
  
 <span data-ttu-id="61a13-107">Bez ohledu na způsob generování dynamický kód spouštění generovaný kód vyžaduje všechna oprávnění, které jsou vyžadované typy a metody, které používá generovaného kódu.</span><span class="sxs-lookup"><span data-stu-id="61a13-107">Regardless of the way you generate dynamic code, executing the generated code requires all the permissions that are required by the types and methods the generated code uses.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="61a13-108">Došlo ke změně oprávnění, které jsou požadovány pro odrážející na kód a generování kódu s úspěšné verzích [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="61a13-108">The permissions that are required for reflecting on code and emitting code have changed with succeeding releases of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="61a13-109">V tématu [informace o verzi](#Version_Information)dál v tomto tématu.</span><span class="sxs-lookup"><span data-stu-id="61a13-109">See [Version Information](#Version_Information), later in this topic.</span></span>  
  
<a name="Dynamic_Assemblies"></a>   
## <a name="dynamic-assemblies"></a><span data-ttu-id="61a13-110">Dynamická sestavení</span><span class="sxs-lookup"><span data-stu-id="61a13-110">Dynamic Assemblies</span></span>  
 <span data-ttu-id="61a13-111">Dynamická sestavení se vytváří pomocí přetížení <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType> metoda.</span><span class="sxs-lookup"><span data-stu-id="61a13-111">Dynamic assemblies are created by using overloads of the <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="61a13-112">Většina přetížení této metody jsou zastaralé v [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], z důvodu odstranění zásady zabezpečení pro celý počítač.</span><span class="sxs-lookup"><span data-stu-id="61a13-112">Most overloads of this method are deprecated in the [!INCLUDE[net_v40_long](../../../includes/net-v40-long-md.md)], because of the elimination of machine-wide security policy.</span></span> <span data-ttu-id="61a13-113">(Viz [změny zabezpečení](../../../docs/framework/security/security-changes.md).) Zbývající přetížení může provádět žádný kód, bez ohledu na úroveň důvěryhodnosti.</span><span class="sxs-lookup"><span data-stu-id="61a13-113">(See [Security Changes](../../../docs/framework/security/security-changes.md).) The remaining overloads can be executed by any code, regardless of trust level.</span></span> <span data-ttu-id="61a13-114">Tato přetížení lze rozdělit do dvou skupin: ty, které zadat seznam atributů, které chcete použít u dynamických sestavení, když je vytvořen a ty, které nepodporují.</span><span class="sxs-lookup"><span data-stu-id="61a13-114">These overloads fall into two groups: those that specify a list of attributes to apply to the dynamic assembly when it is created, and those that do not.</span></span> <span data-ttu-id="61a13-115">Pokud nezadáte model transparentnosti pro sestavení, s použitím <xref:System.Security.SecurityRulesAttribute> atribut při vytváření, model transparentnosti je zděděn z generování sestavení.</span><span class="sxs-lookup"><span data-stu-id="61a13-115">If you do not specify the transparency model for the assembly, by applying the <xref:System.Security.SecurityRulesAttribute> attribute when you create it, the transparency model is inherited from the emitting assembly.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="61a13-116">Atributy, které používají dynamické sestavení po vytvoření pomocí <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> metoda, se projeví až sestavení je uložen na disk a znovu načten do paměti.</span><span class="sxs-lookup"><span data-stu-id="61a13-116">Attributes that you apply to the dynamic assembly after it is created, by using the <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> method, do not take effect until the assembly has been saved to disk and loaded into memory again.</span></span>  
  
 <span data-ttu-id="61a13-117">Kód v dynamickém sestavení může přistupovat viditelné typy a členy v ostatních sestavení.</span><span class="sxs-lookup"><span data-stu-id="61a13-117">Code in a dynamic assembly can access visible types and members in other assemblies.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="61a13-118">Dynamická sestavení se nedoporučuje používat <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> a <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> příznaky, které umožňují dynamické metody pro přístup k neveřejní typy a členy.</span><span class="sxs-lookup"><span data-stu-id="61a13-118">Dynamic assemblies do not use the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> and <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flags that allow dynamic methods to access nonpublic types and members.</span></span>  
  
 <span data-ttu-id="61a13-119">Přechodný dynamická sestavení jsou vytvořené v paměti a nikdy uložen na disk, proto potřebují žádné přístupová oprávnění k souboru.</span><span class="sxs-lookup"><span data-stu-id="61a13-119">Transient dynamic assemblies are created in memory and never saved to disk, so they require no file access permissions.</span></span> <span data-ttu-id="61a13-120">Dynamická sestavení ukládání na disk vyžaduje <xref:System.Security.Permissions.FileIOPermission> s příslušnými příznaky.</span><span class="sxs-lookup"><span data-stu-id="61a13-120">Saving a dynamic assembly to disk requires <xref:System.Security.Permissions.FileIOPermission> with the appropriate flags.</span></span>  
  
### <a name="generating-dynamic-assemblies-from-partially-trusted-code"></a><span data-ttu-id="61a13-121">Generování dynamických sestavení z částečně důvěryhodného kódu</span><span class="sxs-lookup"><span data-stu-id="61a13-121">Generating Dynamic Assemblies from Partially Trusted Code</span></span>  
 <span data-ttu-id="61a13-122">Vezměte v úvahu podmínky, ve kterých sestavení s oprávněními Internetu generovat přechodný dynamické sestavení a provést jeho kód:</span><span class="sxs-lookup"><span data-stu-id="61a13-122">Consider the conditions in which an assembly with Internet permissions can generate a transient dynamic assembly and execute its code:</span></span>  
  
-   <span data-ttu-id="61a13-123">Dynamická sestavení používá pouze veřejné typy a členy ostatních sestavení.</span><span class="sxs-lookup"><span data-stu-id="61a13-123">The dynamic assembly uses only public types and members of other assemblies.</span></span>  
  
-   <span data-ttu-id="61a13-124">Oprávnění pro název tyto typy a členy jsou součástí sady udělení částečně důvěryhodné sestavení.</span><span class="sxs-lookup"><span data-stu-id="61a13-124">The permissions demanded by those types and members are included in the grant set of the partially trusted assembly.</span></span>  
  
-   <span data-ttu-id="61a13-125">Sestavení není uložen na disk.</span><span class="sxs-lookup"><span data-stu-id="61a13-125">The assembly is not saved to disk.</span></span>  
  
-   <span data-ttu-id="61a13-126">Ladění nejsou generované symboly.</span><span class="sxs-lookup"><span data-stu-id="61a13-126">Debug symbols are not generated.</span></span> <span data-ttu-id="61a13-127">(`Internet` a `LocalIntranet` sady oprávnění nezahrnují potřebná oprávnění.)</span><span class="sxs-lookup"><span data-stu-id="61a13-127">(`Internet` and `LocalIntranet` permission sets do not include the necessary permissions.)</span></span>  
  
<a name="Anonymously_Hosted_Dynamic_Methods"></a>   
## <a name="anonymously-hosted-dynamic-methods"></a><span data-ttu-id="61a13-128">Anonymně hostované dynamické metody</span><span class="sxs-lookup"><span data-stu-id="61a13-128">Anonymously Hosted Dynamic Methods</span></span>  
 <span data-ttu-id="61a13-129">Anonymně hostované dynamické metody se vytváří pomocí dvou <xref:System.Reflection.Emit.DynamicMethod> konstruktory, které neurčují modul, nebo přidružený typ <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> a <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="61a13-129">Anonymously hosted dynamic methods are created by using the two <xref:System.Reflection.Emit.DynamicMethod> constructors that do not specify an associated type or module, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> and <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span></span> <span data-ttu-id="61a13-130">Tyto konstruktory umístit dynamické metody poskytované systémem, plně důvěryhodný, transparentní pro zabezpečení sestavení.</span><span class="sxs-lookup"><span data-stu-id="61a13-130">These constructors place the dynamic methods in a system-provided, fully trusted, security-transparent assembly.</span></span> <span data-ttu-id="61a13-131">Je nutné použít tyto konstruktory nebo pro vydávání kód pro dynamické metody žádná oprávnění.</span><span class="sxs-lookup"><span data-stu-id="61a13-131">No permissions are required to use these constructors or to emit code for the dynamic methods.</span></span>  
  
 <span data-ttu-id="61a13-132">Místo toho když je vytvořen pomocí anonymně hostované dynamické metody, se zaznamená zásobníku volání.</span><span class="sxs-lookup"><span data-stu-id="61a13-132">Instead, when an anonymously hosted dynamic method is created, the call stack is captured.</span></span> <span data-ttu-id="61a13-133">Když se metoda, jsou vytvářeny požadavky zabezpečení proti zásobníku zaznamenané volání.</span><span class="sxs-lookup"><span data-stu-id="61a13-133">When the method is constructed, security demands are made against the captured call stack.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="61a13-134">Požadavky koncepčně, jsou vytvářeny během vytváření metody.</span><span class="sxs-lookup"><span data-stu-id="61a13-134">Conceptually, demands are made during the construction of the method.</span></span> <span data-ttu-id="61a13-135">Požadavky na to znamená, může být provedeny, jako jsou vydávány každé MSIL instrukcí.</span><span class="sxs-lookup"><span data-stu-id="61a13-135">That is, demands could be made as each MSIL instruction is emitted.</span></span> <span data-ttu-id="61a13-136">V aktuální implementace všechny požadavky probíhají, kdy <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> metoda je volána, nebo když je volána kompilátoru v běhu (JIT), pokud metoda je volána bez volání <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span><span class="sxs-lookup"><span data-stu-id="61a13-136">In the current implementation, all demands are made when the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> method is called or when the just-in-time (JIT) compiler is invoked, if the method is invoked without calling <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span></span>  
  
 <span data-ttu-id="61a13-137">Pokud to dovoluje doménu aplikace, anonymně hostované dynamické metody můžete přeskočit kontroly viditelnost JIT, vztahují následující omezení: neveřejní typy a členy přistupují anonymně hostované dynamické metody musí být v sestavení, jejichž grant nastaví se rovná se nebo podmnožiny, udělte sadu generování zásobníku volání.</span><span class="sxs-lookup"><span data-stu-id="61a13-137">If the application domain permits it, anonymously hosted dynamic methods can skip JIT visibility checks, subject to the following restriction: The nonpublic types and members accessed by an anonymously hosted dynamic method must be in assemblies whose grant sets are equal to, or subsets of, the grant set of the emitting call stack.</span></span> <span data-ttu-id="61a13-138">Tato omezená schopnost přeskočit JIT viditelnost kontroluje je povolena, pokud doména aplikace uděluje <xref:System.Security.Permissions.ReflectionPermission> s <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> příznak.</span><span class="sxs-lookup"><span data-stu-id="61a13-138">This restricted ability to skip JIT visibility checks is enabled if the application domain grants <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
-   <span data-ttu-id="61a13-139">Pokud vaše metoda se používá pouze veřejné typy a členy, během vytváření nejsou požadována žádná oprávnění.</span><span class="sxs-lookup"><span data-stu-id="61a13-139">If your method uses only public types and members, no permissions are required during construction.</span></span>  
  
-   <span data-ttu-id="61a13-140">Pokud určíte, že JIT viditelnost kontroluje má vynecháno, požadavků, které se provádí, když se metoda zahrnuje <xref:System.Security.Permissions.ReflectionPermission> s <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> příznak a udělte sadu sestavení, které obsahuje neveřejní člena, který je přistupuje.</span><span class="sxs-lookup"><span data-stu-id="61a13-140">If you specify that JIT visibility checks should be skipped, the demand that is made when the method is constructed includes <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag and the grant set of the assembly that contains the nonpublic member that is being accessed.</span></span>  
  
 <span data-ttu-id="61a13-141">Protože sady udělení neveřejní člena v úvahu, částečně důvěryhodného kódu, kterému byla udělena <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> nelze zvýšení jeho oprávnění tak, že spustíte neveřejní členové důvěryhodných sestavení.</span><span class="sxs-lookup"><span data-stu-id="61a13-141">Because the grant set of the nonpublic member is taken into consideration, partially trusted code that has been granted <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> cannot elevate its privileges by executing nonpublic members of trusted assemblies.</span></span>  
  
 <span data-ttu-id="61a13-142">Jako další emitovaného kód, provedení dynamické metody vyžaduje všechna oprávnění jsou pro název metody, které používá metodu dynamické.</span><span class="sxs-lookup"><span data-stu-id="61a13-142">As with any other emitted code, executing the dynamic method requires whatever permissions are demanded by the methods the dynamic method uses.</span></span>  
  
 <span data-ttu-id="61a13-143">Sestavení systému, který je hostitelem anonymně hostované dynamické metody používá <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType> průhlednost model, který je průhlednost model, který byl použit v rozhraní .NET Framework, než [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)].</span><span class="sxs-lookup"><span data-stu-id="61a13-143">The system assembly that hosts anonymously-hosted dynamic methods uses the <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType> transparency model, which is the transparency model that was used in the .NET Framework before the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)].</span></span>  
  
 <span data-ttu-id="61a13-144">Další informace najdete v tématu <xref:System.Reflection.Emit.DynamicMethod> třídy.</span><span class="sxs-lookup"><span data-stu-id="61a13-144">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-anonymously-hosted-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="61a13-145">Generování anonymně hostované dynamické metody z částečně důvěryhodného kódu</span><span class="sxs-lookup"><span data-stu-id="61a13-145">Generating Anonymously Hosted Dynamic Methods from Partially Trusted Code</span></span>  
 <span data-ttu-id="61a13-146">Vezměte v úvahu podmínky, ve kterých můžete generovat anonymně hostované dynamické metody a provést sestavení s Internet oprávnění:</span><span class="sxs-lookup"><span data-stu-id="61a13-146">Consider the conditions in which an assembly with Internet permissions can generate an anonymously hosted dynamic method and execute it:</span></span>  
  
-   <span data-ttu-id="61a13-147">Dynamické metoda se používá pouze veřejné typy a členy.</span><span class="sxs-lookup"><span data-stu-id="61a13-147">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="61a13-148">Pokud obsahuje jeho grant sady <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, může použít neveřejní typy a členy jakékoli sestavení, jejichž grant nastavit je rovno, nebo jsou podmnožinou, udělte sadu generování sestavení.</span><span class="sxs-lookup"><span data-stu-id="61a13-148">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, it can use nonpublic types and members of any assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
-   <span data-ttu-id="61a13-149">Oprávnění, která jsou nutná všechny typy a členy používá metodu dynamické jsou součástí sady udělení částečně důvěryhodné sestavení.</span><span class="sxs-lookup"><span data-stu-id="61a13-149">The permissions that are required by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="61a13-150">Dynamické metody nepodporují ladicími symboly.</span><span class="sxs-lookup"><span data-stu-id="61a13-150">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Dynamic_Methods_Associated_with_Existing_Assemblies"></a>   
## <a name="dynamic-methods-associated-with-existing-assemblies"></a><span data-ttu-id="61a13-151">Dynamické metody, které jsou přidružené k existující sestavení</span><span class="sxs-lookup"><span data-stu-id="61a13-151">Dynamic Methods Associated with Existing Assemblies</span></span>  
 <span data-ttu-id="61a13-152">Chcete-li přidružit dynamické metoda modul v existujícím sestavení nebo typ, použijte některou z <xref:System.Reflection.Emit.DynamicMethod> konstruktory, které určují přidružený typ nebo modul.</span><span class="sxs-lookup"><span data-stu-id="61a13-152">To associate a dynamic method with a type or module in an existing assembly, use any of the <xref:System.Reflection.Emit.DynamicMethod> constructors that specify the associated type or module.</span></span> <span data-ttu-id="61a13-153">Oprávnění, která jsou nutná k volání těchto konstruktorů měnit, protože existující typ přiřazení dynamické metody nebo modul umožňuje dynamické metoda přístup k neveřejní typy a členy:</span><span class="sxs-lookup"><span data-stu-id="61a13-153">The permissions that are required to call these constructors vary, because associating a dynamic method with an existing type or module gives the dynamic method access to nonpublic types and members:</span></span>  
  
-   <span data-ttu-id="61a13-154">Dynamické metody, který je přidružený k typu má přístup u všech členů tohoto typu, i soukromé členy, a pro všechny interní typy a členy v sestavení obsahující typ přidružené.</span><span class="sxs-lookup"><span data-stu-id="61a13-154">A dynamic method that is associated with a type has access to all members of that type, even private members, and to all internal types and members in the assembly that contains the associated type.</span></span>  
  
-   <span data-ttu-id="61a13-155">Dynamické metodu, která souvisí s modul má přístup ke všem `internal` typy a členy (`Friend` v jazyce Visual Basic `assembly` v běžná metadata language runtime) v modulu.</span><span class="sxs-lookup"><span data-stu-id="61a13-155">A dynamic method that is associated with a module has access to all the `internal` types and members (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the module.</span></span>  
  
 <span data-ttu-id="61a13-156">Kromě toho můžete použít konstruktor, který určuje, že možnost pro přeskočení viditelnost kontroluje JIT kompilátoru.</span><span class="sxs-lookup"><span data-stu-id="61a13-156">In addition, you can use a constructor that specifies the ability to skip the visibility checks of the JIT compiler.</span></span> <span data-ttu-id="61a13-157">Díky tomu dává vaše dynamické metoda přístup k všechny typy a členy ve všech sestaveních, bez ohledu na úroveň přístupu.</span><span class="sxs-lookup"><span data-stu-id="61a13-157">Doing so gives your dynamic method access to all types and members in all assemblies, regardless of access level.</span></span>  
  
 <span data-ttu-id="61a13-158">Oprávnění pro název konstruktoru závisí na tom, kolik přístup se rozhodnete udělit dynamické metodu:</span><span class="sxs-lookup"><span data-stu-id="61a13-158">The permissions demanded by the constructor depend on how much access you decide to give your dynamic method:</span></span>  
  
-   <span data-ttu-id="61a13-159">Pokud vaše metoda se používá pouze veřejné typy a členy a přiřaďte ji k vlastní typ nebo vlastní modul, nejsou požadována žádná oprávnění.</span><span class="sxs-lookup"><span data-stu-id="61a13-159">If your method uses only public types and members, and you associate it with your own type or your own module, no permissions are required.</span></span>  
  
-   <span data-ttu-id="61a13-160">Pokud určíte, že se má přeskočit JIT viditelnost kontroly, vyžaduje konstruktoru <xref:System.Security.Permissions.ReflectionPermission> s <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> příznak.</span><span class="sxs-lookup"><span data-stu-id="61a13-160">If you specify that JIT visibility checks should be skipped, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
-   <span data-ttu-id="61a13-161">Pokud přidružíte dynamické metoda jiného typu, i jiný typ vlastního sestavení vyžaduje konstruktoru <xref:System.Security.Permissions.ReflectionPermission> s <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> příznak a <xref:System.Security.Permissions.SecurityPermission> s <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> příznak.</span><span class="sxs-lookup"><span data-stu-id="61a13-161">If you associate the dynamic method with another type, even another type in your own assembly, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag and <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
-   <span data-ttu-id="61a13-162">Pokud přidružíte dynamické metoda modul v jiném sestavení nebo typ, konstruktoru vyžaduje dvě věci: <xref:System.Security.Permissions.ReflectionPermission> s <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> příznak a udělte sadu sestavení, které obsahuje další modul.</span><span class="sxs-lookup"><span data-stu-id="61a13-162">If you associate the dynamic method with a type or module in another assembly, the constructor demands two things: <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag, and the grant set of the assembly that contains the other module.</span></span> <span data-ttu-id="61a13-163">To znamená, zásobník volání musí obsahovat všechna oprávnění v sadě grant modulu cílový plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="61a13-163">That is, your call stack must include all the permissions in the grant set of the target module, plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="61a13-164">Pro zpětnou kompatibilitu, pokud vyžádání pro cíl udělit sadu plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> selže, požadavky konstruktor <xref:System.Security.Permissions.SecurityPermission> s <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> příznak.</span><span class="sxs-lookup"><span data-stu-id="61a13-164">For backward compatibility, if the demand for the target grant set plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> fails, the constructor demands <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
 <span data-ttu-id="61a13-165">I když se položky v tomto seznamu jsou popsány z hlediska sady udělení generování sestavení, mějte na paměti, že jsou vytvářeny požadavky proti zásobníku volání úplné, včetně hranic domény aplikace.</span><span class="sxs-lookup"><span data-stu-id="61a13-165">Although the items in this list are described in terms of the grant set of the emitting assembly, remember that the demands are made against the full call stack, including the application domain boundary.</span></span>  
  
 <span data-ttu-id="61a13-166">Další informace najdete v tématu <xref:System.Reflection.Emit.DynamicMethod> třídy.</span><span class="sxs-lookup"><span data-stu-id="61a13-166">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="61a13-167">Generování dynamických metod z částečně důvěryhodného kódu</span><span class="sxs-lookup"><span data-stu-id="61a13-167">Generating Dynamic Methods from Partially Trusted Code</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="61a13-168">Doporučený způsob generování dynamických metod z částečně důvěryhodného kódu se má používat [anonymně hostované dynamické metody](#Anonymously_Hosted_Dynamic_Methods).</span><span class="sxs-lookup"><span data-stu-id="61a13-168">The recommended way to generate dynamic methods from partially trusted code is to use [anonymously hosted dynamic methods](#Anonymously_Hosted_Dynamic_Methods).</span></span>  
  
 <span data-ttu-id="61a13-169">Vezměte v úvahu podmínky, ve kterých sestavení s oprávněními Internetu generovat dynamické metoda a provést:</span><span class="sxs-lookup"><span data-stu-id="61a13-169">Consider the conditions in which an assembly with Internet permissions can generate a dynamic method and execute it:</span></span>  
  
-   <span data-ttu-id="61a13-170">Buď dynamické metoda je přidružena k modulu nebo typ, který vysílá ji, nebo jeho udělení sada obsahuje <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> a je přidružen modulu v sestavení jejichž grant sada je rovno, nebo jsou podmnožinou, udělte sadu generování sestavení.</span><span class="sxs-lookup"><span data-stu-id="61a13-170">Either the dynamic method is associated with the module or type that emits it, or its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
-   <span data-ttu-id="61a13-171">Dynamické metoda se používá pouze veřejné typy a členy.</span><span class="sxs-lookup"><span data-stu-id="61a13-171">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="61a13-172">Pokud obsahuje jeho grant sady <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> a je přidružen modulu v sestavení jejichž grant sada je rovno, nebo jsou podmnožinou, udělte sadu generování sestavení, můžete použít, typy a členy označené `internal` (`Friend` v jazyce Visual Basic `assembly`v běžná metadata language runtime) v modulu přidružené.</span><span class="sxs-lookup"><span data-stu-id="61a13-172">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly, it can use types and members marked `internal` (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the associated module.</span></span>  
  
-   <span data-ttu-id="61a13-173">Oprávnění pro název všechny typy a členy používá metodu dynamické jsou součástí sady udělení částečně důvěryhodné sestavení.</span><span class="sxs-lookup"><span data-stu-id="61a13-173">The permissions demanded by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
-   <span data-ttu-id="61a13-174">Dynamické metody není přeskočit JIT viditelnost kontroly.</span><span class="sxs-lookup"><span data-stu-id="61a13-174">The dynamic method does not skip JIT visibility checks.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="61a13-175">Dynamické metody nepodporují ladicími symboly.</span><span class="sxs-lookup"><span data-stu-id="61a13-175">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Version_Information"></a>   
## <a name="version-information"></a><span data-ttu-id="61a13-176">Informace o verzi</span><span class="sxs-lookup"><span data-stu-id="61a13-176">Version Information</span></span>  
 <span data-ttu-id="61a13-177">Od verze [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], zásady zabezpečení pro celý počítač je odstraněny a zabezpečení průhlednost změní výchozí mechanismus pro vynucení.</span><span class="sxs-lookup"><span data-stu-id="61a13-177">Starting with the [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)], machine-wide security policy is eliminated and security transparency becomes the default enforcement mechanism.</span></span> <span data-ttu-id="61a13-178">V tématu [změny zabezpečení](../../../docs/framework/security/security-changes.md).</span><span class="sxs-lookup"><span data-stu-id="61a13-178">See [Security Changes](../../../docs/framework/security/security-changes.md).</span></span>  
  
 <span data-ttu-id="61a13-179">Od verze [!INCLUDE[net_v20SP1_long](../../../includes/net-v20sp1-long-md.md)], <xref:System.Security.Permissions.ReflectionPermission> s <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> příznak se už nevyžaduje při Emitování dynamických sestavení a dynamických metod.</span><span class="sxs-lookup"><span data-stu-id="61a13-179">Starting with the [!INCLUDE[net_v20SP1_long](../../../includes/net-v20sp1-long-md.md)], <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is no longer required when emitting dynamic assemblies and dynamic methods.</span></span> <span data-ttu-id="61a13-180">Tento příznak je vyžadována ve starších verzích [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="61a13-180">This flag is required in all earlier versions of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)].</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="61a13-181"><xref:System.Security.Permissions.ReflectionPermission>s <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> příznak je zahrnutá ve výchozím nastavení v `FullTrust` a `LocalIntranet` nastaví oprávnění, ale ne v `Internet` sadu oprávnění.</span><span class="sxs-lookup"><span data-stu-id="61a13-181"><xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is included by default in the `FullTrust` and `LocalIntranet` named permission sets, but not in the `Internet` permission set.</span></span> <span data-ttu-id="61a13-182">Proto v dřívějších verzích [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)], knihovny lze použít s Internet oprávnění jenom v případě, že se provede <xref:System.Security.PermissionSet.Assert%2A> pro <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span><span class="sxs-lookup"><span data-stu-id="61a13-182">Therefore, in earlier versions of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)], a library can be used with Internet permissions only if it executes an <xref:System.Security.PermissionSet.Assert%2A> for <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span></span> <span data-ttu-id="61a13-183">Tyto knihovny vyžadovat kontrolu pozor, zabezpečení, protože chyby kódování může mít za následek celistvosti.</span><span class="sxs-lookup"><span data-stu-id="61a13-183">Such libraries require careful security review because coding errors could result in security holes.</span></span> <span data-ttu-id="61a13-184">[!INCLUDE[net_v20SP1_short](../../../includes/net-v20sp1-short-md.md)] Umožňuje kód pro vypuštění ve scénářích s částečnou důvěryhodností bez vydání všechny požadavky na zabezpečení, protože generování kódu není ze své podstaty privilegovaného operace.</span><span class="sxs-lookup"><span data-stu-id="61a13-184">The [!INCLUDE[net_v20SP1_short](../../../includes/net-v20sp1-short-md.md)] allows code to be emitted in partial trust scenarios without issuing any security demands, because generating code is not inherently a privileged operation.</span></span> <span data-ttu-id="61a13-185">To znamená že generovaný kód má žádná další oprávnění než sestavení, který vysílá ho.</span><span class="sxs-lookup"><span data-stu-id="61a13-185">That is, the generated code has no more permissions than the assembly that emits it.</span></span> <span data-ttu-id="61a13-186">To umožňuje knihovny, které emitování kódu být transparentní pro zabezpečení a eliminuje nutnost assert <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, což zjednodušuje zápisu knihovnu zabezpečení.</span><span class="sxs-lookup"><span data-stu-id="61a13-186">This allows libraries that emit code to be security transparent and removes the need to assert <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, which simplifies the task of writing a secure library.</span></span>  
  
 <span data-ttu-id="61a13-187">Kromě toho [!INCLUDE[net_v20SP1_short](../../../includes/net-v20sp1-short-md.md)] zavádí <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> příznak pro přístup k neveřejní typy a členy z částečně důvěryhodného dynamických metod.</span><span class="sxs-lookup"><span data-stu-id="61a13-187">In addition, the [!INCLUDE[net_v20SP1_short](../../../includes/net-v20sp1-short-md.md)] introduces the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag for accessing nonpublic types and members from partially trusted dynamic methods.</span></span> <span data-ttu-id="61a13-188">Starší verze [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] vyžadují <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> příznak pro dynamické metody, které přístup k neveřejní typy a členy; jde o oprávnění, které se nikdy udělení částečně důvěryhodným kódem.</span><span class="sxs-lookup"><span data-stu-id="61a13-188">Earlier versions of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] require the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag for dynamic methods that access nonpublic types and members; this is a permission that should never be granted to partially trusted code.</span></span>  
  
 <span data-ttu-id="61a13-189">Nakonec [!INCLUDE[net_v20SP1_short](../../../includes/net-v20sp1-short-md.md)] zavádí anonymně hostované metody.</span><span class="sxs-lookup"><span data-stu-id="61a13-189">Finally, the [!INCLUDE[net_v20SP1_short](../../../includes/net-v20sp1-short-md.md)] introduces anonymously hosted methods.</span></span>  
  
### <a name="obtaining-information-on-types-and-members"></a><span data-ttu-id="61a13-190">Získávání informací o pro typy a členy</span><span class="sxs-lookup"><span data-stu-id="61a13-190">Obtaining Information on Types and Members</span></span>  
 <span data-ttu-id="61a13-191">Počínaje [!INCLUDE[dnprdnlong](../../../includes/dnprdnlong-md.md)], je třeba získat informace o neveřejní typy a členy žádné oprávnění.</span><span class="sxs-lookup"><span data-stu-id="61a13-191">Starting with the [!INCLUDE[dnprdnlong](../../../includes/dnprdnlong-md.md)], no permissions are required to obtain information about nonpublic types and members.</span></span> <span data-ttu-id="61a13-192">Reflexe slouží k získání informací potřebných k emitování dynamických metod.</span><span class="sxs-lookup"><span data-stu-id="61a13-192">Reflection is used to obtain information needed to emit dynamic methods.</span></span> <span data-ttu-id="61a13-193">Například <xref:System.Reflection.MethodInfo> objekty se používají k vydávání volání metody.</span><span class="sxs-lookup"><span data-stu-id="61a13-193">For example, <xref:System.Reflection.MethodInfo> objects are used to emit method calls.</span></span> <span data-ttu-id="61a13-194">Starší verze [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] vyžadují <xref:System.Security.Permissions.ReflectionPermission> s <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> příznak.</span><span class="sxs-lookup"><span data-stu-id="61a13-194">Earlier versions of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] require <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> flag.</span></span> <span data-ttu-id="61a13-195">Další informace najdete v tématu [důležité informace o zabezpečení pro reflexi](../../../docs/framework/reflection-and-codedom/security-considerations-for-reflection.md).</span><span class="sxs-lookup"><span data-stu-id="61a13-195">For more information, see [Security Considerations for Reflection](../../../docs/framework/reflection-and-codedom/security-considerations-for-reflection.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="61a13-196">Viz také</span><span class="sxs-lookup"><span data-stu-id="61a13-196">See Also</span></span>  
 [<span data-ttu-id="61a13-197">Důležité informace o zabezpečení pro reflexi</span><span class="sxs-lookup"><span data-stu-id="61a13-197">Security Considerations for Reflection</span></span>](../../../docs/framework/reflection-and-codedom/security-considerations-for-reflection.md)  
 [<span data-ttu-id="61a13-198">Emitování dynamických metod a sestavení</span><span class="sxs-lookup"><span data-stu-id="61a13-198">Emitting Dynamic Methods and Assemblies</span></span>](../../../docs/framework/reflection-and-codedom/emitting-dynamic-methods-and-assemblies.md)
