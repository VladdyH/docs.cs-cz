---
title: Problémy s migrací rozhraní .NET framework 4
ms.date: 05/02/2017
ms.prod: .net-framework
ms.technology:
- dotnet-clr
ms.topic: article
helpviewer_keywords:
- .NET Framework 4, migration
- application compatibility
ms.assetid: df478548-8c05-4de2-8ba7-adcdbe1c2a60
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload:
- mariaw
ms.openlocfilehash: 05c86759b16fa4e1cbf31b7409601cb6b91cd08e
ms.sourcegitcommit: 2e8acae16ae802f2d6d04e3ce0a6dbf04e476513
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/18/2018
---
# <a name="net-framework-4-migration-issues"></a>Problémy s migrací rozhraní .NET framework 4

Toto téma popisuje problémy s migrací mezi verzi rozhraní .NET Framework 3.5 Service Pack 1 a rozhraní .NET Framework verze 4, včetně oprav, změny zabezpečení a dodržování standardů a změny na základě názorů zákazníků. Většina těchto změn nevyžaduje žádné programové změny v aplikacích. Pro ty, které mohou zahrnovat změny najdete v části Doporučená změny sloupec tabulky.

Toto téma popisuje důležité změny v následujících oblastech:

* [ASP.NET a webové](#asp-net-and-web)

* [Jádro](#core)

* [Data](#data)

* [Windows Communication Foundation (WCF)](#windows-communication-foundation-wcf)

* [Windows Presentation Foundation (WPF)](#windows-presentation-foundation-wpf)

* [XML](#xml)

Přehled vyšší úrovně problémů v tomto tématu najdete [příručka k migraci na rozhraní .NET Framework 4](https://msdn.microsoft.com/library/ff657133(v=vs.100).aspx).

Migrace problémy po Beta 2 najdete v tématu [problémy s migrací pro aplikace .NET Framework 4: Beta 2 na RTM](http://go.microsoft.com/fwlink/?LinkId=191505).

Informace o nových funkcích najdete v tématu [co je nového v rozhraní .NET Framework 4](https://msdn.microsoft.com/library/ms171868(v=vs.100).aspx).

## <a name="aspnet-and-web"></a>ASP.NET a Web

Obory názvů: <xref:System.Web>, <xref:System.Web.Mobile>, <xref:System.Web.Security>, <xref:System.Web.UI.WebControls>; sestavení: System.Web (v System.Web.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Soubory definice prohlížeče** | Informace o nových a aktualizovaných prohlížečích a zařízeních byly aktualizovány s definicemi prohlížeče. Starší prohlížečích a zařízeních, jako je například Netscape Navigátor byly odstraněny a novější prohlížeče a přidané zařízení, jako například Google Chrome a Apple iPhone.<br><br>Pokud vaše aplikace obsahuje definice vlastní prohlížečů, které dědí z jednoho z definice prohlížeče, které byly odebrány, zobrazí se chyba.<br><br><xref:System.Web.HttpBrowserCapabilities> Objektu (který je zveřejněný prostřednictvím stránky `Request.Browse` vlastnost) vycházejí z prohlížeče definičních souborech. Informace, které se vrátí pomocí přístupu k vlastnosti tohoto objektu v technologii ASP.NET 4 proto může být jiná než informace, které vrátil ve starší verzi technologie ASP.NET. | Pokud vaše aplikace závisí na původním definičních souborech prohlížeče, zkopírujte je z následující složky:<br><br>*Windows\\Microsoft.NET\\Framework\\v2.0.50727\\konfigurace\\prohlížečů*<br><br>Zkopírujte soubory do odpovídajícího  *\\konfigurace\\prohlížeče* složku pro technologii ASP.NET 4. Po zkopírování souborů, spusťte [Aspnet_regbrowsers.exe](https://msdn.microsoft.com/library/ms229858.aspx) nástroj příkazového řádku. Další informace najdete v tématu [ http://www.asp.net/mobile ](http://go.microsoft.com/fwlink/?LinkId=182900) webu. |
| **Podřízená aplikace spuštěná v smíšené verze technologie ASP.NET** | ASP.NET 4 aplikace, které jsou nakonfigurovány jako podřízené objekty aplikace, které běží starší verze technologie ASP.NET se pravděpodobně nezdaří z důvodu chyby konfigurace nebo kompilace. Konkrétní chyby, ke kterému dochází závisí na tom, zda je aplikace spuštěná v rámci služby IIS 6.0 a IIS 7 nebo IIS 7.5. | Konfigurační soubory ovlivněné aplikací můžete provést změny, tak, aby konfigurační systém správně rozpozná aplikace ASP.NET 4. Informace o změnách, je nutné provést, najdete v části "ASP.NET 4 podřízené aplikace nezdaří na spuštění při pod ASP.NET 2.0 nebo aplikacích ASP.NET 3.5" v dokumentu [ASP.NET 4 nejnovější změny](http://go.microsoft.com/fwlink/?LinkId=182908) na webu technologie ASP.NET. |
| **Změny ID klienta** | Nové `clientIDMode` nastavení v rozhraní ASP.NET 4 umožňuje určit, jak technologie ASP.NET vygeneruje `id` atribut pro elementů HTML. V předchozích verzích technologie ASP.NET byla ekvivalentní výchozí chování `AutoID` nastavení `clientIDMode`. Ve výchozím nastavení je nyní `Predictable`. Další informace najdete v tématu [identifikace ovládacích prvků technologie ASP.NET Web](https://msdn.microsoft.com/library/1d04y8ss(v=vs.100).aspx). | Pokud používáte Visual Studio 2010 k upgradu vaší aplikace z technologie ASP.NET 2.0 nebo ASP.NET 3.5, nástroje nastavení automaticky přidá do souboru Web.config, který zachovává chování starší verze rozhraní .NET Framework. Ale pokud provádíte upgrade aplikace můžete změnit fond aplikací ve službě IIS pro rozhraní .NET Framework 4, ASP.NET používá nový režim ve výchozím nastavení. Pokud chcete zakázat nový režim ID klienta, přidejte následující nastavení v souboru Web.config:<br><br>`<pages clientIDMode="AutoID" />` |
| **Zabezpečení přístupu kódu (CAS)** | ASP.NET 2.0 NET funkce, které byly přidány v technologii ASP.NET 3.5 pomocí rozhraní .NET Framework 1.1 a rozhraní .NET Framework 2.0 kód přístup (CAS) modelu zabezpečení. Implementace certifikační Autority v technologii ASP.NET 4 však byl podstatně overhauled. Částečně důvěryhodné aplikace ASP.NET, které spoléhat na důvěryhodný kód spuštěný v globální mezipaměti sestavení může dojít v důsledku toho různé výjimky zabezpečení. Částečně důvěryhodné aplikace, které závisí na rozsáhlých úpravách zásady počítače CAS může také selže a vyvolá výjimky zabezpečení. | Částečně důvěryhodné aplikace ASP.NET 4 pro chování ASP.NET 1.1 a 2.0 můžete obnovit pomocí nové `legacyCasModel` atribut `trust` konfigurační element, jak je znázorněno v následujícím příkladu:<br><br>`<trust level= "Medium" legacyCasModel="true" />`<br><br>Důležité: Návrat k starší model certifikačních Autorit může představovat snížení bezpečnosti.<br><br>Další informace o modelu zabezpečení přístupu kódu novou technologii ASP.NET 4 najdete v tématu [zabezpečení přístupu kódu v aplikacích ASP.NET 4](https://msdn.microsoft.com/library/dd984947.aspx). |
| **Konfigurační soubory** | Kořenové konfigurační soubory (souboru machine.config a kořenovém souboru Web.config) pro rozhraní .NET Framework a technologii ASP.NET 4 byly aktualizovány zahrnout většinu informace o konfiguraci standardní, která byla nalezena v souborech Web.config aplikace technologie ASP.NET 3.5. Z důvodu složitosti spravované služby IIS 7 a IIS 7.5 systémy konfigurace spouštění aplikací využívajících technologii ASP.NET 3.5 v rozhraní ASP.NET 4 a v rámci služby IIS 7 a IIS 7.5 může způsobit chyby technologie ASP.NET nebo chyby služby IIS. | Upgrade aplikace technologie ASP.NET 3.5 na technologii ASP.NET 4 pomocí nástroje pro upgrade projektu v sadě Visual Studio 2010. Visual Studio 2010 automaticky upraví souboru Web.config aplikace technologie ASP.NET 3.5 tak, aby obsahovala příslušná nastavení pro technologii ASP.NET 4.<br><br>Však můžete spustit pomocí rozhraní .NET Framework 4 bez rekompilace aplikace technologie ASP.NET 3.5. V takovém případě budete muset ručně upravit soubor Web.config aplikace předtím, než spustíte aplikaci v rozhraní .NET Framework 4 a IIS 7 nebo IIS 7.5. Konkrétní změny, které je nutné závisí na kombinaci softwaru, který pracujete, včetně verze Service Pack (SP). Informace o možných softwaru kombinace, které jsou ovlivněné tuto změnu a řešení problémů s konkrétní kombinace, najdete v části "Konfigurace chyby související k nové ASP.NET 4 kořenové konfigurace" v dokumentu [ ASP.NET 4 narušující změny](http://go.microsoft.com/fwlink/?LinkId=182908) na webu technologie ASP.NET. |
| **Vykreslování ovládacího prvku** | V předchozích verzích technologie ASP.NET některé ovládací prvky vytvářely značky, které nelze zakázat. Ve výchozím nastavení je tento typ značky nebude vygenerována v technologii ASP.NET 4. Změny vykreslování ovlivňují následující prvky:<br><br>* Na `Image` a `ImageButton` už vykreslení ovládacích prvků `border="0"` atribut.<br>* Na `BaseValidator` třídy a ověření ovládací prvky, které jsou odvozeny od ho už nebudou zobrazovat červený text ve výchozím nastavení.<br>* Na `HtmlForm` prvek nezobrazuje `name` atribut.<br>* Na `Table` řízení už vykreslí `border="0"` atribut.<br><br>Ovládací prvky, které nejsou určeny pro vstup uživatele (například `Label` ovládací prvek) už nebudou zobrazovat `disabled="disabled"` atribut, pokud jejich `Enabled` je nastavena na `false` (nebo pokud toto nastavení dědí z ovládacího prvku kontejner). | Pokud používáte Visual Studio 2010 k upgradu vaší aplikace z technologie ASP.NET 2.0 nebo ASP.NET 3.5, nástroje nastavení automaticky přidá do souboru Web.config, který zachovává starší vykreslování. Ale pokud provádíte upgrade aplikace můžete změnit fond aplikací ve službě IIS pro rozhraní .NET Framework 4, ASP.NET používá nový režim vykreslování ve výchozím nastavení. Pokud chcete zakázat nový režim vykreslování, přidejte následující nastavení v souboru Web.config:<br><br>`<pages controlRenderingCompatibilityVersion="3.5" />` |
| **Obslužné rutiny událostí ve výchozích dokumentů.** | Rozhraní ASP.NET 4 vykreslí HTML `form` elementu `action` při požadavku na adresu URL bez přípony, který má výchozí dokument k němu mapována hodnota atributu jako prázdný řetězec. Ve starších verzích technologie ASP.NET, požadavek na `http://contoso.com` by způsobilo požadavek na Default.aspx. V tomto dokumentu, otevření `form` vykreslená značka jako v následujícím příkladu:<br><br>`<form action="Default.aspx" />`<br><br>V technologii ASP.NET 4, požadavek na `http://contoso.com` také výsledky v požadavku na Default.aspx, ale technologie ASP.NET nyní vykreslí otevírání HTML `form` značky jako v následujícím příkladu:<br><br>`<form action="" />`<br><br>Když `action` atribut je řetězec prázdný, služby IIS `DefaultDocumentModule` objekt vytvoří podřízený požadavek na Default.aspx. Ve většině případů tento podřízený požadavek je transparentní pro kód aplikace a stránka Default.aspx běží normálně. Potenciální interakce mezi spravovaného kódu a IIS 7 nebo IIS 7.5 integrovaného režimu však může způsobit spravované stránky .aspx přestane fungovat správně při podřízený požadavek. Pokud nastanou následující podmínky, podřízený požadavek na výchozí dokument .aspx bude mít za následek chybu nebo neočekávané chování:<br><br>* Stránky ASPX je odesláno prohlížeči s `form` elementu `action` atribut nastaven na "".<br>* Formuláře je odeslána zpět do technologie ASP.NET.<br>* Spravovaný modul HTTP čte některé části obsahu entity, jako například `Request.Form` nebo `Request.Params`. To způsobí, že obsah entity požadavku POST čtení do spravované paměti. Obsah entity je v důsledku toho již nebude k dispozici pro všechny moduly nativního kódu, které běží ve službě IIS 7 nebo IIS 7.5 integrovaného režimu.<br>* IIS `DefaultDocumentModule` objekt nakonec spustí a vytvoří podřízenou žádost Default.aspx dokumentu. Protože obsah entity je již přečtena část spravovaného kódu, neexistuje však žádný obsah entity k dispozici k odeslání do podřízený požadavek.<br>* Když kanál protokolu HTTP pro podřízený požadavek, je spuštěna spuštěna během fáze spuštění obslužné rutiny obslužná rutina pro soubory .aspx.<br><br>Protože neexistuje žádný obsah entity, neexistují žádné proměnné formuláře a bez zobrazení stavu. Proto není k dispozici pro obslužnou rutinu stránky .aspx, chcete-li zjistit, jaké události (pokud existuje) by měla být zvýšena žádné informace. V důsledku toho žádné zpětného volání obslužné rutiny pro stránky .aspx ovlivněných spustit. | Informace o způsobech řešení problémů, které by mohly nastat v důsledku této změny naleznete v tématu "Události obslužné rutiny může není být není vyvolána v výchozí dokument v IIS 7 nebo IIS 7.5 integrovaný režim" v dokumentu [ASP.NET 4 nejnovější změny](http://go.microsoft.com/fwlink/?LinkId=182908)na webu technologie ASP.NET. |
| **algoritmus hash** | Technologie ASP.NET používá šifrování a algoritmy hash k zabezpečení dat, jako jsou soubory cookie ověřování formulářů a stavu zobrazení. Ve výchozím nastavení, používá technologii ASP.NET 4 <xref:System.Security.Cryptography.HMACSHA256> algoritmus hash operací se soubory cookie a stav zobrazení. Starší verze technologie ASP.NET používá starší <xref:System.Security.Cryptography.HMACSHA1> algoritmus. | Pokud spustíte aplikace kombinující technologie ASP.NET 2.0 a technologii ASP.NET 4, kde data, jako jsou soubory cookie ověřování formulářů musí fungovat na všech verzí rozhraní .NET Framework, konfiguraci aplikace ASP.NET 4 Web používat starší <xref:System.Security.Cryptography.HMACSHA1> algoritmus přidáním následující nastavení v v souboru Web.config:<br><br>`<machineKey validation="SHA1" />` |
| **Hostování ovládacích prvků v aplikaci Internet Explorer** | Můžete už hostitelské ovládací prvky Windows Forms v aplikaci Internet Explorer, protože nejsou k dispozici lepší řešení pro hostování ovládacích prvků na webu. Proto sestavení IEHost.dll a IEExec.exe byly odebrány z rozhraní .NET Framework. | Můžete použít následující technologie pro vývoj vlastní ovládací prvek v webových aplikací:<br><br>* Můžete vytvořit aplikaci Silverlight a nakonfigurovat jej pro spuštění mimo prohlížeče. Další informace najdete v tématu [podpora na více systémů prohlížeče](https://msdn.microsoft.com/library/dd550721(v=vs.100).aspx).<br>* Můžete vytvořit aplikace prohlížeče XAML (XBAP) chcete využít výhod funkcí grafického subsystému WPF (vyžaduje rozhraní .NET Framework na klientských počítačích). Další informace najdete v tématu [přehled aplikace prohlížeče XAML WPF](/dotnet/framework/wpf/app-development/wpf-xaml-browser-applications-overview). |
| **Metody HtmlEncode a UrlEncode** | `HtmlEncode` a `UrlEncode` metody <xref:System.Web.HttpUtility> a <xref:System.Web.HttpServerUtility> třídy byly aktualizovány ke kódování znak jednoduché uvozovky (') následujícím způsobem:<br><br>* Na `HtmlEncode` metoda kóduje instance jako jednoduché uvozovky `&#39;`<br>* Na `UrlEncode` metoda kóduje instance jako jednoduché uvozovky `%27` | Zkontrolujte místa, kde používáte v kódu `HtmlEncode` a `UrlEncode` metody a ujistěte se, že změna v kódování nevede změny, které má vliv na vaše aplikace. |
| **Chyby HttpException v aplikacích ASP.NET 2.0** | Po ASP.NET 4 byla zapnuta služby IIS 6, aplikace ASP.NET 2.0, které běží na služby IIS 6 (v systému Windows Server 2003 nebo Windows Server 2003 R2) může způsobit chyby, například následující: `System.Web.HttpException: Path '/[yourApplicationRoot]/eurl.axd/[Value]' was not found.` | * Pokud technologie ASP.NET 4 není nutné ke spuštění webové stránky, přemapujte webu místo toho použít technologii ASP.NET 2.0.<br><br>-nebo-<br><br>* Pokud technologie ASP.NET 4 je potřeba ke spuštění webové stránky, přesuňte všechny podřízené technologii ASP.NET 2.0 virtuální adresáře do jiného webu, který je namapovaný na technologii ASP.NET 2.0.<br><br>-nebo-<br><br>* Zakážete adresy URL bez přípony. Další informace najdete v tématu "ASP.NET 2.0 může aplikace generovat chyby HttpException odkazující soubor eurl.axd" v dokumentu [ASP.NET 4 nejnovější změny](http://go.microsoft.com/fwlink/?LinkId=182908) na webu technologie ASP.NET. |
| **Typy členství** | Některé typy (například <xref:System.Web.Security.MembershipProvider>) používané v technologii ASP.NET byly přesunuté členství z System.Web.dll do sestavení System.Web.ApplicationServices.dll. Typy byly přesunuty za účelem vyřešení závislostí architektonických vrstev mezi typy v klientovi a v rozšířených SKU rozhraní .NET Framework. | Knihovny tříd, které byly upgradovány z dřívějších verzí technologie ASP.NET a které používají členství typy, které byly přesunuté se nemusí podařit kompilovat při použití v projektu ASP.NET 4. Pokud ano, přidáte odkaz na soubor System.Web.ApplicationServices.dll v projektu knihovny tříd. |
| **Změny nabídky ovládací prvek** | Změny <xref:System.Web.UI.WebControls.Menu> řízení způsobí následující chování:<br><br>* Pokud <xref:System.Web.UI.WebControls.MenuRenderingMode> je nastaven na `List`, nebo pokud <xref:System.Web.UI.WebControls.MenuRenderingMode> je nastaven na `Default` a <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> je nastaven na `4.0` nebo novější, <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> vlastnost nemá žádný efekt.<br>* Pokud cesta, která je nastavena v <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> a <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> vlastnosti obsahuje zpětné lomítko (\\), nejsou vykreslovány bitové kopie. (V předchozích verzích technologie ASP.NET, může zahrnovat cesta zpětné lomítko.) | * Místo z nastavení <xref:System.Web.UI.WebControls.MenuItem.PopOutImageUrl> vlastnost pro jednotlivé položky nabídky, nastavena <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> nebo <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> nadřazené <xref:System.Web.UI.WebControls.Menu> ovládacího prvku.<br><br>-nebo-<br><br>Nastavit <xref:System.Web.UI.WebControls.MenuRenderingMode> k `Table`, nebo nastavte <xref:System.Web.UI.WebControls.MenuRenderingMode> k `Default` a nastavte <xref:System.Web.Configuration.PagesSection.ControlRenderingCompatibilityVersion> k `3.5`. Tato nastavení způsobí <xref:System.Web.UI.WebControls.Menu> ovládací prvek pro použití na základě tabulky rozložení HTML, která je použita v předchozích verzích technologie ASP.NET.<br>* Pokud cestu ve <xref:System.Web.UI.WebControls.Menu.StaticPopOutImageUrl%2A> nebo <xref:System.Web.UI.WebControls.Menu.DynamicPopOutImageUrl> vlastnost obsahuje zpětné lomítko (\\), nahraďte jej znakem lomítka (/). |
| **Mobilní sestavení v souboru Web.config** | V předchozích verzích technologie ASP.NET, je odkaz na sestavení System.Web.Mobile.dll zahrnutý v kořenovém souboru Web.config v `assemblies` oddílu pod `system.web` / `compilation`. Chcete-li zvýšit výkon, byl odebrán odkaz na toto sestavení.<br><br>Poznámka: Sestavení System.Web.Mobile.dll a mobilní ovládací prvky ASP.NET jsou zahrnuty v technologii ASP.NET 4, ale jsou zastaralé. | Pokud chcete používat typy z tohoto sestavení, přidejte odkaz na sestavení, buď v kořenovém souboru Web.config nebo v souboru Web.config aplikace. |
| **Ukládání výstupu do mezipaměti** | V technologii ASP.NET 1.0 nezdařila z důvodu chyby v mezipaměti stránek, které zadané `Location="ServerAndClient"` jako výstupu€ "mezipaměti nastavení pro vydávání `Vary:*` hlavičky protokolu HTTP v odpovědi. To mělo za následek předání klientský prohlížeč pro ukládání do mezipaměti nikdy stránce místně. V technologii ASP.NET 1.1 <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> byla přidána metoda, která mohla být volána, chcete-li potlačit `Vary:*` záhlaví. Sestavy chyb však naznačují, že vývojáři neberou v existující `SetOmitVaryStar` chování.<br><br>V technologii ASP.NET 4 `Vary:*` hlavičky protokolu HTTP už nevydává odpovědi, které zadat direktivu následující:<br><br>`<%@ OutputCache Location="ServerAndClient" %>`<br><br>V důsledku toho <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A> metoda již není potřeba Chcete-li potlačit `Vary:*` záhlaví. V aplikacích, které určují "hodnotu ServerAndClient" pro `Location` atribut stránky budou ukládat do mezipaměti v prohlížeči bez nutnosti zavoláte <xref:System.Web.HttpCachePolicy.SetOmitVaryStar%2A>. | Pokud stránky v aplikaci musí emitování `Vary:*`, volání <xref:System.Web.HttpResponse.AppendHeader%2A> metoda, jak je znázorněno v následujícím příkladu:<br><br>`System.Web.HttpResponse.AppendHeader("Vary","*");`<br><br>Alternativně můžete změnit hodnotu ukládání výstupu do mezipaměti `Location` atribut "Server". |
| **Stránka analýza** | Analyzátor stránky pro webové stránky ASP.NET (soubory .aspx) a uživatelských ovládacích prvků (soubory .ascx) je přísnější v technologii ASP.NET 4 než v předchozích verzích technologie ASP.NET a označuje více kódů jako neplatné než v dřívějších verzích. | Zkontrolujte chybové zprávy, které jsou vytvářeny při spuštění stránky a opravte chyby, které jsou výsledkem neplatné značky. |
| **Typy Passport** | Podpora služby Passport integrovaný do technologie ASP.NET 2.0 je zastaralá a není podporován z důvodu změn v Passport (nyní Live ID SDK). V důsledku toho typy související se Passport v <xref:System.Web.Security> jsou nyní označeny `ObsoleteAttribute` atribut. | Změňte všechny kód, který používá typy Passport v <xref:System.Web.Security> obor názvů (například <xref:System.Web.Security.PassportIdentity>) použít [SDK](http://go.microsoft.com/fwlink/?LinkId=106346). |
| **Informace o PathInfo ve vlastnosti FilePath** | Technologie ASP.NET 4 už obsahuje `PathInfo` hodnotu v vrácení hodnoty z vlastnosti, jako <xref:System.Web.HttpRequest.FilePath>, <xref:System.Web.HttpRequest.AppRelativeCurrentExecutionFilePath>, a <xref:System.Web.HttpRequest.CurrentExecutionFilePath>. Místo toho `PathInfo` informace jsou k dispozici v <xref:System.Web.HttpRequest.PathInfo>. Představte si například následující fragment adresy URL:<br><br>`/testapp/Action.mvc/SomeAction`<br><br>V předchozích verzích technologie ASP.NET <xref:System.Web.HttpRequest> vlastnosti mít následující hodnoty:<br><br>* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc/SomeAction`<br>* <xref:System.Web.HttpRequest.PathInfo>: (prázdný)<br><br>V technologii ASP.NET 4 <xref:System.Web.HttpRequest> vlastnosti místo toho mít následující hodnoty:<br><br>* <xref:System.Web.HttpRequest.FilePath>: `/testapp/Action.mvc`<br>* <xref:System.Web.HttpRequest.PathInfo>: `SomeAction` | Zkontrolujte místa, kde závisí na vlastnosti v kódu <xref:System.Web.HttpRequest> třídy k vrácení informací o cestě; změnit kód tak, aby odrážely změny v tom, jak se vrátí informace o cestě. |
| **Ověření žádosti** | Ke zlepšení ověření žádosti, je vyvolána ověření požadavku ASP.NET dříve v životním cyklu žádosti. V důsledku toho se spouští ověření žádosti pro požadavky, které nejsou pro soubory .aspx, například pro volání webové služby a pro vlastní obslužné rutiny. Ověření žádosti bude také aktivní, pokud vlastní modulů HTTP v kanálu zpracování požadavku.<br><br>V důsledku této změny požadavků na zdroje, než soubory .aspx může vrátit chyby ověření požadavku. Vlastní kód, který běží v kanálu požadavku (například vlastní moduly typu HTTP), může také vrátit chyby ověření požadavku. | V případě potřeby můžete obnovit pouze stránky ASPX vyvolávají ověřování žádostí pomocí následující nastavení v konfiguračním souboru webu staré chování:<br><br>`<httpRuntime requestValidationMode="2.0" />`<br><br>Upozornění: Pokud se můžete vrátit na původní chování, ujistěte se, že veškerý kód v stávající obslužné rutiny, moduly a další vlastní kód pro vektory útoku potenciálně nebezpečného vstupy HTTP, které by mohly být XSS provádí kontroly. " |
| **Směrování** | Pokud vytvoříte web v systému souborů v sadě Visual Studio 2010 a webu je ve složce, která obsahuje tečku (.) v názvu složky, směrování adres URL nebude fungovat spolehlivě. Vrátí chybu HTTP 404 z některé virtuální cesty. K tomu dochází, protože Visual Studio 2010 spustí Visual Studio vývojový Server (Cassini) pomocí nesprávné cesty pro virtuální kořenový adresář. | * V **vlastnosti** stránky pro web na základě souborů, změny **virtuální cestu** atribut "/".<br><br>-nebo-<br><br>* Vytvořte projekt webové aplikace místo webový projekt. Projekty webových aplikací nemusí tento problém a směrování adres URL funguje i v případě, že složka projektu obsahuje tečku v názvu.<br><br>-nebo-<br><br>* Vytvoření webu založené na protokolu HTTP, který je hostován ve službě IIS. Webové stránky hostované službou IIS mohou obsahovat tečky ve virtuální cestě i ve složce soubor projektu. |
| **Weby služby SharePoint** | Pokud se pokusíte spustit ASP.NET 4 webovou stránku, která je nasazena jako podřízený web služby SharePoint, který obsahuje vlastní částečným vztahem důvěryhodnosti úroveň s názvem `WSS_Minimal`, zobrazí se následující chyba:<br><br>`Could not find permission set named 'ASP.Net'.` | V současné době žádné verze služby SharePoint jsou kompatibilní s technologií ASP.NET. V důsledku toho byste neměli spouštět webu technologie ASP.NET 4 jako podřízený web služby SharePoint. |
| **Standardy XHTML 1.1** | Povolit XHTML 1.1 dodržování předpisů pro nové weby, vygeneruje ovládacích prvků technologie ASP.NET v rozhraní .NET Framework 4 XHTML 1.1 kompatibilní HTML. Toto vykreslování je povoleno pomocí následující možnosti v souboru Web.config uvnitř `<system.Web>` element:<br><br>`<pages controlRenderingCompatibilityVersion="4.0"/>`<br><br>Tato možnost je standardně nastavena na 4.0. Webové projekty, které jsou upgradovány na Visual Studio ze sady Visual Studio 2008 bude mít nastavení 3.5 povolena z důvodu kompatibility. | Žádné |

## <a name="core"></a>Jádro

### <a name="general-features"></a>Obecné funkce

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **CardSpace** | Služba Windows CardSpace je už součástí rozhraní .NET Framework; je poskytována samostatně. | Stáhněte si Windows CardSpace z [Microsoft Download Center](http://go.microsoft.com/fwlink/?LinkId=199868). |
| **Konfigurační soubory** | V tom, jak rozhraní .NET Framework přistupuje konfigurační soubory aplikace byly provedeny opravy. | Pokud je název konfiguračního souboru aplikace *aplikace name.config*, přejmenujte ji na *aplikace name.exe.config*. Například přejmenujte *MyApp.config* k *MyApp.exe.config*. |
| **Kód kompilátor jazyka C#** | `Compiler`, `CompilerError`, A `ErrorLevel` třídy, které byly v <xref:Microsoft.CSharp> obor názvů již nejsou k dispozici, a jejich sestavení (cscompmgd.dll) je již zahrnut v rozhraní .NET Framework. | Použití <xref:System.CodeDom.Compiler.CodeDomProvider> třídy a jiné třídy v <xref:System.CodeDom.Compiler> oboru názvů. Další informace najdete v tématu [pomocí modelu CodeDOM](https://msdn.microsoft.com/library/y2k85ax6(v=vs.100).aspx). |
| **Hostování** (nespravovaného rozhraní API) | K vylepšení možností hostingových služeb, jsou zastaralé některé hostování aktivace rozhraní API. Spuštění vedle sebe v procesu povoluje aplikaci načtení a spuštění více verzí rozhraní .NET Framework v rámci jednoho procesu. Například můžete mít aplikace, které načítají doplňky (nebo komponenty), jsou založené na rozhraní .NET Framework 2.0 SP1 a doplňky, které jsou založeny na rozhraní .NET Framework 4 v rámci jednoho procesu. Starší komponenty nadále používat starší verzi rozhraní .NET Framework a nové komponenty použili tuto novou verzi rozhraní .NET Framework. | Použijte konfigurace popsané v [spuštění vedle sebe v procesu](/dotnet/framework/deployment/in-process-side-by-side-execution). |
| **Nový model zabezpečení** | Zásady zabezpečení (CA) přístupu kódu byla vypnuta a nahradí zjednodušený model, jak je popsáno v [změny zabezpečení v rozhraní .NET Framework 4](https://msdn.microsoft.com/library/dd233103(v=vs.100).aspx). | Změny mohou být vyžadovány, pokud závisí na certifikačních Autoritách ve svých aplikacích. Další informace najdete v tématu [kompatibilitou zásad zabezpečení přístupu kódu a migrace](/dotnet/framework/misc/code-access-security-policy-compatibility-and-migration). |

### <a name="date-and-time"></a>Datum a čas

Namespace: <xref:System>; sestavení: mscorlib (v mscorlib.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Letního** | Chcete-li být v souladu se systémové hodiny, chvíli vlastnosti (například <xref:System.TimeZoneInfo.Local> a <xref:System.DateTime.Now>) místo další data rozhraní .NET Framework teď používat operační systém pravidla pro letní čas operace. | Žádné |
| **Formátování řetězců** | Pro podporu formátování jazykové verzi, <xref:System.TimeSpan> struktura zahrnuje nové přetížení `ToString`, `Parse`, a `TryParse` metody kromě nového `ParseExact` a `TryParseExact` metody. | Žádné |


### <a name="globalization"></a>Globalizace

Seznam nové neutrální a konkrétní jazykové verze, najdete v části [co je nového v globalizace a lokalizace](https://msdn.microsoft.com/library/dd997383(v=vs.100).aspx).

Namespace: <xref:System.Globalization>; sestavení: mscorlib (v mscorlib.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Názvy jazykové verze** | Následující změny názvu ovlivnit němčina, Divehština a africké jazykové verze:<br><br>* <xref:System.Globalization.CultureAndRegionInfoBuilder.CurrencyEnglishName>: Název měny pro německou (Švýcarsko) (de-CH) jazykovou verzi se změnil z hodnoty "sFr." na "FN".<br>* <xref:System.Globalization.DateTimeFormatInfo.LongDatePattern>: Vzoru dlouhého data pro Divehština (Maledivy) (dv-MV) jazykovou verzi se změnil z "MMMM/dd/rrrr" na "dd/MM/rrrr".<br>* <xref:System.Globalization.DateTimeFormatInfo.PMDesignator>: Odp. označení Afrikánština (Jižní Afrika) (af-ZA) jazykovou verzi se změnil z "nm" na "Odp.". | Poznámka: změny názvu jazykové verze. |
| **Parametr LCID** | Aby byl konzistentní s očekávané chování v nastavení automatizačního serveru, modul CLR už předá aktuální jazykovou verzi `LCID` parametru nespravované aplikace založené na modelu COM. Místo toho předává 1033 (en-us) pro jazykovou verzi. | Žádné úpravy nezbytné s výjimkou nativních aplikací, které vyžadují zadanou jazykovou verzi. |
| **Jazyková verze zastaralé typy** | <xref:System.Globalization.CultureTypes> a <xref:System.Globalization.CultureTypes> jsou nyní zastaralé.<br><br>Z důvodu zpětné kompatibility <xref:System.Globalization.CultureTypes> nyní vrací neutrální a konkrétní jazykové verze, které byly součástí předchozí rozhraní .NET Framework, a <xref:System.Globalization.CultureTypes> nyní vrací prázdný seznam. | Použít jiné hodnoty <xref:System.Globalization.CultureTypes> výčtu. |
| **Načítání jazykové verze** | Od verze Windows 7, rozhraní .NET Framework 4 načte informace o jazykové verzi z operačního systému místo ukládání samotná data. Kromě toho rozhraní .NET Framework synchronizuje s Windows pro řazení a data velká a malá písmena. | Žádné |
| **Standardy Unicode 5.1** | Rozhraní .NET Framework nyní podporuje všechny znaky Unicode 5.1 doplněk přibližně 1400 znaků. Další znaky zahrnují nových symbolů, šipky, znaky s diakritikou, interpunkce, matematické symboly, znaky CJK a ideografickými znaky, další Malajálamské a telugština číselnými znaky a různé Barmské, Latin, Arabské, řečtina, Mongolština a cyrilici znaky. Kódování Unicode 5.1 jsou podporovány následující nové skripty: sundánské písmo, lepčské písmo, Ol Chiki, Vai, Saurashtra, Kali, Rejang, Gurmukhi, Udijština, tamilština, telugština a Malajálamské znaky a Cham. | Žádné |

### <a name="exceptions"></a>Výjimky

Obory názvů: <xref:System>, <xref:System.Runtime.ExceptionServices>; sestavení: mscorlib (v mscorlib.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Výjimky pro poškozený stav procesu** | Modul CLR již dodává výjimky pro poškozený stav procesu obslužné rutiny výjimek ve spravovaném kódu. | Tyto výjimky znamenat, že stav procesu je poškozená. Nedoporučujeme spouštět aplikaci v tomto stavu.<br><br>Další informace najdete v tématu <xref:System.Runtime.ExceptionServices.HandleProcessCorruptedStateExceptionsAttribute> a položka [zpracování poškozený stav výjimky](http://go.microsoft.com/fwlink/?LinkID=179681) v CLR zevnitř ven. blogu. |
| **Spuštění modulu výjimky** | <xref:System.ExecutionEngineException> je zastaralý, protože zachytitelné výjimka vám umožní nestabilnímu procesu pokračovat v běhu. Tato změna zlepšuje předvídatelnost a spolehlivost v modulu runtime. | Použijte <xref:System.InvalidOperationException> signál podmínku. |

### <a name="reflection"></a>Reflexe

Namespace: <xref:System.Reflection>; sestavení: mscorlib (v mscorlib.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Algoritmy hash sestavení** | <xref:System.Reflection.AssemblyName.HashAlgorithm> Vlastnost nyní vrátí <xref:System.Configuration.Assemblies.AssemblyHashAlgorithm>, protože modul runtime neví algoritmus hash odkazovaného sestavení sestavení není načteno. (Vztahuje se k použití vlastnosti v odkazované sestavení, jako je například vrácené <xref:System.Reflection.Assembly.GetReferencedAssemblies%2A> metoda.) | Žádné |
| **Načítání sestavení** | Aby se zabránilo redundantní načítání sestavení a uložíte virtuální adresní prostor, modul CLR nyní načte sestavení s použitím pouze Win32 `MapViewOfFile` funkce. Už také zavolá `LoadLibrary` funkce.<br><br>Tato změna ovlivňuje diagnostických aplikací následujícími způsoby:<br><br>* A <xref:System.Diagnostics.ProcessModuleCollection> již nebude obsahovat všechny moduly z knihovny tříd (soubor .dll), získaný volání `Process.GetCurrentProcess().Modules`.<br>* Aplikace Win32, které používají `EnumProcessModules` funkce nezobrazí všechny spravované moduly, které jsou uvedené. | Žádné |
| **Deklarace typu** | <xref:System.Type.DeclaringType> Vlastnost nyní správně vrátí hodnotu null. Pokud typ nemá deklarující typ. | Žádné |
| **Delegáti** | Nyní vyvolá delegáta <xref:System.ArgumentNullException> místo <xref:System.NullReferenceException> Pokud je hodnota null předaný konstruktoru delegáta. | Ujistěte se, že jakékoli zpracování výjimky zachytí <xref:System.ArgumentNullException>. |
| **Změna umístění mezipaměti globální sestavení** | Pro sestavení rozhraní .NET Framework 4, byl přesunut do globální mezipaměti sestavení z adresáře systému Windows (% WINDIR %) do podadresáře Microsoft.Net (*% WINDIR %\\Microsoft.Net*). Sestavení z dřívějších verzí zůstanou v adresáři starší.<br><br>Nespravovanou [ASM_CACHE_FLAGS](https://msdn.microsoft.com/library/ms231621(v=vs.100).aspx) výčet obsahuje nové `ASM_CACHE_ROOT_EX` příznak. Tento příznak získá umístění mezipaměti pro rozhraní .NET Framework 4 sestavení, která je možné získat [GetCachePath](/dotnet/framework/unmanaged-api/fusion/getcachepath-function) funkce. | Žádné, za předpokladu, že aplikace nepoužívají explicitní cesty k sestavení, což není doporučený postup. |
| **Nástroj globální mezipaměti sestavení** | [Gacutil.exe (Global Assembly Cache Tool)](https://msdn.microsoft.com/library/ex0ss12c(v=vs.100).aspx) již nepodporuje prohlížeč zásuvných. | Žádné |

### <a name="interoperability"></a>Interoperabilita

Namespace: <xref:System.Runtime.InteropServices>; sestavení: mscorlib (v mscorlib.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Délka vyrovnávací paměti** (nespravovaného rozhraní API) | Uložit paměť, funkce pro `pBufferLengthOffset` parametr pro [ICorProfilerInfo2::GetStringLayout](/dotnet/framework/unmanaged-api/profiling/icorprofilerinfo2-getstringlayout-method) metoda byla změněna tak, aby odpovídala `pStringLengthOffset` parametr. Oba parametry se teď přejděte na posunu umístění délku řetězce. Velikost vyrovnávací paměti byla odebrána z reprezentace třídy string. | Odeberte závislost na velikost vyrovnávací paměti. |
| **Ladění JIT** | Ladicí program rozhraní .NET Framework pro zjednodušení registrace pro ladění za běhu (JIT), teď používá jenom klíč registru AeDebug, který řídí chování pro nativní kód JIT ladění. Tato změna vede následující:<br><br>* Můžete registrovat už dva různé ladicí programy pro spravovaná a nativní kód.<br>* Už zahájením ladicí program automaticky pro neinteraktivní zpracování, ale můžete vyzvat uživatele k interaktivní proces.<br>* Už upozornění se zobrazí při ladicího programu se nepodaří spustit, nebo když se žádné registrované ladicí program, který by měl být spuštěn.<br>* Automatického – spuštění zásady, které jsou závislé na interakce aplikace již nejsou podporovány. | Operace ladění podle potřeby upravte. |
| **Vyvolání platformy** | Pro zvýšení výkonu ve vzájemná funkční spolupráce s nespravovaným kódem, nesprávné volání konvencí ve vyvolání nyní způsobí selhání aplikace. V předchozích verzích vrstvě zařazování vyřešit tyto chyby. | Ladění aplikací v Microsoft Visual Studio 2010 vás upozorní na tyto chyby, můžete je vyřešit.<br><br>Pokud máte binární soubory, které nelze aktualizovat, můžete zahrnout [ \<netfx40_pinvokestackresilience – >](/dotnet/framework/configure-apps/file-schema/runtime/netfx40-pinvokestackresilience-element) element v konfiguračním souboru aplikace chcete-li povolit volání chyby do zásobníku jako v řešení starší verze. Ale to může mít vliv na výkon vaší aplikace. |
| **Odebrat rozhraní** (nespravovaného rozhraní API) | Aby nedocházelo k záměně developer, byly odebrány následující rozhraní, protože neposkytl žádné užitečné scénáře doby běhu, a modulu CLR neposkytl ani neakceptoval jakékoli implementace:<br><br>* **INativeImageINativeImageDependency**<br>* **INativeImageInstallInfo**<br>* **INativeImageEvaluate**<br>* **INativeImageConverter**<br>* **ICorModule**<br>* **Imetadataconverter –** | Žádné |

## <a name="data"></a>Data

Tato část popisuje problémy s migrací pro používání datových sad a klienti SQL, rozhraní Entity Framework technologie LINQ to SQL a datové servery WCF (dříve označované jako ADO.NET Data Services).

### <a name="dataset-and-sql-client"></a>Datové sady a klient SQL

Následující tabulka popisuje přináší vylepšení funkcí, které měly dříve omezení nebo jiné problémy.

Obory názvů: <xref:System.Data>, <xref:System.Data.Objects.DataClasses>, <xref:System.Data.SqlClient>; sestavení: System.Data (v System.Data.dll), System.Data.Entity (v knihovně System.Data.Entity.dll)

| Funkce | Rozdíl oproti 3.5 SP1 |
| ------- | ------------------------ |
| **Objektů POCO scénáře** | <xref:System.Data.Objects.DataClasses.IRelatedEnd> Rozhraní má nové metody pro lepší použitelnost ve scénářích prostý staré CLR objektů POCO (). Tyto nové metody přijímají <xref:System.Object> místo <xref:System.Data.Objects.DataClasses.IEntityWithRelationships> entity jako parametr. |
| **Úpravy řádků** | <xref:System.Collections.IList.IndexOf%2A> Metoda, jak je implementované <xref:System.Data.DataView> třídy, nyní správně vrátí hodnotu řádek, který je upravována, místo vrácení hodnoty -1. |
| **Události** | <xref:System.Data.DataRowView.PropertyChanged> Událost se vyvolá teď, když řádek v změny stavu a <xref:System.Data.DataRow.RejectChanges%2A> metoda je volána. Tato změna usnadňuje vytváření ovládacích prvků uživatelského rozhraní, které zveřejňují obsah <xref:System.Data.DataSet> objektu. |
| **Výjimky** | <xref:System.Data.SqlClient.SqlCommand.Prepare%2A> Nyní vyvolá metoda <xref:System.InvalidOperationException> při připojení není nastaven nebo otevřít místo <xref:System.NullReferenceException>. |
| **Zobrazení mapování** | Chyby mapování zobrazení dotazu jsou nyní zachyceny v době návrhu místo vyvolání <xref:System.NullReferenceException> za běhu.<br><br>Mapování ověření nyní zachytí chyby, ve které dvě přidružení sady v konceptuálním schématu (CSDL) jsou namapované na stejný sloupec. |
| **Transakce** | Pokud se aplikace pokusí po dokončení transakce (včetně přerušených nebo transakcí vrácených zpět), provedení příkazu na připojení <xref:System.InvalidOperationException> je nyní vyvolána. Předchozí verze není vyvolána výjimka a umožňují spouštět další příkazy i v případě, že transakce byla přerušena. |

### <a name="entity-framework"></a>Entity Framework

Následující tabulka popisuje přináší vylepšení funkcí, které měly dříve omezení nebo jiné problémy.

Obory názvů: <xref:System.Data>, <xref:System.Data.Objects>, <xref:System.Data.Objects.DataClasses>; sestavení: System.Data.Entity (v knihovně System.Data.Entity.dll)

| Funkce | Rozdíl oproti 3.5 SP1 |
| ------- | ------------------------ |
| **Objekty entity** | Je nyní rozdíly mezi <xref:System.Data.Objects.ObjectContext.Detach%2A> metoda a stavu entity objektu při <xref:System.Data.Objects.ObjectContext.SaveChanges%2A> metoda je volána. Tato vylepšená konzistence brání vyvolání neočekávané výjimky. |
| **Entity SQL** | Pravidla byla vylepšena pro rozlišení identifikátoru v Entity SQL.<br><br>Analyzátor Entity SQL zlepšil logiku pro řešení s více částmi identifikátory. |
| **Strukturální poznámky** | Rozhraní Entity Framework nyní rozpoznává strukturální poznámky. |
| **Dotazy** | V dotazech byly provedeny následující vylepšení:<br><br>* A `GroupBy` dotaz pomocí nulového klíče přes prázdnou kolekci nevrátí žádné řádky, bez ohledu na to pokud neexistují žádné další vybere v dotazu.<br>* Ve výchozím nastavení dotazy generovaného SQL v LINQ a Entity-SQL parametrů řetězce nyní zpracovávat jako hodnoty kódování Unicode. |

### <a name="linq-to-sql"></a>Technologie LINQ to SQL

Následující tabulka popisuje přináší vylepšení funkcí, které měly dříve omezení nebo jiné problémy.

Namespace: <xref:System.Data.Linq>; sestavení: System.Data.Linq (v knihovně System.Data.Linq.dll)

| Funkce | Rozdíl oproti 3.5 SP1 |
| ------- | ------------------------ |
| **Události** | A <xref:System.Data.Linq.EntitySet%601> kolekce nyní vyvolá <xref:System.Data.Linq.EntitySet%601.ListChanged> pro přidání a odstranění operací, pokud <xref:System.Data.Linq.EntitySet%601> je odpojen, kromě vyvolá událost při načtení kolekce. |
| **Dotazy** | `Skip(0)` je už ignorován v LINQ dotazy SQL. Dotazy, které mají tuto metodu v důsledku toho mohou chovat jinak. Například v některých případech `OrderBy` klauzule je požadován spolu s `Skip(0)`, a nyní vyvolá dotaz <xref:System.NotSupportedException> výjimka pokud `OrderBy` klauzule nebyly zahrnuty. |

### <a name="wcf-data-services"></a>WCF Data Services

Následující tabulka popisuje přináší vylepšení funkcí, které měly dříve omezení nebo jiné problémy.

Obory názvů: <xref:System.Data.Services>, <xref:System.Data.Services.Client>, <xref:System.Data.Services.Common>, <xref:System.Data.Services.Providers>; sestavení: System.Data.Services (v knihovně System.Data.Services.dll), System.Data.Services.Client (v knihovně System.Data.Services.Client.dll)

| Funkce | Rozdíl oproti 3.5 SP1 |
| ------- | ------------------------ |
| **Dávkový binární obsah** | Služby WCF Data Services nyní podporuje dávkové binární obsah v požadavky a odpovědi. |
| **Změnit sběrače** | Změna sběrače jsou nyní provést pro žádost o odstranění.<br><br>Změna interceptoru je metoda, která se spustí pokaždé, když je žádost o přijaté serverem na změnu entity v sadě entit. Spustí se před provedením příchozího požadavku. Zachycování dotazů poskytuje přístup k typ entity, která mění a operace, které se provádí na něm. |
| **Výjimky** | Následující podmínky nyní vyvolají užitečnější výjimky místo <xref:System.NullReferenceException>:<br><br>* A <xref:System.ServiceProcess.TimeoutException> když vyprší časový limit volání datové služby.<br>* A <xref:System.Data.Services.Client.DataServiceRequestException> při chybné žádosti se ke službě data.<br><br>V aplikacích měli byste změnit výjimek zachytit nové výjimky. |
| **Záhlaví** | Záhlaví byla provedena následující vylepšení:<br><br>* Součásti WCF Data Services nyní správně odmítne `eTag` záhlaví, který má neurčené hodnotu.<br>* Součásti WCF Data Services nyní vrátí chybu a nespustí požadavek na odstranění požadavek na odkaz při `if-*` záhlaví je v požadavku.<br>* Součásti WCF Data Services nyní vrátí chybu klientovi ve formátu (Atom, JSON), který klient uvedená v hlavičce Accept. |
| **Čtečka JSON** | Čtečka JavaScript Object Notation (JSON) nyní správně vrátí chybu při čtení jedno zpětné lomítko ("\\") řídicí znak, při zpracování datové části JSON odeslán služby WCF Data Service. |
| **Sloučí** | Byly provedeny následující vylepšení <xref:System.Data.Services.Client.MergeOption> výčtu:<br><br>* Na <xref:System.Data.Services.Client.MergeOption> možnosti sloučení upraví už se entita na straně klienta při následné odpověď od datové služby.<br>* Na <xref:System.Data.Services.Client.MergeOption> je teď konzistentní mezi dynamické SQL a uložené procedury aktualizace. |
| **požadavky** | <xref:System.Data.Services.DataService%601.OnStartProcessingRequest%2A> Metoda se nyní označuje jako předtím, než požadavek na data služby je zpracován. To umožňuje žádost o fungovat správně při použití <xref:System.Data.Services.Providers.ServiceOperation> služby. |
| **Datové proudy** | Služby WCF Data Services již zavře základní stream pro operacích čtení a zápisu. |
| **Identifikátory URI** | Byla opravena uvození identifikátory URI klientem služby WCF Data Services. |

## <a name="windows-communication-foundation-wcf"></a>Windows Communication Foundation (WCF)

Následující tabulka popisuje přináší vylepšení funkcí, které měly dříve omezení nebo jiné problémy.

| Funkce | Rozdíl oproti 3.5 SP1 |
| ------- | ------------------------ |
| **Konfigurační soubory** | Pokud chcete povolit dědičnost chování prostřednictvím hierarchie konfiguračního souboru, WCF nyní podporuje sloučení v konfiguračních souborech.<br><br>Model dědičnosti konfigurace je nyní rozšířit tak, aby uživatelé definovat chování, které se použijí pro všechny služby, které jsou spuštěné v počítači.<br><br>Chování změny mohou nastat, pokud se chování se stejným názvem na různých úrovních hierarchie. |
| **Služby hostování** | Už můžete zadat `<serviceHostingEnvironment>` element konfigurace na úrovni služby přidáním atributu `allowDefinition="MachineToApplication"` do definice elementu.<br><br>Určení `<serviceHostingEnvironment>` element na úrovni služby, je technicky nesprávné a povede k nekonzistentnímu chování. |

## <a name="windows-presentation-foundation-wpf"></a>Windows Presentation Foundation (WPF)

### <a name="applications"></a>Aplikace

Obory názvů: <xref:System.Windows>, <xref:System.Windows.Controls>; sestavení: PresentationFramework (v knihovně PresentationFramework.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Zpracování výjimek** | Povolit chyby zjistit dříve, vyvolá WPF <xref:System.Reflection.TargetInvocationException> a nastaví <xref:System.Exception.InnerException> vlastnost kritické výjimky, například <xref:System.NullReferenceException>, <xref:System.OutOfMemoryException>, <xref:System.StackOverflowException>, a <xref:System.Security.SecurityException>, místo zachycení původní výjimky. | Žádné |
| **Odkazované zdroje.** | Aby vytváření prostředků jednodušší, soubory (například obrázky), které se nacházejí v umístění než struktura složek projektu použít úplnou cestu souboru prostředků místo právě její název souboru jako ID prostředku při vytváření aplikace. Aplikace se nebude moci najít soubory v době běhu. | Žádné |
| **Částečně důvěryhodné aplikace** | Kvůli zabezpečení, aplikace pro systém Windows spuštěné na částečného vztahu důvěryhodnosti a obsahovat <xref:System.Windows.Controls.WebBrowser> ovládací prvek nebo <xref:System.Windows.Controls.Frame> vyvolá ovládací prvek, který obsahuje kód HTML <xref:System.Security.SecurityException> vytvoření ovládacího prvku.<br><br>Aplikace prohlížeče bude vyvolána výjimka a zobrazit zprávu, pokud jsou splněny všechny následující podmínky:<br><br>* Aplikace běží v Firefox.<br>* Aplikace běží v částečné důvěryhodnosti v zóně Internet z nedůvěryhodné lokalit.<br>* Aplikace obsahuje <xref:System.Windows.Controls.WebBrowser> ovládací prvek nebo <xref:System.Windows.Controls.Frame> ovládací prvek, který obsahuje HTML.<br><br>Všimněte si, že nebude mít vliv aplikace, které běží z důvěryhodných webů nebo ze zóny intranetu. | V aplikacích prohlížeče můžete tuto změnu zmírnit jedním z následujících akcí:<br><br>* Spusťte aplikaci prohlížeče v režimu plné důvěryhodnosti.<br>* Mají zákazníci přidat aplikace Web do zóny důvěryhodných serverů.<br>* Mají zákazníci spusťte aplikaci v aplikaci Internet Explorer. |
| **Slovnících prostředků** | Zvyšování slovnících prostředků úrovni motiv a zabránit jejich změna, zmrazitelné prostředky, které jsou definované ve slovníku prostředků a sloučí slovník motiv úrovni vždy označeny jako zmrazené a jsou neměnné. Toto je očekávané chování u zmrazitelné zdroje. | Aplikace, které upravit prostředek, který je definován v slovník sloučené motiv úrovni by měl klonovat prostředku a upravte klonované kopie. Alternativně můžete označit prostředek `x:Shared="false"` tak, aby <xref:System.Windows.ResourceDictionary> pokaždé, když je dotazován prostředek vytvoří novou kopií. |
| **Windows 7** | Chcete-li aplikace WPF fungují lépe na systému Windows 7, byly provedeny následující vylepšení opravte chování časového období:<br><br>* Ukotvení a ovládání gesty stavy nyní pracovní jako očekávané na základě uživatelské interakce.<br>* Na panelu příkazů **sebe, zobrazit windows skládaný**, a **zobrazit windows vedle sebe** Teď máte správné chování a aktualizujte příslušné vlastnosti.<br>* Na `Top`, `Left`, `Width`, a `Height` vlastnosti maximalizovaném okně nebo minimalizované okno teď obsahují umístění pro správné obnovení okna místo jiné hodnoty, v závislosti na monitorování. | Žádné |
| **Styl systému Windows a průhlednosti** | <xref:System.InvalidOperationException> Je vyvolána, pokud se pokusíte nastavit <xref:System.Windows.Window.WindowStyle> hodnotu jinou než <xref:System.Windows.WindowStyle> při <xref:System.Windows.Window.AllowsTransparency> je `true` a <xref:System.Windows.WindowState> je <xref:System.Windows.WindowState>. | Pokud je třeba změnit <xref:System.Windows.Window.WindowStyle> při <xref:System.Windows.Window.AllowsTransparency> je `true`, můžete volat Win32 `SetWindowLongPtr` funkce. |
| **Prohlížeč XPS** | WPF nezahrnuje Microsoft XML Paper Specification Essentials Pack (XPSEP). XPSEP je součástí systému Windows 7 a Windows Vista.<br><br>Na počítači, který se systémem Windows XP bez nainstalované rozhraní .NET Framework 3.5 SP1, tisk pomocí rozhraní API WPF nejsou uvedeny v <xref:System.Windows.Controls.PrintDialog> se spoléhat na WINSPOOL. Některé možnosti tiskárny, nebudou ohlášena a některá nastavení tiskárny se nepoužije během tisku. | V případě potřeby nainstalujte [Microsoft XML Paper Specification Essentials Pack](http://go.microsoft.com/fwlink/?LinkId=178895). |

### <a name="controls"></a>Ovládací prvky

Obory názvů: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>; sestavení: PresentationFramework (v knihovně PresentationFramework.dll), PresentationCore (v knihovně PresentationCore.dll), WindowsBase (v knihovně WindowsBase.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Dialogová okna** | Kvůli vyšší spolehlivosti <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> metoda je volána ve stejném vlákně, který vytvořili <xref:Microsoft.Win32.FileDialog> ovládacího prvku. | Vytvořte <xref:Microsoft.Win32.FileDialog> řízení a volání <xref:Microsoft.Win32.CommonDialog.ShowDialog%2A> metoda ve stejném vlákně. |
| **Plovoucí windows** | Pokud chcete vyřešit fokus obnovení logiky, která udržuje nesprávně opětovná aktivace plovoucího okna (tím se zobrazí jako modální dialogové okno), fokus obnovení je teď zabráníte na candidate není podřízená okna. | Žádné |
| **Položky v kolekcích** | Po přesunutí nebo přidat do základní kolekce položku, zobrazí se v <xref:System.Windows.Data.CollectionView> ve stejném relativní umístění, pokud <xref:System.Windows.Data.CollectionView> není seřazen. To poskytuje konzistenci mezi umístění položky v kolekci a v přidruženém <xref:System.Windows.Data.CollectionView>. | Použití <xref:System.Windows.Controls.ItemContainerGenerator.ContainerFromItem%2A> nebo <xref:System.Windows.Data.CollectionView.IndexOf%2A> metoda a vyhledejte umístění položky v <xref:System.Windows.Data.CollectionView> aniž byste museli spoléhat na pevné umístění položky. |
| **Rozložení** | K vyloučení zbytečné opětovné rozložení změna <xref:System.Windows.Controls.Page.ShowsNavigationUI> už by způsobila neplatnost rozložení nebo způsobí, že další předání rozložení. | Pokud očekáváte, že změna <xref:System.Windows.Controls.Page.ShowsNavigationUI> způsobí, že jiné rozložení předat, volejte <xref:System.Windows.UIElement.InvalidateVisual%2A> po nastavení vlastnosti. |
| **Nabídky** | Povolit ClearType text v nabídce automaticky otevíraná okna, byly provedeny změny <xref:System.Windows.Controls.ControlTemplate> třída a <xref:System.Windows.Controls.MenuItem> řízení a jiných ovládacích prvků. | Aplikace neměli spoléhat na visual strukturu šablon ovládacího prvku. Pouze s názvem částí <xref:System.Windows.Controls.ControlTemplate> jsou součástí veřejného kontraktu. Pokud aplikace potřebuje najít určitý objekt v <xref:System.Windows.Controls.ControlTemplate>, vyhledejte ve vizuálním stromu pro konkrétní typ aniž byste museli spoléhat na pevné umístění objektu ve stromové struktuře. |
| **Navigace** | Pokud <xref:System.Windows.Controls.Frame> přímo přejde do umístění, <xref:System.Windows.Navigation.NavigatingCancelEventArgs.IsNavigationInitiator> vlastnost je `true` po počáteční navigaci. Tato změna zabrání další události vyvolaných během spuštění scénářů. | Žádné |
| **Automaticky otevíraná okna** | <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> Delegáta nyní nelze volat vícekrát během průchodu rozložení místo pouze jednou. | Pokud vaše <xref:System.Windows.Controls.Primitives.CustomPopupPlacementCallback> delegáta vypočítá pozice <xref:System.Windows.Controls.Primitives.Popup> založená na předchozí pozici, Přepočítat pozice, pouze pokud hodnoty `popupSize`, `targetSize`, nebo `offset` změnit parametry. |
| **Hodnoty vlastností** | <xref:System.Windows.DependencyObject.SetCurrentValue%2A> Metoda teď umožňuje nastavit vlastnost na hodnotu efektivní, i když nadále respektuje žádné vazby, styl nebo aktivační událost, která ovlivňuje vlastnost. | Ovládací prvek autoři by měli používat <xref:System.Windows.DependencyObject.SetCurrentValue%2A> při každé změně hodnoty vlastnosti jako vedlejší účinek některých jiných akcí, včetně manipulace uživatele. |
| **Textová pole** | Kvůli zabezpečení <xref:System.Windows.Forms.TextBoxBase.Copy%2A> a <xref:System.Windows.Forms.TextBoxBase.Cut%2A> metody bezobslužně úspěšná, když jsou volány v částečné důvěryhodnosti.<br><br>Kromě toho programové spouštění <xref:System.Windows.Input.ApplicationCommands.Copy> nebo <xref:System.Windows.Input.ApplicationCommands.Cut> ovládacího prvku, který dědí z <xref:System.Windows.Controls.Primitives.TextBoxBase> zablokuje v částečné důvěryhodnosti. Ale uživatel spustil kopírování a vyjmutí příkazy, jako je například kliknutí na tlačítko jejichž <xref:System.Windows.Controls.Primitives.ButtonBase.Command> vlastnost je vázána na jednu z těchto příkazů, bude fungovat. Standardní kopírování a vyjmutí pomocí klávesové zkratky a v místní nabídce budou i nadále fungovat jako předtím v částečné důvěryhodnosti. | Vytvoření vazby <xref:System.Windows.Input.ApplicationCommands.Copy> nebo <xref:System.Windows.Input.ApplicationCommands.Cut> příkaz akce zahájená uživatelem, jako je například kliknutí na tlačítko. |

### <a name="graphics"></a>Grafika

Obory názvů: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>, <xref:System.Windows.Media.Effects>; sestavení: PresentationFramework (v knihovně PresentationFramework.dll), PresentationCore (v knihovně PresentationCore.dll), WindowsBase (v knihovně WindowsBase.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Účinky rastrového obrázku** | Pro zlepšení výkonnosti <xref:System.Windows.Media.Effects.BitmapEffect> třídy a třídy, které dědí <xref:System.Windows.Media.Effects.BitmapEffect> třídy, i když stále přítomen, jsou zakázané. Výsledek provede vykreslení pomocí kanálu hardwarově urychlené vykreslování, pokud jsou splněny následující podmínky:<br><br>* Aplikace používá <xref:System.Windows.Media.Effects.DropShadowBitmapEffect> nebo <xref:System.Windows.Media.Effects.BlurBitmapEffect> , že má vlastnost radius nastavená méně než 100 DIU.<br>* Grafická karta v počítači, který spouští aplikace podporuje pixelů shaderu 2.0.<br><br>Pokud tyto podmínky nejsou splněné, <xref:System.Windows.Media.Effects.BitmapEffect> objekt nebude mít žádný vliv.<br><br>Navíc Visual Studio 2010 vygeneruje upozornění kompilátoru zjistí-li <xref:System.Windows.Media.Effects.BitmapEffect> objekt nebo podtřídy.<br><br><xref:System.Windows.Media.DrawingContext.PushEffect%2A> Metoda je označena jako zastaralá. | Ukončí pomocí starší verze <xref:System.Windows.Media.Effects.BitmapEffect> a odvozených tříd a místo toho použijte nové třídy odvozené z <xref:System.Windows.Media.Effects.Effect>: <xref:System.Windows.Media.Effects.BlurEffect>, <xref:System.Windows.Media.Effects.DropShadowEffect>, a <xref:System.Windows.Media.Effects.ShaderEffect>.<br><br>Můžete také vytvořit vlastní efekty dědění ze <xref:System.Windows.Media.Effects.ShaderEffect> třídy. |
| **Rastrový obrázek rámce** | Klonované <xref:System.Windows.Media.Imaging.BitmapFrame> nyní obdrží objekty <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress>, <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted>, a <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> události. To umožňuje bitové kopie, které jsou stažený z webu a použít <xref:System.Windows.Controls.Image> ovládat prostřednictvím <xref:System.Windows.Style> fungovala správně.<br><br>Ke změně chování se zobrazí jenom v případě, že jsou splněny všechny následující příkazy:<br><br>* Přihlášení k odběru <xref:System.Windows.Media.Imaging.BitmapSource.DownloadProgress>, <xref:System.Windows.Media.Imaging.BitmapSource.DownloadCompleted>, nebo <xref:System.Windows.Media.Imaging.BitmapSource.DownloadFailed> událostí.<br>* Zdroj <xref:System.Windows.Media.Imaging.BitmapFrame> je z webu.<br>* Na <xref:System.Windows.Media.Imaging.BitmapFrame> naklonována při stahování stále probíhá. | Zkontrolujte odesílatele v obslužné rutiny události a provést akci pouze v případě, že odesílatel je původní <xref:System.Windows.Media.Imaging.BitmapFrame>. |
| **Dekódování bitové kopie** | Aby se zabránilo <xref:System.IO.IOException> zpracován, když nelze obrazy dekódovat, <xref:System.Windows.Media.Imaging.BitmapSource> třída vyvolá <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> událost v případě nedekóduje bitovou kopii. | Odeberte všechna zpracování výjimek pro <xref:System.IO.IOException>a použít <xref:System.Windows.Media.Imaging.BitmapSource.DecodeFailed> událostí zkontrolujte dekódovat selhání. |

### <a name="input"></a>Vstup

Obory názvů: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>; sestavení: PresentationFramework (v knihovně PresentationFramework.dll), PresentationCore (v knihovně PresentationCore.dll), WindowsBase (v knihovně WindowsBase.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Instance příkazu vytvoření vazby** | K poskytování mechanismus k vytvoření vazby na základě zobrazení modelu příkaz instancí na základě zobrazení vstupní gesta <xref:System.Windows.Input.InputBinding> třídy dědí vlastnosti z <xref:System.Windows.Freezable> místo <xref:System.Windows.DependencyObject>. Následující vlastnosti jsou teď vlastnosti závislosti:<br><br>* <xref:System.Windows.Input.InputBinding.Command><br>* <xref:System.Windows.Input.InputBinding.CommandParameter><br>* <xref:System.Windows.Input.InputBinding.CommandTarget><br><br>Tato změna vede následující:<br><br>* K <xref:System.Windows.Input.InputBinding> objekt teď po registraci místo zbývající měnitelný nereaguje.<br>* Nemáte přístup k úrovni instance <xref:System.Windows.Input.InputBinding> objekty z více vláken, z důvodu omezení systému <xref:System.Windows.DependencyObject> třídy.<br>* Nelze mutovat vstupní vazby na úrovni třídy po jejich registraci z důvodu omezení systému <xref:System.Windows.Freezable> třídy.<br>* Vstupní vazby nelze zadat v příkazu instancí, které jsou vytvořeny ve Model zobrazení. | Vytvoření samostatné instance <xref:System.Windows.Input.InputBinding> třídy v samostatných vláknech vazby mají-li být měnitelný, nebo v opačném případě je ukotvit. Neprovádějte statického úrovni třídy <xref:System.Windows.Input.InputBinding> po jeho registraci. |
| **Aplikace prohlížeče** | Aplikace prohlížeče WPF (. Klíče událostí procesu XBAP) teď stejně jako samostatné aplikace WPF tak, aby objekty přijímaly směrované klíčové události ve správném pořadí. | Žádné |
| **Kombinace mrtvých kláves** | WPF zastírá neaktivní klíčů, které nevytvářejí viditelné znaky, ale místo toho označuje, že klíč je a nelze jej zkombinovat s další písmeno klíčem k vytvoření jeden znak. Klíč vstupu, například <xref:System.Windows.Input.Keyboard.KeyDownEvent> událost, sestavy při klíč je klíč neaktivní nastavením <xref:System.Windows.Input.KeyEventArgs.Key> vlastnost, která má <xref:System.Windows.Input.Key> hodnotu. Toto je obvykle očekávané chování, protože aplikace obvykle nemáte v úmyslu reagovat na vstupu klávesnice, který vytváří kombinované znaky. | Aplikace, které očekávají čtení klíčů, které byly součástí kombinovaného znaků můžete získat již zastaralý klíč pomocí <xref:System.Windows.Input.KeyEventArgs.DeadCharProcessedKey> vlastnost. |
| **Správce aktivace** | Když <xref:System.Windows.Input.FocusManager.GetFocusedElement(System.Windows.DependencyObject)?displayProperty=nameWithType> metodě se předává element, který má [IsFocusScope](https://msdn.microsoft.com/library/system.windows.input.focusmanager.isfocusscope.aspx) přidružená vlastnost nastavena na `true`, vrátí metoda služby element, který je posledním elementem zaměřené na klávesnici v rámci zaměření oboru, pokud a pouze v případě Vrátí element patří do stejné <xref:System.Windows.PresentationSource> objektu jako elementu, který je předaný metodě. | Žádné |

### <a name="ui-automation"></a>automatizace uživatelského rozhraní

Namespace: <xref:System.Windows>, <xref:System.Windows.Automation.Peers>, <xref:System.Windows.Automation.Provider>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>; sestavení: PresentationFramework (v knihovně PresentationFramework.dll), PresentationCore (v knihovně PresentationCore.dll), UIAutomationProvider (v knihovně UIAutomationProvider.dll), WindowsBase (v knihovně WindowsBase.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **Hierarchie tříd zobrazení** | <xref:System.Windows.Automation.Peers.TreeViewAutomationPeer> a <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> třídy dědí <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer> místo <xref:System.Windows.Automation.Peers.FrameworkElementAutomationPeer>. | Pokud dědí od <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer> třídy a přepsání <xref:System.Windows.Automation.Peers.TreeViewItemAutomationPeer.GetChildrenCore%2A> metoda, vezměte v úvahu vrátí objekt, který dědí z nové <xref:System.Windows.Automation.Peers.TreeViewDataItemAutomationPeer> třída. |
| **Kontejnery mimo obrazovku.** | Chcete-li odstranit nesprávnou návratovou hodnotu, <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.IsOffscreenCore%2A> metoda nyní správně vrátí `false` pro kontejnery položek, které přešla oblasti mimo zobrazení. Hodnota metody není navíc ovlivněna uzavřeními jiných windows, nebo zda je viditelný na konkrétní monitorování elementu. | Žádné |
| **Nabídky a podřízené objekty** | Jak povolit automatizaci uživatelského rozhraní nabídky, které obsahují podřízené objekty jiné než <xref:System.Windows.Controls.MenuItem> objekty, <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer.GetChildrenCore%2A> metoda vrátí nyní <xref:System.Windows.Automation.Peers.AutomationPeer> objekt podřízenou <xref:System.Windows.UIElement> objekt, místo <xref:System.Windows.Automation.Peers.MenuItemAutomationPeer> objektu. | Žádné |
| **Nové rozhraní a sestavení** | Pokud chcete povolit nové funkce pro automatizaci uživatelského rozhraní, byly přidány následující rozhraní:<br><br>* <xref:System.Windows.Automation.Provider.IItemContainerProvider><br>* <xref:System.Windows.Automation.Provider.ISynchronizedInputProvider><br>* <xref:System.Windows.Automation.Provider.IVirtualizedItemProvider> | Všechny projekt, který vytváří protějšky automatizace WPF musíte přidat explicitní odkaz na UIAutomationProvider.dll. |
| **Palec** | <xref:System.Windows.Automation.Peers.ThumbAutomationPeer.GetClassNameCore%2A> Metoda vrátí hodnotu, místo null. Proto ovládací prvky ovládací prvky, jako <xref:System.Windows.Controls.GridSplitter> , dědí <xref:System.Windows.Controls.Primitives.Thumb> třída bude hlásit název automatizace uživatelského rozhraní. | Žádné |
| **Virtualizované elementy** | Pro zlepšení výkonnosti <xref:System.Windows.Automation.Peers.UIElementAutomationPeer.GetChildrenCore%2A> metoda vrátí pouze podřízené objekty, které jsou ve skutečnosti ve vizuálním stromu, namísto všechny podřízené objekty, bez ohledu na to, jestli jsou virtualizované. | Použití <xref:System.Windows.Automation.ItemContainerPattern> Iterujte přes všechny položky <xref:System.Windows.Automation.Peers.ItemsControlAutomationPeer>. |

### <a name="xaml"></a>XAML

Obory názvů: <xref:System.Windows>, <xref:System.Windows.Controls>, <xref:System.Windows.Data>, <xref:System.Windows.Input>, <xref:System.Windows.Markup>; sestavení: PresentationFramework (v knihovně PresentationFramework.dll), PresentationCore (v knihovně PresentationCore.dll), WindowsBase (v knihovně WindowsBase.dll)

| Funkce | Rozdíl oproti 3.5 SP1 | Doporučené změny |
| ------- | ------------------------ | ------------------- |
| **– Rozšíření značek** | WPF nyní správně vždy používá hodnotu z <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A> metody místo vrácení <xref:System.Windows.Markup.MarkupExtension> objekt v určitých případech, kdy rozšíření značek se používá k nastavení vlastnosti nebo vytvoření položky v kolekci. Rozšíření značek může v některých případech vrátí sám sebe. | Pokud vaše aplikace přistupovat ke zdroji, který vrátil <xref:System.Windows.Markup.MarkupExtension> objektu v dřívějších verzích, odkaz na objekt, který je vrácen z <xref:System.Windows.Markup.MarkupExtension.ProvideValue%2A>, místo <xref:System.Windows.Markup.MarkupExtension> objektu. |
| **Analýza atributy** | Atributy v jazyce XAML nyní mohou mít pouze jeden období. Například následující jsou platné:<br><br>`<Button Background="Red"/>` (bez tečky)<br><br>`<Button Button.Background = "Red"/>` (jedna tečka)<br><br>Následující již není platný:<br><br>`<Button Control.Button.Background = "Red"/>` (více než jedno období) | Správné atributy XAML, které mají více než jedno období. |

## <a name="xml"></a>XML

Řádky v této tabulce popisují vylepšení funkcí, které měly dříve omezení nebo jiné problémy.

### <a name="schema-and-transforms"></a>Schéma a transformace

Obory názvů: <xref:System.Xml.Linq>; <xref:System.Xml.Schema>, <xref:System.Xml.XPath>; sestavení: System.Xml (v System.Xml.dll), System.Xml.Linq (v knihovně System.Xml.Linq.dll)

| Funkce | Rozdíl oproti 3.5 SP1 |
| ------- | ------------------------ |
| **Schémata Chameleon** | Chcete-li zabránit poškození dat, schémata chameleon jsou nyní klonovat správně když jsou součástí více schémat.<br><br>Schémata Chameleon jsou schémat, které nemají cílový obor názvů, a když jsou zahrnuty v jiné XSD, proveďte na cílový obor názvů import schématu. Často se používají k přidání běžné typy do schématu. |
| **Funkce ID** | Soubor XSLT [funkce id](/sql/xquery/functions-on-sequences-id) nyní vrací správnou hodnotu místo null v případě <xref:System.Xml.XmlReader> objekt předaný XLST vztahuje.<br><br>Pokud uživatel vytvořil <xref:System.Xml.XmlReader> objekt z LINQ na třídy XML pomocí <xref:System.Xml.Linq.XNode.CreateReader%2A> metodu a to <xref:System.Xml.XmlReader> byl předán objekt XSLT, všechny instance `id` funkce v XSLT předtím vrátila hodnotu null. Toto není povolená vrácená hodnota pro `id` funkce. |
| **Atribut Namespace** | Chcete-li zabránit poškození dat, <xref:System.Xml.XPath.XPathNavigator> teď vrací místní název `x:xmlns` atribut správně. |
| **Namespace – deklarace** | <xref:System.Xml.XmlReader> Objektu na dílčí stromu už vytvoří duplicitní deklarace oboru názvů v rámci jednoho elementu XML. |
| **Ověření schématu** | Aby se zabránilo chybnému ověření schématu, <xref:System.Xml.Schema.XmlSchemaSet> umožňuje třídu XSD schémata sestavují správnou a konzistentní. Tato schémata mohou zahrnovat jiná schémata; například `A.xsd` mohou zahrnovat `B.xsd`, což může zahrnovat `C.xsd`. Kompilování kterékoli z těchto příčin tohoto grafu závislostí nelze procházet. |
| **Funkce skriptu** | [Funkce dostupné funkce](https://msdn.microsoft.com/library/ms256124(v=vs.110).aspx) již nesprávně vrací `false` při funkce je ve skutečnosti k dispozici. |
| **Identifikátory URI** | <xref:System.Xml.Linq.XElement.Load%2A> Metoda nyní vrátí správné BaseURI v dotazech LINQ. |

### <a name="validation"></a>Ověřování

Obory názvů: <xref:System.Xml.Linq>; <xref:System.Xml.Schema>, <xref:System.Xml.XPath>; sestavení: System.Xml (v System.Xml.dll), System.Xml.Linq (v knihovně System.Xml.Linq.dll)

| Funkce | Rozdíl oproti 3.5 SP1 |
| ------- | ------------------------ |
| **Namespace překladače** | <xref:System.Xml.XmlReader.ReadContentAs%2A> Metoda už ignoruje <xref:System.Xml.IXmlNamespaceResolver> do ní předán překladač.<br><br>V předchozích verzích byla ignorována překladač zadaného oboru názvů a <xref:System.Xml.XmlReader> místo toho použít. |
| **Prázdné znaky** | Aby se zabránilo ztrátě dat při vytváření čtečka čipových karet, <xref:System.Xml.XmlReader.Create%2A> metoda již neodstraňuje významné prázdné znaky.<br><br>Ověření XML rozpozná režim pro smíšený obsah, kde může být text míchán s kódem XML. Ve smíšeném režimu všech mezer je důležité a měly by být uvedeny. |

### <a name="writing"></a>Zápis

Obory názvů: <xref:System.Xml.Linq>; <xref:System.Xml.Schema>, <xref:System.Xml.XPath>; sestavení: System.Xml (v System.Xml.dll), System.Xml.Linq (v knihovně System.Xml.Linq.dll)

| Funkce | Rozdíl oproti 3.5 SP1 |
| ------- | ------------------------ |
| **Odkazy na entity** | Chcete-li zabránit poškození dat, jsou odkazy na entity už vytvářeny dvakrát v atributy XML.<br><br>Pokud uživatel se pokusil zapsat entitu do `xmlns` atribut nebo do `xml:lang` nebo `xml:space` atribut pomocí <xref:System.Xml.XmlWriter.WriteEntityRef%2A> metoda entita byla vytvářeny dvakrát v výstup, proto došlo k poškození dat. |
| **Zpracování nového řádku** | Chcete-li zabránit poškození dat, <xref:System.Xml.XmlWriter> objekty ohledem <xref:System.Xml.NewLineHandling> možnost. |

## <a name="see-also"></a>Viz také

### <a name="reference"></a>Odkaz

[Nové typy a členy v rozhraní .NET Framework 4](https://msdn.microsoft.com/library/ff641764(v=vs.100).aspx)

### <a name="concepts"></a>Koncepty

[Příručka k migraci na rozhraní .NET Framework 4](https://msdn.microsoft.com/library/ff657133(v=vs.100).aspx)   
[Co je nového v rozhraní .NET Framework 4](https://msdn.microsoft.com/library/ms171868(v=vs.100).aspx)   
[Kompatibilita verzí v rozhraní .NET Framework](../../../docs/framework/migration-guide/version-compatibility.md)   
[Migrace řešení Office na rozhraní .NET Framework 4](https://msdn.microsoft.com/library/ee207231.aspx)

### <a name="other-resources"></a>Další zdroje

[Zastaralé v rozhraní .NET Framework](https://msdn.microsoft.com/library/ee461502(v=vs.110).aspx)   
[Problémy s migrací pro aplikace .NET Framework 4: Beta 2 RTM](http://go.microsoft.com/fwlink/?LinkId=191505)
