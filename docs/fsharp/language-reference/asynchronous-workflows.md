---
title: Asynchronní pracovní postupy (F#)
description: 'Další informace o podpoře v programovací jazyk pro asynchronně, provádění výpočtů F # které provedou bez blokování provádění jinou práci.'
author: cartermp
ms.author: phcart
ms.date: 05/16/2016
ms.topic: language-reference
ms.prod: dotnet-fsharp
ms.devlang: fsharp
ms.openlocfilehash: 1521ea3719f906a45b11d19a27256e87c5643e28
ms.sourcegitcommit: 03ee570f6f528a7d23a4221dcb26a9498edbdf8c
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/28/2018
---
# <a name="asynchronous-workflows"></a><span data-ttu-id="124bb-103">Asynchronní pracovní postupy</span><span class="sxs-lookup"><span data-stu-id="124bb-103">Asynchronous Workflows</span></span>

> [!NOTE]
<span data-ttu-id="124bb-104">Rozhraní API použití odkazu přejdete na webu MSDN.</span><span class="sxs-lookup"><span data-stu-id="124bb-104">The API reference link will take you to MSDN.</span></span>  <span data-ttu-id="124bb-105">Referenční dokumentace rozhraní API docs.microsoft.com není dokončena.</span><span class="sxs-lookup"><span data-stu-id="124bb-105">The docs.microsoft.com API reference is not complete.</span></span>

<span data-ttu-id="124bb-106">Toto téma popisuje podporu v F # pro provádění výpočtů asynchronně, který je bez blokování provádění jinou práci.</span><span class="sxs-lookup"><span data-stu-id="124bb-106">This topic describes support in F# for performing computations asynchronously, that is, without blocking execution of other work.</span></span> <span data-ttu-id="124bb-107">Například asynchronní výpočty slouží k zápisu aplikace, které mají uživatelská rozhraní, které zůstávají reaguje na uživatele, jak aplikace provede další práci.</span><span class="sxs-lookup"><span data-stu-id="124bb-107">For example, asynchronous computations can be used to write applications that have UIs that remain responsive to users as the application performs other work.</span></span>

## <a name="syntax"></a><span data-ttu-id="124bb-108">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="124bb-108">Syntax</span></span>

```fsharp
async { expression }
```

## <a name="remarks"></a><span data-ttu-id="124bb-109">Poznámky</span><span class="sxs-lookup"><span data-stu-id="124bb-109">Remarks</span></span>

<span data-ttu-id="124bb-110">V předchozích syntaxi výpočet reprezentována `expression` je nastavení spuštění asynchronně, který je bez blokování aktuální vlákno výpočetní při provádění operace asynchronní režimu spánku, vstupně-výstupních operací a další asynchronní operace jsou.</span><span class="sxs-lookup"><span data-stu-id="124bb-110">In the previous syntax, the computation represented by `expression` is set up to run asynchronously, that is, without blocking the current computation thread when asynchronous sleep operations, I/O, and other asynchronous operations are performed.</span></span> <span data-ttu-id="124bb-111">Asynchronní výpočty jsou často zahájeno vlákna na pozadí při spuštění bude pokračovat na aktuální vlákno.</span><span class="sxs-lookup"><span data-stu-id="124bb-111">Asynchronous computations are often started on a background thread while execution continues on the current thread.</span></span> <span data-ttu-id="124bb-112">Typ výrazu je `Async<'T>`, kde `'T` je typ vrácený výrazem při `return` – klíčové slovo se používá.</span><span class="sxs-lookup"><span data-stu-id="124bb-112">The type of the expression is `Async<'T>`, where `'T` is the type returned by the expression when the `return` keyword is used.</span></span> <span data-ttu-id="124bb-113">Kód v takové výraz se označuje jako *asynchronní bloku*, nebo *asynchronní bloku*.</span><span class="sxs-lookup"><span data-stu-id="124bb-113">The code in such an expression is referred to as an *asynchronous block*, or *async block*.</span></span>

<span data-ttu-id="124bb-114">Existuje mnoho různých způsobů programování asynchronně a [ `Async` ](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7) třída poskytuje metody, které podporují několik scénářů.</span><span class="sxs-lookup"><span data-stu-id="124bb-114">There are a variety of ways of programming asynchronously, and the [`Async`](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7) class provides methods that support several scenarios.</span></span> <span data-ttu-id="124bb-115">Obecný přístup je vytvoření `Async` objekty, které představují výpočtu nebo výpočtů, u kterých chcete spustit asynchronně a pak spusťte tyto výpočty pomocí jedné z spouštěcí funkce.</span><span class="sxs-lookup"><span data-stu-id="124bb-115">The general approach is to create `Async` objects that represent the computation or computations that you want to run asynchronously, and then start these computations by using one of the triggering functions.</span></span> <span data-ttu-id="124bb-116">Různé spouštěcí funkce poskytují různé způsoby spuštění asynchronní výpočty a který, kterou použijete, závisí na tom, jestli chcete používat aktuální vlákno, vlákna na pozadí nebo objekt úlohy rozhraní .NET Framework a jestli existují pokračování Funkce, které měly být spuštěny po dokončení výpočet.</span><span class="sxs-lookup"><span data-stu-id="124bb-116">The various triggering functions provide different ways of running asynchronous computations, and which one you use depends on whether you want to use the current thread, a background thread, or a .NET Framework task object, and whether there are continuation functions that should run when the computation finishes.</span></span> <span data-ttu-id="124bb-117">Například spusťte asynchronní výpočetní na aktuální vlákno, můžete použít [ `Async.StartImmediate` ](https://msdn.microsoft.com/library/2f71d1cc-187f-48cf-ac66-e7fda41c46e3).</span><span class="sxs-lookup"><span data-stu-id="124bb-117">For example, to start an asynchronous computation on the current thread, you can use [`Async.StartImmediate`](https://msdn.microsoft.com/library/2f71d1cc-187f-48cf-ac66-e7fda41c46e3).</span></span> <span data-ttu-id="124bb-118">Když spustíte asynchronní výpočetní z vlákna uživatelského rozhraní, nejsou blokovány smyčky hlavní událost, která zpracovává uživatelské akcí, například stisknutí kláves a aktivity myši, vaše aplikace stále poměrně rychle reaguje.</span><span class="sxs-lookup"><span data-stu-id="124bb-118">When you start an asynchronous computation from the UI thread, you do not block the main event loop that processes user actions such as keystrokes and mouse activity, so your application remains responsive.</span></span>

## <a name="asynchronous-binding-by-using-let"></a><span data-ttu-id="124bb-119">Asynchronní vazby pomocí umožňují!</span><span class="sxs-lookup"><span data-stu-id="124bb-119">Asynchronous Binding by Using let!</span></span>

<span data-ttu-id="124bb-120">V pracovním postupu asynchronní některé operace a výrazy jsou synchronní a některé jsou delší výpočtů, které jsou určeny k vrácení výsledku asynchronně.</span><span class="sxs-lookup"><span data-stu-id="124bb-120">In an asynchronous workflow, some expressions and operations are synchronous, and some are longer computations that are designed to return a result asynchronously.</span></span> <span data-ttu-id="124bb-121">Když zavoláte metodu asynchronně, místo běžný `let` vazby, můžete použít `let!`.</span><span class="sxs-lookup"><span data-stu-id="124bb-121">When you call a method asynchronously, instead of an ordinary `let` binding, you use `let!`.</span></span> <span data-ttu-id="124bb-122">Účinek `let!` je umožnit spouštění jako provádí výpočet pokračujte na další výpočty nebo vláken.</span><span class="sxs-lookup"><span data-stu-id="124bb-122">The effect of `let!` is to enable execution to continue on other computations or threads as the computation is being performed.</span></span> <span data-ttu-id="124bb-123">Po pravé straně `let!` vazby Vrátí zbytek asynchronní pracovního postupu obnoví spuštění.</span><span class="sxs-lookup"><span data-stu-id="124bb-123">After the right side of the `let!` binding returns, the rest of the asynchronous workflow resumes execution.</span></span>

<span data-ttu-id="124bb-124">Následující kód ukazuje rozdíl mezi `let` a `let!`.</span><span class="sxs-lookup"><span data-stu-id="124bb-124">The following code shows the difference between `let` and `let!`.</span></span> <span data-ttu-id="124bb-125">Řádek kódu, který používá `let` právě vytvoří asynchronní výpočetní jako objekt, který můžete spustit později pomocí, například `Async.StartImmediate` nebo [ `Async.RunSynchronously` ](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b).</span><span class="sxs-lookup"><span data-stu-id="124bb-125">The line of code that uses `let` just creates an asynchronous computation as an object that you can run later by using, for example, `Async.StartImmediate` or [`Async.RunSynchronously`](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b).</span></span> <span data-ttu-id="124bb-126">Řádek kódu, který používá `let!` spustí výpočet, a pak vlákno je pozastaveno, dokud výsledek je k dispozici, na které bodu provádění pokračuje.</span><span class="sxs-lookup"><span data-stu-id="124bb-126">The line of code that uses `let!` starts the computation, and then the thread is suspended until the result is available, at which point execution continues.</span></span>

```fsharp
// let just stores the result as an asynchronous operation.
let (result1 : Async<byte[]>) = stream.AsyncRead(bufferSize)
// let! completes the asynchronous operation and returns the data.
let! (result2 : byte[])  = stream.AsyncRead(bufferSize)
```

<span data-ttu-id="124bb-127">Kromě `let!`, můžete použít `use!` k provedení asynchronní vazby.</span><span class="sxs-lookup"><span data-stu-id="124bb-127">In addition to `let!`, you can use `use!` to perform asynchronous bindings.</span></span> <span data-ttu-id="124bb-128">Rozdíl mezi `let!` a `use!` je stejný jako rozdíl mezi `let` a `use`.</span><span class="sxs-lookup"><span data-stu-id="124bb-128">The difference between `let!` and `use!` is the same as the difference between `let` and `use`.</span></span> <span data-ttu-id="124bb-129">Pro `use!`, objekt je odstraněny na ukončení aktuálního oboru.</span><span class="sxs-lookup"><span data-stu-id="124bb-129">For `use!`, the object is disposed of at the close of the current scope.</span></span> <span data-ttu-id="124bb-130">Všimněte si, že se v aktuální verzi jazyka F # `use!` nepovoluje hodnotu inicializace na hodnotu null, i když `use` nepodporuje.</span><span class="sxs-lookup"><span data-stu-id="124bb-130">Note that in the current release of the F# language, `use!` does not allow a value to be initialized to null, even though `use` does.</span></span>

## <a name="asynchronous-primitives"></a><span data-ttu-id="124bb-131">Asynchronní primitivní elementy.</span><span class="sxs-lookup"><span data-stu-id="124bb-131">Asynchronous Primitives</span></span>

<span data-ttu-id="124bb-132">Je volána metoda, která provede asynchronní jednu úlohu a vrátí výsledek *asynchronní primitivní*, a ty jsou navrženy speciálně pro použití s `let!`.</span><span class="sxs-lookup"><span data-stu-id="124bb-132">A method that performs a single asynchronous task and returns the result is called an *asynchronous primitive*, and these are designed specifically for use with `let!`.</span></span> <span data-ttu-id="124bb-133">Několik asynchronní primitiv jsou definovány v základní knihovny F #.</span><span class="sxs-lookup"><span data-stu-id="124bb-133">Several asynchronous primitives are defined in the F# core library.</span></span> <span data-ttu-id="124bb-134">Tyto dvě metody pro webové aplikace jsou definovány v modulu [ `Microsoft.FSharp.Control.WebExtensions` ](https://msdn.microsoft.com/library/95ef17bc-ee3f-44ba-8a11-c90fcf4cf003): [ `WebRequest.AsyncGetResponse` ](https://msdn.microsoft.com/library/09a60c31-e6e2-4b5c-ad23-92a86e50060c) a [ `WebClient.AsyncDownloadString` ](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a).</span><span class="sxs-lookup"><span data-stu-id="124bb-134">Two such methods for Web applications are defined in the module [`Microsoft.FSharp.Control.WebExtensions`](https://msdn.microsoft.com/library/95ef17bc-ee3f-44ba-8a11-c90fcf4cf003): [`WebRequest.AsyncGetResponse`](https://msdn.microsoft.com/library/09a60c31-e6e2-4b5c-ad23-92a86e50060c) and [`WebClient.AsyncDownloadString`](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a).</span></span> <span data-ttu-id="124bb-135">Obě primitiv stahování dat z webové stránky, danou adresu URL.</span><span class="sxs-lookup"><span data-stu-id="124bb-135">Both primitives download data from a Web page, given a URL.</span></span> <span data-ttu-id="124bb-136">`AsyncGetResponse` vytváří `System.Net.WebResponse` objekt, a `AsyncDownloadString` vytvoří řetězec, který představuje HTML pro webovou stránku.</span><span class="sxs-lookup"><span data-stu-id="124bb-136">`AsyncGetResponse` produces a `System.Net.WebResponse` object, and `AsyncDownloadString` produces a string that represents the HTML for a Web page.</span></span>

<span data-ttu-id="124bb-137">Několik primitiv pro asynchronní vstupně-výstupní operace jsou součástí [ `Microsoft.FSharp.Control.CommonExtensions` ](https://msdn.microsoft.com/library/2edb67cb-6814-4a30-849f-b6dbdd042396) modulu.</span><span class="sxs-lookup"><span data-stu-id="124bb-137">Several primitives for asynchronous I/O operations are included in the [`Microsoft.FSharp.Control.CommonExtensions`](https://msdn.microsoft.com/library/2edb67cb-6814-4a30-849f-b6dbdd042396) module.</span></span> <span data-ttu-id="124bb-138">Tyto metody rozšíření `System.IO.Stream` třídy jsou [ `Stream.AsyncRead` ](https://msdn.microsoft.com/library/85698aaa-bdda-47e6-abed-3730f59fda5e) a [ `Stream.AsyncWrite` ](https://msdn.microsoft.com/library/1b0a2751-e42a-47e1-bd27-020224adc618).</span><span class="sxs-lookup"><span data-stu-id="124bb-138">These extension methods of the `System.IO.Stream` class are [`Stream.AsyncRead`](https://msdn.microsoft.com/library/85698aaa-bdda-47e6-abed-3730f59fda5e) and [`Stream.AsyncWrite`](https://msdn.microsoft.com/library/1b0a2751-e42a-47e1-bd27-020224adc618).</span></span>

<span data-ttu-id="124bb-139">Jsou k dispozici v dalších asynchronní primitiv [F # PowerTools](https://fsprojects.github.io/VisualFSharpPowerTools/).</span><span class="sxs-lookup"><span data-stu-id="124bb-139">Additional asynchronous primitives are available in the [F# PowerTools](https://fsprojects.github.io/VisualFSharpPowerTools/).</span></span> <span data-ttu-id="124bb-140">Je také možné zapsat vlastní asynchronní primitiv definováním funkce, jehož dokončení textu je uzavřené v bloku asynchronní.</span><span class="sxs-lookup"><span data-stu-id="124bb-140">You can also write your own asynchronous primitives by defining a function whose complete body is enclosed in an async block.</span></span>

<span data-ttu-id="124bb-141">Chcete-li použít asynchronních metod v rozhraní .NET Framework, které jsou určené pro dalšími asynchronními modely F # asynchronní programování modelu, vytvoříte funkci, která vrátí F # `Async` objektu.</span><span class="sxs-lookup"><span data-stu-id="124bb-141">To use asynchronous methods in the .NET Framework that are designed for other asynchronous models with the F# asynchronous programming model, you create a function that returns an F# `Async` object.</span></span> <span data-ttu-id="124bb-142">Knihovny F # obsahuje funkce, které usnadnění udělat.</span><span class="sxs-lookup"><span data-stu-id="124bb-142">The F# library has functions that make this easy to do.</span></span>

<span data-ttu-id="124bb-143">Jedním z příkladů použití asynchronní pracovní postupy je součástí zde; Existuje mnoho dalších v dokumentaci pro metody [Async – třída](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7).</span><span class="sxs-lookup"><span data-stu-id="124bb-143">One example of using asynchronous workflows is included here; there are many others in the documentation for the methods of the [Async class](https://msdn.microsoft.com/library/03eb4d12-a01a-4565-a077-5e83f17cf6f7).</span></span>

<span data-ttu-id="124bb-144">Tento příklad ukazuje, jak používat asynchronní pracovní postupy k provádění výpočtů paralelně.</span><span class="sxs-lookup"><span data-stu-id="124bb-144">This example shows how to use asynchronous workflows to perform computations in parallel.</span></span>

<span data-ttu-id="124bb-145">V následujícím příkladu kódu funkci `fetchAsync` získá HTML text vrácená z webového požadavku.</span><span class="sxs-lookup"><span data-stu-id="124bb-145">In the following code example, a function `fetchAsync` gets the HTML text returned from a Web request.</span></span> <span data-ttu-id="124bb-146">`fetchAsync` Funkce obsahuje asynchronní blok kódu.</span><span class="sxs-lookup"><span data-stu-id="124bb-146">The `fetchAsync` function contains an asynchronous block of code.</span></span> <span data-ttu-id="124bb-147">Když vazbu přišla výsledek asynchronní primitivní, v takovém případě [ `AsyncDownloadString` ](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a), umožňují!</span><span class="sxs-lookup"><span data-stu-id="124bb-147">When a binding is made to the result of an asynchronous primitive, in this case [`AsyncDownloadString`](https://msdn.microsoft.com/library/8a85a9b7-f712-4cac-a0ce-0a797f8ea32a), let!</span></span> <span data-ttu-id="124bb-148">se používá namísto umožňují.</span><span class="sxs-lookup"><span data-stu-id="124bb-148">is used instead of let.</span></span>

<span data-ttu-id="124bb-149">Pomocí funkce [ `Async.RunSynchronously` ](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b) k provedení asynchronní operaci a počkat na její výsledek.</span><span class="sxs-lookup"><span data-stu-id="124bb-149">You use the function [`Async.RunSynchronously`](https://msdn.microsoft.com/library/0a6663a9-50f2-4d38-8bf3-cefd1a51fd6b) to execute an asynchronous operation and wait for its result.</span></span> <span data-ttu-id="124bb-150">Jako příklad můžete spouštět více asynchronní operace paralelně pomocí [ `Async.Parallel` ](https://msdn.microsoft.com/library/aa9b0355-2d55-4858-b943-cbe428de9dc4) fungovat společně s `Async.RunSynchronously` funkce.</span><span class="sxs-lookup"><span data-stu-id="124bb-150">As an example, you can execute multiple asynchronous operations in parallel by using the [`Async.Parallel`](https://msdn.microsoft.com/library/aa9b0355-2d55-4858-b943-cbe428de9dc4) function together with the `Async.RunSynchronously` function.</span></span> <span data-ttu-id="124bb-151">`Async.Parallel` Funkce přebírá seznam `Async` objekty, nastaví kód pro každou `Async` objekt úlohy ke spuštění v paralelní a vrátí `Async` objekt, který reprezentuje paralelní výpočty.</span><span class="sxs-lookup"><span data-stu-id="124bb-151">The `Async.Parallel` function takes a list of the `Async` objects, sets up the code for each `Async` task object to run in parallel, and returns an `Async` object that represents the parallel computation.</span></span> <span data-ttu-id="124bb-152">Stejně jako u jednu operaci zavolání `Async.RunSynchronously` jeho spuštění.</span><span class="sxs-lookup"><span data-stu-id="124bb-152">Just as for a single operation, you call `Async.RunSynchronously` to start the execution.</span></span>

<span data-ttu-id="124bb-153">`runAll` Funkce spustí paralelně tři asynchronní pracovní postupy a počká, až budou všechny dokončili.</span><span class="sxs-lookup"><span data-stu-id="124bb-153">The `runAll` function launches three asynchronous workflows in parallel and waits until they have all completed.</span></span>

[!code-fsharp[Main](../../../samples/snippets/fsharp/lang-ref-2/snippet8003.fs)]

## <a name="see-also"></a><span data-ttu-id="124bb-154">Viz také</span><span class="sxs-lookup"><span data-stu-id="124bb-154">See Also</span></span>

[<span data-ttu-id="124bb-155">Referenční dokumentace jazyka F#</span><span class="sxs-lookup"><span data-stu-id="124bb-155">F# Language Reference</span></span>](index.md)

[<span data-ttu-id="124bb-156">Výpočetní výrazy</span><span class="sxs-lookup"><span data-stu-id="124bb-156">Computation Expressions</span></span>](computation-expressions.md)

[<span data-ttu-id="124bb-157">Control.Async – třída</span><span class="sxs-lookup"><span data-stu-id="124bb-157">Control.Async Class</span></span>](https://msdn.microsoft.com/visualfsharpdocs/conceptual/control.async-class-%5bfsharp%5d)
