---
title: "Postupy: Vytváření a používání dynamických objektů (C# a Visual Basic)"
ms.date: 07/20/2015
ms.prod: .net
ms.technology: devlang-csharp
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- dynamic objects [Visual Basic]
- dynamic objects
- dynamic objects [C#]
ms.assetid: 568f1645-1305-4906-8625-5d77af81e04f
caps.latest.revision: "22"
author: BillWagner
ms.author: wiwagn
ms.openlocfilehash: ab1e245ed806cf0ea6346c76c6ade83273eed7be
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 11/21/2017
---
# <a name="walkthrough-creating-and-using-dynamic-objects-c-and-visual-basic"></a><span data-ttu-id="9efc6-102">Postupy: Vytváření a používání dynamických objektů (C# a Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="9efc6-102">Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)</span></span>

<span data-ttu-id="9efc6-103">Dynamické objekty vystavit členy například vlastnosti a metody za běhu, místo v při kompilaci.</span><span class="sxs-lookup"><span data-stu-id="9efc6-103">Dynamic objects expose members such as properties and methods at run time, instead of in at compile time.</span></span> <span data-ttu-id="9efc6-104">To umožňuje vytvářet objekty pro práci s struktury, které neodpovídají statický typ nebo formát.</span><span class="sxs-lookup"><span data-stu-id="9efc6-104">This enables you to create objects to work with structures that do not match a static type or format.</span></span> <span data-ttu-id="9efc6-105">Můžete například použít dynamický objekt tak, aby odkazovaly HTML modelu DOM (Document Object), která může obsahovat libovolnou kombinaci platný elementů značek HTML a atributů.</span><span class="sxs-lookup"><span data-stu-id="9efc6-105">For example, you can use a dynamic object to reference the HTML Document Object Model (DOM), which can contain any combination of valid HTML markup elements and attributes.</span></span> <span data-ttu-id="9efc6-106">Protože každý dokument HTML je jedinečný, členy u konkrétního dokumentu HTML určuje za běhu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-106">Because each HTML document is unique, the members for a particular HTML document are determined at run time.</span></span> <span data-ttu-id="9efc6-107">Běžnou metodou k odkazovat na atribut elementu HTML je předat název atributu `GetProperty` metoda elementu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-107">A common method to reference an attribute of an HTML element is to pass the name of the attribute to the `GetProperty` method of the element.</span></span> <span data-ttu-id="9efc6-108">Odkazy `id` atribut elementu HTML `<div id="Div1">`, nejprve získat odkaz na `<div>` element a pak použijte `divElement.GetProperty("id")`.</span><span class="sxs-lookup"><span data-stu-id="9efc6-108">To reference the `id` attribute of the HTML element `<div id="Div1">`, you first obtain a reference to the `<div>` element, and then use `divElement.GetProperty("id")`.</span></span> <span data-ttu-id="9efc6-109">Pokud chcete použít dynamický objekt, můžete odkazovat `id` atribut jako `divElement.id`.</span><span class="sxs-lookup"><span data-stu-id="9efc6-109">If you use a dynamic object, you can reference the `id` attribute as `divElement.id`.</span></span>  
  
 <span data-ttu-id="9efc6-110">Dynamické objekty také poskytují pohodlný přístup k dynamické jazyků, například IronPython a IronRuby.</span><span class="sxs-lookup"><span data-stu-id="9efc6-110">Dynamic objects also provide convenient access to dynamic languages such as IronPython and IronRuby.</span></span> <span data-ttu-id="9efc6-111">Dynamický objekt můžete použít k odkazování na dynamické skript, který je považován za běhu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-111">You can use a dynamic object to refer to a dynamic script that is interpreted at run time.</span></span>  
  
 <span data-ttu-id="9efc6-112">Odkazování na dynamický objekt s použitím pozdní vazba.</span><span class="sxs-lookup"><span data-stu-id="9efc6-112">You reference a dynamic object by using late binding.</span></span> <span data-ttu-id="9efc6-113">V jazyce C#, zadejte typ objektu pozdní vazbou jako `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="9efc6-113">In C#, you specify the type of a late-bound object as `dynamic`.</span></span> <span data-ttu-id="9efc6-114">V [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], zadejte typ objektu pozdní vazbou jako `Object`.</span><span class="sxs-lookup"><span data-stu-id="9efc6-114">In [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], you specify the type of a late-bound object as `Object`.</span></span> <span data-ttu-id="9efc6-115">Další informace najdete v tématu [dynamické](../../../csharp/language-reference/keywords/dynamic.md) a [Early a pozdní vazby](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span><span class="sxs-lookup"><span data-stu-id="9efc6-115">For more information, see [dynamic](../../../csharp/language-reference/keywords/dynamic.md) and [Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span></span>  
  
 <span data-ttu-id="9efc6-116">Můžete vytvořit vlastní dynamických objektů pomocí třídy v <xref:System.Dynamic?displayProperty=nameWithType> oboru názvů.</span><span class="sxs-lookup"><span data-stu-id="9efc6-116">You can create custom dynamic objects by using the classes in the <xref:System.Dynamic?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="9efc6-117">Například můžete vytvořit <xref:System.Dynamic.ExpandoObject> a zadejte členy tohoto objektu v době běhu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-117">For example, you can create an <xref:System.Dynamic.ExpandoObject> and specify the members of that object at run time.</span></span> <span data-ttu-id="9efc6-118">Můžete také vytvořit vlastní typ, který dědí <xref:System.Dynamic.DynamicObject> třídy.</span><span class="sxs-lookup"><span data-stu-id="9efc6-118">You can also create your own type that inherits the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="9efc6-119">Potom můžete přepsat členů <xref:System.Dynamic.DynamicObject> třídy poskytují spuštění dynamické funkce.</span><span class="sxs-lookup"><span data-stu-id="9efc6-119">You can then override the members of the <xref:System.Dynamic.DynamicObject> class to provide run-time dynamic functionality.</span></span>  
  
 <span data-ttu-id="9efc6-120">V tomto návodu budete provádět následující úlohy:</span><span class="sxs-lookup"><span data-stu-id="9efc6-120">In this walkthrough you will perform the following tasks:</span></span>  
  
-   <span data-ttu-id="9efc6-121">Vytvořte vlastní objekt, který dynamicky zpřístupní obsah textového souboru jako vlastnosti objektu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-121">Create a custom object that dynamically exposes the contents of a text file as properties of an object.</span></span>  
  
-   <span data-ttu-id="9efc6-122">Vytvořit projekt, který se používá `IronPython` knihovny.</span><span class="sxs-lookup"><span data-stu-id="9efc6-122">Create a project that uses an `IronPython` library.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="9efc6-123">Požadavky</span><span class="sxs-lookup"><span data-stu-id="9efc6-123">Prerequisites</span></span>  
<span data-ttu-id="9efc6-124">Je třeba [IronPython](http://ironpython.net/) pro .NET pro dokončení tohoto návodu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-124">You need [IronPython](http://ironpython.net/) for .NET to complete this walkthrough.</span></span> <span data-ttu-id="9efc6-125">Přejděte na jejich [stránky pro stažení](http://ironpython.net/download/) získat nejnovější verzi.</span><span class="sxs-lookup"><span data-stu-id="9efc6-125">Go to their [Download page](http://ironpython.net/download/) to obtain the latest version.</span></span>
  
[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  
  
## <a name="creating-a-custom-dynamic-object"></a><span data-ttu-id="9efc6-126">Vytváření vlastních dynamických objektů</span><span class="sxs-lookup"><span data-stu-id="9efc6-126">Creating a Custom Dynamic Object</span></span>  
 <span data-ttu-id="9efc6-127">První projekt, který vytvoříte v tomto názorném postupu definuje vlastní dynamický objekt, který vyhledá obsah textového souboru.</span><span class="sxs-lookup"><span data-stu-id="9efc6-127">The first project that you create in this walkthrough defines a custom dynamic object that searches the contents of a text file.</span></span> <span data-ttu-id="9efc6-128">Hledaný text je zadán název dynamických vlastností.</span><span class="sxs-lookup"><span data-stu-id="9efc6-128">Text to search for is specified by the name of a dynamic property.</span></span> <span data-ttu-id="9efc6-129">Například pokud volání kódu určuje `dynamicFile.Sample`, dynamické třídy vrátí obecné seznam řetězců, které obsahuje všechny řádky ze souboru, které začínají řetězcem "Ukázkový".</span><span class="sxs-lookup"><span data-stu-id="9efc6-129">For example, if calling code specifies `dynamicFile.Sample`, the dynamic class returns a generic list of strings that contains all of the lines from the file that begin with "Sample".</span></span> <span data-ttu-id="9efc6-130">Vyhledávání nerozlišuje velká a malá písmena.</span><span class="sxs-lookup"><span data-stu-id="9efc6-130">The search is case-insensitive.</span></span> <span data-ttu-id="9efc6-131">Dynamické třída také podporuje dva volitelné argumenty.</span><span class="sxs-lookup"><span data-stu-id="9efc6-131">The dynamic class also supports two optional arguments.</span></span> <span data-ttu-id="9efc6-132">První argument je hodnota výčtu možnost vyhledávání, která určuje třídu dynamické program hledat odpovídá na začátku řádku, koncem řádku, nebo kdekoli v řádku.</span><span class="sxs-lookup"><span data-stu-id="9efc6-132">The first argument is a search option enum value that specifies that the dynamic class should search for matches at the start of the line, the end of the line, or anywhere in the line.</span></span> <span data-ttu-id="9efc6-133">Druhý argument určuje, že by měl dynamické třídy trim úvodní i koncové mezery z každého řádku před vyhledáváním.</span><span class="sxs-lookup"><span data-stu-id="9efc6-133">The second argument specifies that the dynamic class should trim leading and trailing spaces from each line before searching.</span></span> <span data-ttu-id="9efc6-134">Například pokud volání kódu určuje `dynamicFile.Sample(StringSearchOption.Contains)`, dynamické třídy hledá "Ukázkový" kdekoli v řádku.</span><span class="sxs-lookup"><span data-stu-id="9efc6-134">For example, if calling code specifies `dynamicFile.Sample(StringSearchOption.Contains)`, the dynamic class searches for "Sample" anywhere in a line.</span></span> <span data-ttu-id="9efc6-135">Pokud volání kódu určuje `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, dynamické Třída hledá "Ukázkový" na začátku každého řádku a neodebere úvodní i koncové mezery.</span><span class="sxs-lookup"><span data-stu-id="9efc6-135">If calling code specifies `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, the dynamic class searches for "Sample" at the start of each line, and does not remove leading and trailing spaces.</span></span> <span data-ttu-id="9efc6-136">Výchozí chování dynamické třídy je chcete vyhledávat shodu na začátku každého řádku a odebrat úvodní i koncové mezery.</span><span class="sxs-lookup"><span data-stu-id="9efc6-136">The default behavior of the dynamic class is to search for a match at the start of each line and to remove leading and trailing spaces.</span></span>  
  
#### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="9efc6-137">Chcete-li vytvořit vlastní dynamické – třída</span><span class="sxs-lookup"><span data-stu-id="9efc6-137">To create a custom dynamic class</span></span>  
  
1.  <span data-ttu-id="9efc6-138">Spustit [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9efc6-138">Start [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)].</span></span>  
  
2.  <span data-ttu-id="9efc6-139">Na **soubor** nabídky, přejděte na příkaz **nový** a pak klikněte na **projektu**.</span><span class="sxs-lookup"><span data-stu-id="9efc6-139">On the **File** menu, point to **New** and then click **Project**.</span></span>  
  
3.  <span data-ttu-id="9efc6-140">V **nový projekt** dialogovém **typy projektů** podokně, ujistěte se, že **Windows** je vybrána.</span><span class="sxs-lookup"><span data-stu-id="9efc6-140">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="9efc6-141">Vyberte **konzolové aplikace** v **šablony** podokně.</span><span class="sxs-lookup"><span data-stu-id="9efc6-141">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="9efc6-142">V **název** zadejte `DynamicSample`a potom klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="9efc6-142">In the **Name** box, type `DynamicSample`, and then click **OK**.</span></span> <span data-ttu-id="9efc6-143">Vytvoření nového projektu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-143">The new project is created.</span></span>  
  
4.  <span data-ttu-id="9efc6-144">Klikněte pravým tlačítkem na projekt DynamicSample a přejděte na **přidat**a potom klikněte na **třída**.</span><span class="sxs-lookup"><span data-stu-id="9efc6-144">Right-click the DynamicSample project and point to **Add**, and then click **Class**.</span></span> <span data-ttu-id="9efc6-145">V **název** zadejte `ReadOnlyFile`a potom klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="9efc6-145">In the **Name** box, type `ReadOnlyFile`, and then click **OK**.</span></span> <span data-ttu-id="9efc6-146">Která obsahuje třídu ReadOnlyFile přidán nový soubor.</span><span class="sxs-lookup"><span data-stu-id="9efc6-146">A new file is added that contains the ReadOnlyFile class.</span></span>  
  
5.  <span data-ttu-id="9efc6-147">V horní části souboru ReadOnlyFile.cs nebo ReadOnlyFile.vb, přidejte následující kód k importu <xref:System.IO?displayProperty=nameWithType> a <xref:System.Dynamic?displayProperty=nameWithType> obory názvů.</span><span class="sxs-lookup"><span data-stu-id="9efc6-147">At the top of the ReadOnlyFile.cs or ReadOnlyFile.vb file, add the following code to import the <xref:System.IO?displayProperty=nameWithType> and <xref:System.Dynamic?displayProperty=nameWithType> namespaces.</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#1](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_1.cs)]

     [!code-vb[VbDynamicWalkthrough#1](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_1.vb)]  
  
6.  <span data-ttu-id="9efc6-148">Vlastní dynamický objekt výčet používá k určení kritérií vyhledávání.</span><span class="sxs-lookup"><span data-stu-id="9efc6-148">The custom dynamic object uses an enum to determine the search criteria.</span></span> <span data-ttu-id="9efc6-149">Před příkazem třídy přidejte následující definice výčtu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-149">Before the class statement, add the following enum definition.</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#2](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_2.cs)]

     [!code-vb[VbDynamicWalkthrough#2](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_2.vb)]  
  
7.  <span data-ttu-id="9efc6-150">Aktualizovat Class – příkaz dědění `DynamicObject` třídy, jak je znázorněno v následujícím příkladu kódu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-150">Update the class statement to inherit the `DynamicObject` class, as shown in the following code example.</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#3](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_3.cs)]

     [!code-vb[VbDynamicWalkthrough#3](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_3.vb)]  
  
8.  <span data-ttu-id="9efc6-151">Přidejte následující kód, který `ReadOnlyFile` třída zadat soukromé pole pro cestu k souboru a konstruktor pro `ReadOnlyFile` – třída.</span><span class="sxs-lookup"><span data-stu-id="9efc6-151">Add the following code to the `ReadOnlyFile` class to define a private field for the file path and a constructor for the `ReadOnlyFile` class.</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#4](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_4.cs)]
     
     [!code-vb[VbDynamicWalkthrough#4](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_4.vb)]  
  
9. <span data-ttu-id="9efc6-152">Přidejte následující `GetPropertyValue` metodu `ReadOnlyFile` třídy.</span><span class="sxs-lookup"><span data-stu-id="9efc6-152">Add the following `GetPropertyValue` method to the `ReadOnlyFile` class.</span></span> <span data-ttu-id="9efc6-153">`GetPropertyValue` Metoda přebírá jako vstup, kritéria hledání a vrátí řádky z textového souboru, které odpovídají, který vyhledávací kritéria.</span><span class="sxs-lookup"><span data-stu-id="9efc6-153">The `GetPropertyValue` method takes, as input, search criteria and returns the lines from a text file that match that search criteria.</span></span> <span data-ttu-id="9efc6-154">Dynamické metody poskytované `ReadOnlyFile` třídy volání `GetPropertyValue` metoda pro načtení jejich odpovídajících výsledků.</span><span class="sxs-lookup"><span data-stu-id="9efc6-154">The dynamic methods provided by the `ReadOnlyFile` class call the `GetPropertyValue` method to retrieve their respective results.</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#5](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_5.cs)]
     
     [!code-vb[VbDynamicWalkthrough#5](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_5.vb)]  
  
10. <span data-ttu-id="9efc6-155">Po `GetPropertyValue` metoda, přidejte následující kód k přepsání <xref:System.Dynamic.DynamicObject.TryGetMember%2A> metodu <xref:System.Dynamic.DynamicObject> třídy.</span><span class="sxs-lookup"><span data-stu-id="9efc6-155">After the `GetPropertyValue` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="9efc6-156"><xref:System.Dynamic.DynamicObject.TryGetMember%2A> Metoda je volána, když je požadován členem dynamické třídy a nejsou zadány žádné argumenty.</span><span class="sxs-lookup"><span data-stu-id="9efc6-156">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method is called when a member of a dynamic class is requested and no arguments are specified.</span></span> <span data-ttu-id="9efc6-157">`binder` Argument obsahuje informace o odkazované člen a `result` argument odkazuje výsledek vrácený pro zadaného člena.</span><span class="sxs-lookup"><span data-stu-id="9efc6-157">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="9efc6-158"><xref:System.Dynamic.DynamicObject.TryGetMember%2A> Metoda vrací logickou hodnotu, která vrací `true` Pokud požadovaný člena existuje; jinak vrátí `false`.</span><span class="sxs-lookup"><span data-stu-id="9efc6-158">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#6](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_6.cs)]
     
     [!code-vb[VbDynamicWalkthrough#6](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_6.vb)]  
  
11. <span data-ttu-id="9efc6-159">Po `TryGetMember` metoda, přidejte následující kód k přepsání <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> metodu <xref:System.Dynamic.DynamicObject> třídy.</span><span class="sxs-lookup"><span data-stu-id="9efc6-159">After the `TryGetMember` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="9efc6-160"><xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> Metoda je volána, pokud se požaduje členem dynamické třídy s argumenty.</span><span class="sxs-lookup"><span data-stu-id="9efc6-160">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method is called when a member of a dynamic class is requested with arguments.</span></span> <span data-ttu-id="9efc6-161">`binder` Argument obsahuje informace o odkazované člen a `result` argument odkazuje výsledek vrácený pro zadaného člena.</span><span class="sxs-lookup"><span data-stu-id="9efc6-161">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="9efc6-162">`args` Argument obsahuje pole argumentů, které se předávají do člena.</span><span class="sxs-lookup"><span data-stu-id="9efc6-162">The `args` argument contains an array of the arguments that are passed to the member.</span></span> <span data-ttu-id="9efc6-163"><xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> Metoda vrací logickou hodnotu, která vrací `true` Pokud požadovaný člena existuje; jinak vrátí `false`.</span><span class="sxs-lookup"><span data-stu-id="9efc6-163">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
     <span data-ttu-id="9efc6-164">Vlastní verzi `TryInvokeMember` metoda očekává se hodnota z první argument `StringSearchOption` výčet, který jste zadali v předchozím kroku.</span><span class="sxs-lookup"><span data-stu-id="9efc6-164">The custom version of the `TryInvokeMember` method expects the first argument to be a value from the `StringSearchOption` enum that you defined in a previous step.</span></span> <span data-ttu-id="9efc6-165">`TryInvokeMember` Metoda očekává druhý argument jako logická hodnota.</span><span class="sxs-lookup"><span data-stu-id="9efc6-165">The `TryInvokeMember` method expects the second argument to be a Boolean value.</span></span> <span data-ttu-id="9efc6-166">Pokud jeden nebo oba argumenty jsou platné hodnoty, že jsou předány `GetPropertyValue` metoda načíst výsledky.</span><span class="sxs-lookup"><span data-stu-id="9efc6-166">If one or both arguments are valid values, they are passed to the `GetPropertyValue` method to retrieve the results.</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#7](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_7.cs)]
     
     [!code-vb[VbDynamicWalkthrough#7](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_7.vb)]  
  
12. <span data-ttu-id="9efc6-167">Soubor uložte a zavřete.</span><span class="sxs-lookup"><span data-stu-id="9efc6-167">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-text-file"></a><span data-ttu-id="9efc6-168">Chcete-li vytvořit ukázkový textový soubor</span><span class="sxs-lookup"><span data-stu-id="9efc6-168">To create a sample text file</span></span>  
  
1.  <span data-ttu-id="9efc6-169">Klikněte pravým tlačítkem na projekt DynamicSample a přejděte na **přidat**a potom klikněte na **novou položku**.</span><span class="sxs-lookup"><span data-stu-id="9efc6-169">Right-click the DynamicSample project and point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="9efc6-170">V **nainstalovaných šablonách** podokně, vyberte **Obecné**a pak vyberte **textový soubor** šablony.</span><span class="sxs-lookup"><span data-stu-id="9efc6-170">In the **Installed Templates** pane, select **General**, and then select the **Text File** template.</span></span> <span data-ttu-id="9efc6-171">Ponechte výchozí název soubory TextFile1.txt v **název** pole a pak klikněte na **přidat**.</span><span class="sxs-lookup"><span data-stu-id="9efc6-171">Leave the default name of TextFile1.txt in the **Name** box, and then click **Add**.</span></span> <span data-ttu-id="9efc6-172">Nový textový soubor se přidá do projektu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-172">A new text file is added to the project.</span></span>  
  
2.  <span data-ttu-id="9efc6-173">Zkopírujte následující text do souboru soubory TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="9efc6-173">Copy the following text to the TextFile1.txt file.</span></span>  
  
    ```  
    List of customers and suppliers  
  
    Supplier: Lucerne Publishing (http://www.lucernepublishing.com/)  
    Customer: Preston, Chris  
    Customer: Hines, Patrick  
    Customer: Cameron, Maria  
    Supplier: Graphic Design Institute (http://www.graphicdesigninstitute.com/)   
    Supplier: Fabrikam, Inc. (http://www.fabrikam.com/)   
    Customer: Seubert, Roxanne  
    Supplier: Proseware, Inc. (http://www.proseware.com/)   
    Customer: Adolphi, Stephan  
    Customer: Koch, Paul  
    ```  
  
3.  <span data-ttu-id="9efc6-174">Soubor uložte a zavřete.</span><span class="sxs-lookup"><span data-stu-id="9efc6-174">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-application-that-uses-the-custom-dynamic-object"></a><span data-ttu-id="9efc6-175">K vytvoření ukázkové aplikace, která používá vlastní dynamických objektů</span><span class="sxs-lookup"><span data-stu-id="9efc6-175">To create a sample application that uses the custom dynamic object</span></span>  
  
1.  <span data-ttu-id="9efc6-176">V **Průzkumníku řešení**, poklikejte na soubor Module1.vb, pokud používáte [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] nebo souboru Program.cs, pokud používáte Visual C#.</span><span class="sxs-lookup"><span data-stu-id="9efc6-176">In **Solution Explorer**, double-click the Module1.vb file if you are using [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] or the Program.cs file if you are using Visual C#.</span></span>  
  
2.  <span data-ttu-id="9efc6-177">Přidejte následující kód do hlavní postup vytvoření instance `ReadOnlyFile` třídu pro soubory TextFile1.txt souboru.</span><span class="sxs-lookup"><span data-stu-id="9efc6-177">Add the following code to the Main procedure to create an instance of the `ReadOnlyFile` class for the TextFile1.txt file.</span></span> <span data-ttu-id="9efc6-178">Kód používá pozdní vazba volání dynamické členy a načtení řádků textu, které obsahují řetězec "Zákazník".</span><span class="sxs-lookup"><span data-stu-id="9efc6-178">The code uses late binding to call dynamic members and retrieve lines of text that contain the string "Customer".</span></span>  
  
     [!code-csharp[VbDynamicWalkthrough#8](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_8.cs)]
     
     [!code-vb[VbDynamicWalkthrough#8](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_8.vb)]  
  
3.  <span data-ttu-id="9efc6-179">Uložte soubor a stiskněte klávesu CTRL + F5 sestavení a spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="9efc6-179">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="calling-a-dynamic-language-library"></a><span data-ttu-id="9efc6-180">Volání metody knihovnu Dynamic Language</span><span class="sxs-lookup"><span data-stu-id="9efc6-180">Calling a Dynamic Language Library</span></span>  

<span data-ttu-id="9efc6-181">Další projekt, který vytvoříte v tomto návodu přistupuje k knihovny, která se píšou v jazyce dynamické IronPython.</span><span class="sxs-lookup"><span data-stu-id="9efc6-181">The next project that you create in this walkthrough accesses a library that is written in the dynamic language IronPython.</span></span>
  
#### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="9efc6-182">Chcete-li vytvořit vlastní dynamické – třída</span><span class="sxs-lookup"><span data-stu-id="9efc6-182">To create a custom dynamic class</span></span>  
  
1.  <span data-ttu-id="9efc6-183">V [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)]na **soubor** nabídky, přejděte na příkaz **nový** a pak klikněte na **projektu**.</span><span class="sxs-lookup"><span data-stu-id="9efc6-183">In [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)], on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2.  <span data-ttu-id="9efc6-184">V **nový projekt** dialogovém **typy projektů** podokně, ujistěte se, že **Windows** je vybrána.</span><span class="sxs-lookup"><span data-stu-id="9efc6-184">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="9efc6-185">Vyberte **konzolové aplikace** v **šablony** podokně.</span><span class="sxs-lookup"><span data-stu-id="9efc6-185">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="9efc6-186">V **název** zadejte `DynamicIronPythonSample`a potom klikněte na **OK**.</span><span class="sxs-lookup"><span data-stu-id="9efc6-186">In the **Name** box, type `DynamicIronPythonSample`, and then click **OK**.</span></span> <span data-ttu-id="9efc6-187">Vytvoření nového projektu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-187">The new project is created.</span></span>  
  
3.  <span data-ttu-id="9efc6-188">Pokud používáte [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], klikněte pravým tlačítkem na projekt DynamicIronPythonSample a pak klikněte na tlačítko **vlastnosti**.</span><span class="sxs-lookup"><span data-stu-id="9efc6-188">If you are using [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], right-click the DynamicIronPythonSample project and then click **Properties**.</span></span> <span data-ttu-id="9efc6-189">Klikněte **odkazy** kartě. Klikněte **přidat** tlačítko.</span><span class="sxs-lookup"><span data-stu-id="9efc6-189">Click the **References** tab. Click the **Add** button.</span></span> <span data-ttu-id="9efc6-190">Pokud používáte Visual C#, v **Průzkumníku řešení**, klikněte pravým tlačítkem myši **odkazy** složku a pak klikněte na tlačítko **přidat odkaz na**.</span><span class="sxs-lookup"><span data-stu-id="9efc6-190">If you are using Visual C#, in **Solution Explorer**, right-click the **References** folder and then click **Add Reference**.</span></span>  
  
4.  <span data-ttu-id="9efc6-191">Na **Procházet** kartě, přejděte do složky, kde jsou nainstalovány knihovny IronPython.</span><span class="sxs-lookup"><span data-stu-id="9efc6-191">On the **Browse** tab, browse to the folder where the IronPython libraries are installed.</span></span> <span data-ttu-id="9efc6-192">Například C:\Program pro rozhraní .NET 4.0 2.6 Files\IronPython.</span><span class="sxs-lookup"><span data-stu-id="9efc6-192">For example, C:\Program Files\IronPython 2.6 for .NET 4.0.</span></span> <span data-ttu-id="9efc6-193">Vyberte **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, a **Microsoft.Dynamic.dll** knihovny .</span><span class="sxs-lookup"><span data-stu-id="9efc6-193">Select the **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, and **Microsoft.Dynamic.dll** libraries.</span></span> <span data-ttu-id="9efc6-194">Click **OK**.</span><span class="sxs-lookup"><span data-stu-id="9efc6-194">Click **OK**.</span></span>  
  
5.  <span data-ttu-id="9efc6-195">Pokud používáte [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], upravte soubor Module1.vb.</span><span class="sxs-lookup"><span data-stu-id="9efc6-195">If you are using [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], edit the Module1.vb file.</span></span> <span data-ttu-id="9efc6-196">Pokud používáte Visual C#, upravte soubor Program.cs.</span><span class="sxs-lookup"><span data-stu-id="9efc6-196">If you are using Visual C#, edit the Program.cs file.</span></span>  
  
6.  <span data-ttu-id="9efc6-197">Na začátek souboru přidejte následující kód k importu `Microsoft.Scripting.Hosting` a `IronPython.Hosting` obory názvů v IronPython knihovny.</span><span class="sxs-lookup"><span data-stu-id="9efc6-197">At the top of the file, add the following code to import the `Microsoft.Scripting.Hosting` and `IronPython.Hosting` namespaces from the IronPython libraries.</span></span>  
  
     [!code-csharp[VbDynamicWalkthroughIronPython#1](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_9.cs)]
     
     [!code-vb[VbDynamicWalkthroughIronPython#1](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_9.vb)]  
  
7.  <span data-ttu-id="9efc6-198">V metodě hlavní, přidejte následující kód pro vytvoření nového `Microsoft.Scripting.Hosting.ScriptRuntime` objektu k hostování IronPython knihovny.</span><span class="sxs-lookup"><span data-stu-id="9efc6-198">In the Main method, add the following code to create a new `Microsoft.Scripting.Hosting.ScriptRuntime` object to host the IronPython libraries.</span></span> <span data-ttu-id="9efc6-199">`ScriptRuntime` Objekt načte random.py IronPython knihovna modulu.</span><span class="sxs-lookup"><span data-stu-id="9efc6-199">The `ScriptRuntime` object loads the IronPython library module random.py.</span></span>  
  
     [!code-csharp[VbDynamicWalkthroughIronPython#2](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_10.cs)]
     
     [!code-vb[VbDynamicWalkthroughIronPython#2](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_10.vb)]  
  
8.  <span data-ttu-id="9efc6-200">Za kód pro načtení modulu random.py přidejte následující kód k vytvoření pole celých čísel.</span><span class="sxs-lookup"><span data-stu-id="9efc6-200">After the code to load the random.py module, add the following code to create an array of integers.</span></span> <span data-ttu-id="9efc6-201">Toto pole je předána `shuffle` metoda random.py modul, kterým náhodně seřadí hodnoty v poli.</span><span class="sxs-lookup"><span data-stu-id="9efc6-201">The array is passed to the `shuffle` method of the random.py module, which randomly sorts the values in the array.</span></span>  
  
     [!code-csharp[VbDynamicWalkthroughIronPython#3](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_11.cs)]
     
     [!code-vb[VbDynamicWalkthroughIronPython#3](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_11.vb)]  
  
9. <span data-ttu-id="9efc6-202">Uložte soubor a stiskněte klávesu CTRL + F5 sestavení a spuštění aplikace.</span><span class="sxs-lookup"><span data-stu-id="9efc6-202">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9efc6-203">Viz také</span><span class="sxs-lookup"><span data-stu-id="9efc6-203">See Also</span></span>  
 <xref:System.Dynamic?displayProperty=nameWithType>  
 <xref:System.Dynamic.DynamicObject?displayProperty=nameWithType>  
 [<span data-ttu-id="9efc6-204">Použití typu dynamic</span><span class="sxs-lookup"><span data-stu-id="9efc6-204">Using Type dynamic</span></span>](../../../csharp/programming-guide/types/using-type-dynamic.md)  
 [<span data-ttu-id="9efc6-205">Statické a pozdní vazby</span><span class="sxs-lookup"><span data-stu-id="9efc6-205">Early and Late Binding</span></span>](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md)  
 [<span data-ttu-id="9efc6-206">dynamické</span><span class="sxs-lookup"><span data-stu-id="9efc6-206">dynamic</span></span>](../../../csharp/language-reference/keywords/dynamic.md)  
 [<span data-ttu-id="9efc6-207">Implementace rozhraní dynamické (externí blog)</span><span class="sxs-lookup"><span data-stu-id="9efc6-207">Implementing Dynamic Interfaces (external blog)</span></span>](http://go.microsoft.com/fwlink/?LinkId=230895)
