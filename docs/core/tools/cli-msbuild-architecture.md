---
title: "Architektura nástrojů příkazového řádku .NET core"
description: "Další informace o .NET Core tooling vrstvy a co se změnilo v nejnovější verze."
keywords: .NET core, MSBuild, architektura
author: blackdwarf
ms.date: 03/06/2017
ms.topic: article
ms.prod: .net-core
ms.technology: dotnet-cli
ms.devlang: dotnet
ms.assetid: 7fff0f61-ac23-42f0-9661-72a7240a4456
ms.openlocfilehash: ad34faa0c2577bd5e3a0ba339b19a9ad387e015a
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 10/18/2017
---
# <a name="high-level-overview-of-changes-in-the-net-core-tools"></a><span data-ttu-id="58a36-104">Přehled změn v nástrojích pro .NET Core</span><span class="sxs-lookup"><span data-stu-id="58a36-104">High-level overview of changes in the .NET Core tools</span></span>

<span data-ttu-id="58a36-105">Tento dokument popisuje změny přidružené přechod z *project.json* k MSBuild a *csproj* projektu systému s informacemi o změny rozvrstvení nástrojů .NET Core a implementace rozhraní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="58a36-105">This document describes the changes associated with moving from *project.json* to MSBuild and the *csproj* project system with information on the changes to the layering of the .NET Core tooling and the implementation of the CLI commands.</span></span> <span data-ttu-id="58a36-106">Tyto změny došlo oproti verzi rozhraní .NET Core SDK 1.0 a Visual Studio 2017 na 7 března 2017 (najdete v článku [oznámení](https://blogs.msdn.microsoft.com/dotnet/2017/03/07/announcing-net-core-tools-1-0/)), ale byly původně implementována ve verzi .NET Core SDK Preview 3.</span><span class="sxs-lookup"><span data-stu-id="58a36-106">These changes occurred with the release of .NET Core SDK 1.0 and Visual Studio 2017 on March 7, 2017 (see the [announcement](https://blogs.msdn.microsoft.com/dotnet/2017/03/07/announcing-net-core-tools-1-0/)) but were initially implemented with the release of the .NET Core SDK Preview 3.</span></span>

## <a name="moving-away-from-projectjson"></a><span data-ttu-id="58a36-107">Přesun mimo project.json</span><span class="sxs-lookup"><span data-stu-id="58a36-107">Moving away from project.json</span></span>
<span data-ttu-id="58a36-108">Největší změnou v nástroji pro .NET Core je určitě [přesunout mimo project.json do csproj](https://blogs.msdn.microsoft.com/dotnet/2016/05/23/changes-to-project-json/) jako systém projektu.</span><span class="sxs-lookup"><span data-stu-id="58a36-108">The biggest change in the tooling for .NET Core is certainly the [move away from project.json to csproj](https://blogs.msdn.microsoft.com/dotnet/2016/05/23/changes-to-project-json/) as the project system.</span></span> <span data-ttu-id="58a36-109">Nejnovější verze nástroje příkazového řádku nepodporují *project.json* soubory.</span><span class="sxs-lookup"><span data-stu-id="58a36-109">The latest versions of the command-line tools don't support *project.json* files.</span></span> <span data-ttu-id="58a36-110">To znamená, že nelze použít k vytvoření, spuštění nebo publikování aplikací na základě project.json a knihovny.</span><span class="sxs-lookup"><span data-stu-id="58a36-110">That means that it cannot be used to build, run or publish project.json based applications and libraries.</span></span> <span data-ttu-id="58a36-111">Chcete-li použít tuto verzi nástroje, musíte migrovat existující projekty nebo nové spuštění.</span><span class="sxs-lookup"><span data-stu-id="58a36-111">In order to use this version of the tools, you will need to migrate your existing projects or start new ones.</span></span> 

<span data-ttu-id="58a36-112">Jako součást tento přesun byl nahrazený vlastní sestavovací modulem, který byl vyvinutý k sestavení projektů project.json modul vyspělá a plně podporuje sestavení s názvem [MSBuild](https://github.com/Microsoft/msbuild).</span><span class="sxs-lookup"><span data-stu-id="58a36-112">As part of this move, the custom build engine that was developed to build project.json projects was replaced with a mature and fully capable build engine called [MSBuild](https://github.com/Microsoft/msbuild).</span></span> <span data-ttu-id="58a36-113">MSBuild je dobře známé stroje v rozhraní .NET komunitě, vzhledem k tomu, že byla klíčová technologie od prvního vydání platformu.</span><span class="sxs-lookup"><span data-stu-id="58a36-113">MSBuild is a well-known engine in the .NET community, since it has been a key technology since the platform's first release.</span></span> <span data-ttu-id="58a36-114">Samozřejmě protože je nutné k vytváření aplikací .NET Core, MSBuild má byly přesně na .NET Core a můžete použít na jakékoli platformě, která .NET Core běží na.</span><span class="sxs-lookup"><span data-stu-id="58a36-114">Of course, because it needs to build .NET Core applications, MSBuild has been ported to .NET Core and can be used on any platform that .NET Core runs on.</span></span> <span data-ttu-id="58a36-115">Jedním z hlavních lišící jádra .NET je, že zásobníku vývoj napříč platformami a jsme provedli jistotu, že tento přesun se nezalamuje této promise.</span><span class="sxs-lookup"><span data-stu-id="58a36-115">One of the main promises of .NET Core is that of a cross-platform development stack, and we have made sure that this move does not break that promise.</span></span>

> [!NOTE]
> <span data-ttu-id="58a36-116">Pokud se nový MSBuild a chcete další informace o tom, můžete spustit načtením [koncepty nástroje MSBuild](/visualstudio/msbuild/msbuild-concepts) článku.</span><span class="sxs-lookup"><span data-stu-id="58a36-116">If you are new to MSBuild and would like to learn more about it, you can start by reading the [MSBuild Concepts](/visualstudio/msbuild/msbuild-concepts) article.</span></span> 

## <a name="the-tooling-layers"></a><span data-ttu-id="58a36-117">Vrstvy nástrojů</span><span class="sxs-lookup"><span data-stu-id="58a36-117">The tooling layers</span></span>
<span data-ttu-id="58a36-118">S přechodem od existujícího projektu systému a také při budování modul přepínače je na otázku, která následuje přirozeně, některou z těchto změn Změna celkové "rozvrstvení" celý ekosystém nástrojů .NET Core?</span><span class="sxs-lookup"><span data-stu-id="58a36-118">With the move away from the existing project system as well as with building engine switches, the question that naturally follows is do any of these changes change the overall "layering" of the whole .NET Core tooling ecosystem?</span></span> <span data-ttu-id="58a36-119">Existují nové službě bits a součásti?</span><span class="sxs-lookup"><span data-stu-id="58a36-119">Are there new bits and components?</span></span>

<span data-ttu-id="58a36-120">Začněme s rychlé aktualizačnímu programu na rozvrstvení Preview 2, jak je znázorněno na následujícím obrázku:</span><span class="sxs-lookup"><span data-stu-id="58a36-120">Let's start with a quick refresher on Preview 2 layering as shown in the following picture:</span></span>

![Architektura vysoké úrovně nástrojů Preview 2](media/cli-msbuild-architecture/p2-arch.png)

<span data-ttu-id="58a36-122">Rozvrstvení nástroje je poměrně jednoduché.</span><span class="sxs-lookup"><span data-stu-id="58a36-122">The layering of the tools is quite simple.</span></span> <span data-ttu-id="58a36-123">V dolní části máme jako základ nástroje příkazového řádku .NET Core.</span><span class="sxs-lookup"><span data-stu-id="58a36-123">At the bottom we have the .NET Core Command Line tools as a foundation.</span></span> <span data-ttu-id="58a36-124">Všechny nástroje, které vyšší úrovně, jako je Visual Studio nebo Visual Studio Code závisí a spoléhá na rozhraní příkazového řádku k vytvoření projektů, obnovte závislosti a tak dále.</span><span class="sxs-lookup"><span data-stu-id="58a36-124">All other, higher-level tools such as Visual Studio or Visual Studio Code, depend and rely on the CLI to build projects, restore dependencies and so on.</span></span> <span data-ttu-id="58a36-125">Vynutila si, že například pokud Visual Studio se chtěli provést operaci obnovení, bylo by zavolat do `dotnet restore` ([viz Poznámka](#dotnet-restore-note)) v rozhraní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="58a36-125">This meant that, for example, if Visual Studio wanted to perform a restore operation, it would call into `dotnet restore` ([see note](#dotnet-restore-note)) command in the CLI.</span></span> 

<span data-ttu-id="58a36-126">S přechodem na nový systém projektu se změní na předchozím diagramu:</span><span class="sxs-lookup"><span data-stu-id="58a36-126">With the move to the new project system, the previous diagram changes:</span></span> 

![Architektura vysoké úrovně .NET core SDK 1.0.0](media/cli-msbuild-architecture/p3-arch.png)

<span data-ttu-id="58a36-128">Hlavní rozdíl je, že rozhraní příkazového řádku není základní vrstvě už; Tato role je nyní vyplněn "sdílené SDK součástí".</span><span class="sxs-lookup"><span data-stu-id="58a36-128">The main difference is that the CLI is not the foundational layer anymore; this role is now filled by the "shared SDK component".</span></span> <span data-ttu-id="58a36-129">Tato sdílená součást SDK je sada cílů a související úlohy, které zodpovídají za kompilace kódu, publikování, balení balíčky NuGet atd. Sada SDK, samotné je open source a je k dispozici na webu GitHub na [SDK úložišti](https://github.com/dotnet/sdk).</span><span class="sxs-lookup"><span data-stu-id="58a36-129">This shared SDK component is a set of targets and associated tasks that are responsible for compiling your code, publishing it, packing NuGet packages etc. The SDK itself is open-source and is available on GitHub on the [SDK repo](https://github.com/dotnet/sdk).</span></span> 

> [!NOTE]
> <span data-ttu-id="58a36-130">"Cíl" je MSBuild termín, který určuje pojmenované operace, který lze vyvolat MSBuild.</span><span class="sxs-lookup"><span data-stu-id="58a36-130">A "target" is a MSBuild term that indicates a named operation that MSBuild can invoke.</span></span> <span data-ttu-id="58a36-131">Toto pravidlo je kombinaci obvykle s jedné nebo více úloh, které provést některé logiky, která by měla provést cíl.</span><span class="sxs-lookup"><span data-stu-id="58a36-131">It is usually coupled with one or more tasks that execute some logic that the target is supposed to do.</span></span> <span data-ttu-id="58a36-132">MSBuild podporuje mnoho předdefinovaných cílů například `Copy` nebo `Execute`; také umožňuje uživatelům napsat vlastní úlohy pomocí spravovaného kódu a definovat cíle k provedení těchto úloh.</span><span class="sxs-lookup"><span data-stu-id="58a36-132">MSBuild supports many ready-made targets such as `Copy` or `Execute`; it also allows users to write their own tasks using managed code and define targets to execute those tasks.</span></span> <span data-ttu-id="58a36-133">Další informace najdete v tématu [úlohy nástroje MSBuild](/visualstudio/msbuild/msbuild-tasks).</span><span class="sxs-lookup"><span data-stu-id="58a36-133">For more information, see [MSBuild tasks](/visualstudio/msbuild/msbuild-tasks).</span></span> 

<span data-ttu-id="58a36-134">Všechny modulové nyní využívat sdílená součást sady SDK a jeho cíle, rozhraní příkazového řádku zahrnutý.</span><span class="sxs-lookup"><span data-stu-id="58a36-134">All the toolsets now consume the shared SDK component and its targets, CLI included.</span></span> <span data-ttu-id="58a36-135">Například nebude další verze sady Visual Studio volání do `dotnet restore` ([viz Poznámka](#dotnet-restore-note)) příkaz, který má obnovit závislosti pro projekty .NET Core, cíl "Obnovení" se bude používat přímo.</span><span class="sxs-lookup"><span data-stu-id="58a36-135">For example, the next version of Visual Studio will not call into `dotnet restore` ([see note](#dotnet-restore-note)) command to restore dependencies for .NET Core projects, it will use the "Restore" target directly.</span></span> <span data-ttu-id="58a36-136">Vzhledem k tomu, že jsou tyto cíle MSBuild, můžete také použít nezpracovaná MSBuild provést je pomocí [dotnet msbuild](dotnet-msbuild.md) příkaz.</span><span class="sxs-lookup"><span data-stu-id="58a36-136">Since these are MSBuild targets, you can also use raw MSBuild to execute them using the [dotnet msbuild](dotnet-msbuild.md) command.</span></span> 

### <a name="cli-commands"></a><span data-ttu-id="58a36-137">Rozhraní příkazového řádku</span><span class="sxs-lookup"><span data-stu-id="58a36-137">CLI commands</span></span>
<span data-ttu-id="58a36-138">Sdílená součást SDK znamená, že většina existující rozhraní příkazového řádku byla znovu implementovaná jako úlohy nástroje MSBuild a cíle.</span><span class="sxs-lookup"><span data-stu-id="58a36-138">The shared SDK component means that the majority of existing CLI commands have been re-implemented as MSBuild tasks and targets.</span></span> <span data-ttu-id="58a36-139">Co to znamená rozhraní příkazového řádku a vaše používání sady nástrojů?</span><span class="sxs-lookup"><span data-stu-id="58a36-139">What does this mean for the CLI commands and your usage of the toolset?</span></span> 

<span data-ttu-id="58a36-140">Z hlediska využití nemění způsobu, jakým používáte rozhraní příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="58a36-140">From an usage perspective, it doesn't change the way you use the CLI.</span></span> <span data-ttu-id="58a36-141">Rozhraní příkazového řádku má stále základní příkazy, které existují v verzi Preview 2:</span><span class="sxs-lookup"><span data-stu-id="58a36-141">The CLI still has the core commands that exist in Preview 2 release:</span></span>

* `new`
* `restore`
* `run` 
* `build`
* `publish`
* `test`
* `pack` 

<span data-ttu-id="58a36-142">Tyto příkazy stále udělat, co můžete očekávat, aby (nové vytvořte projekt sestavení ji publikovat, sady pack a tak dále).</span><span class="sxs-lookup"><span data-stu-id="58a36-142">These commands still do what you expect them to do (new up a project, build it, publish it, pack it and so on).</span></span> <span data-ttu-id="58a36-143">Většina možností se nezmění a stále existují a poraďte se se příkazy, buď obrazovky nápovědy (pomocí `dotnet <command> --help`) nebo v dokumentaci na tomto webu, abyste se seznámili s případnými změnami.</span><span class="sxs-lookup"><span data-stu-id="58a36-143">Majority of the options are not changed, and are still there, and you can consult either the commands' help screens (using `dotnet <command> --help`) or documentation on this site to get familiar with any changes.</span></span> 

<span data-ttu-id="58a36-144">Z hlediska provádění rozhraní příkazového řádku vezme jejich parametrů a vytvořit volání "nezpracovaných" MSBuild, který bude nastavit potřebné vlastnosti a spustit na požadovaný cíl.</span><span class="sxs-lookup"><span data-stu-id="58a36-144">From an execution perspective, the CLI commands will take their parameters and construct a call to "raw" MSBuild that will set the needed properties and run the desired target.</span></span> <span data-ttu-id="58a36-145">Pro lepší znázornění, vezměte v úvahu následující příkaz:</span><span class="sxs-lookup"><span data-stu-id="58a36-145">To better illustrate this, consider the following command:</span></span> 

   `dotnet publish -o pub -c Release`
    
<span data-ttu-id="58a36-146">Tento příkaz je publikování aplikace do aplikace `pub` složku pomocí konfigurace "Verze".</span><span class="sxs-lookup"><span data-stu-id="58a36-146">This command is publishing an application into a `pub` folder using the "Release" configuration.</span></span> <span data-ttu-id="58a36-147">Tento příkaz načte interně přeložit na následující MSBuild volání:</span><span class="sxs-lookup"><span data-stu-id="58a36-147">Internally, this command gets translated into the following MSBuild invocation:</span></span> 

   `dotnet msbuild /t:Publish /p:OutputPath=pub /p:Configuration=Release`

<span data-ttu-id="58a36-148">Významné výjimkou tohoto pravidla jsou `new` a `run` příkazy, protože nejsou implementované jako cíle MSBuild.</span><span class="sxs-lookup"><span data-stu-id="58a36-148">The notable exception to this rule are `new` and `run` commands, as they have not been implemented as MSBuild targets.</span></span>

<a name="dotnet-restore-note"></a> <span data-ttu-id="58a36-149">[!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]</span><span class="sxs-lookup"><span data-stu-id="58a36-149">[!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]</span></span>