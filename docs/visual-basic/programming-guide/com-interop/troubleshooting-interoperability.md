---
title: Řešení potíží s interoperabilitou (Visual Basic)
ms.custom: ''
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: ''
ms.suite: ''
ms.technology:
- devlang-visual-basic
ms.topic: article
helpviewer_keywords:
- interop, deploying assemblies
- assemblies [Visual Basic]
- interop, installing assemblies that share components
- COM objects, troubleshooting
- interop, sharing components
- troubleshooting interoperability [Visual Basic]
- interoperability, troubleshooting
- COM interop [Visual Basic], troubleshooting
- assemblies [Visual Basic], deploying
- troubleshooting Visual Basic, interoperability
- interop assemblies
- interoperability, sharing components
- shared components, using with assemblies
ms.assetid: b324cc1e-b03c-4f39-aea6-6a6d5bfd0e37
caps.latest.revision: 21
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: f3ff175a0f8d152febf2d50c294d401b12285fc7
ms.sourcegitcommit: 86adcc06e35390f13c1e372c36d2e044f1fc31ef
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 04/26/2018
---
# <a name="troubleshooting-interoperability-visual-basic"></a><span data-ttu-id="25fc2-102">Řešení potíží s interoperabilitou (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="25fc2-102">Troubleshooting Interoperability (Visual Basic)</span></span>
<span data-ttu-id="25fc2-103">Když jste vzájemnou spolupráci mezi COM a spravovaného kódu [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], můžete narazit na jeden nebo více z následujících běžných problémů.</span><span class="sxs-lookup"><span data-stu-id="25fc2-103">When you interoperate between COM and the managed code of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)], you may encounter one or more of the following common issues.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor1"></a> <span data-ttu-id="25fc2-104">Zařazování spolupráce</span><span class="sxs-lookup"><span data-stu-id="25fc2-104">Interop Marshaling</span></span>  
 <span data-ttu-id="25fc2-105">V některých případech možná budete muset použít datové typy, které nejsou součástí [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="25fc2-105">At times, you may have to use data types that are not part of the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="25fc2-106">Sestavení spolupráce zpracovávat většinu práce pro objekty modelu COM, ale možná budete muset řídit typy dat, které se používají při spravované objekty jsou viditelné na modelu COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-106">Interop assemblies handle most of the work for COM objects, but you may have to control the data types that are used when managed objects are exposed to COM.</span></span> <span data-ttu-id="25fc2-107">Například musíte zadat struktury v knihovny tříd `BStr` nespravované typ řetězce posílá COM – objekty vytvořené Visual Basic 6.0 a starší verze.</span><span class="sxs-lookup"><span data-stu-id="25fc2-107">For example, structures in class libraries must specify the `BStr` unmanaged type on strings sent to COM objects created by Visual Basic 6.0 and earlier versions.</span></span> <span data-ttu-id="25fc2-108">V takových případech můžete použít <xref:System.Runtime.InteropServices.MarshalAsAttribute> atributu způsobí spravovaných typů, jako nespravované typy.</span><span class="sxs-lookup"><span data-stu-id="25fc2-108">In such cases, you can use the <xref:System.Runtime.InteropServices.MarshalAsAttribute> attribute to cause managed types to be exposed as unmanaged types.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor2"></a> <span data-ttu-id="25fc2-109">Export řetězce pevné délky na nespravovaný kód</span><span class="sxs-lookup"><span data-stu-id="25fc2-109">Exporting Fixed-Length Strings to Unmanaged Code</span></span>  
 <span data-ttu-id="25fc2-110">V jazyce Visual Basic 6.0 a starší verze řetězce exportují se objekty modelu COM jako pořadí bajtů bez null ukončení znaků.</span><span class="sxs-lookup"><span data-stu-id="25fc2-110">In Visual Basic 6.0 and earlier versions, strings are exported to COM objects as sequences of bytes without a null termination character.</span></span> <span data-ttu-id="25fc2-111">Pro kompatibilitu s jinými jazyky Visual Basic .NET obsahuje znak ukončení při exportu řetězce.</span><span class="sxs-lookup"><span data-stu-id="25fc2-111">For compatibility with other languages, Visual Basic .NET includes a termination character when exporting strings.</span></span> <span data-ttu-id="25fc2-112">Nejlepší způsob, jak vyřešit tuto nekompatibilitu se neexportují řetězce, které chybí ukončovací znak jako pole `Byte` nebo `Char`.</span><span class="sxs-lookup"><span data-stu-id="25fc2-112">The best way to address this incompatibility is to export strings that lack the termination character as arrays of `Byte` or `Char`.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor3"></a> <span data-ttu-id="25fc2-113">Export hierarchie dědičnosti</span><span class="sxs-lookup"><span data-stu-id="25fc2-113">Exporting Inheritance Hierarchies</span></span>  
 <span data-ttu-id="25fc2-114">Spravované třídy, které hierarchií do jedné se při zveřejněné jako objekty modelu COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-114">Managed class hierarchies flatten out when exposed as COM objects.</span></span> <span data-ttu-id="25fc2-115">Například pokud definice základní třídy, se členem a pak dědění základní třídy odvozené třídy, který je zveřejněný jako objekt COM, klienti, kteří používají odvozené třídy v objektu COM nebudou moci používat zděděné členy.</span><span class="sxs-lookup"><span data-stu-id="25fc2-115">For example, if you define a base class with a member, and then inherit the base class in a derived class that is exposed as a COM object, clients that use the derived class in the COM object will not be able to use the inherited members.</span></span> <span data-ttu-id="25fc2-116">Členy základní třídy lze přistupovat z COM – objekty pouze jako instance základní třídy a potom pouze v případě, že základní třídy je taky vytvořit jako objekt COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-116">Base class members can be accessed from COM objects only as instances of a base class, and then only if the base class is also created as a COM object.</span></span>  
  
## <a name="overloaded-methods"></a><span data-ttu-id="25fc2-117">Přetížené metody</span><span class="sxs-lookup"><span data-stu-id="25fc2-117">Overloaded Methods</span></span>  
 <span data-ttu-id="25fc2-118">I když přetížené metody můžete vytvořit pomocí jazyka Visual Basic, nejsou podporovány COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-118">Although you can create overloaded methods with Visual Basic, they are not supported by COM.</span></span> <span data-ttu-id="25fc2-119">Pokud třídu, která obsahuje přetížené metody, které je vystavený jako objekt COM, nové názvy metoda jsou generovány pro přetížené metody.</span><span class="sxs-lookup"><span data-stu-id="25fc2-119">When a class that contains overloaded methods is exposed as a COM object, new method names are generated for the overloaded methods.</span></span>  
  
 <span data-ttu-id="25fc2-120">Představte si třeba třídy, která má dvě přetížení `Synch` metoda.</span><span class="sxs-lookup"><span data-stu-id="25fc2-120">For example, consider a class that has two overloads of the `Synch` method.</span></span> <span data-ttu-id="25fc2-121">Pokud třída je vystavený jako objekt COM, může být nové názvy generované metoda `Synch` a `Synch_2`.</span><span class="sxs-lookup"><span data-stu-id="25fc2-121">When the class is exposed as a COM object, the new generated method names could be `Synch` and `Synch_2`.</span></span>  
  
 <span data-ttu-id="25fc2-122">Přejmenováním může způsobit problémy dva pro spotřebitele objektu COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-122">The renaming can cause two problems for consumers of the COM object.</span></span>  
  
1.  <span data-ttu-id="25fc2-123">Klienti nemusí očekávají, že názvy generované metoda.</span><span class="sxs-lookup"><span data-stu-id="25fc2-123">Clients might not expect the generated method names.</span></span>  
  
2.  <span data-ttu-id="25fc2-124">Názvy generované metod ve třídě jako objekty modelu COM lze změnit, pokud nové přetížení se přidají do třídy nebo její základní třída.</span><span class="sxs-lookup"><span data-stu-id="25fc2-124">The generated method names in the class exposed as a COM object can change when new overloads are added to the class or its base class.</span></span> <span data-ttu-id="25fc2-125">To může způsobit problémy se správou verzí.</span><span class="sxs-lookup"><span data-stu-id="25fc2-125">This can cause versioning problems.</span></span>  
  
 <span data-ttu-id="25fc2-126">Obě problémy vyřešíte poskytněte každá metoda jedinečný název, místo použití přetížení, když vyvíjíte objekty, které jsou k dispozici jako objekty modelu COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-126">To solve both problems, give each method a unique name, instead of using overloading, when you develop objects that will be exposed as COM objects.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor4"></a> <span data-ttu-id="25fc2-127">Použití objektů COM spolupráce – sestavení</span><span class="sxs-lookup"><span data-stu-id="25fc2-127">Use of COM Objects Through Interop Assemblies</span></span>  
 <span data-ttu-id="25fc2-128">Téměř jako by šlo náhrady spravovaného kódu pro objekty modelu COM, které reprezentují použijete spolupráce – sestavení.</span><span class="sxs-lookup"><span data-stu-id="25fc2-128">You use interop assemblies almost as if they are managed code replacements for the COM objects they represent.</span></span> <span data-ttu-id="25fc2-129">Protože jsou obálky a ne skutečné objekty modelu COM, existují však určité rozdíly mezi použitím sestavení vzájemné spolupráce a standardní sestavení.</span><span class="sxs-lookup"><span data-stu-id="25fc2-129">However, because they are wrappers and not actual COM objects, there are some differences between using interop assemblies and standard assemblies.</span></span> <span data-ttu-id="25fc2-130">Rozdíl v těchto oblastech zahrnují ohrožení tříd a typů dat pro parametry a návratové hodnoty.</span><span class="sxs-lookup"><span data-stu-id="25fc2-130">These areas of difference include the exposure of classes, and data types for parameters and return values.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor5"></a> <span data-ttu-id="25fc2-131">Třídy, které jsou zveřejněné jako obě rozhraní a třídy</span><span class="sxs-lookup"><span data-stu-id="25fc2-131">Classes Exposed as Both Interfaces and Classes</span></span>  
 <span data-ttu-id="25fc2-132">Na rozdíl od třídy v standardní sestavení COM třídy jsou přístupné spolupráce – sestavení jako třída, která představuje třídy COM i rozhraní.</span><span class="sxs-lookup"><span data-stu-id="25fc2-132">Unlike classes in standard assemblies, COM classes are exposed in interop assemblies as both an interface and a class that represents the COM class.</span></span> <span data-ttu-id="25fc2-133">Název rozhraní je stejná jako třídy COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-133">The interface's name is identical to that of the COM class.</span></span> <span data-ttu-id="25fc2-134">Název třídy spolupráce je stejný jako u původního třídy COM, ale slovem "Třída" připojí.</span><span class="sxs-lookup"><span data-stu-id="25fc2-134">The name of the interop class is the same as that of the original COM class, but with the word "Class" appended.</span></span> <span data-ttu-id="25fc2-135">Předpokládejme například, že máte projekt se odkaz na sestavení vzájemné spolupráce pro objekt COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-135">For example, suppose you have a project with a reference to an interop assembly for a COM object.</span></span> <span data-ttu-id="25fc2-136">Pokud je název třídy COM `MyComClass`, IntelliSense a prohlížeč objektů zobrazit rozhraní s názvem `MyComClass` a třídy s názvem `MyComClassClass`.</span><span class="sxs-lookup"><span data-stu-id="25fc2-136">If the COM class is named `MyComClass`, IntelliSense and the Object Browser show an interface named `MyComClass` and a class named `MyComClassClass`.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor6"></a> <span data-ttu-id="25fc2-137">Vytváření instancí třídy rozhraní .NET Framework</span><span class="sxs-lookup"><span data-stu-id="25fc2-137">Creating Instances of a .NET Framework Class</span></span>  
 <span data-ttu-id="25fc2-138">Obecně platí, vytvořte instanci [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] pomocí `New` příkaz s název třídy.</span><span class="sxs-lookup"><span data-stu-id="25fc2-138">Generally, you create an instance of a [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] class using the `New` statement with a class name.</span></span> <span data-ttu-id="25fc2-139">Třída COM reprezentované spolupráce sestavení je jeden případ, kdy můžete použít `New` příkaz s rozhraní.</span><span class="sxs-lookup"><span data-stu-id="25fc2-139">Having a COM class represented by an interop assembly is the one case in which you can use the `New` statement with an interface.</span></span> <span data-ttu-id="25fc2-140">Pokud používáte třídy COM s `Inherits` prohlášení, můžete použít rozhraní, stejně jako třídu.</span><span class="sxs-lookup"><span data-stu-id="25fc2-140">Unless you are using the COM class with an `Inherits` statement, you can use the interface just as you would a class.</span></span> <span data-ttu-id="25fc2-141">Následující kód ukazuje, jak vytvořit `Command` objekt v projektu, který obsahuje odkaz na objekt Microsoft ActiveX Data objekty 2.8 knihovny COM:</span><span class="sxs-lookup"><span data-stu-id="25fc2-141">The following code demonstrates how to create a `Command` object in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object:</span></span>  
  
 [!code-vb[VbVbalrInterop#20](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_1.vb)]  
  
 <span data-ttu-id="25fc2-142">Pokud používáte jako základní třídy COM odvozené třídy, ale musíte použít spolupráce třídu, která představuje třídy COM, jako v následujícím kódu:</span><span class="sxs-lookup"><span data-stu-id="25fc2-142">However, if you are using the COM class as the base for a derived class, you must use the interop class that represents the COM class, as in the following code:</span></span>  
  
 [!code-vb[VbVbalrInterop#21](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_2.vb)]  
  
> [!NOTE]
>  <span data-ttu-id="25fc2-143">Sestavení spolupráce implicitně implementovat rozhraní, které představují třídy COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-143">Interop assemblies implicitly implement interfaces that represent COM classes.</span></span> <span data-ttu-id="25fc2-144">By se neměl pokoušet použít `Implements` způsobí příkaz k implementaci těchto rozhraní nebo došlo k chybě.</span><span class="sxs-lookup"><span data-stu-id="25fc2-144">You should not try to use the `Implements` statement to implement these interfaces or an error will result.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor7"></a> <span data-ttu-id="25fc2-145">Datové typy pro parametry a návratové hodnoty</span><span class="sxs-lookup"><span data-stu-id="25fc2-145">Data Types for Parameters and Return Values</span></span>  
 <span data-ttu-id="25fc2-146">Na rozdíl od členů standardní sestavení může mít členy sestavení vzájemné spolupráce datové typy, které se liší od těch, které používá v původní deklarace objektu.</span><span class="sxs-lookup"><span data-stu-id="25fc2-146">Unlike members of standard assemblies, interop assembly members may have data types that differ from those used in the  original object declaration.</span></span> <span data-ttu-id="25fc2-147">I když sestavení vzájemné spolupráce implicitně převést na kompatibilní běžné typy runtime jazyka typy modelu COM, měli byste věnovat pozornost do datových typů, které jsou používány na obou stranách aby se zabránilo chybám za běhu.</span><span class="sxs-lookup"><span data-stu-id="25fc2-147">Although interop assemblies implicitly convert COM types to compatible common language runtime types, you should pay attention to the data types that are used by both sides to prevent runtime errors.</span></span> <span data-ttu-id="25fc2-148">Například v modelu COM objekty vytvořené v jazyce Visual Basic 6.0 a starší verze, hodnoty typu `Integer` předpokládá [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] ekvivalentní typu `Short`.</span><span class="sxs-lookup"><span data-stu-id="25fc2-148">For example, in COM objects created in Visual Basic 6.0 and earlier versions, values of type `Integer` assume the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] equivalent type, `Short`.</span></span> <span data-ttu-id="25fc2-149">Doporučuje se použít Prohlížeč objektů pro zjištění vlastností importované členů dříve, než je použijete.</span><span class="sxs-lookup"><span data-stu-id="25fc2-149">It is recommended that you use the Object Browser to examine the characteristics of imported members before you use them.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor8"></a> <span data-ttu-id="25fc2-150">Modul metody na úrovni modelu COM</span><span class="sxs-lookup"><span data-stu-id="25fc2-150">Module level COM methods</span></span>  
 <span data-ttu-id="25fc2-151">Většinu objektů COM používají vytvoření instance třídy modelu COM pomocí `New` – klíčové slovo a pak volání metody objektu.</span><span class="sxs-lookup"><span data-stu-id="25fc2-151">Most COM objects are used by creating an instance of a COM class using the `New` keyword and then calling methods of the object.</span></span> <span data-ttu-id="25fc2-152">Jedinou výjimkou tohoto pravidla zahrnuje objekty modelu COM, které obsahují `AppObj` nebo `GlobalMultiUse` třídy COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-152">One exception to this rule involves COM objects that contain `AppObj` or `GlobalMultiUse` COM classes.</span></span> <span data-ttu-id="25fc2-153">Těchto tříd podobat modulu úrovně metody v jazyce Visual Basic .NET třídy.</span><span class="sxs-lookup"><span data-stu-id="25fc2-153">Such classes resemble module level methods in Visual Basic .NET classes.</span></span> <span data-ttu-id="25fc2-154">Visual Basic 6.0 a starší verze implicitně instancí těchto objektů za vás vytvořit při prvním volání jednoho z své metody.</span><span class="sxs-lookup"><span data-stu-id="25fc2-154">Visual Basic 6.0 and earlier versions implicitly create instances of such objects for you the first time that you call one of their methods.</span></span> <span data-ttu-id="25fc2-155">Ve Visual Basic 6.0 můžete například přidat odkaz na knihovnu Microsoft DAO 3.6 objektu a volání `DBEngine` metoda bez vytvoření první instance:</span><span class="sxs-lookup"><span data-stu-id="25fc2-155">For example, in Visual Basic 6.0 you can add a reference to the Microsoft DAO 3.6 Object Library and call the `DBEngine` method without first creating an instance:</span></span>  
  
```vb  
Dim db As DAO.Database  
' Open the database.  
Set db = DBEngine.OpenDatabase("C:\nwind.mdb")  
' Use the database object.  
```  
  
 <span data-ttu-id="25fc2-156">Visual Basic .NET vyžaduje, abyste mohli používat své metody vždy vytváření instancí objektů COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-156">Visual Basic .NET requires that you always create instances of COM objects before you can use their methods.</span></span> <span data-ttu-id="25fc2-157">Chcete-li používat tyto metody v jazyce Visual Basic, deklarovat proměnnou požadovanou třídu a použijte new – klíčové slovo přiřazení objektu k proměnné objektu.</span><span class="sxs-lookup"><span data-stu-id="25fc2-157">To use these methods in Visual Basic, declare a variable of the desired class and use the new keyword to assign the object to the object variable.</span></span> <span data-ttu-id="25fc2-158">`Shared` – Klíčové slovo lze použít, pokud chcete zajistit, že pouze jedna instance třídy se vytvoří.</span><span class="sxs-lookup"><span data-stu-id="25fc2-158">The `Shared` keyword can be used when you want to make sure that only one instance of the class is created.</span></span>  
  
 [!code-vb[VbVbalrInterop#23](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_3.vb)]  
  
##  <a name="vbconinteroperabilitymarshalinganchor9"></a> <span data-ttu-id="25fc2-159">Neošetřené chyby v obslužné rutiny událostí</span><span class="sxs-lookup"><span data-stu-id="25fc2-159">Unhandled Errors in Event Handlers</span></span>  
 <span data-ttu-id="25fc2-160">Jedním z běžných problémů spolupráce zahrnuje chyby v obslužné rutiny, které zpracovávají události vyvolané COM – objekty.</span><span class="sxs-lookup"><span data-stu-id="25fc2-160">One common interop problem involves errors in event handlers that handle events raised by COM objects.</span></span> <span data-ttu-id="25fc2-161">Takové chyby se ignoruje, pokud je konkrétně zkontrolovat chyby pomocí `On Error` nebo `Try...Catch...Finally` příkazy.</span><span class="sxs-lookup"><span data-stu-id="25fc2-161">Such errors are ignored unless you specifically check for errors using `On Error` or `Try...Catch...Finally` statements.</span></span> <span data-ttu-id="25fc2-162">Například v následujícím příkladu je z projektu Visual Basic .NET, který obsahuje odkaz na objekt Microsoft ActiveX Data objekty 2.8 knihovny COM.</span><span class="sxs-lookup"><span data-stu-id="25fc2-162">For example, the following example is from a Visual Basic .NET project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object.</span></span>  
  
 [!code-vb[VbVbalrInterop#24](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_4.vb)]  
  
 <span data-ttu-id="25fc2-163">Tento příklad vyvolá chybu podle očekávání.</span><span class="sxs-lookup"><span data-stu-id="25fc2-163">This example raises an error as expected.</span></span> <span data-ttu-id="25fc2-164">Ale pokud se pokusíte příkladě bez `Try...Catch...Finally` bloku k chybě se ignoruje, protože pokud jste použili `OnError Resume Next` příkaz.</span><span class="sxs-lookup"><span data-stu-id="25fc2-164">However, if you try the same example without the `Try...Catch...Finally` block, the error is ignored as if you used the `OnError Resume Next` statement.</span></span> <span data-ttu-id="25fc2-165">Bez zpracování chyb bez upozornění selže dělení nulou.</span><span class="sxs-lookup"><span data-stu-id="25fc2-165">Without error handling, the division by zero silently fails.</span></span> <span data-ttu-id="25fc2-166">Protože takové chyby nikdy vyvolání chyby neošetřených výjimek, je důležité, abyste používali určitou formu zpracování výjimek v obslužné rutiny událostí, které zpracovávají události z COM – objekty.</span><span class="sxs-lookup"><span data-stu-id="25fc2-166">Because such errors never raise unhandled exception errors, it is important that you use some form of exception handling in event handlers that handle events from COM objects.</span></span>  
  
### <a name="understanding-com-interop-errors"></a><span data-ttu-id="25fc2-167">Principy chyb zprostředkovatele komunikace s objekty COM</span><span class="sxs-lookup"><span data-stu-id="25fc2-167">Understanding COM interop errors</span></span>  
 <span data-ttu-id="25fc2-168">Spolupráce volání generovat bez zpracování chyb, často chyby, které obsahují malé informace.</span><span class="sxs-lookup"><span data-stu-id="25fc2-168">Without error handling, interop calls often generate errors that provide little information.</span></span> <span data-ttu-id="25fc2-169">Pokud je to možné, použijte strukturované zpracování poskytnout další informace o problémech při jejich výskytu chyb.</span><span class="sxs-lookup"><span data-stu-id="25fc2-169">Whenever possible, use structured error handling to provide more information about problems when they occur.</span></span> <span data-ttu-id="25fc2-170">To může být obzvláště užitečné při ladění aplikace.</span><span class="sxs-lookup"><span data-stu-id="25fc2-170">This can be especially helpful when you debug applications.</span></span> <span data-ttu-id="25fc2-171">Příklad:</span><span class="sxs-lookup"><span data-stu-id="25fc2-171">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#25](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_5.vb)]  
  
 <span data-ttu-id="25fc2-172">Informace, jako je popis chyby, HRESULT a zdroj COM chyby můžete najít tak, že prověří obsah objekt výjimky.</span><span class="sxs-lookup"><span data-stu-id="25fc2-172">You can find information such as the error description, HRESULT, and the source of COM errors by examining the contents of the exception object.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor10"></a> <span data-ttu-id="25fc2-173">Ovládací prvek ActiveX problémy</span><span class="sxs-lookup"><span data-stu-id="25fc2-173">ActiveX Control Issues</span></span>  
 <span data-ttu-id="25fc2-174">Většina ovládacích prvků ActiveX, které pracují s Visual Basic 6.0 Visual Basic .NET pracovat bez řešení problémů.</span><span class="sxs-lookup"><span data-stu-id="25fc2-174">Most ActiveX controls that work with Visual Basic 6.0 work with Visual Basic .NET without trouble.</span></span> <span data-ttu-id="25fc2-175">Hlavní výjimky jsou ovládací prvky kontejneru nebo ovládací prvky, které vizuálně obsahují další ovládací prvky.</span><span class="sxs-lookup"><span data-stu-id="25fc2-175">The main exceptions are container controls, or controls that visually contain other controls.</span></span> <span data-ttu-id="25fc2-176">Některé příklady starší ovládacích prvků, které nebudou správně fungovat s [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)] jsou následující:</span><span class="sxs-lookup"><span data-stu-id="25fc2-176">Some examples of older controls that do not work correctly with [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)] are as follows:</span></span>  
  
-   <span data-ttu-id="25fc2-177">Ovládací prvek Microsoft Forms 2.0 rámce</span><span class="sxs-lookup"><span data-stu-id="25fc2-177">Microsoft Forms 2.0 Frame control</span></span>  
  
-   <span data-ttu-id="25fc2-178">Číselník – ovládací prvek, také známé jako ovládací prvek typu číselník</span><span class="sxs-lookup"><span data-stu-id="25fc2-178">Up-Down control, also known as the spin control</span></span>  
  
-   <span data-ttu-id="25fc2-179">Ovládací prvek karty Sheridan</span><span class="sxs-lookup"><span data-stu-id="25fc2-179">Sheridan Tab Control</span></span>  
  
 <span data-ttu-id="25fc2-180">Existují jenom několik řešení pro nepodporovaný problémy ovládací prvek ActiveX.</span><span class="sxs-lookup"><span data-stu-id="25fc2-180">There are only a few workarounds for unsupported ActiveX control problems.</span></span> <span data-ttu-id="25fc2-181">Můžete migrovat existujících ovládacích prvků [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)] Pokud původní zdrojový kód.</span><span class="sxs-lookup"><span data-stu-id="25fc2-181">You can migrate existing controls to [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)] if you own the original source code.</span></span> <span data-ttu-id="25fc2-182">Jinak můžete zkontrolovat s dodavateli softwaru pro aktualizovat. NET kompatibilní s verzí ovládacích prvků k nahrazení nepodporované ovládací prvky ActiveX.</span><span class="sxs-lookup"><span data-stu-id="25fc2-182">Otherwise, you can check with software vendors for updated .NET-compatible versions of controls to replace unsupported ActiveX controls.</span></span>  
  
##  <a name="vbconinteroperabilitymarshalinganchor11"></a> <span data-ttu-id="25fc2-183">Vlastnosti jen pro čtení předávání ByRef ovládací prvky</span><span class="sxs-lookup"><span data-stu-id="25fc2-183">Passing ReadOnly Properties of Controls ByRef</span></span>  
 <span data-ttu-id="25fc2-184">Visual Basic .NET někdy vyvolá chyby COM, jako je například "Chyba 0x800A017F CTL_E_SETNOTSUPPORTED", při předání `ReadOnly` vlastnosti některé starší ovládací prvky ActiveX jako `ByRef` parametry pro další postupy.</span><span class="sxs-lookup"><span data-stu-id="25fc2-184">Visual Basic .NET sometimes raises COM errors such as, "Error 0x800A017F CTL_E_SETNOTSUPPORTED", when you pass `ReadOnly` properties of some older ActiveX controls as `ByRef` parameters to other procedures.</span></span> <span data-ttu-id="25fc2-185">Podobně jako u volání procedur jazyka Visual Basic 6.0 není vyvolá chybu, a parametry jsou zpracovány jako v případě, že jste je předaná hodnota.</span><span class="sxs-lookup"><span data-stu-id="25fc2-185">Similar procedure calls from Visual Basic 6.0 do not raise an error, and the parameters are treated as if you passed them by value.</span></span> <span data-ttu-id="25fc2-186">Visual Basic .NET chybová zpráva znamená, že se pokoušíte změnit vlastnost, která nemá vlastnost `Set` postupu.</span><span class="sxs-lookup"><span data-stu-id="25fc2-186">The Visual Basic .NET error message indicates that you are trying to change a property that does not have a property `Set` procedure.</span></span>  
  
 <span data-ttu-id="25fc2-187">Pokud máte přístup k procedura volaná, abyste zabránili této chyby pomocí `ByVal` – klíčové slovo deklarovat parametry, které přijímají `ReadOnly` vlastnosti.</span><span class="sxs-lookup"><span data-stu-id="25fc2-187">If you have access to the procedure being called, you can prevent this error by using the `ByVal` keyword to declare parameters that accept `ReadOnly` properties.</span></span> <span data-ttu-id="25fc2-188">Příklad:</span><span class="sxs-lookup"><span data-stu-id="25fc2-188">For example:</span></span>  
  
 [!code-vb[VbVbalrInterop#26](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_6.vb)]  
  
 <span data-ttu-id="25fc2-189">Pokud nemáte přístup ke zdrojovému kódu pro proceduru volané, můžete vynutit vlastnost, která má být předaná hodnota přidáním další sadu hranaté závorky kolem volání procedury.</span><span class="sxs-lookup"><span data-stu-id="25fc2-189">If you do not have access to the source code for the procedure being called, you can force the property to be passed by value by adding an extra set of brackets around the calling procedure.</span></span> <span data-ttu-id="25fc2-190">Například v projektu, který obsahuje odkaz na objekt Microsoft ActiveX Data objekty 2.8 knihovny COM, můžete použít:</span><span class="sxs-lookup"><span data-stu-id="25fc2-190">For example, in a project that has a reference to the Microsoft ActiveX Data Objects 2.8 Library COM object, you can use:</span></span>  
  
 [!code-vb[VbVbalrInterop#27](../../../visual-basic/programming-guide/com-interop/codesnippet/VisualBasic/troubleshooting-interoperability_7.vb)]  
  
##  <a name="vbconinteroperabilitymarshalinganchor12"></a> <span data-ttu-id="25fc2-191">Nasazení sestavení, které zveřejňují zprostředkovatel komunikace s objekty</span><span class="sxs-lookup"><span data-stu-id="25fc2-191">Deploying Assemblies That Expose Interop</span></span>  
 <span data-ttu-id="25fc2-192">Nasazení sestavení, které zveřejňují rozhraní modelu COM uvede některé jedinečné výzvy.</span><span class="sxs-lookup"><span data-stu-id="25fc2-192">Deploying assemblies that expose COM interfaces presents some unique challenges.</span></span> <span data-ttu-id="25fc2-193">Například na potenciální problém nastane, když do stejného sestavení modelu COM odkazovat na samostatné aplikace.</span><span class="sxs-lookup"><span data-stu-id="25fc2-193">For example, a potential problem occurs when separate applications reference the same COM assembly.</span></span> <span data-ttu-id="25fc2-194">Tato situace je běžné při instalaci nové verze sestavení a stará verze sestavení je stále používá jiná aplikace.</span><span class="sxs-lookup"><span data-stu-id="25fc2-194">This situation is common when a new version of an assembly is installed and another application is still using the old version of the assembly.</span></span> <span data-ttu-id="25fc2-195">Pokud odinstalujete sestavení, které sdílí knihovnu DLL, lze neúmyslně znepřístupnit ho na jiné sestavení.</span><span class="sxs-lookup"><span data-stu-id="25fc2-195">If you uninstall an assembly that shares a DLL, you can unintentionally make it unavailable to the other assemblies.</span></span>  
  
 <span data-ttu-id="25fc2-196">K tomuto problému nedošlo, musíte nainstalovat sdílená sestavení do globální mezipaměti sestavení (GAC) a použít MergeModule pro komponentu.</span><span class="sxs-lookup"><span data-stu-id="25fc2-196">To avoid this problem, you should install shared assemblies to the Global Assembly Cache (GAC) and use a MergeModule for the component.</span></span> <span data-ttu-id="25fc2-197">Pokud v mezipaměti GAC nemůžete instalovat aplikace, je třeba nainstalovat do CommonFilesFolder v podadresáři specifické pro verzi.</span><span class="sxs-lookup"><span data-stu-id="25fc2-197">If you cannot install the application in the GAC, it should be installed to CommonFilesFolder in a version-specific subdirectory.</span></span>  
  
 <span data-ttu-id="25fc2-198">Sestavení, které nejsou sdílené musí nacházet v adresáři s volající aplikace vedle sebe.</span><span class="sxs-lookup"><span data-stu-id="25fc2-198">Assemblies that are not shared should be located side by side in the directory with the calling application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="25fc2-199">Viz také</span><span class="sxs-lookup"><span data-stu-id="25fc2-199">See Also</span></span>  
 <xref:System.Runtime.InteropServices.MarshalAsAttribute>  
 [<span data-ttu-id="25fc2-200">Zprostředkovatel komunikace s objekty COM</span><span class="sxs-lookup"><span data-stu-id="25fc2-200">COM Interop</span></span>](../../../visual-basic/programming-guide/com-interop/index.md)  
 [<span data-ttu-id="25fc2-201">Tlbimp.exe (importér knihovny typů)</span><span class="sxs-lookup"><span data-stu-id="25fc2-201">Tlbimp.exe (Type Library Importer)</span></span>](../../../framework/tools/tlbimp-exe-type-library-importer.md)  
 [<span data-ttu-id="25fc2-202">Tlbexp.exe (exportér knihovny typů)</span><span class="sxs-lookup"><span data-stu-id="25fc2-202">Tlbexp.exe (Type Library Exporter)</span></span>](http://msdn.microsoft.com/library/a487d61b-d166-467b-a7ca-d8b52fbff42d)  
 [<span data-ttu-id="25fc2-203">Návod: Implementace dědičnosti pomocí objektů COM</span><span class="sxs-lookup"><span data-stu-id="25fc2-203">Walkthrough: Implementing Inheritance with COM Objects</span></span>](../../../visual-basic/programming-guide/com-interop/walkthrough-implementing-inheritance-with-com-objects.md)  
 [<span data-ttu-id="25fc2-204">Příkaz Inherits</span><span class="sxs-lookup"><span data-stu-id="25fc2-204">Inherits Statement</span></span>](../../../visual-basic/language-reference/statements/inherits-statement.md)  
 [<span data-ttu-id="25fc2-205">Globální mezipaměť sestavení</span><span class="sxs-lookup"><span data-stu-id="25fc2-205">Global Assembly Cache</span></span>](../../../framework/app-domains/gac.md)
