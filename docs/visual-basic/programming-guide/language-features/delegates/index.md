---
title: Delegáti (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- delegates [Visual Basic]
- Visual Basic code, delegates
ms.assetid: 410b60dc-5e60-4ec0-bfae-426755a2ee28
ms.openlocfilehash: 99fe0eee194fae21615652c9426bf6027fbf4354
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 05/04/2018
ms.locfileid: "33652880"
---
# <a name="delegates-visual-basic"></a><span data-ttu-id="f9a40-102">Delegáti (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="f9a40-102">Delegates (Visual Basic)</span></span>
<span data-ttu-id="f9a40-103">Delegáti jsou objekty, které odkazují na metody.</span><span class="sxs-lookup"><span data-stu-id="f9a40-103">Delegates are objects that refer to methods.</span></span> <span data-ttu-id="f9a40-104">V některých případech jsou popsány jako *ukazatelů na funkce zajišťující bezpečnost typů* vzhledem k tomu, že jsou podobná ukazatelů na funkce používán jinými programovací jazyky.</span><span class="sxs-lookup"><span data-stu-id="f9a40-104">They are sometimes described as *type-safe function pointers* because they are similar to function pointers used in other programming languages.</span></span> <span data-ttu-id="f9a40-105">Ale na rozdíl od ukazatelů na funkce, Visual Basic delegáti typu odkazu na základě třídy <xref:System.Delegate?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="f9a40-105">But unlike function pointers, Visual Basic delegates are a reference type based on the class <xref:System.Delegate?displayProperty=nameWithType>.</span></span> <span data-ttu-id="f9a40-106">Delegáti odkazovat oba sdílené metody – metody, které může být volána bez konkrétní instanci třídy – a instanci metody.</span><span class="sxs-lookup"><span data-stu-id="f9a40-106">Delegates can reference both shared methods — methods that can be called without a specific instance of a class — and instance methods.</span></span>  
  
## <a name="delegates-and-events"></a><span data-ttu-id="f9a40-107">Delegáti a události</span><span class="sxs-lookup"><span data-stu-id="f9a40-107">Delegates and Events</span></span>  
 <span data-ttu-id="f9a40-108">Delegáti jsou užitečné v situacích, kde je nutné zprostředkovatel mezi volání procedury a postup volána.</span><span class="sxs-lookup"><span data-stu-id="f9a40-108">Delegates are useful in situations where you need an intermediary between a calling procedure and the procedure being called.</span></span> <span data-ttu-id="f9a40-109">Například můžete objekt, který vyvolává události, abyste mohli volání obslužné rutiny různých událostí za různých okolností.</span><span class="sxs-lookup"><span data-stu-id="f9a40-109">For example, you might want an object that raises events to be able to call different event handlers under different circumstances.</span></span> <span data-ttu-id="f9a40-110">Bohužel objekt vyvolání události nemůže vědět předem, které obslužná rutina události zpracovává konkrétní události.</span><span class="sxs-lookup"><span data-stu-id="f9a40-110">Unfortunately, the object raising the events cannot know ahead of time which event handler is handling a specific event.</span></span> <span data-ttu-id="f9a40-111">Visual Basic umožňuje obslužné rutiny událostí dynamicky přidružení s událostmi vytvořením delegáta pro vás při použití `AddHandler` příkaz.</span><span class="sxs-lookup"><span data-stu-id="f9a40-111">Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the `AddHandler` statement.</span></span> <span data-ttu-id="f9a40-112">V době běhu předává delegát volání obslužné rutiny příslušné události.</span><span class="sxs-lookup"><span data-stu-id="f9a40-112">At run time, the delegate forwards calls to the appropriate event handler.</span></span>  
  
 <span data-ttu-id="f9a40-113">I když můžete vytvořit vlastní delegáty, ve většině případů jazyka Visual Basic vytvoří delegáta a podrobnosti postará za vás.</span><span class="sxs-lookup"><span data-stu-id="f9a40-113">Although you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you.</span></span> <span data-ttu-id="f9a40-114">Například `Event` příkaz implicitně definuje delegát třídy s názvem `<EventName>EventHandler` jako vnořenou třídu třída obsahující `Event` příkaz a se stejným podpisem jako událost.</span><span class="sxs-lookup"><span data-stu-id="f9a40-114">For example, an `Event` statement implicitly defines a delegate class named `<EventName>EventHandler` as a nested class of the class containing the `Event` statement, and with the same signature as the event.</span></span> <span data-ttu-id="f9a40-115">`AddressOf` Implicitně vytvoří instanci delegáta, který odkazuje na zvláštní postup.</span><span class="sxs-lookup"><span data-stu-id="f9a40-115">The `AddressOf` statement implicitly creates an instance of a delegate that refers to a specific procedure.</span></span> <span data-ttu-id="f9a40-116">Následující dva řádky kódu jsou ekvivalentní.</span><span class="sxs-lookup"><span data-stu-id="f9a40-116">The following two lines of code are equivalent.</span></span> <span data-ttu-id="f9a40-117">V prvním řádku, uvidíte explicitní vytvoření instance `Eventhandler`, s odkazem na metoda `Button1_Click` odeslán jako argumentem.</span><span class="sxs-lookup"><span data-stu-id="f9a40-117">In the first line, you see the explicit creation of an instance of `Eventhandler`, with a reference to method `Button1_Click` sent as the argument.</span></span> <span data-ttu-id="f9a40-118">Druhý řádek je pohodlnější způsob, jak stejnou věc udělat.</span><span class="sxs-lookup"><span data-stu-id="f9a40-118">The second line is a more convenient way to do the same thing.</span></span>  
  
 [!code-vb[VbVbalrDelegates#6](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/delegates_1.vb)]  
  
 <span data-ttu-id="f9a40-119">Můžete použít zkrácený způsob vytváření delegátů kdekoli kompilátor můžete určit typ delegáta podle kontextu.</span><span class="sxs-lookup"><span data-stu-id="f9a40-119">You can use the shorthand way of creating delegates anywhere the compiler can determine the delegate's type by the context.</span></span>  
  
## <a name="declaring-events-that-use-an-existing-delegate-type"></a><span data-ttu-id="f9a40-120">Deklarující události, které použijte existující typ delegáta</span><span class="sxs-lookup"><span data-stu-id="f9a40-120">Declaring Events that Use an Existing Delegate Type</span></span>  
 <span data-ttu-id="f9a40-121">V některých situacích můžete událost chcete použít existující typ delegáta jako jeho základní delegáta deklarovat.</span><span class="sxs-lookup"><span data-stu-id="f9a40-121">In some situations, you may want to declare an event to use an existing delegate type as its underlying delegate.</span></span> <span data-ttu-id="f9a40-122">Následující syntaxe ukazuje, jak:</span><span class="sxs-lookup"><span data-stu-id="f9a40-122">The following syntax demonstrates how:</span></span>  
  
 [!code-vb[VbVbalrDelegates#7](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/delegates_2.vb)]  
  
 <span data-ttu-id="f9a40-123">To je užitečné, pokud chcete směrovat více událostí do stejné obslužné rutiny.</span><span class="sxs-lookup"><span data-stu-id="f9a40-123">This is useful when you want to route multiple events to the same handler.</span></span>  
  
## <a name="delegate-variables-and-parameters"></a><span data-ttu-id="f9a40-124">Parametry a proměnné delegáta</span><span class="sxs-lookup"><span data-stu-id="f9a40-124">Delegate Variables and Parameters</span></span>  
 <span data-ttu-id="f9a40-125">Delegáti můžete použít pro ostatní, událostmi související úlohy, jako je například volných vláken nebo s postupy, které je třeba volat různé verze funkcí v době běhu.</span><span class="sxs-lookup"><span data-stu-id="f9a40-125">You can use delegates for other, non-event related tasks, such as free threading or with procedures that need to call different versions of functions at run time.</span></span>  
  
 <span data-ttu-id="f9a40-126">Předpokládejme například, že máte aplikaci klasifikované ad, která obsahuje seznam s názvy automobilů.</span><span class="sxs-lookup"><span data-stu-id="f9a40-126">For example, suppose you have a classified-ad application that includes a list box with the names of cars.</span></span> <span data-ttu-id="f9a40-127">Reklamy jsou seřazené podle název, který je obvykle značku Auto.</span><span class="sxs-lookup"><span data-stu-id="f9a40-127">The ads are sorted by title, which is normally the make of the car.</span></span> <span data-ttu-id="f9a40-128">Pokud některé aut obsahovat rok car před značku dojde k potížím, které může být vystaven.</span><span class="sxs-lookup"><span data-stu-id="f9a40-128">A problem you may face occurs when some cars include the year of the car before the make.</span></span> <span data-ttu-id="f9a40-129">Problém je, že funkce integrované řazení pole se seznamem seřadí pouze podle kódy znaků; umístí všechny reklamy nejprve spustit s daty, za nímž následuje reklamy počínaje značku.</span><span class="sxs-lookup"><span data-stu-id="f9a40-129">The problem is that the built-in sort functionality of the list box sorts only by character codes; it places all the ads starting with dates first, followed by the ads starting with the make.</span></span>  
  
 <span data-ttu-id="f9a40-130">Problém odstraníte tak, můžete vytvořit proceduru řazení ve třídě, která používá standardní abecedním řazení na seznamy většina, ale je moci v době běhu na vlastní řazení postup car reklamy.</span><span class="sxs-lookup"><span data-stu-id="f9a40-130">To fix this, you can create a sort procedure in a class that uses the standard alphabetic sort on most list boxes, but is able to switch at run time to the custom sort procedure for car ads.</span></span> <span data-ttu-id="f9a40-131">K tomu, předáte vlastní řazení postup k třídě řazení v době běhu použití delegátů.</span><span class="sxs-lookup"><span data-stu-id="f9a40-131">To do this, you pass the custom sort procedure to the sort class at run time, using delegates.</span></span>  
  
## <a name="addressof-and-lambda-expressions"></a><span data-ttu-id="f9a40-132">AddressOf a výrazy Lambda</span><span class="sxs-lookup"><span data-stu-id="f9a40-132">AddressOf and Lambda Expressions</span></span>  
 <span data-ttu-id="f9a40-133">Každá třída delegáta definuje konstruktor, který je předán specifikace metodu objektu.</span><span class="sxs-lookup"><span data-stu-id="f9a40-133">Each delegate class defines a constructor that is passed the specification of an object method.</span></span> <span data-ttu-id="f9a40-134">Argument pro konstruktor delegáta musí být odkaz na metodu nebo výrazu lambda.</span><span class="sxs-lookup"><span data-stu-id="f9a40-134">An argument to a delegate constructor must be a reference to a method, or a lambda expression.</span></span>  
  
 <span data-ttu-id="f9a40-135">Pokud chcete zadat odkaz na metodu, použijte následující syntaxi:</span><span class="sxs-lookup"><span data-stu-id="f9a40-135">To specify a reference to a method, use the following syntax:</span></span>  
  
 <span data-ttu-id="f9a40-136">`AddressOf` [`expression`.]`methodName`</span><span class="sxs-lookup"><span data-stu-id="f9a40-136">`AddressOf` [`expression`.]`methodName`</span></span>  
  
 <span data-ttu-id="f9a40-137">Typ kompilaci `expression` musí být název třídy nebo rozhraní, které obsahuje metodu pro zadaný název, jejichž podpis odpovídá podpis delegát třídy.</span><span class="sxs-lookup"><span data-stu-id="f9a40-137">The compile-time type of the `expression` must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class.</span></span> <span data-ttu-id="f9a40-138">`methodName` Může být buď sdílené metody nebo metodu instance.</span><span class="sxs-lookup"><span data-stu-id="f9a40-138">The `methodName` can be either a shared method or an instance method.</span></span> <span data-ttu-id="f9a40-139">`methodName` Je povinný, i v případě, že vytvoříte delegáta pro metodu výchozí třídy.</span><span class="sxs-lookup"><span data-stu-id="f9a40-139">The `methodName` is not optional, even if you create a delegate for the default method of the class.</span></span>  
  
 <span data-ttu-id="f9a40-140">Pokud chcete zadat výrazu lambda, použijte následující syntaxi:</span><span class="sxs-lookup"><span data-stu-id="f9a40-140">To specify a lambda expression, use the following syntax:</span></span>  
  
 <span data-ttu-id="f9a40-141">`Function` ([`parm` Jako `type`, `parm2` jako `type2`,...]) `expression`</span><span class="sxs-lookup"><span data-stu-id="f9a40-141">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span></span>  
  
 <span data-ttu-id="f9a40-142">Následující příklad ukazuje, jak `AddressOf` a slouží k zadání odkazu pro delegáta výrazy lambda.</span><span class="sxs-lookup"><span data-stu-id="f9a40-142">The following example shows both `AddressOf` and lambda expressions used to specify the reference for a delegate.</span></span>  
  
 [!code-vb[VbVbalrDelegates#15](../../../../visual-basic/language-reference/operators/codesnippet/VisualBasic/delegates_3.vb)]  
  
 <span data-ttu-id="f9a40-143">Podpis funkce musí odpovídat typu delegáta.</span><span class="sxs-lookup"><span data-stu-id="f9a40-143">The signature of the function must match that of the delegate type.</span></span> <span data-ttu-id="f9a40-144">Další informace o výrazy lambda najdete v tématu [výrazy Lambda](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="f9a40-144">For more information about lambda expressions, see [Lambda Expressions](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).</span></span> <span data-ttu-id="f9a40-145">Další příklady výrazů lambda a `AddressOf` přiřazení delegáti, najdete v části [volný převod delegáta](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md).</span><span class="sxs-lookup"><span data-stu-id="f9a40-145">For more examples of lambda expression and `AddressOf` assignments to delegates, see [Relaxed Delegate Conversion](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md).</span></span>  
  
## <a name="related-topics"></a><span data-ttu-id="f9a40-146">Související témata</span><span class="sxs-lookup"><span data-stu-id="f9a40-146">Related Topics</span></span>  
  
|<span data-ttu-id="f9a40-147">Název</span><span class="sxs-lookup"><span data-stu-id="f9a40-147">Title</span></span>|<span data-ttu-id="f9a40-148">Popis</span><span class="sxs-lookup"><span data-stu-id="f9a40-148">Description</span></span>|  
|-----------|-----------------|  
|[<span data-ttu-id="f9a40-149">Postupy: Volání metody delegáta</span><span class="sxs-lookup"><span data-stu-id="f9a40-149">How to: Invoke a Delegate Method</span></span>](../../../../visual-basic/programming-guide/language-features/delegates/how-to-invoke-a-delegate-method.md)|<span data-ttu-id="f9a40-150">Poskytuje příklad, který ukazuje, jak přidružit metody delegáta a pak volání této metody prostřednictvím delegáta.</span><span class="sxs-lookup"><span data-stu-id="f9a40-150">Provides an example that shows how to associate a method with a delegate and then invoke that method through the delegate.</span></span>|  
|[<span data-ttu-id="f9a40-151">Postupy: předání procedur jiné proceduře v jazyce Visual Basic</span><span class="sxs-lookup"><span data-stu-id="f9a40-151">How to: Pass Procedures to Another Procedure in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)|<span data-ttu-id="f9a40-152">Demonstruje způsob používání delegátů předat jeden procedur jiné proceduře.</span><span class="sxs-lookup"><span data-stu-id="f9a40-152">Demonstrates how to use delegates to pass one procedure to another procedure.</span></span>|  
|[<span data-ttu-id="f9a40-153">Volný převod delegáta</span><span class="sxs-lookup"><span data-stu-id="f9a40-153">Relaxed Delegate Conversion</span></span>](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)|<span data-ttu-id="f9a40-154">Popisuje, jak můžete přiřadit předplatných a funkce na delegáty nebo obslužné rutiny i v případě, že jejich podpisy nejsou identické</span><span class="sxs-lookup"><span data-stu-id="f9a40-154">Describes how you can assign subs and functions to delegates or handlers even when their signatures are not identical</span></span>|  
|[<span data-ttu-id="f9a40-155">Události</span><span class="sxs-lookup"><span data-stu-id="f9a40-155">Events</span></span>](../../../../visual-basic/programming-guide/language-features/events/index.md)|<span data-ttu-id="f9a40-156">Obsahuje přehled událostí v jazyce Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="f9a40-156">Provides an overview of events in Visual Basic.</span></span>|
