---
title: Částečné selhání zpracování
description: Architektura Mikroslužeb .NET pro aplikace .NET Kontejnerizované | Částečné selhání zpracování
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.openlocfilehash: 957a0b1b8b4d217fac591db54e4ee053098bc7da
ms.sourcegitcommit: 979597cd8055534b63d2c6ee8322938a27d0c87b
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 06/29/2018
ms.locfileid: "37105192"
---
# <a name="handling-partial-failure"></a><span data-ttu-id="74965-103">Částečné selhání zpracování</span><span class="sxs-lookup"><span data-stu-id="74965-103">Handling partial failure</span></span>

<span data-ttu-id="74965-104">V distribuovaných systémech jako aplikace založené na mikroslužeb existuje všudypřítomné nebezpečí částečné selhání.</span><span class="sxs-lookup"><span data-stu-id="74965-104">In distributed systems like microservices-based applications, there is an ever-present risk of partial failure.</span></span> <span data-ttu-id="74965-105">Pro instanci jediný mikroslužbu nebo kontejner může selhat nebo nemusí být k dispozici po krátkou dobu reagovat, nebo jeden virtuální počítač nebo server může dojít k chybě.</span><span class="sxs-lookup"><span data-stu-id="74965-105">For instance, a single microservice/container can fail or might not be available to respond for a short time, or a single VM or server can crash.</span></span> <span data-ttu-id="74965-106">Vzhledem k tomu, že služby a klienti jsou samostatné procesy, nemusí být schopné reagovat včas na žádost klienta služby.</span><span class="sxs-lookup"><span data-stu-id="74965-106">Since clients and services are separate processes, a service might not be able to respond in a timely way to a client’s request.</span></span> <span data-ttu-id="74965-107">Služba může být požadavky přetížené a reagování na velmi pomalu nebo nemusí být dostupný po krátkou dobu jednoduše z důvodu problémů se sítí.</span><span class="sxs-lookup"><span data-stu-id="74965-107">The service might be overloaded and responding extremely slowly to requests, or might simply not be accessible for a short time because of network issues.</span></span>

<span data-ttu-id="74965-108">Představte si třeba stránce s podrobnostmi o pořadí z eShopOnContainers ukázkovou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="74965-108">For example, consider the Order details page from the eShopOnContainers sample application.</span></span> <span data-ttu-id="74965-109">Pokud je řazení mikroslužbu reagovat při pokusu uživatele o odešlete odbejdnávku, chybný provádění procesu klienta (webová aplikace MVC) – například pokud kód klienta použili synchronní RPC s bez časového limitu – by po neomezenou dobu blokování vláken Čekání na odpověď.</span><span class="sxs-lookup"><span data-stu-id="74965-109">If the ordering microservice is unresponsive when the user tries to submit an order, a bad implementation of the client process (the MVC web application)—for example, if the client code were to use synchronous RPCs with no timeout—would block threads indefinitely waiting for a response.</span></span> <span data-ttu-id="74965-110">Kromě vytváření nepříjemné zkušenosti, každých reagovat čekání používá nebo blokuje vlákno a vláken jsou velmi cenné ve vysoce škálovatelné aplikace.</span><span class="sxs-lookup"><span data-stu-id="74965-110">In addition to creating a bad user experience, every unresponsive wait consumes or blocks a thread, and threads are extremely valuable in highly scalable applications.</span></span> <span data-ttu-id="74965-111">Pokud je počet pozastavených vláken, nakonec běhu aplikace můžete spustit z vláken.</span><span class="sxs-lookup"><span data-stu-id="74965-111">If there are many blocked threads, eventually the application’s runtime can run out of threads.</span></span> <span data-ttu-id="74965-112">V takovém případě může stát aplikace místo globálně reagovat jen částečně reagovat, jak je vidět v obrázek 10-1.</span><span class="sxs-lookup"><span data-stu-id="74965-112">In that case, the application can become globally unresponsive instead of just partially unresponsive, as show in Figure 10-1.</span></span>

![](./media/image1.png)

<span data-ttu-id="74965-113">**Obrázek 10-1**.</span><span class="sxs-lookup"><span data-stu-id="74965-113">**Figure 10-1**.</span></span> <span data-ttu-id="74965-114">Částečné selhání kvůli závislosti, které mít dopad na dostupnost služby přístup z více vláken</span><span class="sxs-lookup"><span data-stu-id="74965-114">Partial failures because of dependencies that impact service thread availability</span></span>

<span data-ttu-id="74965-115">V rozsáhlé aplikace na základě mikroslužeb může být rozšířena jakákoli částečné chyba, hlavně v případě, že většina interní mikroslužeb interakce je založen na synchronní volání protokolu HTTP (které považuje za proti vzor).</span><span class="sxs-lookup"><span data-stu-id="74965-115">In a large microservices-based application, any partial failure can be amplified, especially if most of the internal microservices interaction is based on synchronous HTTP calls (which is considered an anti-pattern).</span></span> <span data-ttu-id="74965-116">Vezměte v úvahu systému, která bude přijímat miliony příchozí volání za den.</span><span class="sxs-lookup"><span data-stu-id="74965-116">Think about a system that receives millions of incoming calls per day.</span></span> <span data-ttu-id="74965-117">Pokud má váš systém chybný návrh, který je založen na dlouhé řetězy synchronní volání protokolu HTTP, tyto příchozí volání může vést v mnoha milionů další odchozí volání (Předpokládejme poměr 1:4) desítek interní mikroslužeb jako synchronní závislosti.</span><span class="sxs-lookup"><span data-stu-id="74965-117">If your system has a bad design that is based on long chains of synchronous HTTP calls, these incoming calls might result in many more millions of outgoing calls (let’s suppose a ratio of 1:4) to dozens of internal microservices as synchronous dependencies.</span></span> <span data-ttu-id="74965-118">Tato situace se zobrazí v 10 obrázek-2, zejména závislostí \#3.</span><span class="sxs-lookup"><span data-stu-id="74965-118">This situation is shown in Figure 10-2, especially dependency \#3.</span></span>

![](./media/image2.png)

<span data-ttu-id="74965-119">**Obrázek 10-2**.</span><span class="sxs-lookup"><span data-stu-id="74965-119">**Figure 10-2**.</span></span> <span data-ttu-id="74965-120">Dopad toho, že nesprávné návrh s funkcí dlouho řetězy požadavků HTTP</span><span class="sxs-lookup"><span data-stu-id="74965-120">The impact of having an incorrect design featuring long chains of HTTP requests</span></span>

<span data-ttu-id="74965-121">Občasné selhání je v podstatě zaručit v distribuované a cloud na bázi systému, i v případě, že všechny závislosti, samotné má vynikající dostupnosti.</span><span class="sxs-lookup"><span data-stu-id="74965-121">Intermittent failure is virtually guaranteed in a distributed and cloud based system, even if every dependency itself has excellent availability.</span></span> <span data-ttu-id="74965-122">To by měl být faktů, které je třeba vzít v úvahu.</span><span class="sxs-lookup"><span data-stu-id="74965-122">This should be a fact you need to consider.</span></span>

<span data-ttu-id="74965-123">Pokud nemáte navrhnout a implementovat techniky k zajištění odolnosti proti chybám, může být rozšířena i malé výpadky způsobené nástrojem.</span><span class="sxs-lookup"><span data-stu-id="74965-123">If you do not design and implement techniques to ensure fault tolerance, even small downtimes can be amplified.</span></span> <span data-ttu-id="74965-124">Jako příklad by kvůli tomu ripple 50 závislosti každý s 99,99 % dostupnost způsobilo několik hodin výpadku každý měsíc.</span><span class="sxs-lookup"><span data-stu-id="74965-124">As an example, 50 dependencies each with 99.99% of availability would result in several hours of downtime each month because of this ripple effect.</span></span> <span data-ttu-id="74965-125">Když závislost mikroslužbu selže při zpracování k velkému počtu požadavků, které selhání můžete rychle saturate všechna vlákna požadavek k dispozici v jednotlivých služeb a havárií celou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="74965-125">When a microservice dependency fails while handling a high volume of requests, that failure can quickly saturate all available request threads in each service and crash the whole application.</span></span>

![](./media/image3.png)

<span data-ttu-id="74965-126">**Obrázek 10-3**.</span><span class="sxs-lookup"><span data-stu-id="74965-126">**Figure 10-3**.</span></span> <span data-ttu-id="74965-127">Částečné selhání doplněné mikroslužeb s dlouhou řetězy synchronní volání protokolu HTTP</span><span class="sxs-lookup"><span data-stu-id="74965-127">Partial failure amplified by microservices with long chains of synchronous HTTP calls</span></span>

<span data-ttu-id="74965-128">Chcete-li minimalizovat tento problém, v části "*asynchronní mikroslužbu integrace vynutit nezávislé na mikroslužbu*" (v kapitole architektura), můžeme vám umožní používat asynchronní komunikaci mezi interní podporovat mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="74965-128">To minimize this problem, in the section "*Asynchronous microservice integration enforce microservice’s autonomy*” (in the architecture chapter), we encouraged you to use asynchronous communication across the internal microservices.</span></span> <span data-ttu-id="74965-129">Stručně objasníme více v další části.</span><span class="sxs-lookup"><span data-stu-id="74965-129">We briefly explain more in the next section.</span></span>

<span data-ttu-id="74965-130">Kromě toho je důležité, navrhnout vaše mikroslužeb a klientské aplikace pro zpracování částečné selhání – to znamená, vytvářet odolné mikroslužeb a klientské aplikace.</span><span class="sxs-lookup"><span data-stu-id="74965-130">In addition, it is essential that you design your microservices and client applications to handle partial failures—that is, to build resilient microservices and client applications.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="74965-131">[Předchozí](index.md)
[další](partial-failure-strategies.md)</span><span class="sxs-lookup"><span data-stu-id="74965-131">[Previous](index.md)
[Next](partial-failure-strategies.md)</span></span>
