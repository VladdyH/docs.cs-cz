---
title: "Nasazení jednoho kontejneru na základě webových aplikací .NET Core na hostitelích Nano Server systému Windows nebo Linux"
description: "Architektura Mikroslužeb .NET pro aplikace .NET Kontejnerizované | Nasazení jednoho kontejneru na základě webových aplikací .NET Core na hostitelích Nano Server systému Windows nebo Linux"
keywords: "Docker, Mikroslužeb, ASP.NET, kontejneru"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: f85b3db6b4ca6d22c4b855c8b96051c1c31350a6
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/23/2017
---
# <a name="deploying-single-container-based-net-core-web-applications-on-linux-or-windows-nano-server-hosts"></a><span data-ttu-id="76ebe-104">Nasazení webových aplikací na základě jednoho kontejneru .NET Core na hostitelích Nano Server systému Windows nebo Linux</span><span class="sxs-lookup"><span data-stu-id="76ebe-104">Deploying Single-Container-Based .NET Core Web Applications on Linux or Windows Nano Server Hosts</span></span>

<span data-ttu-id="76ebe-105">*Kontejnery Docker můžete použít pro nasazení monolitický jednodušší webových aplikací. Tím se zlepšuje průběžnou integraci a průběžné nasazování kanálů a pomáhá dosáhnout úspěšné nasazení produkční. Žádné další "funguje v počítači, proč nefunguje v produkčním prostředí?"*</span><span class="sxs-lookup"><span data-stu-id="76ebe-105">*You can use Docker containers for monolithic deployment of simpler web applications. This improves continuous integration and continuous deployment pipelines and helps achieve deployment-to-production success. No more “It works in my machine, why does not work in production?”*</span></span>

<span data-ttu-id="76ebe-106">Architektura se na základě mikroslužeb má mnoho výhod, ale tyto výhody pocházet s náklady zvýšenou složitostí.</span><span class="sxs-lookup"><span data-stu-id="76ebe-106">A microservices-based architecture has many benefits, but those benefits come at a cost of increased complexity.</span></span> <span data-ttu-id="76ebe-107">V některých případech náklady převažují nad přínosy a můžete se s aplikací monolitický nasazení spuštěn v jednom kontejneru nebo v několika kontejnerů lépe vyhovovat.</span><span class="sxs-lookup"><span data-stu-id="76ebe-107">In some cases, the costs outweigh the benefits, and you will be better served with a monolithic deployment application running in a single container or in just a few containers.</span></span> 

<span data-ttu-id="76ebe-108">Monolitický aplikace nemusí být snadno decomposable do dobře oddělených mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="76ebe-108">A monolithic application might not be easily decomposable into well-separated microservices.</span></span> <span data-ttu-id="76ebe-109">Jste se naučili tyto by měl být oddíly podle funkce: mikroslužeb by měla fungovat nezávisle na sobě zajistit pružnější aplikace.</span><span class="sxs-lookup"><span data-stu-id="76ebe-109">You have learned that these should be partitioned by function: microservices should work independently of each other to provide a more resilient application.</span></span> <span data-ttu-id="76ebe-110">Pokud nelze doručit řezy funkce aplikace, oddělení ho přidá jenom složitost.</span><span class="sxs-lookup"><span data-stu-id="76ebe-110">If you cannot deliver feature slices of the application, separating it only adds complexity.</span></span>

<span data-ttu-id="76ebe-111">Aplikace nemusí ještě nezávisle škálovat funkce.</span><span class="sxs-lookup"><span data-stu-id="76ebe-111">An application might not yet need to scale features independently.</span></span> <span data-ttu-id="76ebe-112">Předpokládejme, že již v rané fázi v dobu životnosti naší eShopOnContainers odkaz na aplikaci, provoz není justify funkce rozdělit do různých mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="76ebe-112">Let’s suppose that early in the life of our eShopOnContainers reference application, the traffic did not justify separating features into different microservices.</span></span> <span data-ttu-id="76ebe-113">Provoz se dostatečně malé, obvykle přidávání zdrojů do jedné služby určené přidávání zdrojů ke všem službám.</span><span class="sxs-lookup"><span data-stu-id="76ebe-113">Traffic was small enough that adding resources to one service typically meant adding resources to all services.</span></span> <span data-ttu-id="76ebe-114">Další kroky k oddělení aplikaci do samostatné služby k dispozici minimální výhody.</span><span class="sxs-lookup"><span data-stu-id="76ebe-114">The additional work to separate the application into discrete services provided minimal benefit.</span></span>

<span data-ttu-id="76ebe-115">Časná ve vývoji aplikace nemusí být také jasno kde přirozené funkční hranice jsou.</span><span class="sxs-lookup"><span data-stu-id="76ebe-115">Also, early in the development of an application you might not have a clear idea where the natural functional boundaries are.</span></span> <span data-ttu-id="76ebe-116">Když budete vyvíjet minimální přijatelná produktu, fyzické oddělení nemusí ještě této služby.</span><span class="sxs-lookup"><span data-stu-id="76ebe-116">As you develop a minimum viable product, the natural separation might not yet have emerged.</span></span>

<span data-ttu-id="76ebe-117">Některé z těchto podmínek může být dočasné.</span><span class="sxs-lookup"><span data-stu-id="76ebe-117">Some of these conditions might be temporary.</span></span> <span data-ttu-id="76ebe-118">Můžete začít tak, že vytvoříte monolitický aplikace a později oddělit některé funkce vyvinuté a nasadit jako mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="76ebe-118">You might start by creating a monolithic application, and later separate some features to be developed and deployed as microservices.</span></span> <span data-ttu-id="76ebe-119">Další podmínky může být nezbytné pro aplikace problém místa, což znamená, že aplikace může být nikdy rozdělen do více mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="76ebe-119">Other conditions might be essential to the application’s problem space, meaning that the application might never be broken into multiple microservices.</span></span>

<span data-ttu-id="76ebe-120">Oddělení aplikace do mnoha diskrétní procesů také zavádí režijní náklady.</span><span class="sxs-lookup"><span data-stu-id="76ebe-120">Separating an application into many discrete processes also introduces overhead.</span></span> <span data-ttu-id="76ebe-121">Rozdělit funkce do různých procesů je složitější.</span><span class="sxs-lookup"><span data-stu-id="76ebe-121">There is more complexity in separating features into different processes.</span></span> <span data-ttu-id="76ebe-122">S růstem složitosti komunikační protokoly.</span><span class="sxs-lookup"><span data-stu-id="76ebe-122">The communication protocols become more complex.</span></span> <span data-ttu-id="76ebe-123">Místo volání metod je nutné použít asynchronní komunikaci mezi službami.</span><span class="sxs-lookup"><span data-stu-id="76ebe-123">Instead of method calls, you must use asynchronous communications between services.</span></span> <span data-ttu-id="76ebe-124">Když přesouváte mikroslužeb architektury, budete muset přidat řadu stavební bloky implementované v mikroslužeb verze aplikace eShopOnContainers: sběrnice zpracování událostí, zprávy odolnost proti chybám a opakovaných pokusů, konzistence typu případné a další.</span><span class="sxs-lookup"><span data-stu-id="76ebe-124">As you move to a microservices architecture, you need to add many of the building blocks implemented in the microservices version of the eShopOnContainers application: event bus handling, message resiliency and retries, eventual consistency, and more.</span></span>

<span data-ttu-id="76ebe-125">Velmi zjednodušené verzi eShopOnContainers (s názvem [eShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic) a zahrnuté ve stejném úložišti GitHub) spustí jako monolitický aplikace MVC a jako právě popsáno, existují výhod nabízených volbou tohoto návrhu.</span><span class="sxs-lookup"><span data-stu-id="76ebe-125">A much-simplified version of eShopOnContainers (named [eShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic) and included in the same GitHub repo) runs as a monolithic MVC application, and as just described, there are advantages offered by that design choice.</span></span> <span data-ttu-id="76ebe-126">Můžete stáhnout z webu GitHub zdroj pro tuto aplikaci a ji spustit místně.</span><span class="sxs-lookup"><span data-stu-id="76ebe-126">You can download the source for this application from GitHub and run it locally.</span></span> <span data-ttu-id="76ebe-127">Výhody této monolitický aplikace z nasazuje v prostředí kontejneru.</span><span class="sxs-lookup"><span data-stu-id="76ebe-127">Even this monolithic application benefits from being deployed in a container environment.</span></span>

<span data-ttu-id="76ebe-128">Pro jeden kontejnerizované nasazení znamená, že každá instance aplikace běží ve stejném prostředí.</span><span class="sxs-lookup"><span data-stu-id="76ebe-128">For one, the containerized deployment means that every instance of the application runs in the same environment.</span></span> <span data-ttu-id="76ebe-129">To zahrnuje vývojářského prostředí, kde již v rané fázi testování a vývoje probíhat.</span><span class="sxs-lookup"><span data-stu-id="76ebe-129">This includes the developer environment where early testing and development take place.</span></span> <span data-ttu-id="76ebe-130">Vývojový tým aplikaci můžete spustit v prostředí s kontejnerizované, které odpovídá produkčního prostředí.</span><span class="sxs-lookup"><span data-stu-id="76ebe-130">The development team can run the application in a containerized environment that matches the production environment.</span></span>

<span data-ttu-id="76ebe-131">Kromě toho kontejnerizované aplikace škálování při nižších nákladech.</span><span class="sxs-lookup"><span data-stu-id="76ebe-131">In addition, containerized applications scale out at lower cost.</span></span> <span data-ttu-id="76ebe-132">Jak už jste viděli dříve, kontejner prostředí umožňuje sdílení než tradiční prostředí virtuálního počítače větší prostředků.</span><span class="sxs-lookup"><span data-stu-id="76ebe-132">As you saw earlier, the container environment enables greater resource sharing than traditional VM environments.</span></span>

<span data-ttu-id="76ebe-133">Nakonec containerizing aplikace vynutí oddělení mezi obchodní logiky a storage server.</span><span class="sxs-lookup"><span data-stu-id="76ebe-133">Finally, containerizing the application forces a separation between the business logic and the storage server.</span></span> <span data-ttu-id="76ebe-134">Jak aplikace horizontálně navýší kapacitu, bude několika kontejnerů spoléhají na střední jedno fyzické úložiště.</span><span class="sxs-lookup"><span data-stu-id="76ebe-134">As the application scales out, the multiple containers will all rely on a single physical storage medium.</span></span> <span data-ttu-id="76ebe-135">Obvykle to může být vysoká dostupnost serveru se systémem databázi systému SQL Server.</span><span class="sxs-lookup"><span data-stu-id="76ebe-135">This would typically be a high-availability server running a SQL Server database.</span></span>

## <a name="application-tour"></a><span data-ttu-id="76ebe-136">Prohlídka aplikace</span><span class="sxs-lookup"><span data-stu-id="76ebe-136">Application tour</span></span>

<span data-ttu-id="76ebe-137">[EShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic) aplikace představuje část aplikace eShopOnContainers běžící jako monolitický aplikace – aplikace ASP.NET MVC jádra na základě běžící na .NET Core.</span><span class="sxs-lookup"><span data-stu-id="76ebe-137">The [eShopWeb](https://github.com/dotnet-architecture/eShopOnContainers/tree/master/src/Web/WebMonolithic) application represents some of the eShopOnContainers application running as a monolithic application—an ASP.NET Core MVC based application running on .NET Core.</span></span> <span data-ttu-id="76ebe-138">Poskytuje především katalogu procházení možností, které jsme popsané v předchozích částech.</span><span class="sxs-lookup"><span data-stu-id="76ebe-138">It mainly provides the catalog browsing capabilities that we described in earlier sections.</span></span>

<span data-ttu-id="76ebe-139">Aplikace používá databázi systému SQL Server pro úložiště katalogu.</span><span class="sxs-lookup"><span data-stu-id="76ebe-139">The application uses a SQL Server database for the catalog storage.</span></span> <span data-ttu-id="76ebe-140">V nasazení založené na kontejner můžete tato monolitický aplikace přístup k úložišti dat stejné jako aplikace založené na mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="76ebe-140">In container-based deployments, this monolithic application can access the same data store as the microservices-based application.</span></span> <span data-ttu-id="76ebe-141">Aplikace je nakonfigurovaná pro spuštění systému SQL Server v kontejneru spolu s monolitický aplikace.</span><span class="sxs-lookup"><span data-stu-id="76ebe-141">The application is configured to run SQL Server in a container alongside the monolithic application.</span></span> <span data-ttu-id="76ebe-142">V produkčním prostředí by systému SQL Server spustit na počítači vysokou dostupnost, mimo Docker hostitele.</span><span class="sxs-lookup"><span data-stu-id="76ebe-142">In a production environment, SQL Server would run on a high-availability machine, outside of the Docker host.</span></span> <span data-ttu-id="76ebe-143">Pro usnadnění práce v dev nebo testovací prostředí doporučujeme systémem SQL Server v jeho vlastní kontejneru.</span><span class="sxs-lookup"><span data-stu-id="76ebe-143">For convenience in a dev or test environment, we recommend running SQL Server in its own container.</span></span>

<span data-ttu-id="76ebe-144">Funkci počáteční nastavení pouze povolí procházení katalogu.</span><span class="sxs-lookup"><span data-stu-id="76ebe-144">The initial feature set only enables browsing the catalog.</span></span> <span data-ttu-id="76ebe-145">Aktualizace by povolit úplnou sadu funkcí kontejnerové aplikace.</span><span class="sxs-lookup"><span data-stu-id="76ebe-145">Updates would enable the full feature set of the containerized application.</span></span> <span data-ttu-id="76ebe-146">Pokročilejší architektura monolitický webové aplikace A je popsána v [webové aplikace ASP.NET architektura postupy](https://aka.ms/webappebook) elektronickou knihu a související [eShopOnWeb ukázkovou aplikaci](http://aka.ms/WebAppArchitecture), i když v takovém případě není spuštěna na Docker kontejnery, protože tento scénář se zaměřuje na vývoj prostý webové s ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="76ebe-146">A more advanced monolithic web application architecture is described in the [ASP.NET Web Application architecture practices](https://aka.ms/webappebook) e-book and related [eShopOnWeb sample application](http://aka.ms/WebAppArchitecture), although in that case it is not running on Docker containers because that scenario focuses on plain web development with ASP.NET Core.</span></span>

<span data-ttu-id="76ebe-147">Zjednodušené verzi k dispozici v eShopOnContainers (eShopWeb) ale běží v kontejner Docker.</span><span class="sxs-lookup"><span data-stu-id="76ebe-147">However, the simplified version available in eShopOnContainers (eShopWeb) runs in a Docker container.</span></span>

## <a name="docker-support"></a><span data-ttu-id="76ebe-148">Podpora docker</span><span class="sxs-lookup"><span data-stu-id="76ebe-148">Docker support</span></span>

<span data-ttu-id="76ebe-149">Spustí eShopOnWeb projektu na .NET Core.</span><span class="sxs-lookup"><span data-stu-id="76ebe-149">The eShopOnWeb project runs on .NET Core.</span></span> <span data-ttu-id="76ebe-150">Proto můžete spustit v kontejnerech systémem Linux nebo systému Windows.</span><span class="sxs-lookup"><span data-stu-id="76ebe-150">Therefore, it can run in either Linux-based or Windows-based containers.</span></span> <span data-ttu-id="76ebe-151">Všimněte si, že pro nasazení Docker chcete použít stejný typ hostitele pro SQL Server.</span><span class="sxs-lookup"><span data-stu-id="76ebe-151">Note that for Docker deployment, you want to use the same host type for SQL Server.</span></span> <span data-ttu-id="76ebe-152">Systémem Linux kontejnery umožňují menší nároky a mají přednost.</span><span class="sxs-lookup"><span data-stu-id="76ebe-152">Linux-based containers allow a smaller footprint and are preferred.</span></span>

<span data-ttu-id="76ebe-153">Visual Studio poskytuje šablony projektu, který přidává podporu pro Docker řešení.</span><span class="sxs-lookup"><span data-stu-id="76ebe-153">Visual Studio provides a project template that adds support for Docker to a solution.</span></span> <span data-ttu-id="76ebe-154">Klikněte pravým tlačítkem na projekt, klikněte na tlačítko **přidat** následuje **Docker podporu**.</span><span class="sxs-lookup"><span data-stu-id="76ebe-154">You right-click the project, click **Add** followed by **Docker Support**.</span></span> <span data-ttu-id="76ebe-155">Šablona přidá do projektu a nový soubor Docker **docker compose** projekt, který poskytuje počáteční soubor docker-compose.yml.</span><span class="sxs-lookup"><span data-stu-id="76ebe-155">The template adds a Dockerfile to your project, and a new **docker-compose** project that provides a starter docker-compose.yml file.</span></span> <span data-ttu-id="76ebe-156">Tento krok již byla provedena v projektu eShopOnWeb stáhnout z webu GitHub.</span><span class="sxs-lookup"><span data-stu-id="76ebe-156">This step has already been done in the eShopOnWeb project downloaded from GitHub.</span></span> <span data-ttu-id="76ebe-157">Zobrazí se, že obsahuje řešení **eShopOnWeb** projektu a **docker compose** projektu jak je znázorněno v obrázek 6-1.</span><span class="sxs-lookup"><span data-stu-id="76ebe-157">You will see that the solution contains the **eShopOnWeb** project and the **docker-compose** project as shown in Figure 6-1.</span></span>

![](./media/image1.png)

<span data-ttu-id="76ebe-158">**Obrázek 6-1**.</span><span class="sxs-lookup"><span data-stu-id="76ebe-158">**Figure 6-1**.</span></span> <span data-ttu-id="76ebe-159">**Docker compose** projekt v kontejneru jedné webové aplikace</span><span class="sxs-lookup"><span data-stu-id="76ebe-159">The **docker-compose** project in a single-container web application</span></span>

<span data-ttu-id="76ebe-160">Tyto soubory jsou standardní docker-soubory, které jsou konzistentní s žádným projektem Docker compose.</span><span class="sxs-lookup"><span data-stu-id="76ebe-160">These files are standard docker-compose files, consistent with any Docker project.</span></span> <span data-ttu-id="76ebe-161">Můžete je používat pomocí sady Visual Studio nebo z příkazového řádku.</span><span class="sxs-lookup"><span data-stu-id="76ebe-161">You can use them with Visual Studio or from the command line.</span></span> <span data-ttu-id="76ebe-162">Tato aplikace běží na .NET Core a používá Linux kontejnery, takže můžete také code, sestavit a spustit na Macu nebo na počítač s Linuxem.</span><span class="sxs-lookup"><span data-stu-id="76ebe-162">This application runs on .NET Core and uses Linux containers, so you can also code, build, and run on a Mac or on a Linux machine.</span></span>

<span data-ttu-id="76ebe-163">Soubor docker-compose.yml obsahuje informace o co bitové kopie k sestavení a jaké kontejnerů ke spuštění.</span><span class="sxs-lookup"><span data-stu-id="76ebe-163">The docker-compose.yml file contains information about what images to build and what containers to launch.</span></span> <span data-ttu-id="76ebe-164">Šablony zadejte, jak vytvořit bitovou kopii eshopweb a spusťte kontejnery aplikace.</span><span class="sxs-lookup"><span data-stu-id="76ebe-164">The templates specify how to build the eshopweb image and launch the application’s containers.</span></span> <span data-ttu-id="76ebe-165">Je nutné přidat závislost na serveru SQL Server tak, že začleníte bitovou kopii pro něj (například mssql. server linux) a služby pro bitovou kopii sql.data pro Docker sestavení a spuštění tohoto kontejneru.</span><span class="sxs-lookup"><span data-stu-id="76ebe-165">You need to add the dependency on SQL Server by including an image for it (for example, mssql-server-linux), and a service for the sql.data image for Docker to build and launch that container.</span></span> <span data-ttu-id="76ebe-166">Tato nastavení jsou zobrazena v následujícím příkladu:</span><span class="sxs-lookup"><span data-stu-id="76ebe-166">These settings are shown in the following example:</span></span>

```yml
version: '2'

services:
  eshopweb:
    image: eshop/web
    build:
    context: ./eShopWeb
    dockerfile: Dockerfile
    depends_on:
      - sql.data

  sql.data:
    image: microsoft/mssql-server-linux
```

<span data-ttu-id="76ebe-167">Závisí\_na direktiva uvádějí Docker že bitovou kopii eShopWeb závisí na bitovou kopii sql.data.</span><span class="sxs-lookup"><span data-stu-id="76ebe-167">The depends\_on directive tells Docker that the eShopWeb image depends on the sql.data image.</span></span> <span data-ttu-id="76ebe-168">Řádky níže, které jsou pokyny k vytvoření image označené sql.data pomocí bitové kopie microsoft/mssql-server-linux.</span><span class="sxs-lookup"><span data-stu-id="76ebe-168">Lines below that are the instructions to build an image tagged sql.data using the microsoft/mssql-server-linux image.</span></span>

<span data-ttu-id="76ebe-169">**Docker compose** projektu zobrazí další soubory docker-compose pod uzlem hlavní docker-compose.yml zajistit vizuální označení, že tyto soubory souvisí.</span><span class="sxs-lookup"><span data-stu-id="76ebe-169">The **docker-compose** project displays the other docker-compose files under the main docker-compose.yml node to provide a visual indication that these files are related.</span></span> <span data-ttu-id="76ebe-170">Soubor docker compose override.yml obsahuje nastavení pro obě služby, jako je například připojovací řetězce a další nastavení aplikace.</span><span class="sxs-lookup"><span data-stu-id="76ebe-170">The docker-compose-override.yml file contains settings for both services, such as connection strings and other application settings.</span></span>

<span data-ttu-id="76ebe-171">Následující příklad ukazuje soubor docker-compose.vs.debug.yml, který obsahuje nastavení používaná pro ladění v sadě Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="76ebe-171">The following example shows the docker-compose.vs.debug.yml file, which contains settings used for debugging in Visual Studio.</span></span> <span data-ttu-id="76ebe-172">V tomto souboru má obrázek eshopweb značce vývojářů, přidá se k němu.</span><span class="sxs-lookup"><span data-stu-id="76ebe-172">In that file, the eshopweb image has the dev tag appended to it.</span></span> <span data-ttu-id="76ebe-173">Který pomáhá samostatné ladění z bitové kopie verze tak, aby nenasazujte omylem informace o ladění do provozního prostředí:</span><span class="sxs-lookup"><span data-stu-id="76ebe-173">That helps separate debug from release images so that you do not accidentally deploy the debug information to a production environment:</span></span>

```yml
version: '2'
  
services:
  eshopweb:
    image: eshop/web:dev
    build:
    args:
    source: ${DOCKER_BUILD_SOURCE}
    environment:
      - DOTNET_USE_POLLING_FILE_WATCHER=1
    volumes:
      - ./eShopWeb:/app
      - ~/.nuget/packages:/root/.nuget/packages:ro
      - ~/clrdbg:/clrdbg:ro
    entrypoint: tail -f /dev/null
    labels:
      - "com.microsoft.visualstudio.targetoperatingsystem=linux"
```

<span data-ttu-id="76ebe-174">Přidat posledního souboru je docker compose.ci.build.yml.</span><span class="sxs-lookup"><span data-stu-id="76ebe-174">The last file added is docker-compose.ci.build.yml.</span></span> <span data-ttu-id="76ebe-175">Tím se použije z příkazového řádku pro sestavení projektu ze serveru položek konfigurace.</span><span class="sxs-lookup"><span data-stu-id="76ebe-175">This would be used from the command line to build the project from a CI server.</span></span> <span data-ttu-id="76ebe-176">Tento soubor vytvářené spustí kontejner Docker, který vytvoří bitové kopie pro vaši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="76ebe-176">This compose file starts a Docker container that builds the images needed for your application.</span></span> <span data-ttu-id="76ebe-177">Následující příklad ukazuje obsah souboru docker compose.ci.build.yml.</span><span class="sxs-lookup"><span data-stu-id="76ebe-177">The following example shows the contents of the docker-compose.ci.build.yml file.</span></span>

```yml
version: '2'
  
services:
  ci-build:
    image: microsoft/aspnetcore-build:latest
    volumes:
      - .:/src
    working_dir: /src
  command: /bin/bash -c "dotnet restore ./eShopWeb.sln && dotnet publish  ./eShopWeb.sln -c Release -o ./obj/Docker/publish"
```

<span data-ttu-id="76ebe-178">**Poznámka:**: od verze rozhraní .NET 2.0 jádra, dotnet obnovení příkaz provede automaticky při publikování dotnet se spustí.</span><span class="sxs-lookup"><span data-stu-id="76ebe-178">**Note**: Starting with .NET Core 2.0, the dotnet restore command executes automatically when dotnet publish is executed.</span></span>

<span data-ttu-id="76ebe-179">Všimněte si, že obrázek je obrázek, který ASP.NET Core sestavení.</span><span class="sxs-lookup"><span data-stu-id="76ebe-179">Notice that the image is an ASP.NET Core build image.</span></span> <span data-ttu-id="76ebe-180">Této bitové kopie zahrnuje sady SDK a sestavení nástroje pro sestavení aplikace a vytvořte požadované obrázky.</span><span class="sxs-lookup"><span data-stu-id="76ebe-180">That image includes the SDK and build tools to build your application and create the required images.</span></span> <span data-ttu-id="76ebe-181">Spuštění **docker compose** projekt pomocí tento soubor spustí kontejneru sestavení z bitové kopie, pak sestavení vaší aplikace bitové kopie v tomto kontejneru.</span><span class="sxs-lookup"><span data-stu-id="76ebe-181">Running the **docker-compose** project using this file starts the build container from the image, then builds your application’s image in that container.</span></span> <span data-ttu-id="76ebe-182">Zadejte tento docker-jako součást příkazového řádku k vytvoření aplikace v kontejner Docker compose souboru a potom ho spusťte.</span><span class="sxs-lookup"><span data-stu-id="76ebe-182">You specify that docker-compose file as part of the command line to build your application in a Docker container, then launch it.</span></span>

<span data-ttu-id="76ebe-183">V sadě Visual Studio, můžete spustit svoji aplikaci v Docker kontejnery výběrem **docker-tvoří** projekt jako spouštěný projekt a stisknutím klávesy Ctrl + F5 (F5 k ladění), jako u jakékoli jiné aplikace.</span><span class="sxs-lookup"><span data-stu-id="76ebe-183">In Visual Studio, you can run your application in Docker containers by selecting the **docker-compose** project as the startup project, and then pressing Ctrl+F5 (F5 to debug), as you can with any other application.</span></span> <span data-ttu-id="76ebe-184">Při prvním spuštění **docker compose** projektu sady Visual Studio spustí **docker compose** pomocí soubor docker-compose.yml, soubor docker-compose.override.yml a jeden z docker-compose.vs.\* soubory.</span><span class="sxs-lookup"><span data-stu-id="76ebe-184">When you start the **docker-compose** project, Visual Studio runs **docker-compose** using the docker-compose.yml file, the docker-compose.override.yml file, and one of the docker-compose.vs.\* files.</span></span> <span data-ttu-id="76ebe-185">Po spuštění aplikace Visual Studio spustí prohlížeč za vás.</span><span class="sxs-lookup"><span data-stu-id="76ebe-185">Once the application has started, Visual Studio launches the browser for you.</span></span>

<span data-ttu-id="76ebe-186">Pokud je spuštění aplikace v ladicím programu, připojí se k běžící aplikaci v Docker Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="76ebe-186">If you launch the application in the debugger, Visual Studio will attach to the running application in Docker.</span></span>

## <a name="troubleshooting"></a><span data-ttu-id="76ebe-187">Poradce při potížích</span><span class="sxs-lookup"><span data-stu-id="76ebe-187">Troubleshooting</span></span>

<span data-ttu-id="76ebe-188">Tato část popisuje několik problémů, které by mohly nastat při spuštění kontejnery místně a navrhne některé opravy.</span><span class="sxs-lookup"><span data-stu-id="76ebe-188">This section describes a few issues that might arise when your run containers locally and suggests some fixes.</span></span>

### <a name="stopping-docker-containers"></a><span data-ttu-id="76ebe-189">Zastavení Docker kontejnery</span><span class="sxs-lookup"><span data-stu-id="76ebe-189">Stopping Docker containers</span></span> 

<span data-ttu-id="76ebe-190">Po spuštění aplikace kontejnerizované kontejnery nadále spouštět, i když je nutné zastavit ladění.</span><span class="sxs-lookup"><span data-stu-id="76ebe-190">After you launch the containerized application, the containers continue to run, even after you have stopped debugging.</span></span> <span data-ttu-id="76ebe-191">Spuštěním docker ps příkazu z příkazového řádku kontejnery, které jsou spuštěny.</span><span class="sxs-lookup"><span data-stu-id="76ebe-191">You can run the docker ps command from the command line to see which containers are running.</span></span> <span data-ttu-id="76ebe-192">Příkaz k ukončení docker zastaví kontejner spuštěné, jak je znázorněno na obrázku 6-2.</span><span class="sxs-lookup"><span data-stu-id="76ebe-192">The docker stop command stops a running container, as shown in Figure 6-2.</span></span>

![](./media/image2.png)

<span data-ttu-id="76ebe-193">**Obrázek 6-2**.</span><span class="sxs-lookup"><span data-stu-id="76ebe-193">**Figure 6-2**.</span></span> <span data-ttu-id="76ebe-194">Výpis a zastavení kontejnerů pomocí docker ps a docker zastavit rozhraní příkazového řádku</span><span class="sxs-lookup"><span data-stu-id="76ebe-194">Listing and stopping containers with the docker ps and docker stop CLI commands</span></span>

<span data-ttu-id="76ebe-195">Možná budete muset zastavit spuštěné procesy při přepínání mezi různými konfiguracemi.</span><span class="sxs-lookup"><span data-stu-id="76ebe-195">You might need to stop running processes when you switch between different configurations.</span></span> <span data-ttu-id="76ebe-196">V opačném kontejner, ve kterém běží webová aplikace používá port pro vaši aplikaci (5106 v tomto příkladu).</span><span class="sxs-lookup"><span data-stu-id="76ebe-196">Otherwise, the container that is running the web application is using the port for your application (5106 in this example).</span></span>

### <a name="adding-docker-to-your-projects"></a><span data-ttu-id="76ebe-197">Přidání Docker do vašich projektů</span><span class="sxs-lookup"><span data-stu-id="76ebe-197">Adding Docker to your projects</span></span>

<span data-ttu-id="76ebe-198">Průvodce, který přidává podporu Docker komunikuje s běžící proces Docker.</span><span class="sxs-lookup"><span data-stu-id="76ebe-198">The wizard that adds Docker support communicates with the running Docker process.</span></span> <span data-ttu-id="76ebe-199">Průvodce nebude pracovat správně, pokud Docker není spuštěn, když spustíte průvodce.</span><span class="sxs-lookup"><span data-stu-id="76ebe-199">The wizard will not run correctly if Docker is not running when you start the wizard.</span></span> <span data-ttu-id="76ebe-200">Kromě toho Průvodce prověří zvoleného aktuální kontejner přidání správné Docker podpory.</span><span class="sxs-lookup"><span data-stu-id="76ebe-200">In addition, the wizard examines your current container choice to add the correct Docker support.</span></span> <span data-ttu-id="76ebe-201">Pokud chcete přidat podporu pro Windows kontejnery, budete muset spustit průvodce, dokud máte Docker s kontejnery Windows nakonfigurovat.</span><span class="sxs-lookup"><span data-stu-id="76ebe-201">If you want to add support for Windows Containers, you need to run the wizard while you have Docker running with Windows Containers configured.</span></span> <span data-ttu-id="76ebe-202">Pokud chcete přidat podporu pro kontejnery Linux, spusťte Průvodce při Docker s kontejnery Linux nakonfigurované.</span><span class="sxs-lookup"><span data-stu-id="76ebe-202">If you want to add support for Linux containers, run the wizard while you have Docker running with Linux containers configured.</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="76ebe-203">[Předchozí] (.. / docker-application-development-process/docker-app-development-workflow.md) [Další] (.. /containerize-NET-Framework-Applications/index.MD)</span><span class="sxs-lookup"><span data-stu-id="76ebe-203">[Previous] (../docker-application-development-process/docker-app-development-workflow.md) [Next] (../containerize-net-framework-applications/index.md)</span></span>
