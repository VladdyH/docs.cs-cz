---
title: "Containerizing monolitický aplikace"
description: "Architektura Mikroslužeb .NET pro aplikace .NET Kontejnerizované | Containerizing monolitický aplikace"
keywords: "Docker, Mikroslužeb, ASP.NET, kontejneru"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: fc01054e4352a711d2203e694001a1204dedadf9
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/23/2017
---
# <a name="containerizing-monolithic-applications"></a><span data-ttu-id="75899-104">Containerizing monolitický aplikace</span><span class="sxs-lookup"><span data-stu-id="75899-104">Containerizing monolithic applications</span></span>

<span data-ttu-id="75899-105">Můžete chtít vytvořit jeden, monolithically nasazené webové aplikace nebo služby a nasaďte ho jako kontejner.</span><span class="sxs-lookup"><span data-stu-id="75899-105">You might want to build a single, monolithically deployed web application or service and deploy it as a container.</span></span> <span data-ttu-id="75899-106">Vlastní aplikace nemusí být interně monolitický, ale strukturovaná jako několik knihovny, komponenty nebo dokonce i vrstvy (aplikační vrstvu, domény vrstvy, přístup k datům vrstvy atd.).</span><span class="sxs-lookup"><span data-stu-id="75899-106">The application itself might not be internally monolithic, but structured as several libraries, components, or even layers (application layer, domain layer, data-access layer, etc.).</span></span> <span data-ttu-id="75899-107">Externě, ale je jediný kontejner – jeden proces, jednu webovou aplikaci nebo jedné služby.</span><span class="sxs-lookup"><span data-stu-id="75899-107">Externally, however, it is a single container—a single process, a single web application, or a single service.</span></span>

<span data-ttu-id="75899-108">Ke správě tohoto modelu, můžete nasadit jediný kontejner k reprezentaci aplikace.</span><span class="sxs-lookup"><span data-stu-id="75899-108">To manage this model, you deploy a single container to represent the application.</span></span> <span data-ttu-id="75899-109">Škálování, stačí přidat více kopií pro vyrovnávání zatížení vpředu.</span><span class="sxs-lookup"><span data-stu-id="75899-109">To scale up, you just add more copies with a load balancer in front.</span></span> <span data-ttu-id="75899-110">Jednoduchost pochází z Správa jedno nasazení v jedné kontejneru nebo virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="75899-110">The simplicity comes from managing a single deployment in a single container or VM.</span></span>

![](./media/image1.png)

<span data-ttu-id="75899-111">**Obrázek 4-1**.</span><span class="sxs-lookup"><span data-stu-id="75899-111">**Figure 4-1**.</span></span> <span data-ttu-id="75899-112">Příklad architektury kontejnerizované monolitický aplikace</span><span class="sxs-lookup"><span data-stu-id="75899-112">Example of the architecture of a containerized monolithic application</span></span>

<span data-ttu-id="75899-113">V každém kontejneru, můžete zahrnout více součástí, knihovny nebo interní vrstvy, jak ukazuje obrázek 4-1.</span><span class="sxs-lookup"><span data-stu-id="75899-113">You can include multiple components, libraries, or internal layers in each container, as illustrated in Figure 4-1.</span></span> <span data-ttu-id="75899-114">Však může tento vzor monolitický konfliktu se zásadou kontejneru "kontejner nemá jednou z věcí a nemá v jednom procesu", ale může být v některých případech ok.</span><span class="sxs-lookup"><span data-stu-id="75899-114">However, this monolithic pattern might conflict with the container principle “a container does one thing, and does it in one process”, but might be ok for some cases.</span></span>

<span data-ttu-id="75899-115">Nevýhodou tohoto přístupu bude zřejmé, pokud aplikace roste, vyžadování ji škálovat.</span><span class="sxs-lookup"><span data-stu-id="75899-115">The downside of this approach becomes evident if the application grows, requiring it to scale.</span></span> <span data-ttu-id="75899-116">Pokud bude celá aplikace můžete použít škálování, není skutečně problém.</span><span class="sxs-lookup"><span data-stu-id="75899-116">If the entire application can scale, it is not really a problem.</span></span> <span data-ttu-id="75899-117">Ve většině případů jsou několika částí aplikace potlačení body, že vyžadování škálování, zatímco ostatní součásti jsou používá menší.</span><span class="sxs-lookup"><span data-stu-id="75899-117">However, in most cases, just a few parts of the application are the choke points that requiring scaling, while other components are used less.</span></span>

<span data-ttu-id="75899-118">Například v aplikaci typické elektronické obchodování, je pravděpodobně potřeba škálování subsystému informace o produktu, protože mnoho zákazníků další Procházet produkty než jejich zakoupení.</span><span class="sxs-lookup"><span data-stu-id="75899-118">For example, in a typical e-commerce application, you likely need to scale the product information subsystem, because many more customers browse products than purchase them.</span></span> <span data-ttu-id="75899-119">Další zákazníci využívat nákupního košíku než použití kanálu platba.</span><span class="sxs-lookup"><span data-stu-id="75899-119">More customers use their basket than use the payment pipeline.</span></span> <span data-ttu-id="75899-120">Méně zákazníky přidání komentářů nebo zobrazit historii jejich nákupu.</span><span class="sxs-lookup"><span data-stu-id="75899-120">Fewer customers add comments or view their purchase history.</span></span> <span data-ttu-id="75899-121">A může mít jen někteří z nich zaměstnancům, kteří potřebují spravovat obsah a marketingové kampaně.</span><span class="sxs-lookup"><span data-stu-id="75899-121">And you might have only a handful of employees, that need to manage the content and marketing campaigns.</span></span> <span data-ttu-id="75899-122">Pokud je škálovat monolitický návrhu, všechny kód pro tyto různé úlohy je nasadit více než jednou a škálovat na stejné úrovni.</span><span class="sxs-lookup"><span data-stu-id="75899-122">If you scale the monolithic design, all the code for these different tasks is deployed multiple times and scaled at the same grade.</span></span>

<span data-ttu-id="75899-123">Existuje více způsobů škálování aplikace – duplikaci vodorovné rozdělení různé oblasti aplikace a rozdělení podobné koncepty firmy nebo data.</span><span class="sxs-lookup"><span data-stu-id="75899-123">There are multiple ways to scale an application—horizontal duplication, splitting different areas of the application, and partitioning similar business concepts or data.</span></span> <span data-ttu-id="75899-124">Ale kromě problém škálování všechny součásti, změny jedinou komponentu vyžadují opětovném dokončení testování v celé aplikaci a dokončení opětovného nasazení všech instancí.</span><span class="sxs-lookup"><span data-stu-id="75899-124">But, in addition to the problem of scaling all components, changes to a single component require complete retesting of the entire application, and a complete redeployment of all the instances.</span></span>

<span data-ttu-id="75899-125">Monolitický přístup je však běžné, protože je původně jednodušší než mikroslužeb přístupy vývoje aplikace.</span><span class="sxs-lookup"><span data-stu-id="75899-125">However, the monolithic approach is common, because the development of the application is initially easier than for microservices approaches.</span></span> <span data-ttu-id="75899-126">Mnoho organizací vyvíjet proto tento architektury přístup.</span><span class="sxs-lookup"><span data-stu-id="75899-126">Thus, many organizations develop using this architectural approach.</span></span> <span data-ttu-id="75899-127">Když některé organizace mají vhodné měl dostatek výsledky, ostatní nedosáhli limitů.</span><span class="sxs-lookup"><span data-stu-id="75899-127">While some organizations have had good enough results, others are hitting limits.</span></span> <span data-ttu-id="75899-128">Mnoho organizací určené svých aplikací pomocí tohoto modelu, protože nástroje a infrastruktura provedené příliš složité, vytvoření služby zaměřené na konkrétní architektury (SOA) lety a nenalezli potřeba – dokud vzrostla aplikace.</span><span class="sxs-lookup"><span data-stu-id="75899-128">Many organizations designed their applications using this model because tools and infrastructure made it too difficult to build service oriented architectures (SOA) years ago, and they did not see the need—until the application grew.</span></span>

<span data-ttu-id="75899-129">Z hlediska služby infrastruktury každý server můžete spustit mnoho aplikací v rámci stejného hostitele a mají přijatelné poměr efektivitu využití prostředků, jak je znázorněno na obrázku 4-2.</span><span class="sxs-lookup"><span data-stu-id="75899-129">From an infrastructure perspective, each server can run many applications within the same host and have an acceptable ratio of efficiency in resources usage, as shown in Figure 4-2.</span></span>

![](./media/image2.png)

<span data-ttu-id="75899-130">**Obrázek 4-2**.</span><span class="sxs-lookup"><span data-stu-id="75899-130">**Figure 4-2**.</span></span> <span data-ttu-id="75899-131">Monolitický přístup: hostitele spuštěných víc aplikací, každou aplikaci spuštěnou jako kontejner</span><span class="sxs-lookup"><span data-stu-id="75899-131">Monolithic approach: Host running multiple apps, each app running as a container</span></span>

<span data-ttu-id="75899-132">Monolitický aplikací v Microsoft Azure se dá nasadit pomocí vyhrazených virtuálních počítačích pro každou instanci.</span><span class="sxs-lookup"><span data-stu-id="75899-132">Monolithic applications in Microsoft Azure can be deployed using dedicated VMs for each instance.</span></span> <span data-ttu-id="75899-133">Kromě toho používání [škálovatelné sady virtuálních počítačů Azure](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), je možné snadno škálovat virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="75899-133">Additionally, using [Azure VM Scale Sets](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), you can easily scale the VMs.</span></span> <span data-ttu-id="75899-134">[Aplikační služba Azure](https://azure.microsoft.com/services/app-service/) můžete také spouštět monolitický aplikace a snadno škálovat instance, aniž by bylo nutné ke správě virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="75899-134">[Azure App Service](https://azure.microsoft.com/services/app-service/) can also run monolithic applications and easily scale instances without requiring you to manage the VMs.</span></span> <span data-ttu-id="75899-135">Od 2016 můžete Azure App Services spustit jedné instance Docker kontejnery také, což výrazně zjednodušuje nasazování.</span><span class="sxs-lookup"><span data-stu-id="75899-135">Since 2016, Azure App Services can run single instances of Docker containers as well, simplifying deployment.</span></span>

<span data-ttu-id="75899-136">Jako prostředí QA nebo omezeném produkčním prostředí můžete nasadit více Docker hostitele virtuálních počítačů a vyvážení pomocí Azure vyrovnávání, jak je uvedené v obrázek 4-3.</span><span class="sxs-lookup"><span data-stu-id="75899-136">As a QA environment or a limited production environment, you can deploy multiple Docker host VMs and balance them using the Azure balancer, as shown in Figure 4-3.</span></span> <span data-ttu-id="75899-137">To vám umožní spravovat škálování s hrubým intervalem přístup, protože celou aplikaci obsažen v jednom kontejneru.</span><span class="sxs-lookup"><span data-stu-id="75899-137">This lets you manage scaling with a coarse-grain approach, because the whole application lives within a single container.</span></span>

![](./media/image3.png)

<span data-ttu-id="75899-138">**Obrázek 4-3**.</span><span class="sxs-lookup"><span data-stu-id="75899-138">**Figure 4-3**.</span></span> <span data-ttu-id="75899-139">Příklad více hostitelů vertikálním navýšení kapacity aplikace jediný kontejner</span><span class="sxs-lookup"><span data-stu-id="75899-139">Example of multiple hosts scaling up a single container application</span></span>

<span data-ttu-id="75899-140">Nasazení na různých hostitelích lze spravovat pomocí techniky tradiční nasazení.</span><span class="sxs-lookup"><span data-stu-id="75899-140">Deployment to the various hosts can be managed with traditional deployment techniques.</span></span> <span data-ttu-id="75899-141">Hostitelů docker lze spravovat pomocí příkazů jako `docker run` nebo `docker-compose` provést ručně, nebo prostřednictvím automatizace například kanály nastavené průběžné doručování (CD).</span><span class="sxs-lookup"><span data-stu-id="75899-141">Docker hosts can be managed with commands like `docker run` or `docker-compose` performed manually, or through automation such as continuous delivery (CD) pipelines.</span></span>

## <a name="deploying-a-monolithic-application-as-a-container"></a><span data-ttu-id="75899-142">Nasazení monolitický aplikace jako kontejner</span><span class="sxs-lookup"><span data-stu-id="75899-142">Deploying a monolithic application as a container</span></span>

<span data-ttu-id="75899-143">Existují výhody použití kontejnerů ke správě nasazení monolitický aplikací.</span><span class="sxs-lookup"><span data-stu-id="75899-143">There are benefits to using containers to manage monolithic application deployments.</span></span> <span data-ttu-id="75899-144">Změna velikosti kontejner instancí je mnohem rychlejší a snadnější než nasazení dalších virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="75899-144">Scaling container instances is far faster and easier than deploying additional VMs.</span></span> <span data-ttu-id="75899-145">I když používáte škálovatelné sady virtuálních počítačů, virtuálních počítačů trvat dobu spuštění.</span><span class="sxs-lookup"><span data-stu-id="75899-145">Even if you use VM Scale Sets, VMs take time to start.</span></span> <span data-ttu-id="75899-146">Při nasazení jako instancemi tradiční aplikace místo kontejnery, konfigurace aplikace je spravovaná v rámci virtuálního počítače, což není ideální.</span><span class="sxs-lookup"><span data-stu-id="75899-146">When deployed as traditional application instances instead of containers, the configuration of the application is managed as part of the VM, which is not ideal.</span></span>

<span data-ttu-id="75899-147">Nasazení aktualizací, jako je mnohem rychlejší imagí Dockeru a efektivní sítě.</span><span class="sxs-lookup"><span data-stu-id="75899-147">Deploying updates as Docker images is far faster and network efficient.</span></span> <span data-ttu-id="75899-148">Imagí dockeru obvykle spustit v sekundách, tím se urychlí zavedení uživatelům.</span><span class="sxs-lookup"><span data-stu-id="75899-148">Docker images typically start in seconds, which speeds rollouts.</span></span> <span data-ttu-id="75899-149">Zrušení do instance Docker bitové kopie je stejně snadná jako vystavování `docker stop` příkazů a obvykle se dokončí za méně než jedna sekunda.</span><span class="sxs-lookup"><span data-stu-id="75899-149">Tearing down a Docker image instance is as easy as issuing a `docker stop` command, and typically completes in less than a second.</span></span>

<span data-ttu-id="75899-150">Protože kontejnery jsou neměnné záměrné, budete muset nikdy starat o poškozená virtuálních počítačů.</span><span class="sxs-lookup"><span data-stu-id="75899-150">Because containers are immutable by design, you never need to worry about corrupted VMs.</span></span> <span data-ttu-id="75899-151">Naproti tomu skriptů pro aktualizaci pro virtuální počítač může nezapomněli účet pro některé specifické konfigurace nebo soubor místu na disku.</span><span class="sxs-lookup"><span data-stu-id="75899-151">In contrast, update scripts for a VM might forget to account for some specific configuration or file left on disk.</span></span>

<span data-ttu-id="75899-152">Při monolitický aplikace, můžete využít Docker, jsou dotykové ovládání pouze na výhody.</span><span class="sxs-lookup"><span data-stu-id="75899-152">While monolithic applications can benefit from Docker, we are touching only on the benefits.</span></span> <span data-ttu-id="75899-153">Další výhody správy kontejnerů pocházet z nasazení s orchestrators kontejneru, které spravovat různé instance a životního cyklu jednotlivých instancí kontejneru.</span><span class="sxs-lookup"><span data-stu-id="75899-153">Additional benefits of managing containers come from deploying with container orchestrators, which manage the various instances and lifecycle of each container instance.</span></span> <span data-ttu-id="75899-154">Rozdělení monolitický aplikaci do subsystémy, které můžete škálovat, vyvinuté a nasadit jednotlivě je vašim vstupním bodem do sféru mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="75899-154">Breaking up the monolithic application into subsystems that can be scaled, developed, and deployed individually is your entry point into the realm of microservices.</span></span>

## <a name="publishing-a-single-container-based-application-to-azure-app-service"></a><span data-ttu-id="75899-155">Publikování aplikace na základě jednoho kontejneru do služby Azure App Service</span><span class="sxs-lookup"><span data-stu-id="75899-155">Publishing a single-container-based application to Azure App Service</span></span>

<span data-ttu-id="75899-156">Jestli chcete získat ověření kontejner nasadí do Azure nebo pokud aplikace je jednoduše jedním kontejnerem aplikace, služby Azure App Service nabízí skvělý způsob, jak poskytnout škálovatelných služeb na základě jednoho kontejneru.</span><span class="sxs-lookup"><span data-stu-id="75899-156">Whether you want to get validation of a container deployed to Azure or when an application is simply a single-container application, Azure App Service provides a great way to provide scalable single-container-based services.</span></span> <span data-ttu-id="75899-157">Pomocí služby Azure App Service je jednoduché.</span><span class="sxs-lookup"><span data-stu-id="75899-157">Using Azure App Service is simple.</span></span> <span data-ttu-id="75899-158">Nabízí skvělý integrace s Gitem snadno využít kódu, sestavení v sadě Visual Studio a nasadit přímo do Azure.</span><span class="sxs-lookup"><span data-stu-id="75899-158">It provides great integration with Git to make it easy to take your code, build it in Visual Studio, and deploy it directly to Azure.</span></span>

![](./media/image4.png)

<span data-ttu-id="75899-159">**Obrázek 4 – 4**.</span><span class="sxs-lookup"><span data-stu-id="75899-159">**Figure 4-4**.</span></span> <span data-ttu-id="75899-160">Publikování jedním kontejneru aplikace do služby Azure App Service ze sady Visual Studio</span><span class="sxs-lookup"><span data-stu-id="75899-160">Publishing a single-container application to Azure App Service from Visual Studio</span></span>

<span data-ttu-id="75899-161">Bez Docker v případě potřeby další možnosti, architektury nebo závislosti, které nejsou podporovány v Azure App Service, museli jste Počkejte, dokud tým Azure aktualizovat tyto závislosti ve službě App Service.</span><span class="sxs-lookup"><span data-stu-id="75899-161">Without Docker, if you needed other capabilities, frameworks, or dependencies that are not supported in Azure App Service, you had to wait until the Azure team updated those dependencies in App Service.</span></span> <span data-ttu-id="75899-162">Nebo jste museli přepnout na další služby, jako je Azure Service Fabric, Azure Cloud Services nebo i virtuální počítače, kde jste měli další ovládací prvek a můžete nainstalovat požadovanou součást nebo framework pro vaši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="75899-162">Or you had to switch to other services like Azure Service Fabric, Azure Cloud Services, or even VMs, where you had further control and you could install a required component or framework for your application.</span></span>

<span data-ttu-id="75899-163">Podpora kontejnerů v Visual Studio 2017 vám dává možnost zahrnout všechno ve vašem prostředí aplikace, jak je znázorněno na obrázku 4-4.</span><span class="sxs-lookup"><span data-stu-id="75899-163">Container support in Visual Studio 2017 gives you the ability to include whatever you want in your application environment, as shown in Figure 4-4.</span></span> <span data-ttu-id="75899-164">Vzhledem k tomu, že spustíte ji v kontejneru, je-li přidat závislost do vaší aplikace, můžete zahrnout závislost soubor Docker nebo Docker image.</span><span class="sxs-lookup"><span data-stu-id="75899-164">Since you are running it in a container, if you add a dependency to your application, you can include the dependency in your Dockerfile or Docker image.</span></span>

<span data-ttu-id="75899-165">Jak je také uvedené na obrázku 4-4 doručí toku publikovat bitovou kopii prostřednictvím registru kontejneru.</span><span class="sxs-lookup"><span data-stu-id="75899-165">As also shown in Figure 4-4, the publish flow pushes an image through a container registry.</span></span> <span data-ttu-id="75899-166">To může být Azure registru kontejneru (registru zavřete pro vaše nasazení v Azure a zabezpečené účty a skupiny Azure Active Directory), nebo jakékoli jiné Docker registru jako úložiště Docker Hub nebo místní registru.</span><span class="sxs-lookup"><span data-stu-id="75899-166">This can be the Azure Container Registry (a registry close to your deployments in Azure and secured by Azure Active Directory groups and accounts), or any other Docker registry, like Docker Hub or an on-premises registry.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="75899-167">[Předchozí] (index.md) [Další] (docker-application-state-data.md)</span><span class="sxs-lookup"><span data-stu-id="75899-167">[Previous] (index.md) [Next] (docker-application-state-data.md)</span></span>
