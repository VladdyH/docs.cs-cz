---
title: Svrchovanost dat v jednotlivých mikroslužbách
description: Architektura Mikroslužeb .NET pro Kontejnerizované aplikace .NET | Svrchovanost dat v jednotlivých mikroslužbách
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.openlocfilehash: 6a3fc0e86de673fea5f8e81c14c6456a2256aaa6
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 09/04/2018
ms.locfileid: "43502174"
---
# <a name="data-sovereignty-per-microservice"></a><span data-ttu-id="2aee3-103">Svrchovanost dat v jednotlivých mikroslužbách</span><span class="sxs-lookup"><span data-stu-id="2aee3-103">Data sovereignty per microservice</span></span>

<span data-ttu-id="2aee3-104">Pravidlo důležité pro architekturu mikroslužeb je, že každá mikroslužba musíte vlastnit jeho data domény a logiku.</span><span class="sxs-lookup"><span data-stu-id="2aee3-104">An important rule for microservices architecture is that each microservice must own its domain data and logic.</span></span> <span data-ttu-id="2aee3-105">Stejně jako úplné aplikace vlastní jeho logiku a data, takže musíte jednotlivých mikroslužeb vlastníkem jeho logiku a data v rámci samostatného životní cyklus, s nezávislé nasazení jednotlivých mikroslužbách.</span><span class="sxs-lookup"><span data-stu-id="2aee3-105">Just as a full application owns its logic and data, so must each microservice own its logic and data under an autonomous lifecycle, with independent deployment per microservice.</span></span>

<span data-ttu-id="2aee3-106">To znamená, že konceptuálního modelu domény se budou lišit mezi subsystémy nebo mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="2aee3-106">This means that the conceptual model of the domain will differ between subsystems or microservices.</span></span> <span data-ttu-id="2aee3-107">Vezměte v úvahu podnikové aplikace, kde aplikace vztahů se zákazníky (CRM) pro řízení, transakční nákupní subsystémy a Zákaznická podpora subsystémů každé volání na data a atributům entity jedinečné zákaznické a každá používá jiné Ohraničený kontext (BC).</span><span class="sxs-lookup"><span data-stu-id="2aee3-107">Consider enterprise applications, where customer relationship management (CRM) applications, transactional purchase subsystems, and customer support subsystems each call on unique customer entity attributes and data, and where each employs a different Bounded Context (BC).</span></span>

<span data-ttu-id="2aee3-108">Tato zásada je podobná [návrhu řízeného doménou (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design), kde každý [ohraničená kontextu](https://martinfowler.com/bliki/BoundedContext.html) nebo autonomní subsystému nebo služby musíte vlastnit jeho doménový model (data a logiku a chování).</span><span class="sxs-lookup"><span data-stu-id="2aee3-108">This principle is similar in [Domain-driven design (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design), where each [Bounded Context](https://martinfowler.com/bliki/BoundedContext.html) or autonomous subsystem or service must own its domain model (data plus logic and behavior).</span></span> <span data-ttu-id="2aee3-109">Každý kontext ohraničená DDD souvisí s jednu obchodní mikroslužeb (jednu nebo několik služeb).</span><span class="sxs-lookup"><span data-stu-id="2aee3-109">Each DDD Bounded Context correlates to one business microservice (one or several services).</span></span> <span data-ttu-id="2aee3-110">(Můžeme doplňovat tento bod o ohraničená kontextu vzoru v další části.)</span><span class="sxs-lookup"><span data-stu-id="2aee3-110">(We expand on this point about the Bounded Context pattern in the next section.)</span></span>

<span data-ttu-id="2aee3-111">Na druhé straně přístup tradiční (monolitické data) používaný v mnoha aplikacích je do centralizované databáze jedné nebo několika databází.</span><span class="sxs-lookup"><span data-stu-id="2aee3-111">On the other hand, the traditional (monolithic data) approach used in many applications is to have a single centralized database or just a few databases.</span></span> <span data-ttu-id="2aee3-112">To je často normalizované databáze SQL, který se používá pro celou aplikaci a všechny jeho vnitřní subsystémy, jak ukazuje obrázek 4 – 7.</span><span class="sxs-lookup"><span data-stu-id="2aee3-112">This is often a normalized SQL database that is used for the whole application and all its internal subsystems, as shown in Figure 4-7.</span></span>

![](./media/image7.png)

<span data-ttu-id="2aee3-113">**Obrázek 4 – 7**.</span><span class="sxs-lookup"><span data-stu-id="2aee3-113">**Figure 4-7**.</span></span> <span data-ttu-id="2aee3-114">Porovnání suverenita dat: monolitické databáze a mikroslužeb</span><span class="sxs-lookup"><span data-stu-id="2aee3-114">Data sovereignty comparison: monolithic database versus microservices</span></span>

<span data-ttu-id="2aee3-115">Centralizované databázi přístup zpočátku vypadá jednodušší a zdá se, že umožňují opakované použití entit v různé subsystémy, aby všechno, co konzistentní vzhledem k aplikacím.</span><span class="sxs-lookup"><span data-stu-id="2aee3-115">The centralized database approach initially looks simpler and seems to enable reuse of entities in different subsystems to make everything consistent.</span></span> <span data-ttu-id="2aee3-116">Ale ve skutečnosti je, že skončíte s velkou tabulkami, které slouží řada různé subsystémy a ve většině případů, které zahrnují atributy a sloupce, které nejsou potřebné.</span><span class="sxs-lookup"><span data-stu-id="2aee3-116">But the reality is you end up with huge tables that serve many different subsystems, and that include attributes and columns that are not needed in most cases.</span></span> <span data-ttu-id="2aee3-117">Je to jako pokusu použijte stejný fyzický mapu věnovat turistice krátký záznam pro pořízení automobilu jednodenní cesty a učení zeměpisné oblasti.</span><span class="sxs-lookup"><span data-stu-id="2aee3-117">It is like trying to use the same physical map for hiking a short trail, taking a day-long car trip, and learning geography.</span></span>

<span data-ttu-id="2aee3-118">Monolitické aplikace se obvykle jediné relační databáze má dvě důležité výhody: [transakce ACID](https://en.wikipedia.org/wiki/ACID) a jazyka SQL, obě práce ve všech tabulkách a data související s vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="2aee3-118">A monolithic application with typically a single relational database has two important benefits: [ACID transactions](https://en.wikipedia.org/wiki/ACID) and the SQL language, both working across all the tables and data related to your application.</span></span> <span data-ttu-id="2aee3-119">Tento přístup poskytuje způsob, jak snadno vytvořit dotaz, který kombinuje data z více tabulek.</span><span class="sxs-lookup"><span data-stu-id="2aee3-119">This approach provides a way to easily write a query that combines data from multiple tables.</span></span>

<span data-ttu-id="2aee3-120">Přístup k datům nebude však mnohem složitější, když přesunete na architekturu mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="2aee3-120">However, data access becomes much more complex when you move to a microservices architecture.</span></span> <span data-ttu-id="2aee3-121">Ale i v případě, že transakce ACID jde nebo by měl použít v rámci mikroslužeb nebo ohraničená kontextu, dat vlastněných touto jednotlivých mikroslužeb je privátní pro tento mikroslužeb a je přístupný pouze prostřednictvím jejího rozhraní API mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="2aee3-121">But even when ACID transactions can or should be used within a microservice or Bounded Context, the data owned by each microservice is private to that microservice and can only be accessed via its microservice API.</span></span> <span data-ttu-id="2aee3-122">Zapouzdření dat zajišťuje, že mikroslužby jsou volně propojené a můžete rozvíjet nezávisle na mezi sebou.</span><span class="sxs-lookup"><span data-stu-id="2aee3-122">Encapsulating the data ensures that the microservices are loosely coupled and can evolve independently of one another.</span></span> <span data-ttu-id="2aee3-123">Pokud několik služeb, které získávali přístup stejná data, by aktualizace schématu vyžadují koordinované aktualizace ke všem službám.</span><span class="sxs-lookup"><span data-stu-id="2aee3-123">If multiple services were accessing the same data, schema updates would require coordinated updates to all the services.</span></span> <span data-ttu-id="2aee3-124">To by narušil autonomie životního cyklu mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="2aee3-124">This would break the microservice lifecycle autonomy.</span></span> <span data-ttu-id="2aee3-125">Ale distribuovaných datových struktur znamená, že nemůžete provádět jednu transakci ACID napříč mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="2aee3-125">But distributed data structures mean that you cannot make a single ACID transaction across microservices.</span></span> <span data-ttu-id="2aee3-126">To zase znamená, že při obchodní proces zahrnuje více mikroslužeb je nutné použít konečné konzistence.</span><span class="sxs-lookup"><span data-stu-id="2aee3-126">This in turn means you must use eventual consistency when a business process spans multiple microservices.</span></span> <span data-ttu-id="2aee3-127">To je mnohem obtížnější než jednoduché spojení SQL; implementace Podobně mnoho dalších funkcí relační databáze nejsou k dispozici napříč několika mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="2aee3-127">This is much harder to implement than simple SQL joins; similarly, many other relational database features are not available across multiple microservices.</span></span>

<span data-ttu-id="2aee3-128">Když se ještě dál, různé mikroslužeb často používají různé *typy* databází.</span><span class="sxs-lookup"><span data-stu-id="2aee3-128">Going even further, different microservices often use different *kinds* of databases.</span></span> <span data-ttu-id="2aee3-129">Úložiště pro moderní aplikace a různé druhy dat procesu a relační databáze není vždy nejlepší volbou.</span><span class="sxs-lookup"><span data-stu-id="2aee3-129">Modern applications store and process diverse kinds of data, and a relational database is not always the best choice.</span></span> <span data-ttu-id="2aee3-130">Pro některé případy použití, může být databáze NoSQL, jako je Azure DocumentDB nebo MongoDB pohodlnější datový model a nabízí lepší výkon a škálovatelnost než databáze SQL jako SQL Server nebo databázi SQL Azure.</span><span class="sxs-lookup"><span data-stu-id="2aee3-130">For some use cases, a NoSQL database such as Azure DocumentDB or MongoDB might have a more convenient data model and offer better performance and scalability than a SQL database like SQL Server or Azure SQL Database.</span></span> <span data-ttu-id="2aee3-131">V ostatních případech je relační databáze stále nejlepším řešením.</span><span class="sxs-lookup"><span data-stu-id="2aee3-131">In other cases, a relational database is still the best approach.</span></span> <span data-ttu-id="2aee3-132">Proto založených na mikroslužbách aplikace často používají kombinaci databáze SQL a NoSQL, která se někdy označuje jako [polyglotické trvalosti](https://martinfowler.com/bliki/PolyglotPersistence.html) přístup.</span><span class="sxs-lookup"><span data-stu-id="2aee3-132">Therefore, microservices-based applications often use a mixture of SQL and NoSQL databases, which is sometimes called the [polyglot persistence](https://martinfowler.com/bliki/PolyglotPersistence.html) approach.</span></span>

<span data-ttu-id="2aee3-133">Dělené polyglot trvalé architektury pro ukládání dat má mnoho výhod.</span><span class="sxs-lookup"><span data-stu-id="2aee3-133">A partitioned, polyglot-persistent architecture for data storage has many benefits.</span></span> <span data-ttu-id="2aee3-134">Patří mezi ně volně propojených služeb a lepší výkon, škálovatelnost, náklady a možností správy.</span><span class="sxs-lookup"><span data-stu-id="2aee3-134">These include loosely coupled services and better performance, scalability, costs, and manageability.</span></span> <span data-ttu-id="2aee3-135">To může způsobovat některé běžné problémy správy distribuovaných dat jako vysvětlíme v "[identifikace hranic mezi modelem a doménou](#identifying-domain-model-boundaries-for-each-microservice)" dále v této kapitole.</span><span class="sxs-lookup"><span data-stu-id="2aee3-135">However, it can introduce some distributed data management challenges, as we will explain in “[Identifying domain-model boundaries](#identifying-domain-model-boundaries-for-each-microservice)” later in this chapter.</span></span>

## <a name="the-relationship-between-microservices-and-the-bounded-context-pattern"></a><span data-ttu-id="2aee3-136">Vztah mezi mikroslužbami a vzor ohraničená kontextu</span><span class="sxs-lookup"><span data-stu-id="2aee3-136">The relationship between microservices and the Bounded Context pattern</span></span>

<span data-ttu-id="2aee3-137">Koncept mikroslužeb je odvozen od [ohraničená kontextu (BC) vzor](https://martinfowler.com/bliki/BoundedContext.html) v [návrhu řízeného doménou (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design).</span><span class="sxs-lookup"><span data-stu-id="2aee3-137">The concept of microservice derives from the [Bounded Context (BC) pattern](https://martinfowler.com/bliki/BoundedContext.html) in [domain-driven design (DDD)](https://en.wikipedia.org/wiki/Domain-driven_design).</span></span> <span data-ttu-id="2aee3-138">DDD se zabývá velké modely jejich rozdělení do několika BCs a použití explicitní o jejich hranice.</span><span class="sxs-lookup"><span data-stu-id="2aee3-138">DDD deals with large models by dividing them into multiple BCs and being explicit about their boundaries.</span></span> <span data-ttu-id="2aee3-139">Každý BC musí mít svůj vlastní model a databázi. Každá mikroslužba podobně, vlastní související data.</span><span class="sxs-lookup"><span data-stu-id="2aee3-139">Each BC must have its own model and database; likewise, each microservice owns its related data.</span></span> <span data-ttu-id="2aee3-140">Kromě toho každá BC obvykle má svou vlastní [všudypřítomná jazyk](https://martinfowler.com/bliki/UbiquitousLanguage.html) ke komunikaci mezi vývojáři a odborníky na domény.</span><span class="sxs-lookup"><span data-stu-id="2aee3-140">In addition, each BC usually has its own [ubiquitous language](https://martinfowler.com/bliki/UbiquitousLanguage.html) to help communication between software developers and domain experts.</span></span>

<span data-ttu-id="2aee3-141">Tyto podmínky (hlavně domény entity) v jazyce všudypřítomná může mít různé názvy v různých kontextech ohraničená, i když jiné domény entity sdílejí stejnou identitu (to znamená, jedinečný Identifikátor, který slouží k načtení entity ze služby storage).</span><span class="sxs-lookup"><span data-stu-id="2aee3-141">Those terms (mainly domain entities) in the ubiquitous language can have different names in different Bounded Contexts, even when different domain entities share the same identity (that is, the unique ID that is used to read the entity from storage).</span></span> <span data-ttu-id="2aee3-142">Například v rámci ohraničená profil uživatele entita domény uživatele může nasdílet identity kupujících entita domény v rámci pořadí omezená.</span><span class="sxs-lookup"><span data-stu-id="2aee3-142">For instance, in a user-profile Bounded Context, the User domain entity might share identity with the Buyer domain entity in the ordering Bounded Context.</span></span>

<span data-ttu-id="2aee3-143">Mikroslužba je proto třeba ohraničená kontext, ale také určuje, že je distribuovaná služba.</span><span class="sxs-lookup"><span data-stu-id="2aee3-143">A microservice is therefore like a Bounded Context, but it also specifies that it is a distributed service.</span></span> <span data-ttu-id="2aee3-144">Je vytvořen jako samostatný proces pro jednotlivých ohraničených kontextech, a musí používat distribuované protokoly, které jste si poznamenali dříve, jako jsou HTTP/HTTPS, protokoly Websocket, nebo [AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol).</span><span class="sxs-lookup"><span data-stu-id="2aee3-144">It is built as a separate process for each Bounded Context, and it must use the distributed protocols noted earlier, like HTTP/HTTPS, WebSockets, or [AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol).</span></span> <span data-ttu-id="2aee3-145">Vzor ohraničená kontextu, ale neurčuje, zda je kontext ohraničená distribuované služby nebo pokud je jednoduše logické hraniční (například obecný subsystému) v rámci monolitické nasazení aplikace.</span><span class="sxs-lookup"><span data-stu-id="2aee3-145">The Bounded Context pattern, however, does not specify whether the Bounded Context is a distributed service or if it is simply a logical boundary (such as a generic subsystem) within a monolithic-deployment application.</span></span>

<span data-ttu-id="2aee3-146">Je důležité, abyste měli na očích, definování služby pro jednotlivých ohraničených kontextech je dobrým začátkem.</span><span class="sxs-lookup"><span data-stu-id="2aee3-146">It is important to highlight that defining a service for each Bounded Context is a good place to start.</span></span> <span data-ttu-id="2aee3-147">Ale nemáte k omezení návrhu na ni.</span><span class="sxs-lookup"><span data-stu-id="2aee3-147">But you do not have to constrain your design to it.</span></span> <span data-ttu-id="2aee3-148">Někdy je třeba navrhnout kontext ohraničená nebo obchodní mikroslužeb se skládá z několika fyzických služeb.</span><span class="sxs-lookup"><span data-stu-id="2aee3-148">Sometimes you must design a Bounded Context or business microservice composed of several physical services.</span></span> <span data-ttu-id="2aee3-149">Ale nakonec oba vzorky – omezená kontextu a mikroslužeb – úzce souvisejí.</span><span class="sxs-lookup"><span data-stu-id="2aee3-149">But ultimately, both patterns—Bounded Context and microservice—are closely related.</span></span>

<span data-ttu-id="2aee3-150">DDD těží z mikroslužeb tím, že získáme skutečné hranice ve formě distribuovaných mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="2aee3-150">DDD benefits from microservices by getting real boundaries in the form of distributed microservices.</span></span> <span data-ttu-id="2aee3-151">Ale nápady jako nesdílí modelu mezi mikroslužbami co chcete také v kontextu omezená.</span><span class="sxs-lookup"><span data-stu-id="2aee3-151">But ideas like not sharing the model between microservices are what you also want in a Bounded Context.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="2aee3-152">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="2aee3-152">Additional resources</span></span>

-   <span data-ttu-id="2aee3-153">**Chris Richardson. Vzor: Databáze na službu**
    [*https://microservices.io/patterns/data/database-per-service.html*](https://microservices.io/patterns/data/database-per-service.html)</span><span class="sxs-lookup"><span data-stu-id="2aee3-153">**Chris Richardson. Pattern: Database per service**
[*https://microservices.io/patterns/data/database-per-service.html*](https://microservices.io/patterns/data/database-per-service.html)</span></span>

-   <span data-ttu-id="2aee3-154">**Martina Fowlera. BoundedContext**
    [*https://martinfowler.com/bliki/BoundedContext.html*](https://martinfowler.com/bliki/BoundedContext.html)</span><span class="sxs-lookup"><span data-stu-id="2aee3-154">**Martin Fowler. BoundedContext**
[*https://martinfowler.com/bliki/BoundedContext.html*](https://martinfowler.com/bliki/BoundedContext.html)</span></span>

-   <span data-ttu-id="2aee3-155">**Martina Fowlera. PolyglotPersistence**
    [*https://martinfowler.com/bliki/PolyglotPersistence.html*](https://martinfowler.com/bliki/PolyglotPersistence.html)</span><span class="sxs-lookup"><span data-stu-id="2aee3-155">**Martin Fowler. PolyglotPersistence**
[*https://martinfowler.com/bliki/PolyglotPersistence.html*](https://martinfowler.com/bliki/PolyglotPersistence.html)</span></span>

-   <span data-ttu-id="2aee3-156">**Alberto Brandolini. Návrh s použitím kontextu mapování na základě strategické domény**
    [*https://www.infoq.com/articles/ddd-contextmapping*](https://www.infoq.com/articles/ddd-contextmapping)</span><span class="sxs-lookup"><span data-stu-id="2aee3-156">**Alberto Brandolini. Strategic Domain Driven Design with Context Mapping**
[*https://www.infoq.com/articles/ddd-contextmapping*](https://www.infoq.com/articles/ddd-contextmapping)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="2aee3-157">[Předchozí](microservices-architecture.md)
[další](logical-versus-physical-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="2aee3-157">[Previous](microservices-architecture.md)
[Next](logical-versus-physical-architecture.md)</span></span>
