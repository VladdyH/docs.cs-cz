---
title: "Asynchronní komunikaci na základě zpráv"
description: "Architektura Mikroslužeb .NET pro aplikace .NET Kontejnerizované | Asynchronní komunikaci na základě zpráv"
keywords: "Docker, Mikroslužeb, ASP.NET, kontejneru"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: ed0f12c5eca1ed45dabe94661f84216e07476ebd
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/23/2017
---
# <a name="asynchronous-message-based-communication"></a><span data-ttu-id="ddd5d-104">Asynchronní komunikaci na základě zpráv</span><span class="sxs-lookup"><span data-stu-id="ddd5d-104">Asynchronous message-based communication</span></span>

<span data-ttu-id="ddd5d-105">Asynchronní zasílání zpráv a komunikaci s událostmi řízené jsou důležité, pokud šíření změny napříč více mikroslužeb a modelu související domény.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-105">Asynchronous messaging and event-driven communication are critical when propagating changes across multiple microservices and their related domain models.</span></span> <span data-ttu-id="ddd5d-106">Jak je uvedeno výše v diskusi mikroslužeb a ohraničenou kontexty (BCs), může zahrnovat modely (uživatel, Zákazník, produktu, účtu atd.) na různých mikroslužeb nebo BCs různých věcí.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-106">As mentioned earlier in the discussion microservices and Bounded Contexts (BCs), models (User, Customer, Product, Account, etc.) can mean different things to different microservices or BCs.</span></span> <span data-ttu-id="ddd5d-107">To znamená, že při změnách, je nutné nějakým způsobem sloučit změny v různých modelech.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-107">That means that when changes occur, you need some way to reconcile changes across the different models.</span></span> <span data-ttu-id="ddd5d-108">Řešení je konzistence typu případné a komunikaci s událostmi řízené podle asynchronní zasílání zpráv.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-108">A solution is eventual consistency and event-driven communication based on asynchronous messaging.</span></span>

<span data-ttu-id="ddd5d-109">Pokud používáte zasílání zpráv, procesy komunikují nahrazením zprávy asynchronně.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-109">When using messaging, processes communicate by exchanging messages asynchronously.</span></span> <span data-ttu-id="ddd5d-110">Klient odešle příkaz nebo žádostí o služby odesláním zprávy.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-110">A client makes a command or a request to a service by sending it a message.</span></span> <span data-ttu-id="ddd5d-111">Pokud služba musí odpovědět, odešle zprávu různých zpět do klienta.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-111">If the service needs to reply, it sends a different message back to the client.</span></span> <span data-ttu-id="ddd5d-112">Vzhledem k tomu, že je komunikace na základě zprávy, klient předpokládá odpověď nebude možné přijímání okamžitě a že může být žádná odpověď na všech.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-112">Since it is a message-based communication, the client assumes that the reply will not be received immediately, and that there might be no response at all.</span></span>

<span data-ttu-id="ddd5d-113">Zprávu se skládá hlavičku (metadata jsou to například informace o identifikaci nebo zabezpečení) a text.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-113">A message is composed by a header (metadata such as identification or security information) and a body.</span></span> <span data-ttu-id="ddd5d-114">Zprávy jsou obvykle odesílány prostřednictvím asynchronní protokolů jako AMQP.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-114">Messages are usually sent through asynchronous protocols like AMQP.</span></span>

<span data-ttu-id="ddd5d-115">Upřednostňované infrastrukturu pro tento typ komunikace v komunitě mikroslužeb je zprostředkovatele lightweight zpráv, které se liší od velké zprostředkovatelé a orchestrators použít v SOA.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-115">The preferred infrastructure for this type of communication in the microservices community is a lightweight message broker, which is different than the large brokers and orchestrators used in SOA.</span></span> <span data-ttu-id="ddd5d-116">V broker lightweight zpráva je obvykle "vlečný," funguje pouze jako zprostředkovatele zpráv, s jednoduché implementace, jako je například RabbitMQ nebo škálovatelné služby service bus v cloudu jako Azure Service Bus infrastruktury.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-116">In a lightweight message broker, the infrastructure is typically “dumb,” acting only as a message broker, with simple implementations such as RabbitMQ or a scalable service bus in the cloud like Azure Service Bus.</span></span> <span data-ttu-id="ddd5d-117">V tomto scénáři většinu "smart" přemýšlení stále žije v koncových bodů, které jsou vytvoření a přijímat zprávy – to znamená, že v mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-117">In this scenario, most of the “smart” thinking still lives in the endpoints that are producing and consuming messages—that is, in the microservices.</span></span>

<span data-ttu-id="ddd5d-118">Jiné pravidlo, které byste měli postupovat podle, co nejvíce, je použít jenom asynchronní zasílání zpráv mezi interních služeb a použít synchronní komunikaci (jako je například HTTP) pouze z klientské aplikace front-endové služby (brány rozhraní API a první úroveň z mikroslužeb).</span><span class="sxs-lookup"><span data-stu-id="ddd5d-118">Another rule you should try to follow, as much as possible, is to use only asynchronous messaging between the internal services, and to use synchronous communication (such as HTTP) only from the client apps to the front-end services (API Gateways plus the first level of microservices).</span></span>

<span data-ttu-id="ddd5d-119">Existují dva druhy asynchronní komunikaci zasílání zpráv: komunikace na základě zpráv jednoho příjemce a komunikace na základě zpráv více příjemců.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-119">There are two kinds of asynchronous messaging communication: single receiver message-based communication, and multiple receivers message-based communication.</span></span> <span data-ttu-id="ddd5d-120">V následujících částech budeme obsahují podrobné informace o nich.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-120">In the following sections we provide details about them.</span></span>

## <a name="single-receiver-message-based-communication"></a><span data-ttu-id="ddd5d-121">Komunikace na základě zpráv jednoho příjemce</span><span class="sxs-lookup"><span data-stu-id="ddd5d-121">Single-receiver message-based communication</span></span> 

<span data-ttu-id="ddd5d-122">Na základě zpráv asynchronní komunikaci s jednoho příjemce znamená, že point-to-point komunikaci, která přináší zprávu právě jeden příjemce, který je čtení z tohoto kanálu, a zpráva se zpracuje jenom jednou.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-122">Message-based asynchronous communication with a single receiver means there is point-to-point communication that delivers a message to exactly one of the consumers that is reading from the channel, and that the message is processed just once.</span></span> <span data-ttu-id="ddd5d-123">Existují však zvláštní situace.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-123">However, there are special situations.</span></span> <span data-ttu-id="ddd5d-124">Například v cloudu systému, by se automaticky zotavit po selhání, stejná zpráva může odeslat vícekrát.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-124">For instance, in a cloud system that tries to automatically recover from failures, the same message could be sent multiple times.</span></span> <span data-ttu-id="ddd5d-125">Z důvodu sítě nebo jiné chyby klient má být schopni opakujte odesílání zpráv a server má implementovat určité operace idempotent aby bylo možné zpracovat zprávu konkrétní pouze jednou.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-125">Due to network or other failures, the client has to be able to retry sending messages, and the server has to implement an operation to be idempotent in order to process a particular message just once.</span></span>

<span data-ttu-id="ddd5d-126">Komunikace na základě zpráv jednoho příjemce je velmi dobře vhodné pro odesílání asynchronní příkazy z jednoho mikroslužbu do jiného jak je znázorněno v obrázek 4 až 18 ilustrující tento přístup.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-126">Single-receiver message-based communication is especially well suited for sending asynchronous commands from one microservice to another as shown in Figure 4-18 that illustrates this approach.</span></span>

<span data-ttu-id="ddd5d-127">Jakmile začnete odesílání na základě zpráv komunikace (buď pomocí příkazů nebo událostí), neměli byste kombinování komunikace na základě zpráv s synchronní komunikaci pomocí protokolu HTTP.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-127">Once you start sending message-based communication (either with commands or events), you should avoid mixing message-based communication with synchronous HTTP communication.</span></span>

![](./media/image18.PNG)

<span data-ttu-id="ddd5d-128">**Obrázek 4 až 18**.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-128">**Figure 4-18**.</span></span> <span data-ttu-id="ddd5d-129">Jeden mikroslužbu přijetí asynchronní zprávy</span><span class="sxs-lookup"><span data-stu-id="ddd5d-129">A single microservice receiving an asynchronous message</span></span>

<span data-ttu-id="ddd5d-130">Všimněte si, že pokud příkazy vycházejí z klientské aplikace, mohou být provedeny jako synchronní příkazy HTTP.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-130">Note that when the commands come from client applications, they can be implemented as HTTP synchronous commands.</span></span> <span data-ttu-id="ddd5d-131">Měli byste použít příkazy na základě zpráv, když potřebujete vyšší škálovatelnost, nebo pokud jste již v na základě zpráv obchodní proces.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-131">You should use message-based commands when you need higher scalability or when you are already in a message-based business process.</span></span>

## <a name="multiple-receivers-message-based-communication"></a><span data-ttu-id="ddd5d-132">Komunikace na základě zpráv více příjemců</span><span class="sxs-lookup"><span data-stu-id="ddd5d-132">Multiple-receivers message-based communication</span></span> 

<span data-ttu-id="ddd5d-133">Jako více flexibilní přístup můžete také chtít použít mechanismus publikování a přihlášení k odběru, tak, aby komunikaci od odesílatele, bude k dispozici další odběratele mikroslužeb nebo na externí aplikace.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-133">As a more flexible approach, you might also want to use a publish/subscribe mechanism so that your communication from the sender will be available to additional subscriber microservices or to external applications.</span></span> <span data-ttu-id="ddd5d-134">Proto, abyste postupovali podle pomáhá [otevřený nebo zavřený Princip](https://en.wikipedia.org/wiki/Open/closed_principle) ve službě odesílání.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-134">Thus, it helps you to follow the [open/closed principle](https://en.wikipedia.org/wiki/Open/closed_principle) in the sending service.</span></span> <span data-ttu-id="ddd5d-135">Tímto způsobem lze přidat další odběratele v budoucnu, aniž by bylo nutné upravit službu odesílatele.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-135">That way, additional subscribers can be added in the future without the need to modify the sender service.</span></span>

<span data-ttu-id="ddd5d-136">Pokud použijete komunikaci ve formě publikovat/odebírat, by mohla využívat rozhraní sběrnice událostí k publikování událostí pro všechny odběratele.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-136">When you use a publish/subscribe communication, you might be using an event bus interface to publish events to any subscriber.</span></span>

## <a name="asynchronous-event-driven-communication"></a><span data-ttu-id="ddd5d-137">Asynchronní komunikaci založeného na událostech</span><span class="sxs-lookup"><span data-stu-id="ddd5d-137">Asynchronous event-driven communication</span></span>

<span data-ttu-id="ddd5d-138">Při použití asynchronní komunikaci založeného na událostech, mikroslužbu publikuje integrace událost v případě, že se něco stane v jeho doméně a jiné mikroslužbu musí mít na paměti, jako je změna ceny v katalogu mikroslužbu produktu.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-138">When using asynchronous event-driven communication, a microservice publishes an integration event when something happens within its domain and another microservice needs to be aware of it, like a price change in a product catalog microservice.</span></span> <span data-ttu-id="ddd5d-139">Další mikroslužeb se přihlásit k odběru události, se může přijímat asynchronně.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-139">Additional microservices subscribe to the events so they can receive them asynchronously.</span></span> <span data-ttu-id="ddd5d-140">Pokud k tomu dojde, může aktualizovat příjemci své vlastní domény entity, které může způsobit další události integrace k publikování.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-140">When that happens, the receivers might update their own domain entities, which can cause more integration events to be published.</span></span> <span data-ttu-id="ddd5d-141">Tento systém publikování a přihlášení k odběru se obvykle provádí pomocí implementace sběrnici událostí.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-141">This publish/subscribe system is usually performed by using an implementation of an event bus.</span></span> <span data-ttu-id="ddd5d-142">Sběrnici událostí můžete navrhnout jako abstrakce nebo rozhraní s rozhraním API, který je potřebný k přihlášení k odběru nebo odhlášení odběru událostí a k publikování událostí.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-142">The event bus can be designed as an abstraction or interface, with the API that is needed to subscribe or unsubscribe to events and to publish events.</span></span> <span data-ttu-id="ddd5d-143">Sběrnici událost může mít jeden nebo více implementace založené na všechny meziprocesovou a zasílání zpráv broker, jako je zasílání zpráv fronty nebo služby service bus, která podporuje asynchronní komunikaci a model publikování a přihlášení k odběru.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-143">The event bus can also have one or more implementations based on any inter-process and messaging broker, like a messaging queue or service bus that supports asynchronous communication and a publish/subscribe model.</span></span>

<span data-ttu-id="ddd5d-144">Pokud systém využívá konzistence typu případné doprovází události integrace, se doporučuje, aby tento postup provést úplně vymazat pro koncového uživatele.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-144">If a system uses eventual consistency driven by integration events, it is recommended that this approach be made completely clear to the end user.</span></span> <span data-ttu-id="ddd5d-145">Systém neměli používat přístup, která napodobuje události integrace, jako je SignalR nebo systémy dotazování z klienta.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-145">The system should not use an approach that mimics integration events, like SignalR or polling systems from the client.</span></span> <span data-ttu-id="ddd5d-146">Koncový uživatel a majitel firmy musí explicitně zapojení konzistence typu případné v systému a Uvědomte si, že v mnoha případech firmy nemá jakýkoli problém s tímto přístupem, dokud je explicitní.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-146">The end user and the business owner have to explicitly embrace eventual consistency in the system and realize that in many cases the business does not have any problem with this approach, as long as it is explicit.</span></span>

<span data-ttu-id="ddd5d-147">Jak jsme uvedli výše [problémy a řešení pro správu dat distribuované](#challenges-and-solutions-for-distributed-data-management) části události integrace můžete použít k implementaci pracovní úkoly, které jsou rozmístěny v několika mikroslužeb.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-147">As noted earlier in the [Challenges and solutions for distributed data management](#challenges-and-solutions-for-distributed-data-management) section, you can use integration events to implement business tasks that span multiple microservices.</span></span> <span data-ttu-id="ddd5d-148">Proto bude mít konzistence typu případné mezi tyto služby.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-148">Thus you will have eventual consistency between those services.</span></span> <span data-ttu-id="ddd5d-149">Nakonec byl konzistentní transakce se skládá z kolekce distribuované akce.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-149">An eventually consistent transaction is made up of a collection of distributed actions.</span></span> <span data-ttu-id="ddd5d-150">Na každou akci související mikroslužbu aktualizuje entita domény a publikuje jiný integrace událost, která vyvolá další akce v rámci stejné úlohy obchodní začátku do konce.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-150">At each action, the related microservice updates a domain entity and publishes another integration event that raises the next action within the same end-to-end business task.</span></span>

<span data-ttu-id="ddd5d-151">Důležité je, že můžete chtít komunikovat s více mikroslužeb, která se připojila ke stejné události.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-151">An important point is that you might want to communicate to multiple microservices that are subscribed to the same event.</span></span> <span data-ttu-id="ddd5d-152">V takovém případě můžete publikovat/odebírat zasílání zpráv na základě událostmi řízené komunikaci, jak ukazuje obrázek 4-19.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-152">To do so, you can use publish/subscribe messaging based on event-driven communication, as shown in Figure 4-19.</span></span> <span data-ttu-id="ddd5d-153">Tento mechanismus publikování/přihlášení k odběru není výhradně pro architektury mikroslužby.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-153">This publish/subscribe mechanism is not exclusive to the microservice architecture.</span></span> <span data-ttu-id="ddd5d-154">Je podobně jako [ohraničenou kontexty](http://martinfowler.com/bliki/BoundedContext.html) v DDD musí komunikovat, nebo jako rozšířit aktualizace z databáze zápis do čtení databáze v [příkazů a dotazů odpovědnost oddělení (CQRS)](http://martinfowler.com/bliki/CQRS.html)architektura vzor.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-154">It is similar to the way [Bounded Contexts](http://martinfowler.com/bliki/BoundedContext.html) in DDD should communicate, or to the way you propagate updates from the write database to the read database in the [Command and Query Responsibility Segregation (CQRS)](http://martinfowler.com/bliki/CQRS.html) architecture pattern.</span></span> <span data-ttu-id="ddd5d-155">Cílem je mít konzistence typu případné mezi více zdrojů dat napříč distribuovaného systému.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-155">The goal is to have eventual consistency between multiple data sources across your distributed system.</span></span>

![](./media/image19.png)

<span data-ttu-id="ddd5d-156">**Obrázek 4-19**.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-156">**Figure 4-19**.</span></span> <span data-ttu-id="ddd5d-157">Komunikace asynchronní zprávu založeného na událostech</span><span class="sxs-lookup"><span data-stu-id="ddd5d-157">Asynchronous event-driven message communication</span></span>

<span data-ttu-id="ddd5d-158">Implementace určí, co Pokud chcete použít pro komunikaci s událostmi, na základě zpráv protokolu.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-158">Your implementation will determine what protocol to use for event-driven, message-based communications.</span></span> <span data-ttu-id="ddd5d-159">[AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol) může pomoci dosáhnout spolehlivé komunikace ve frontě.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-159">[AMQP](https://en.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol) can help achieve reliable queued communication.</span></span>

<span data-ttu-id="ddd5d-160">Pokud používáte sběrnici událostí, můžete chtít použít úroveň abstrakce (např. událost sběrnice rozhraní), podle související implementace v třídách s kódem pomocí rozhraní API z zprostředkovatele zpráv jako [RabbitMQ](https://www.rabbitmq.com/) nebo sběrnici služby jako [Azure Service Bus s tématy](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span><span class="sxs-lookup"><span data-stu-id="ddd5d-160">When you use an event bus, you might want to use an abstraction level (like an event bus interface) based on a related implementation in classes with code using the API from a message broker like [RabbitMQ](https://www.rabbitmq.com/) or a service bus like [Azure Service Bus with Topics](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span></span> <span data-ttu-id="ddd5d-161">Alternativně můžete chtít použít vyšší úrovně služby service bus jako NServiceBus, MassTransit nebo Brighter a vyjádřete vaše události sběrnice publikování a přihlášení k odběru systému.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-161">Alternatively, you might want to use a higher-level service bus like NServiceBus, MassTransit, or Brighter to articulate your event bus and publish/subscribe system.</span></span>

## <a name="a-note-about-messaging-technologies-for-production-systems"></a><span data-ttu-id="ddd5d-162">Poznámka o zasílání zpráv technologie pro produkční systémy.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-162">A note about messaging technologies for production systems</span></span>

<span data-ttu-id="ddd5d-163">Zasílání zpráv technologie, které jsou k dispozici pro implementace sběrnice vaší abstraktní událostí jsou na různých úrovních.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-163">The messaging technologies available for implementing your abstract event bus are at different levels.</span></span> <span data-ttu-id="ddd5d-164">Například produktů, třeba RabbitMQ (zasílání zpráv zprostředkovatele doprava) a Azure Service Bus nacházejí na nižší úrovni než jiné produkty, jako je NServiceBus, MassTransit nebo Brighter, které můžete pracovat nad RabbitMQ a Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-164">For instance, products like RabbitMQ (a messaging broker transport) and Azure Service Bus sit at a lower level than other products like, NServiceBus, MassTransit, or Brighter, which can work on top of RabbitMQ and Azure Service Bus.</span></span> <span data-ttu-id="ddd5d-165">Výběr závisí na tom, kolik bohaté funkce na úrovni aplikace a out-of-the-box škálovatelnost, potřebnou pro vaši aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-165">Your choice depends on how many rich features at the application level and out-of-the-box scalability you need for your application.</span></span> <span data-ttu-id="ddd5d-166">Pro implementaci právě událost testování konceptu sběrnice pro vývojové prostředí, jak je uvedeno v ukázce eShopOnContainers v jednoduché implementace nad RabbitMQ systémem kontejner Docker může být dost.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-166">For implementing just a proof-of-concept event bus for your development environment, as we have done in the eShopOnContainers sample, a simple implementation on top of RabbitMQ running on a Docker container might be enough.</span></span>

<span data-ttu-id="ddd5d-167">Ale pro kritické a produkční systémy, které je třeba hyper škálovatelnost, můžete vyhodnotit Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-167">However, for mission-critical and production systems that need hyper-scalability, you might want to evaluate Azure Service Bus.</span></span> <span data-ttu-id="ddd5d-168">Vysoké úrovni abstrakce a funkce, které usnadňují vývoj distribuovaných aplikací doporučujeme vyhodnotit jiné sběrnice služby komerční a open source, například NServiceBus, MassTransit a Brighter.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-168">For high-level abstractions and features that make the development of distributed applications easier, we recommend that you evaluate other commercial and open-source service buses, such as NServiceBus, MassTransit, and Brighter.</span></span> <span data-ttu-id="ddd5d-169">Samozřejmě můžete vytvořit vlastní funkce služby service bus na nižší úrovni technologie, jako je RabbitMQ a Docker.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-169">Of course, you can build your own service-bus features on top of lower-level technologies like RabbitMQ and Docker.</span></span> <span data-ttu-id="ddd5d-170">Ale které pracují vložení může náklady příliš mnoho pro vlastní podnikovou aplikaci.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-170">But that plumbing work might cost too much for a custom enterprise application.</span></span>

## <a name="resiliently-publishing-to-the-event-bus"></a><span data-ttu-id="ddd5d-171">Pružným způsobem publikování ke sběrnici událostí</span><span class="sxs-lookup"><span data-stu-id="ddd5d-171">Resiliently publishing to the event bus</span></span>

<span data-ttu-id="ddd5d-172">Výzvy při implementaci architekturu událostmi řízené napříč více mikroslužeb je postup atomicky aktualizace stavu v původní mikroslužbu při pružným způsobem publikování do sběrnici událostí nějakým způsobem na základě jeho událost související integrace transakce.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-172">A challenge when implementing an event-driven architecture across multiple microservices is how to atomically update state in the original microservice while resiliently publishing its related integration event into the event bus, somehow based on transactions.</span></span> <span data-ttu-id="ddd5d-173">Tady uvádíme několik způsobů, jak dosáhnout, i když může být také další přístupy.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-173">The following are a few ways to accomplish this, although there could be additional approaches as well.</span></span>

-   <span data-ttu-id="ddd5d-174">Použití transakcí (DTC na základě) fronty jako služby MSMQ.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-174">Using a transactional (DTC-based) queue like MSMQ.</span></span> <span data-ttu-id="ddd5d-175">(Je to ale starší verze přístup.)</span><span class="sxs-lookup"><span data-stu-id="ddd5d-175">(However, this is a legacy approach.)</span></span>

-   <span data-ttu-id="ddd5d-176">Pomocí [transakce protokolu dolování](http://www.scoop.it/t/sql-server-transaction-log-mining).</span><span class="sxs-lookup"><span data-stu-id="ddd5d-176">Using [transaction log mining](http://www.scoop.it/t/sql-server-transaction-log-mining).</span></span>

-   <span data-ttu-id="ddd5d-177">Pomocí úplného [Sourcing událostí](https://msdn.microsoft.com/en-us/library/dn589792.aspx) vzor.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-177">Using full [Event Sourcing](https://msdn.microsoft.com/en-us/library/dn589792.aspx) pattern.</span></span>

-   <span data-ttu-id="ddd5d-178">Pomocí [pošta k odeslání vzoru](http://gistlabs.com/2014/05/the-outbox/): transakční databázové tabulky jako fronta zpráv, které se bude základ pro komponentu creator událost, která by vytvoření události a jeho publikování.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-178">Using the [Outbox pattern](http://gistlabs.com/2014/05/the-outbox/): a transactional database table as a message queue that will be the base for an event-creator component that would create the event and publish it.</span></span>

<span data-ttu-id="ddd5d-179">Další témata vzít v úvahu při použití asynchronní komunikaci jsou zprávy idempotenci a odstranění duplicitních zpráv.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-179">Additional topics to consider when using asynchronous communication are message idempotence and message deduplication.</span></span> <span data-ttu-id="ddd5d-180">Tato témata jsou popsané v části [implementace založené na události komunikace mezi mikroslužeb (události integrace)](#implementing_event_based_comms_microserv) dál v této příručce.</span><span class="sxs-lookup"><span data-stu-id="ddd5d-180">These topics are covered in the section [Implementing event-based communication between microservices (integration events)](#implementing_event_based_comms_microserv) later in this guide.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="ddd5d-181">Další zdroje</span><span class="sxs-lookup"><span data-stu-id="ddd5d-181">Additional resources</span></span>

-   <span data-ttu-id="ddd5d-182">**Řízené zasílání zpráv událostí**
    [*http://soapatterns.org/design\_vzory/událost\_řízené\_zasílání zpráv*](http://soapatterns.org/design_patterns/event_driven_messaging)</span><span class="sxs-lookup"><span data-stu-id="ddd5d-182">**Event Driven Messaging**
[*http://soapatterns.org/design\_patterns/event\_driven\_messaging*](http://soapatterns.org/design_patterns/event_driven_messaging)</span></span>

-   <span data-ttu-id="ddd5d-183">**Publikování a přihlášení k odběru kanálu**
    [*http://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html*](http://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html)</span><span class="sxs-lookup"><span data-stu-id="ddd5d-183">**Publish/Subscribe Channel**
[*http://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html*](http://www.enterpriseintegrationpatterns.com/patterns/messaging/PublishSubscribeChannel.html)</span></span>

-   <span data-ttu-id="ddd5d-184">**UDI Dahan. Vyjasněno, CQRS**
    [*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span><span class="sxs-lookup"><span data-stu-id="ddd5d-184">**Udi Dahan. Clarified CQRS**
[*http://udidahan.com/2009/12/09/clarified-cqrs/*](http://udidahan.com/2009/12/09/clarified-cqrs/)</span></span>

-   <span data-ttu-id="ddd5d-185">**Příkaz a dotazování odpovědnost oddělení (CQRS)**
    [*https://docs.microsoft.com/azure/architecture/patterns/cqrs*](https://docs.microsoft.com/azure/architecture/patterns/cqrs)</span><span class="sxs-lookup"><span data-stu-id="ddd5d-185">**Command and Query Responsibility Segregation (CQRS)**
[*https://docs.microsoft.com/azure/architecture/patterns/cqrs*](https://docs.microsoft.com/azure/architecture/patterns/cqrs)</span></span>

-   <span data-ttu-id="ddd5d-186">**Komunikace mezi ohraničenou kontexty**
    [*https://msdn.microsoft.com/library/jj591572.aspx*](https://msdn.microsoft.com/library/jj591572.aspx)</span><span class="sxs-lookup"><span data-stu-id="ddd5d-186">**Communicating Between Bounded Contexts**
[*https://msdn.microsoft.com/library/jj591572.aspx*](https://msdn.microsoft.com/library/jj591572.aspx)</span></span>

-   <span data-ttu-id="ddd5d-187">**Konzistence typu případné**
    [*https://en.wikipedia.org/wiki/Eventual\_konzistence*](https://en.wikipedia.org/wiki/Eventual_consistency)</span><span class="sxs-lookup"><span data-stu-id="ddd5d-187">**Eventual consistency**
[*https://en.wikipedia.org/wiki/Eventual\_consistency*](https://en.wikipedia.org/wiki/Eventual_consistency)</span></span>

-   <span data-ttu-id="ddd5d-188">**Jimmy Bogard. Refaktoring směrem odolnost: Vyhodnocení párování**
    [*https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/*](https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/)</span><span class="sxs-lookup"><span data-stu-id="ddd5d-188">**Jimmy Bogard. Refactoring Towards Resilience: Evaluating Coupling**
[*https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/*](https://jimmybogard.com/refactoring-towards-resilience-evaluating-coupling/)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="ddd5d-189">[Předchozí] (komunikace v mikroslužbu architecture.md) [Další] (udržovat mikroslužbu apis.md)</span><span class="sxs-lookup"><span data-stu-id="ddd5d-189">[Previous] (communication-in-microservice-architecture.md) [Next] (maintain-microservice-apis.md)</span></span>
