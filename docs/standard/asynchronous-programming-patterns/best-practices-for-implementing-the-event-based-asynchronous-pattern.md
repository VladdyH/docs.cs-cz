---
title: "Osvědčené postupy pro implementaci asynchronního vzoru založeného na událostech"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Event-based Asynchronous Pattern
- ProgressChangedEventArgs class
- BackgroundWorker component
- events [.NET Framework], asynchronous
- AsyncOperationManager class
- threading [.NET Framework], asynchronous features
- AsyncOperation class
- AsyncCompletedEventArgs class
ms.assetid: 4acd2094-4f46-4eff-9190-92d0d9ff47db
caps.latest.revision: "8"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: ac206e41f727d24e7748226101b9b8a86ee77376
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/23/2017
---
# <a name="best-practices-for-implementing-the-event-based-asynchronous-pattern"></a><span data-ttu-id="ddb1c-102">Osvědčené postupy pro implementaci asynchronního vzoru založeného na událostech</span><span class="sxs-lookup"><span data-stu-id="ddb1c-102">Best Practices for Implementing the Event-based Asynchronous Pattern</span></span>
<span data-ttu-id="ddb1c-103">Asynchronní vzor založený na událostech nabízí efektivní způsob, jak vystavit asynchronní chování v tříd pomocí známých událostí a delegovat sémantiku.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-103">The Event-based Asynchronous Pattern provides you with an effective way to expose asynchronous behavior in classes, with familiar event and delegate semantics.</span></span> <span data-ttu-id="ddb1c-104">Implementovat asynchronní vzor založený na událostech, budete muset postupovat podle několik požadavků na konkrétní chování.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-104">To implement Event-based Asynchronous Pattern, you need to follow some specific behavioral requirements.</span></span> <span data-ttu-id="ddb1c-105">Následující části popisují požadavky a pokyny, které byste měli zvážit při implementaci třídy, která odpovídá asynchronní vzor založený na událostech.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-105">The following sections describe requirements and guidelines you should consider when you implement a class that follows the Event-based Asynchronous Pattern.</span></span>  
  
 <span data-ttu-id="ddb1c-106">Přehled najdete v tématu [implementace asynchronního vzoru založeného na událostech](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="ddb1c-106">For an overview, see [Implementing the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md).</span></span>  
  
## <a name="required-behavioral-guarantees"></a><span data-ttu-id="ddb1c-107">Požadované chování záruky</span><span class="sxs-lookup"><span data-stu-id="ddb1c-107">Required Behavioral Guarantees</span></span>  
 <span data-ttu-id="ddb1c-108">Pokud budete implementovat asynchronní vzor založený na událostech, zadejte počet záruky, aby se zajistilo třídě budou chovat správně a může se spoléhat na takové chování klientů vaší třídy.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-108">If you implement the Event-based Asynchronous Pattern, you must provide a number of guarantees to ensure that your class will behave properly and clients of your class can rely on such behavior.</span></span>  
  
### <a name="completion"></a><span data-ttu-id="ddb1c-109">Dokončení</span><span class="sxs-lookup"><span data-stu-id="ddb1c-109">Completion</span></span>  
 <span data-ttu-id="ddb1c-110">Vždy vyvolat *MethodName* `Completed` obslužné rutiny události, když máte úspěšné dokončení, chybu nebo zrušení.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-110">Always invoke the *MethodName*`Completed` event handler when you have successful completion, an error, or a cancellation.</span></span> <span data-ttu-id="ddb1c-111">Aplikace by nikdy dojít k situaci, kdy se zůstat v nečinnosti a dokončení se nikdy neprovádí.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-111">Applications should never encounter a situation where they remain idle and completion never occurs.</span></span> <span data-ttu-id="ddb1c-112">Jedinou výjimkou tohoto pravidla je, pokud asynchronní operaci samotné je navržené tak, aby se nedokončí.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-112">One exception to this rule is if the asynchronous operation itself it designed so that it never completes.</span></span>  
  
### <a name="completed-event-and-eventargs"></a><span data-ttu-id="ddb1c-113">Dokončení události a EventArgs</span><span class="sxs-lookup"><span data-stu-id="ddb1c-113">Completed Event and EventArgs</span></span>  
 <span data-ttu-id="ddb1c-114">Pro každou zvláštní *MethodName* `Async` metoda, platí následující požadavky návrhu:</span><span class="sxs-lookup"><span data-stu-id="ddb1c-114">For each separate *MethodName*`Async` method, apply the following design requirements:</span></span>  
  
-   <span data-ttu-id="ddb1c-115">Definování *MethodName* `Completed` události u stejné třídy jako metodu.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-115">Define a *MethodName*`Completed` event on the same class as the method.</span></span>  
  
-   <span data-ttu-id="ddb1c-116">Definovat <xref:System.EventArgs> třídy a doprovodné delegáta pro *MethodName* `Completed` událost, která je odvozena z <xref:System.ComponentModel.AsyncCompletedEventArgs> třídy.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-116">Define an <xref:System.EventArgs> class and accompanying delegate for the *MethodName*`Completed` event that derives from the <xref:System.ComponentModel.AsyncCompletedEventArgs> class.</span></span> <span data-ttu-id="ddb1c-117">Výchozí název třídy musí být ve tvaru *MethodName*`CompletedEventArgs`.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-117">The default class name should be of the form *MethodName*`CompletedEventArgs`.</span></span>  
  
-   <span data-ttu-id="ddb1c-118">Ujistěte se, že <xref:System.EventArgs> třída je specifická pro vrácené hodnoty *MethodName* metoda.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-118">Ensure that the <xref:System.EventArgs> class is specific to the return values of the *MethodName* method.</span></span> <span data-ttu-id="ddb1c-119">Při použití <xref:System.EventArgs> třída, byste měli nikdy vyžadovat vývojáři přetypovat výsledek.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-119">When you use the <xref:System.EventArgs> class, you should never require developers to cast the result.</span></span>  
  
     <span data-ttu-id="ddb1c-120">Následující příklad kódu ukazuje funkční a chybný provádění tomuto požadavku návrhu v uvedeném pořadí.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-120">The following code example shows good and bad implementation of this design requirement respectively.</span></span>  
  
```csharp  
// Good design  
private void Form1_MethodNameCompleted(object sender, xxxCompletedEventArgs e)   
{   
    DemoType result = e.Result;  
}  
  
// Bad design  
private void Form1_MethodNameCompleted(object sender, MethodNameCompletedEventArgs e)   
{   
    DemoType result = (DemoType)(e.Result);  
}  
```  
  
-   <span data-ttu-id="ddb1c-121">Nejsou definovány <xref:System.EventArgs> třídy pro vrácení metody, které vracejí `void`.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-121">Do not define an <xref:System.EventArgs> class for returning methods that return `void`.</span></span> <span data-ttu-id="ddb1c-122">Místo toho použít instanci systému <xref:System.ComponentModel.AsyncCompletedEventArgs> třídy.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-122">Instead, use an instance of the <xref:System.ComponentModel.AsyncCompletedEventArgs> class.</span></span>  
  
-   <span data-ttu-id="ddb1c-123">Ujistěte se, že vždy zvýšit *MethodName* `Completed` událostí.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-123">Ensure that you always raise the *MethodName*`Completed` event.</span></span> <span data-ttu-id="ddb1c-124">Tato událost má se vrhnout při úspěšném dokončení, na chybu nebo na zrušení.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-124">This event should be raised on successful completion, on an error, or on cancellation.</span></span> <span data-ttu-id="ddb1c-125">Aplikace by nikdy dojít k situaci, kdy se zůstat v nečinnosti a dokončení se nikdy neprovádí.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-125">Applications should never encounter a situation where they remain idle and completion never occurs.</span></span>  
  
-   <span data-ttu-id="ddb1c-126">Ujistěte se, zachytit všechny výjimky, které ve asynchronní operaci a přiřaďte zachycená výjimka, která má <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-126">Ensure that you catch any exceptions that occur in the asynchronous operation and assign the caught exception to the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property.</span></span>  
  
-   <span data-ttu-id="ddb1c-127">Pokud došlo k chybě dokončení úlohy, nesmí být dostupný výsledky.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-127">If there was an error completing the task, the results should not be accessible.</span></span> <span data-ttu-id="ddb1c-128">Když <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> vlastnost není `null`, ujistěte se, že přístup k libovolné vlastnosti v <xref:System.EventArgs> struktura vyvolá výjimku.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-128">When the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property is not `null`, ensure that accessing any property in the <xref:System.EventArgs> structure raises an exception.</span></span> <span data-ttu-id="ddb1c-129">Použití <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> metoda k provedení tohoto ověření.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-129">Use the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> method to perform this verification.</span></span>  
  
-   <span data-ttu-id="ddb1c-130">Model vypršení časového limitu za chybu.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-130">Model a time out as an error.</span></span> <span data-ttu-id="ddb1c-131">Když dojde k vypršení časového limitu, zvýšit *MethodName* `Completed` událostí a přiřadit <xref:System.TimeoutException> k <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> vlastnost.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-131">When a time out occurs, raise the *MethodName*`Completed` event and assign a <xref:System.TimeoutException> to the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> property.</span></span>  
  
-   <span data-ttu-id="ddb1c-132">Pokud vaše třída podporuje víc souběžných volání, ujistěte se, že *MethodName* `Completed` události obsahuje odpovídající `userSuppliedState` objektu.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-132">If your class supports multiple concurrent invocations, ensure that the *MethodName*`Completed` event contains the appropriate `userSuppliedState` object.</span></span>  
  
-   <span data-ttu-id="ddb1c-133">Ujistěte se, že *MethodName* `Completed` událost se vyvolá, na odpovídající vlákno a v příslušnou dobu v průběhu životního cyklu aplikace.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-133">Ensure that the *MethodName*`Completed` event is raised on the appropriate thread and at the appropriate time in the application lifecycle.</span></span> <span data-ttu-id="ddb1c-134">Další informace najdete v části zřetězení a kontexty.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-134">For more information, see the Threading and Contexts section.</span></span>  
  
### <a name="simultaneously-executing-operations"></a><span data-ttu-id="ddb1c-135">Současně provádění operací</span><span class="sxs-lookup"><span data-stu-id="ddb1c-135">Simultaneously Executing Operations</span></span>  
  
-   <span data-ttu-id="ddb1c-136">Pokud vaše třída podporuje víc souběžných volání, povolte vývojáři sledovat každé vyvolání samostatně definováním *MethodName* `Async` volá přetížení, které přijímá parametr s hodnotou objekt stavu nebo ID úlohy `userSuppliedState`.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-136">If your class supports multiple concurrent invocations, enable the developer to track each invocation separately by defining the *MethodName*`Async` overload that takes an object-valued state parameter, or task ID, called `userSuppliedState`.</span></span> <span data-ttu-id="ddb1c-137">Tento parametr by měl být vždy poslední parametr v *MethodName* `Async` podpis metody.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-137">This parameter should always be the last parameter in the *MethodName*`Async` method's signature.</span></span>  
  
-   <span data-ttu-id="ddb1c-138">Pokud vaše třída definuje *MethodName* `Async` přetížení, které přijímá parametr s hodnotou objekt stavu nebo ID úlohy je nutné sledovat dobu životnosti operace s tímto ID úloh a nezapomeňte poskytnout ho zpátky do dokončení Obslužná rutina.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-138">If your class defines the *MethodName*`Async` overload that takes an object-valued state parameter, or task ID, be sure to track the lifetime of the operation with that task ID, and be sure to provide it back into the completion handler.</span></span> <span data-ttu-id="ddb1c-139">Existují pomocných tříd, které jsou k dispozici na pomoc.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-139">There are helper classes available to assist.</span></span> <span data-ttu-id="ddb1c-140">Další informace o řízení souběžného zpracování najdete v tématu [návod: implementace komponenty, která podporuje asynchronní vzor založený na událostech](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="ddb1c-140">For more information on concurrency management, see [Walkthrough: Implementing a Component That Supports the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span></span>  
  
-   <span data-ttu-id="ddb1c-141">Pokud vaše třída definuje *MethodName* `Async` metoda bez parametr stavu a nepodporuje více souběžných volání, ujistěte se, že jakýkoli pokus o vyvolání *MethodName* `Async` před předchozího *MethodName* `Async` volání dokončil vyvolá <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-141">If your class defines the *MethodName*`Async` method without the state parameter, and it does not support multiple concurrent invocations, ensure that any attempt to invoke *MethodName*`Async` before the prior *MethodName*`Async` invocation has completed raises an <xref:System.InvalidOperationException>.</span></span>  
  
-   <span data-ttu-id="ddb1c-142">Obecně platí, nebyla vyvolána výjimka, pokud *MethodName* `Async` metoda bez `userSuppliedState` parametr vyvolání vícekrát, aby byl více zbývajících operací.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-142">In general, do not raise an exception if the *MethodName*`Async` method without the `userSuppliedState` parameter is invoked multiple times so that there are multiple outstanding operations.</span></span> <span data-ttu-id="ddb1c-143">Může vyvolat výjimku, pokud třídě explicitně nelze zpracování této situace, ale předpokládá, že vývojáři může zpracovat tyto více nelze rozlišit zpětných volání</span><span class="sxs-lookup"><span data-stu-id="ddb1c-143">You can raise an exception when your class explicitly cannot handle that situation, but assume that developers can handle these multiple indistinguishable callbacks</span></span>  
  
### <a name="accessing-results"></a><span data-ttu-id="ddb1c-144">Přístup k výsledky</span><span class="sxs-lookup"><span data-stu-id="ddb1c-144">Accessing Results</span></span>  
  
-   <span data-ttu-id="ddb1c-145">Pokud došlo k chybě při provádění asynchronní operace, nesmí být dostupný výsledky.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-145">If there was an error during execution of the asynchronous operation, the results should not be accessible.</span></span> <span data-ttu-id="ddb1c-146">Ujistěte se, že přístup k libovolné vlastnosti v <xref:System.ComponentModel.AsyncCompletedEventArgs> při <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> není `null` vyvolá výjimku odkazuje <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-146">Ensure that accessing any property in the <xref:System.ComponentModel.AsyncCompletedEventArgs> when <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A> is not `null` raises the exception referenced by <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A>.</span></span> <span data-ttu-id="ddb1c-147"><xref:System.ComponentModel.AsyncCompletedEventArgs> Třída poskytuje <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> metoda pro tento účel.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-147">The <xref:System.ComponentModel.AsyncCompletedEventArgs> class provides the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A> method for this purpose.</span></span>  
  
-   <span data-ttu-id="ddb1c-148">Ujistěte se, že žádný pokus o přístup vyvolá výsledek <xref:System.InvalidOperationException> s oznámením, že operace byla zrušena.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-148">Ensure that any attempt to access the result raises an <xref:System.InvalidOperationException> stating that the operation was canceled.</span></span> <span data-ttu-id="ddb1c-149">Použití <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> metoda k provedení tohoto ověření.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-149">Use the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> method to perform this verification.</span></span>  
  
### <a name="progress-reporting"></a><span data-ttu-id="ddb1c-150">Průběh vytváření sestav</span><span class="sxs-lookup"><span data-stu-id="ddb1c-150">Progress Reporting</span></span>  
  
-   <span data-ttu-id="ddb1c-151">Podpora tvorby sestav průběh, pokud je to možné.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-151">Support progress reporting, if possible.</span></span> <span data-ttu-id="ddb1c-152">To umožňuje vývojářům poskytovat lepší uživatelské prostředí aplikace při použití třídě.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-152">This enables developers to provide a better application user experience when they use your class.</span></span>  
  
-   <span data-ttu-id="ddb1c-153">Pokud budete implementovat `ProgressChanged` / *MethodName* `ProgressChanged` událostí, ujistěte se, že neexistují žádné takové události vyvolané pro konkrétní asynchronní operaci po této operaci *MethodName* `Completed` událost byla vyvolána.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-153">If you implement a `ProgressChanged`/*MethodName*`ProgressChanged` event, ensure that there are no such events raised for a particular asynchronous operation after that operation's *MethodName*`Completed` event has been raised.</span></span>  
  
-   <span data-ttu-id="ddb1c-154">Pokud standardní <xref:System.ComponentModel.ProgressChangedEventArgs> se naplní, ujistěte se, že <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> vždy jde interpretovat jako procento.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-154">If the standard <xref:System.ComponentModel.ProgressChangedEventArgs> is being populated, ensure that the <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> can always be interpreted as a percentage.</span></span> <span data-ttu-id="ddb1c-155">Procento nemusí být přesné, ale jeho by měl představovat procento.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-155">The percentage does not need to be accurate, but it should represent a percentage.</span></span> <span data-ttu-id="ddb1c-156">Pokud průběh reporting metrika musí být něco jiného než procento, odvození třídy z <xref:System.ComponentModel.ProgressChangedEventArgs> třídy a nechte <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> na 0.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-156">If your progress reporting metric must be something other than a percentage, derive a class from the <xref:System.ComponentModel.ProgressChangedEventArgs> class and leave <xref:System.ComponentModel.ProgressChangedEventArgs.ProgressPercentage%2A> at 0.</span></span> <span data-ttu-id="ddb1c-157">Nepoužívejte reporting metrika než v procentech.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-157">Avoid using a reporting metric other than a percentage.</span></span>  
  
-   <span data-ttu-id="ddb1c-158">Ujistěte se, že `ProgressChanged` událost se vyvolá, na odpovídající vlákno a v příslušnou dobu v průběhu životního cyklu aplikace.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-158">Ensure that the `ProgressChanged` event is raised on the appropriate thread and at the appropriate time in the application lifecycle.</span></span> <span data-ttu-id="ddb1c-159">Další informace najdete v části zřetězení a kontexty.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-159">For more information, see the Threading and Contexts section.</span></span>  
  
### <a name="isbusy-implementation"></a><span data-ttu-id="ddb1c-160">Implementace IsBusy</span><span class="sxs-lookup"><span data-stu-id="ddb1c-160">IsBusy Implementation</span></span>  
  
-   <span data-ttu-id="ddb1c-161">Nevystavujte `IsBusy` vlastnost, pokud vaše třída podporuje víc souběžných volání.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-161">Do not expose an `IsBusy` property if your class supports multiple concurrent invocations.</span></span> <span data-ttu-id="ddb1c-162">Například XML webové proxy servery služby nezveřejňují `IsBusy` vlastnost protože podporují více souběžných volání asynchronních metod.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-162">For example, XML Web service proxies do not expose an `IsBusy` property because they support multiple concurrent invocations of asynchronous methods.</span></span>  
  
-   <span data-ttu-id="ddb1c-163">`IsBusy` Vlastnost by měla vrátit `true` po *MethodName* `Async` byla volána metoda a před *MethodName* `Completed` událost byla vyvolána.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-163">The `IsBusy` property should return `true` after the *MethodName*`Async` method has been called and before the *MethodName*`Completed` event has been raised.</span></span> <span data-ttu-id="ddb1c-164">V opačném případě by měla vrátit `false`.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-164">Otherwise it should return `false`.</span></span> <span data-ttu-id="ddb1c-165"><xref:System.ComponentModel.BackgroundWorker> a <xref:System.Net.WebClient> součásti jsou příklady tříd, které zveřejňují `IsBusy` vlastnost.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-165">The <xref:System.ComponentModel.BackgroundWorker> and <xref:System.Net.WebClient> components are examples of classes that expose an `IsBusy` property.</span></span>  
  
### <a name="cancellation"></a><span data-ttu-id="ddb1c-166">Zrušení</span><span class="sxs-lookup"><span data-stu-id="ddb1c-166">Cancellation</span></span>  
  
-   <span data-ttu-id="ddb1c-167">Podpora zrušení, pokud je to možné.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-167">Support cancellation, if possible.</span></span> <span data-ttu-id="ddb1c-168">To umožňuje vývojářům poskytovat lepší uživatelské prostředí aplikace při použití třídě.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-168">This enables developers to provide a better application user experience when they use your class.</span></span>  
  
-   <span data-ttu-id="ddb1c-169">V případě zrušení, nastavte <xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A> příznak v <xref:System.ComponentModel.AsyncCompletedEventArgs> objektu.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-169">In the case of cancellation, set the <xref:System.ComponentModel.AsyncCompletedEventArgs.Cancelled%2A> flag in the <xref:System.ComponentModel.AsyncCompletedEventArgs> object.</span></span>  
  
-   <span data-ttu-id="ddb1c-170">Ujistěte se, že žádný pokus o přístup vyvolá výsledek <xref:System.InvalidOperationException> s oznámením, že operace byla zrušena.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-170">Ensure that any attempt to access the result raises an <xref:System.InvalidOperationException> stating that the operation was canceled.</span></span> <span data-ttu-id="ddb1c-171">Použití <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> metoda k provedení tohoto ověření.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-171">Use the <xref:System.ComponentModel.AsyncCompletedEventArgs.RaiseExceptionIfNecessary%2A?displayProperty=nameWithType> method to perform this verification.</span></span>  
  
-   <span data-ttu-id="ddb1c-172">Zajistěte, aby vždy vrátí úspěšně volání metody zrušení a nikdy vyvolat výjimku.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-172">Ensure that calls to a cancellation method always return successfully, and never raise an exception.</span></span> <span data-ttu-id="ddb1c-173">Obecně platí klient není upozornění, jestli je možné skutečně zrušit operace v každém okamžiku a nezobrazí upozornění, jestli byl úspěšný dřív vydaných zrušení.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-173">In general, a client is not notified as to whether an operation is truly cancelable at any given time, and is not notified as to whether a previously issued cancellation has succeeded.</span></span> <span data-ttu-id="ddb1c-174">Ale aplikace vždy dostanou oznámení při zrušení byly úspěšné, protože aplikace se účastní stav dokončení.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-174">However, the application will always be given notification when a cancellation succeeded, because the application takes part in the completion status.</span></span>  
  
-   <span data-ttu-id="ddb1c-175">Vyvolat *MethodName* `Completed` událost v případě, že byla operace zrušena.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-175">Raise the *MethodName*`Completed` event when the operation is canceled.</span></span>  
  
### <a name="errors-and-exceptions"></a><span data-ttu-id="ddb1c-176">Chyby a výjimky</span><span class="sxs-lookup"><span data-stu-id="ddb1c-176">Errors and Exceptions</span></span>  
  
-   <span data-ttu-id="ddb1c-177">Catch – všechny výjimky, které ve asynchronní operaci a nastavte hodnotu <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A?displayProperty=nameWithType> vlastnost této výjimky.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-177">Catch any exceptions that occur in the asynchronous operation and set the value of the <xref:System.ComponentModel.AsyncCompletedEventArgs.Error%2A?displayProperty=nameWithType> property to that exception.</span></span>  
  
### <a name="threading-and-contexts"></a><span data-ttu-id="ddb1c-178">Zřetězení a kontexty</span><span class="sxs-lookup"><span data-stu-id="ddb1c-178">Threading and Contexts</span></span>  
 <span data-ttu-id="ddb1c-179">Pro správné fungování třídě, je důležité, aby obslužné rutiny událostí klienta jsou vyvolány na správné vlákno nebo kontext pro dané aplikaci modelu, včetně [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] a formulářových aplikací Windows.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-179">For correct operation of your class, it is critical that the client's event handlers are invoked on the proper thread or context for the given application model, including [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] and Windows Forms applications.</span></span> <span data-ttu-id="ddb1c-180">K zajištění správně chová asynchronní třídu v rámci modelu všechny aplikace jsou uvedeny dvě důležité pomocné třídy: <xref:System.ComponentModel.AsyncOperation> a <xref:System.ComponentModel.AsyncOperationManager>.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-180">Two important helper classes are provided to ensure that your asynchronous class behaves correctly under any application model: <xref:System.ComponentModel.AsyncOperation> and <xref:System.ComponentModel.AsyncOperationManager>.</span></span>  
  
 <span data-ttu-id="ddb1c-181"><xref:System.ComponentModel.AsyncOperationManager>poskytuje jednu metodu <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A>, která vrátí <xref:System.ComponentModel.AsyncOperation>.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-181"><xref:System.ComponentModel.AsyncOperationManager> provides one method, <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A>, which returns an <xref:System.ComponentModel.AsyncOperation>.</span></span> <span data-ttu-id="ddb1c-182">Vaše *MethodName* `Async` volání metod <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A> a používá třídu vrácený <xref:System.ComponentModel.AsyncOperation> sledovat životnost asynchronní úlohu.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-182">Your *MethodName*`Async` method calls <xref:System.ComponentModel.AsyncOperationManager.CreateOperation%2A> and your class uses the returned <xref:System.ComponentModel.AsyncOperation> to track the lifetime of the asynchronous task.</span></span>  
  
 <span data-ttu-id="ddb1c-183">Chcete-li sestavy průběhu, přírůstkové výsledky a dokončení klientovi, volejte <xref:System.ComponentModel.AsyncOperation.Post%2A> a <xref:System.ComponentModel.AsyncOperation.OperationCompleted%2A> metody na <xref:System.ComponentModel.AsyncOperation>.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-183">To report progress, incremental results, and completion to the client, call the <xref:System.ComponentModel.AsyncOperation.Post%2A> and <xref:System.ComponentModel.AsyncOperation.OperationCompleted%2A> methods on the <xref:System.ComponentModel.AsyncOperation>.</span></span> <span data-ttu-id="ddb1c-184"><xref:System.ComponentModel.AsyncOperation>zodpovídá za zařazování volání obslužné rutiny událostí klienta do správné vlákna nebo kontextu.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-184"><xref:System.ComponentModel.AsyncOperation> is responsible for marshaling calls to the client's event handlers to the proper thread or context.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ddb1c-185">Tato pravidla můžete obejít, pokud explicitně chcete přejít na zásad aplikačního modelu služby, ale stále těžit z další výhody použití asynchronního vzoru založeného na událostech.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-185">You can circumvent these rules if you explicitly want to go against the policy of the application model, but still benefit from the other advantages of using the Event-based Asynchronous Pattern.</span></span> <span data-ttu-id="ddb1c-186">Můžete například, že třídu operační ve Windows Forms jako volné zařazování.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-186">For example, you may want a class operating in Windows Forms to be free threaded.</span></span> <span data-ttu-id="ddb1c-187">Volné zařazování třídu, můžete vytvořit tak dlouho, dokud vývojáři pochopit předpokládané omezení.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-187">You can create a free threaded class, as long as developers understand the implied restrictions.</span></span> <span data-ttu-id="ddb1c-188">Konzolové aplikace nesynchronizovat provádění <xref:System.ComponentModel.AsyncOperation.Post%2A> volání.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-188">Console applications do not synchronize the execution of <xref:System.ComponentModel.AsyncOperation.Post%2A> calls.</span></span> <span data-ttu-id="ddb1c-189">To může způsobit `ProgressChanged` události, které má být aktivována mimo pořadí.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-189">This can cause `ProgressChanged` events to be raised out of order.</span></span> <span data-ttu-id="ddb1c-190">Pokud chcete mít serializovat provádění <xref:System.ComponentModel.AsyncOperation.Post%2A> volání, implementaci a nainstalovat <xref:System.Threading.SynchronizationContext?displayProperty=nameWithType> třídy.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-190">If you wish to have serialized execution of <xref:System.ComponentModel.AsyncOperation.Post%2A> calls, implement and install a <xref:System.Threading.SynchronizationContext?displayProperty=nameWithType> class.</span></span>  
  
 <span data-ttu-id="ddb1c-191">Další informace o používání <xref:System.ComponentModel.AsyncOperation> a <xref:System.ComponentModel.AsyncOperationManager> povolit asynchronních operací, najdete v části [návod: implementace komponenty, která podporuje asynchronní vzor založený na událostech](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span><span class="sxs-lookup"><span data-stu-id="ddb1c-191">For more information about using <xref:System.ComponentModel.AsyncOperation> and <xref:System.ComponentModel.AsyncOperationManager> to enable your asynchronous operations, see [Walkthrough: Implementing a Component That Supports the Event-based Asynchronous Pattern](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md).</span></span>  
  
## <a name="guidelines"></a><span data-ttu-id="ddb1c-192">Pokyny</span><span class="sxs-lookup"><span data-stu-id="ddb1c-192">Guidelines</span></span>  
  
-   <span data-ttu-id="ddb1c-193">V ideálním případě by měl být každé volání metody nezávisle na ostatních.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-193">Ideally, each method invocation should be independent of others.</span></span> <span data-ttu-id="ddb1c-194">Vyhněte se spojovacím volání se sdílenými prostředky.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-194">You should avoid coupling invocations with shared resources.</span></span> <span data-ttu-id="ddb1c-195">Pokud prostředky se mají být sdílena mezi volání, musíte zadat správný synchronizační mechanismus v implementaci.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-195">If resources are to be shared among invocations, you will need to provide a proper synchronization mechanism in your implementation.</span></span>  
  
-   <span data-ttu-id="ddb1c-196">Návrhy, které vyžadují implementace synchronizace klienta se nedoporučuje.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-196">Designs that require the client to implement synchronization are discouraged.</span></span> <span data-ttu-id="ddb1c-197">Například můžete mít asynchronní metody, která přijímá objekt globální statické jako parametr; více souběžných volání tato metoda by mohla způsobit poškození dat nebo zablokování.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-197">For example, you could have an asynchronous method that receives a global static object as a parameter; multiple concurrent invocations of such a method could result in data corruption or deadlocks.</span></span>  
  
-   <span data-ttu-id="ddb1c-198">Pokud implementujete metodu s více volání přetížení (`userState` v podpisu), třídě bude muset spravovat kolekci stavů uživatele nebo ID úloh a jejich odpovídajících čekající operace.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-198">If you implement a method with the multiple-invocation overload (`userState` in the signature), your class will need to manage a collection of user states, or task IDs, and their corresponding pending operations.</span></span> <span data-ttu-id="ddb1c-199">Tato kolekce by měly být chráněné s `lock` oblastí, protože u různých volání přidávat a odebírat `userState` objekty v kolekci.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-199">This collection should be protected with `lock` regions, because the various invocations add and remove `userState` objects in the collection.</span></span>  
  
-   <span data-ttu-id="ddb1c-200">Zvažte použití `CompletedEventArgs` třídy, pokud je to vhodné a vhodné.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-200">Consider reusing `CompletedEventArgs` classes where feasible and appropriate.</span></span> <span data-ttu-id="ddb1c-201">V takovém případě není konzistentní s názvem metody pojmenování protože dané delegáta a <xref:System.EventArgs> nejsou typu vázané na jedné metody.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-201">In this case, the naming is not consistent with the method name, because a given delegate and <xref:System.EventArgs> type are not tied to a single method.</span></span> <span data-ttu-id="ddb1c-202">Ale vynucení vývojářům načíst z vlastnosti na hodnotu přetypovat <xref:System.EventArgs> nikdy je přijatelná.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-202">However, forcing developers to cast the value retrieved from a property on the <xref:System.EventArgs> is never acceptable.</span></span>  
  
-   <span data-ttu-id="ddb1c-203">Vytváříte-li třídu odvozenou z <xref:System.ComponentModel.Component>, není implementovat a nainstalujte si vlastní <xref:System.Threading.SynchronizationContext> třídy.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-203">If you are authoring a class that derives from <xref:System.ComponentModel.Component>, do not implement and install your own <xref:System.Threading.SynchronizationContext> class.</span></span> <span data-ttu-id="ddb1c-204">Modely aplikace, není součástí, ovládacího prvku <xref:System.Threading.SynchronizationContext> používané.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-204">Application models, not components, control the <xref:System.Threading.SynchronizationContext> that is used.</span></span>  
  
-   <span data-ttu-id="ddb1c-205">Při použití více vláken jakéhokoli druhu potenciálně vystavit sami na velmi závažnou a komplexní chyby.</span><span class="sxs-lookup"><span data-stu-id="ddb1c-205">When you use multithreading of any sort, you potentially expose yourself to very serious and complex bugs.</span></span> <span data-ttu-id="ddb1c-206">Před implementací jakéhokoli řešení, které používá více vláken, najdete v části [spravované dělení na vlákna osvědčené postupy](../../../docs/standard/threading/managed-threading-best-practices.md).</span><span class="sxs-lookup"><span data-stu-id="ddb1c-206">Before implementing any solution that uses multithreading, see [Managed Threading Best Practices](../../../docs/standard/threading/managed-threading-best-practices.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ddb1c-207">Viz také</span><span class="sxs-lookup"><span data-stu-id="ddb1c-207">See Also</span></span>  
 <xref:System.ComponentModel.AsyncOperation>  
 <xref:System.ComponentModel.AsyncOperationManager>  
 <xref:System.ComponentModel.AsyncCompletedEventArgs>  
 <xref:System.ComponentModel.ProgressChangedEventArgs>  
 <xref:System.ComponentModel.BackgroundWorker>  
 [<span data-ttu-id="ddb1c-208">Implementace asynchronního vzoru založeného na událostech</span><span class="sxs-lookup"><span data-stu-id="ddb1c-208">Implementing the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/implementing-the-event-based-asynchronous-pattern.md)  
 [<span data-ttu-id="ddb1c-209">Vícevláknové programování s asynchronním vzorem založeným na událostech</span><span class="sxs-lookup"><span data-stu-id="ddb1c-209">Multithreaded Programming with the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/multithreaded-programming-with-the-event-based-asynchronous-pattern.md)  
 [<span data-ttu-id="ddb1c-210">Rozhodování, kdy implementovat asynchronní vzor založený na událostech</span><span class="sxs-lookup"><span data-stu-id="ddb1c-210">Deciding When to Implement the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/deciding-when-to-implement-the-event-based-asynchronous-pattern.md)  
 [<span data-ttu-id="ddb1c-211">Osvědčené postupy pro implementaci asynchronního vzoru založeného na událostech</span><span class="sxs-lookup"><span data-stu-id="ddb1c-211">Best Practices for Implementing the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/best-practices-for-implementing-the-event-based-asynchronous-pattern.md)  
 [<span data-ttu-id="ddb1c-212">Postupy: Použití komponent, které podporují asynchronní vzor založený na událostech</span><span class="sxs-lookup"><span data-stu-id="ddb1c-212">How to: Use Components That Support the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/how-to-use-components-that-support-the-event-based-asynchronous-pattern.md)  
 [<span data-ttu-id="ddb1c-213">Návod: Implementace komponenty, která podporuje asynchronní vzor založený na událostech</span><span class="sxs-lookup"><span data-stu-id="ddb1c-213">Walkthrough: Implementing a Component That Supports the Event-based Asynchronous Pattern</span></span>](../../../docs/standard/asynchronous-programming-patterns/component-that-supports-the-event-based-asynchronous-pattern.md)
