<span data-ttu-id="39b7f-101">Pomocí znakový indexování s <xref:System.Text.StringBuilder.Chars%2A> vlastnost může být velmi pomalé za následujících podmínek:</span><span class="sxs-lookup"><span data-stu-id="39b7f-101">Using character-based indexing with the <xref:System.Text.StringBuilder.Chars%2A> property can be extremely slow under the following conditions:</span></span>

- <span data-ttu-id="39b7f-102"><xref:System.Text.StringBuilder> Instance je velký (například obsahuje několik desítkami tisíc znaků).</span><span class="sxs-lookup"><span data-stu-id="39b7f-102">The <xref:System.Text.StringBuilder> instance is large (for example, it consists of several tens of thousands of characters).</span></span>
- <span data-ttu-id="39b7f-103"><xref:System.Text.StringBuilder> Je "rozsekaně."</span><span class="sxs-lookup"><span data-stu-id="39b7f-103">The <xref:System.Text.StringBuilder> is "chunky."</span></span> <span data-ttu-id="39b7f-104">To znamená, jako například opakovaná volání metody <xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType> mají automaticky rozšířena objektu <xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType> vlastnost a přidělené nové bloky paměti k němu.</span><span class="sxs-lookup"><span data-stu-id="39b7f-104">That is, repeated calls to methods such as <xref:System.Text.StringBuilder.Append%2A?displayProperty=nameWithType> have automatically expanded the object's <xref:System.Text.StringBuilder.Capacity%2A?displayProperty=nameWithType> property and allocated new chunks of memory to it.</span></span>

<span data-ttu-id="39b7f-105">Protože každý znak přístup provede celou odkazovaného seznamu bloků dat najít správný vyrovnávací paměť k indexování do je závažný dopad výkon.</span><span class="sxs-lookup"><span data-stu-id="39b7f-105">Performance is severely impacted because each character access walks the entire linked list of chunks to find the correct buffer to index into.</span></span>

> [!NOTE]
>  <span data-ttu-id="39b7f-106">I pro velké "rozsekaně" <xref:System.Text.StringBuilder> objektu, pomocí <xref:System.Text.StringBuilder.Chars%2A> vlastnost pro přístup na základě indexu na jeden nebo malý počet znaků má dopad na výkon zanedbatelný, obvykle je **0(n)** operaci.</span><span class="sxs-lookup"><span data-stu-id="39b7f-106">Even for a large "chunky" <xref:System.Text.StringBuilder> object, using the <xref:System.Text.StringBuilder.Chars%2A> property for index-based access to one or a small number of characters has a negligible performance impact; typically, it is an **0(n)** operation.</span></span> <span data-ttu-id="39b7f-107">Dopad na výkon významné nastane, když iterace znakům <xref:System.Text.StringBuilder> objekt, který je **O(n^2)** operaci.</span><span class="sxs-lookup"><span data-stu-id="39b7f-107">The significant performance impact occurs when iterating the characters in the <xref:System.Text.StringBuilder> object, which is an **O(n^2)** operation.</span></span> 

<span data-ttu-id="39b7f-108">Pokud narazíte na problémy s výkonem při použití znakový indexování s <xref:System.Text.StringBuilder> objekty, můžete použít některou z následujících řešení:</span><span class="sxs-lookup"><span data-stu-id="39b7f-108">If you encounter performance issues when using character-based indexing with <xref:System.Text.StringBuilder> objects, you can use any of the following workarounds:</span></span>

- <span data-ttu-id="39b7f-109">Převést <xref:System.Text.StringBuilder> instance k <xref:System.String> voláním <xref:System.Text.StringBuilder.ToString%2A> metoda, pak přístup ke znakům v řetězci.</span><span class="sxs-lookup"><span data-stu-id="39b7f-109">Convert the <xref:System.Text.StringBuilder> instance to a <xref:System.String> by calling the <xref:System.Text.StringBuilder.ToString%2A> method, then access the characters in the string.</span></span>

- <span data-ttu-id="39b7f-110">Zkopírujte obsah existující <xref:System.Text.StringBuilder> předem velikost objektu na nový <xref:System.Text.StringBuilder> objektu.</span><span class="sxs-lookup"><span data-stu-id="39b7f-110">Copy the contents of the existing <xref:System.Text.StringBuilder> object to a new pre-sized <xref:System.Text.StringBuilder> object.</span></span> <span data-ttu-id="39b7f-111">Zvyšuje výkon, protože nové <xref:System.Text.StringBuilder> objekt není rozsekaně.</span><span class="sxs-lookup"><span data-stu-id="39b7f-111">Performance improves because the new <xref:System.Text.StringBuilder> object is not chunky.</span></span> <span data-ttu-id="39b7f-112">Příklad:</span><span class="sxs-lookup"><span data-stu-id="39b7f-112">For example:</span></span>

   ```csharp
   // sbOriginal is the existing StringBuilder object
   var sbNew = new StringBuilder(sbOriginal.ToString(), sbOriginal.Length);
   ```
   ```vb
   ' sbOriginal is the existing StringBuilder object
   Dim sbNew = New StringBuilder(sbOriginal.ToString(), sbOriginal.Length)
   ```
- <span data-ttu-id="39b7f-113">Nastavit počáteční kapacitu <xref:System.Text.StringBuilder> objekt, který má hodnotu, která je přibližně stejné očekávanou velikost voláním <xref:System.Text.StringBuilder.%23ctor(System.Int32)> konstruktor.</span><span class="sxs-lookup"><span data-stu-id="39b7f-113">Set the initial capacity of the <xref:System.Text.StringBuilder> object to a value that is approximately equal to its maximum expected size by calling the <xref:System.Text.StringBuilder.%23ctor(System.Int32)> constructor.</span></span> <span data-ttu-id="39b7f-114">Všimněte si, že to přiděluje celý blok paměti, i když <xref:System.Text.StringBuilder> zřídka dosáhne své maximální kapacity.</span><span class="sxs-lookup"><span data-stu-id="39b7f-114">Note that this allocates the entire block of memory even if the <xref:System.Text.StringBuilder> rarely reaches its maximum capacity.</span></span>
