### <a name="new-64-bit-jit-compiler-in-the-net-framework-46"></a>Nové 64bitový kompilátor JIT v rozhraní .NET Framework 4.6

|   |   |
|---|---|
|Podrobnosti|Od verze rozhraní .NET Framework 4.6, nové 64bitový kompilátor JIT se používá pro kompilaci za běhu. V některých případech se vyvolala Neočekávaná výjimka nebo různé chování pozorovanou než pokud aplikace běží, pomocí kompilátoru 32-bit nebo starší 64bitový kompilátor JIT. Tato změna nemá vliv na 32-bit kompilátoru za běhu. Známé rozdíly zahrnují následující:<ul><li>Za určitých podmínek může vyvolat operace rozbalení <xref:System.NullReferenceException> v sestavení pro vydání s optimalizací zapnutý.</li><li>V některých případech může spuštění produkčním kódu v textu obsáhlou metodu throw <xref:System.StackOverflowException>.</li><li>Za určitých podmínek struktury předána metodě, jsou považovány za odkazové typy spíš než jako hodnota typy v verzi sestavení. Jedním z projevů tohoto problému je, že jednotlivé položky v kolekci se objeví v neočekávaném pořadí.</li><li>Za určitých podmínek, při porovnání <xref:System.UInt16> hodnoty sadou jejich rozšířené je nesprávný, pokud je povolená optimalizace.</li><li>Za určitých podmínek, zejména při inicializaci pole hodnot, inicializace paměti pomocí <xref:System.Reflection.Emit.OpCodes.Initblk?displayProperty=nameWithType> IL instrukce může inicializovat paměť s nesprávnou hodnotu. To může způsobit buď v neošetřené výjimky nebo nesprávné výstup.</li><li>Za určitých výjimečných podmínek, může vrátit testu podmíněného bit nesprávném <xref:System.Boolean> hodnotu nebo vyvolána výjimka, pokud jsou povolené optimalizace kompilátoru.</li><li>Za určitých podmínek Pokud <code>if</code> příkaz se používá k testování pro podmínku před vstupem <code>try</code> bloku a ve výstupu z <code>try</code> bloku a stejné podmínku vyhodnotí v <code>catch</code> nebo <code>finally</code> bloku, nové 64bitový kompilátor JIT odebere <code>if</code> podmínky z <code>catch</code> nebo <code>finally</code> blokovat, když optimalizuje kódu. V důsledku toho code uvnitř <code>if</code> příkaz v <code>catch</code> nebo <code>finally</code> bezpodmínečně vykonání bloku.</li></ul>|
|Návrh|<strong>Zmírnění dopadů známých problémů</strong> <br/> Pokud narazíte na problémy uvedené výše, můžete je vyřešit pomocí některého z následujících akcí:<ul><li>Upgrade na rozhraní .NET Framework 4.6.2. Nové 64bitový kompilátor součástí rozhraní .NET Framework 4.6.2 řeší každý z těchto známých problémů.</li><li>Zajistěte, aby byl vaši verzi systému Windows aktuální spuštěním služby Windows Update. Aktualizace služby rozhraní .NET Framework 4.6 a 4.6.1 se vztahují na všechny tyto problémy s výjimkou <xref:System.NullReferenceException> v rozbalení operace.</li><li>Kompilace s starší 64bitový kompilátor JIT. Najdete v článku <strong>zmírnění další problémy</strong> části Další informace o tom, jak to udělat.</li></ul><strong>Zmírnění dopadů jiné problémy</strong> <br/> Pokud narazíte na žádné jiné rozdíl v chování mezi kódem kompilovat s starší 64bitový kompilátor a nové 64bitový kompilátor JIT, nebo mezi ladění a vydání verze aplikace, které jsou kompilovat s novou 64bitový kompilátor JIT, můžete provést následující sestavovat aplikace pomocí starší 64bitový kompilátor JIT:<ul><li>Na základě jednotlivých aplikací, můžete přidat [ < ](~/docs/framework/configure-apps/file-schema/runtime/uselegacyjit-element.md) element konfiguračního souboru aplikace. Následující zakáže kompilaci s novou 64bitový kompilátor JIT a místo toho používá starší verze 64bitový kompilátor JIT.</li></ul><pre><code class="lang-xml">&lt;?xml version =&quot;1.0&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;useLegacyJit enabled=&quot;1&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre><ul><li>U každého uživatele zvlášť, můžete přidat <code>REG_DWORD</code> hodnotu s názvem <code>useLegacyJit</code> k <code>HKEY_CURRENT_USER\SOFTWARE\Microsoft\.NETFramework</code> klíče registru. Hodnota 1 povolí starší verze kompilátoru JIT 64-bit; Hodnota 0 zakáže ho a umožňuje nové 64bitový kompilátor JIT.</li><li>U jednotlivých počítačů, můžete přidat <code>REG_DWORD</code> hodnotu s názvem <code>useLegacyJit</code> k <code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework</code> klíče registru. Hodnota <code>1</code> kompilátoru JIT umožňuje starší verze 64-bit; hodnota <code>0</code> zakáže ho a umožňuje nové 64bitový kompilátor JIT.</li></ul>Vám může také dejte nám vědět o problému pomocí hlášení chyby na [Microsoft Connect](https://connect.microsoft.com/VisualStudio).|
|Rozsah|Edge|
|Version|4.6|
|Typ|Změna orientace|

